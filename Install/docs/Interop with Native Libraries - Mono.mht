From: <Saved by Windows Internet Explorer 8>
Subject: Interop with Native Libraries - Mono
Date: Tue, 20 Nov 2012 21:48:29 +1100
MIME-Version: 1.0
Content-Type: multipart/related;
	type="text/html";
	boundary="----=_NextPart_000_0029_01CDC768.C75D0220"
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.6157

This is a multi-part message in MIME format.

------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: text/html;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable
Content-Location: http://www.mono-project.com/Interop_with_Native_Libraries

=EF=BB=BF<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML dir=3Dltr lang=3Den xml:lang=3D"en"=20
xmlns=3D"http://www.w3.org/1999/xhtml"><HEAD><TITLE>Interop with Native =
Libraries - Mono</TITLE>
<META content=3D"text/html; charset=3DUTF-8" http-equiv=3DContent-Type>
<META name=3DGENERATOR content=3D"MSHTML 8.00.6001.19328">
<META name=3Dverify-vl=20
content=3D'CdUrKULfeirXCs/Mpc2sobgsPFNoqmiRL/5n0n08dAY=3D" />'><LINK=20
rel=3D"shortcut icon" href=3D"/favicon.ico"><LINK title=3D"Mono (en)" =
rel=3Dsearch=20
type=3Dapplication/opensearchdescription+xml =
href=3D"/opensearch_desc.php"><LINK=20
rel=3DEditURI type=3Dapplication/rsd+xml=20
href=3D"http://www.mono-project.com/api.php?action=3Drsd"><LINK=20
title=3D"Mono Atom feed" rel=3Dalternate type=3Dapplication/atom+xml=20
href=3D"?title=3DSpecial:RecentChanges&amp;feed=3Datom"><LINK =
title=3DRSS rel=3Dalternate=20
type=3Dapplication/rss+xml href=3D"/news/index.rss2"><LINK =
rel=3Dstylesheet=20
type=3Dtext/css =
href=3D"http://www.mono-project.com/skins/common/commonPrint.css"=20
media=3Dprint><LINK rel=3Dstylesheet type=3Dtext/css=20
href=3D"http://www.mono-project.com/skins/MonoWaveWide/screen.css" =
media=3Dscreen>
<SCRIPT type=3Dtext/javascript>=0A=
       var stylepath=3D"/skins";=0A=
       var skin=3D"MonoWaveWide";=0A=
       var wgContentLanguage=3D"en"=0A=
    </SCRIPT>

<SCRIPT type=3Dtext/javascript=20
src=3D"http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"><=
/SCRIPT>

<SCRIPT type=3Dtext/javascript=20
src=3D"http://www.mono-project.com/skins/MonoWaveWide/prototype.js"></SCR=
IPT>

<SCRIPT type=3Dtext/javascript=20
src=3D"http://www.mono-project.com/skins/MonoWaveWide/wikihacks.js"></SCR=
IPT>

<SCRIPT type=3Dtext/javascript=20
src=3D"http://www.mono-project.com/skins/common/wikibits.js"></SCRIPT>

<SCRIPT type=3Dtext/javascript=20
src=3D"http://www.google-analytics.com/urchin.js"> </SCRIPT>

<SCRIPT type=3Dtext/javascript>=0A=
        _uacct =3D "UA-76510-1";=0A=
       if (typeof (urchinTracker) =3D=3D 'function')=0A=
	       urchinTracker();=0A=
    </SCRIPT>
</HEAD>
<BODY id=3Dpage-InteropwithNativeLibraries>
<DIV id=3Dheader>
<DIV class=3Dwrapper>
<H1>Mono</H1><A title=3DMono href=3D"http://mono-project.com/">
<DIV id=3Dmono-logo></DIV></A>
<UL>
  <LI id=3Dmenu-n-home><A=20
  href=3D"http://www.mono-project.com/Main_Page">Home</A></LI>
  <LI id=3Dmenu-n-download><A=20
  =
href=3D"http://www.go-mono.com/mono-downloads/download.html">Download</A>=
</LI>
  <LI id=3Dmenu-n-start class=3Dcurrent_page_item><A=20
  href=3D"http://www.mono-project.com/Start">Start</A></LI>
  <LI id=3Dmenu-n-news><A =
href=3D"http://www.mono-project.com/news/">News</A></LI>
  <LI id=3Dmenu-n-contribute><A=20
  href=3D"http://www.mono-project.com/Contributing">Contribute</A></LI>
  <LI id=3Dmenu-n-community><A=20
  href=3D"http://www.mono-project.com/Community">Community</A></LI>
  <LI id=3Dmenu-n-ios><A =
href=3D"http://xamarin.com/monotouch">iOS</A></LI>
  <LI id=3Dmenu-n-android><A =
href=3D"http://android.xamarin.com/">android</A></LI>
  <LI id=3Dmenu-n-support><A=20
  href=3D"http://www.mono-project.com/Support">Support</A></LI></UL>
<DIV id=3Dsearch>
<FORM method=3Dget action=3Dhttp://www.google.com/search?>
<DIV><INPUT id=3Dsitesearch value=3Dwww.mono-project.com type=3Dhidden=20
name=3Dsitesearch> <INPUT id=3Ddomains value=3Dwww.mono-project.com =
type=3Dhidden=20
name=3Ddomains> <INPUT onblur=3D"if (this.value =3D=3D '') =
this.value=3D'Search Mono';"=20
id=3Dq class=3Dtext onfocus=3D"if (this.value =3D=3D 'Search Mono') =
this.value=3D'';"=20
value=3D"Search Mono" type=3Dtext name=3Dq> <INPUT class=3Dbutton =
value=3DGo type=3Dsubmit>=20
</DIV></FORM></DIV><!--#search--></DIV><!--.wrapper--></DIV><!--#header--=
>
<DIV id=3Dpage>
<DIV id=3Dcontent-header>
<H2><!--BEGIN PAGE TITLE-->Interop with Native=20
Libraries<!--END PAGE TITLE--></H2></DIV>
<DIV id=3Dwrapper class=3Dwide>
<DIV id=3Dsidebar>
<DIV=20
id=3Dtoc-parent></DIV><!-- BEGIN SIDE CONTENT --><!-- END SIDE CONTENT =
--></DIV><!--#sidebar-->
<DIV id=3Dcontent class=3Dwide><!-- BEGIN MAIN CONTENT -->
<P>Everything you (n)ever wanted to know about marshaling (and were =
afraid to=20
ask!) </P>
<P>By Jonathan Pryor Contributions: Hisham Mardam Bey </P>
<TABLE id=3Dtoc class=3Dtoc>
  <TBODY>
  <TR>
    <TD>
      <DIV id=3Dtoctitle>
      <H2>Table of contents</H2></DIV>
      <UL>
        <LI class=3D"toclevel-1 tocsection-1"><A=20
        =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Introdu=
ction"><SPAN=20
        class=3Dtocnumber>1</SPAN> <SPAN=20
class=3Dtoctext>Introduction</SPAN></A></LI>
        <LI class=3D"toclevel-1 tocsection-2"><A=20
        =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Library=
_Handling"><SPAN=20
        class=3Dtocnumber>2</SPAN> <SPAN class=3Dtoctext>Library =
Handling</SPAN></A>=20

        <UL>
          <LI class=3D"toclevel-2 tocsection-3"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Windows=
_DLL_Search_Path"><SPAN=20
          class=3Dtocnumber>2.1</SPAN> <SPAN class=3Dtoctext>Windows DLL =
Search=20
          Path</SPAN></A></LI>
          <LI class=3D"toclevel-2 tocsection-4"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Linux_S=
hared_Library_Search_Path"><SPAN=20
          class=3Dtocnumber>2.2</SPAN> <SPAN class=3Dtoctext>Linux =
Shared Library=20
          Search Path</SPAN></A></LI>
          <LI class=3D"toclevel-2 tocsection-5"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Mac_OS_=
X_Framework_and_.dylib_Search_Path"><SPAN=20
          class=3Dtocnumber>2.3</SPAN> <SPAN class=3Dtoctext>Mac OS X =
Framework and=20
          .dylib Search Path</SPAN></A></LI>
          <LI class=3D"toclevel-2 tocsection-6"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Library=
_Names"><SPAN=20
          class=3Dtocnumber>2.4</SPAN> <SPAN class=3Dtoctext>Library=20
          Names</SPAN></A></LI></UL></LI>
        <LI class=3D"toclevel-1 tocsection-7"><A=20
        =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Invokin=
g_Unmanaged_Code"><SPAN=20
        class=3Dtocnumber>3</SPAN> <SPAN class=3Dtoctext>Invoking =
Unmanaged=20
        Code</SPAN></A>=20
        <UL>
          <LI class=3D"toclevel-2 tocsection-8"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Runtime=
_Exception_Propagation"><SPAN=20
          class=3Dtocnumber>3.1</SPAN> <SPAN class=3Dtoctext>Runtime =
Exception=20
          Propagation</SPAN></A></LI></UL></LI>
        <LI class=3D"toclevel-1 tocsection-9"><A=20
        =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Marshal=
ing"><SPAN=20
        class=3Dtocnumber>4</SPAN> <SPAN =
class=3Dtoctext>Marshaling</SPAN></A>=20
        <UL>
          <LI class=3D"toclevel-2 tocsection-10"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Memory_=
Boundaries"><SPAN=20
          class=3Dtocnumber>4.1</SPAN> <SPAN class=3Dtoctext>Memory=20
          Boundaries</SPAN></A></LI>
          <LI class=3D"toclevel-2 tocsection-11"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Blittab=
le_Types"><SPAN=20
          class=3Dtocnumber>4.2</SPAN> <SPAN class=3Dtoctext>Blittable=20
          Types</SPAN></A></LI>
          <LI class=3D"toclevel-2 tocsection-12"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Strings=
"><SPAN=20
          class=3Dtocnumber>4.3</SPAN> <SPAN =
class=3Dtoctext>Strings</SPAN></A>=20
          <UL>
            <LI class=3D"toclevel-3 tocsection-13"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#More_Co=
ntrol"><SPAN=20
            class=3Dtocnumber>4.3.1</SPAN> <SPAN class=3Dtoctext>More=20
            Control</SPAN></A></LI>
            <LI class=3D"toclevel-3 tocsection-14"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Passing=
_Caller-Modifiable_Strings"><SPAN=20
            class=3Dtocnumber>4.3.2</SPAN> <SPAN class=3Dtoctext>Passing =

            Caller-Modifiable Strings</SPAN></A></LI>
            <LI class=3D"toclevel-3 tocsection-15"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Strings=
_as_Return_Values"><SPAN=20
            class=3Dtocnumber>4.3.3</SPAN> <SPAN class=3Dtoctext>Strings =
as Return=20
            Values</SPAN></A></LI></UL></LI>
          <LI class=3D"toclevel-2 tocsection-16"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Class_a=
nd_Structure_Marshaling"><SPAN=20
          class=3Dtocnumber>4.4</SPAN> <SPAN class=3Dtoctext>Class and =
Structure=20
          Marshaling</SPAN></A>=20
          <UL>
            <LI class=3D"toclevel-3 tocsection-17"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Class_M=
arshaling"><SPAN=20
            class=3Dtocnumber>4.4.1</SPAN> <SPAN class=3Dtoctext>Class=20
            Marshaling</SPAN></A></LI>
            <LI class=3D"toclevel-3 tocsection-18"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Structu=
re_Marshaling"><SPAN=20
            class=3Dtocnumber>4.4.2</SPAN> <SPAN =
class=3Dtoctext>Structure=20
            Marshaling</SPAN></A></LI>
            <LI class=3D"toclevel-3 tocsection-19"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Classes=
_and_Structures_as_Return_Values"><SPAN=20
            class=3Dtocnumber>4.4.3</SPAN> <SPAN class=3Dtoctext>Classes =
and=20
            Structures as Return Values</SPAN></A></LI>
            <LI class=3D"toclevel-3 tocsection-20"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Memory_=
Management"><SPAN=20
            class=3Dtocnumber>4.4.4</SPAN> <SPAN class=3Dtoctext>Memory=20
            Management</SPAN></A></LI>
            <LI class=3D"toclevel-3 tocsection-21"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Choosin=
g_between_Classes_and_Structures"><SPAN=20
            class=3Dtocnumber>4.4.5</SPAN> <SPAN =
class=3Dtoctext>Choosing between=20
            Classes and Structures</SPAN></A></LI></UL></LI>
          <LI class=3D"toclevel-2 tocsection-22"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Summary=
"><SPAN=20
          class=3Dtocnumber>4.5</SPAN> <SPAN =
class=3Dtoctext>Summary</SPAN></A></LI>
          <LI class=3D"toclevel-2 tocsection-23"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Marshal=
ing_Class_and_Structure_Members"><SPAN=20
          class=3Dtocnumber>4.6</SPAN> <SPAN class=3Dtoctext>Marshaling =
Class and=20
          Structure Members</SPAN></A>=20
          <UL>
            <LI class=3D"toclevel-3 tocsection-24"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Boolean=
_Members"><SPAN=20
            class=3Dtocnumber>4.6.1</SPAN> <SPAN class=3Dtoctext>Boolean =

            Members</SPAN></A></LI>
            <LI class=3D"toclevel-3 tocsection-25"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Unions"=
><SPAN=20
            class=3Dtocnumber>4.6.2</SPAN> <SPAN=20
            class=3Dtoctext>Unions</SPAN></A></LI>
            <LI class=3D"toclevel-3 tocsection-26"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Longs">=
<SPAN=20
            class=3Dtocnumber>4.6.3</SPAN> <SPAN=20
            class=3Dtoctext>Longs</SPAN></A></LI>
            <LI class=3D"toclevel-3 tocsection-27"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Arrays_=
Embedded_Within_Structures"><SPAN=20
            class=3Dtocnumber>4.6.4</SPAN> <SPAN class=3Dtoctext>Arrays =
Embedded=20
            Within Structures</SPAN></A>=20
            <UL>
              <LI class=3D"toclevel-4 tocsection-28"><A=20
              =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#C.23_2.=
0_Functionality"><SPAN=20
              class=3Dtocnumber>4.6.4.1</SPAN> <SPAN class=3Dtoctext>C# =
2.0=20
              Functionality</SPAN></A></LI>
              <LI class=3D"toclevel-4 tocsection-29"><A=20
              =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Real_Wo=
rld_Experience"><SPAN=20
              class=3Dtocnumber>4.6.4.2</SPAN> <SPAN =
class=3Dtoctext>Real World=20
              Experience</SPAN></A></LI></UL></LI>
            <LI class=3D"toclevel-3 tocsection-30"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Summary=
_2"><SPAN=20
            class=3Dtocnumber>4.6.5</SPAN> <SPAN=20
            class=3Dtoctext>Summary</SPAN></A></LI>
            <LI class=3D"toclevel-3 tocsection-31"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#A_Warni=
ng_about_FieldOffset"><SPAN=20
            class=3Dtocnumber>4.6.6</SPAN> <SPAN class=3Dtoctext>A =
Warning about=20
            FieldOffset</SPAN></A></LI>
            <LI class=3D"toclevel-3 tocsection-32"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Marshal=
ing_Pointers"><SPAN=20
            class=3Dtocnumber>4.6.7</SPAN> <SPAN =
class=3Dtoctext>Marshaling=20
            Pointers</SPAN></A>=20
            <UL>
              <LI class=3D"toclevel-4 tocsection-33"><A=20
              =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Marshal=
ing_Embedded_Strings"><SPAN=20
              class=3Dtocnumber>4.6.7.1</SPAN> <SPAN =
class=3Dtoctext>Marshaling=20
              Embedded Strings</SPAN></A></LI></UL></LI></UL></LI>
          <LI class=3D"toclevel-2 tocsection-34"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Custom_=
Marshaling"><SPAN=20
          class=3Dtocnumber>4.7</SPAN> <SPAN class=3Dtoctext>Custom=20
          Marshaling</SPAN></A></LI>
          <LI class=3D"toclevel-2 tocsection-35"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Manual_=
Marshaling"><SPAN=20
          class=3Dtocnumber>4.8</SPAN> <SPAN class=3Dtoctext>Manual=20
          Marshaling</SPAN></A>=20
          <UL>
            <LI class=3D"toclevel-3 tocsection-36"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Marshal=
ing_char.2A.2A"><SPAN=20
            class=3Dtocnumber>4.8.1</SPAN> <SPAN =
class=3Dtoctext>Marshaling=20
            char**</SPAN></A></LI></UL></LI></UL></LI>
        <LI class=3D"toclevel-1 tocsection-37"><A=20
        =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Avoidin=
g_Marshaling"><SPAN=20
        class=3Dtocnumber>5</SPAN> <SPAN class=3Dtoctext>Avoiding=20
        Marshaling</SPAN></A>=20
        <UL>
          <LI class=3D"toclevel-2 tocsection-38"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#GC-Safe=
_P.2FInvoke_code"><SPAN=20
          class=3Dtocnumber>5.1</SPAN> <SPAN class=3Dtoctext>GC-Safe =
P/Invoke=20
          code</SPAN></A>=20
          <UL>
            <LI class=3D"toclevel-3 tocsection-39"><A=20
            =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#.NET_2.=
0_and_SafeHandles"><SPAN=20
            class=3Dtocnumber>5.1.1</SPAN> <SPAN class=3Dtoctext>.NET =
2.0 and=20
            SafeHandles</SPAN></A></LI></UL></LI>
          <LI class=3D"toclevel-2 tocsection-40"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Properl=
y_Disposing_of_Resources"><SPAN=20
          class=3Dtocnumber>5.2</SPAN> <SPAN class=3Dtoctext>Properly =
Disposing of=20
          Resources</SPAN></A></LI></UL></LI>
        <LI class=3D"toclevel-1 tocsection-41"><A=20
        =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Miscell=
aneous_Topics"><SPAN=20
        class=3Dtocnumber>6</SPAN> <SPAN class=3Dtoctext>Miscellaneous=20
        Topics</SPAN></A>=20
        <UL>
          <LI class=3D"toclevel-2 tocsection-42"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Meaning=
_of_.22Unsafe.22"><SPAN=20
          class=3Dtocnumber>6.1</SPAN> <SPAN class=3Dtoctext>Meaning of=20
          "Unsafe"</SPAN></A></LI>
          <LI class=3D"toclevel-2 tocsection-43"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Securit=
y"><SPAN=20
          class=3Dtocnumber>6.2</SPAN> <SPAN=20
        class=3Dtoctext>Security</SPAN></A></LI></UL></LI>
        <LI class=3D"toclevel-1 tocsection-44"><A=20
        =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Trouble=
shooting"><SPAN=20
        class=3Dtocnumber>7</SPAN> <SPAN=20
        class=3Dtoctext>Troubleshooting</SPAN></A></LI>
        <LI class=3D"toclevel-1 tocsection-45"><A=20
        =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Comment=
ary"><SPAN=20
        class=3Dtocnumber>8</SPAN> <SPAN =
class=3Dtoctext>Commentary</SPAN></A>=20
        <UL>
          <LI class=3D"toclevel-2 tocsection-46"><A=20
          =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#P.2FInv=
oke_Specification"><SPAN=20
          class=3Dtocnumber>8.1</SPAN> <SPAN class=3Dtoctext>P/Invoke=20
          Specification</SPAN></A></LI></UL></LI>
        <LI class=3D"toclevel-1 tocsection-47"><A=20
        =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Thanks"=
><SPAN=20
        class=3Dtocnumber>9</SPAN> <SPAN =
class=3Dtoctext>Thanks</SPAN></A></LI>
        <LI class=3D"toclevel-1 tocsection-48"><A=20
        =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Copyrig=
ht"><SPAN=20
        class=3Dtocnumber>10</SPAN> <SPAN =
class=3Dtoctext>Copyright</SPAN></A></LI>
        <LI class=3D"toclevel-1 tocsection-49"><A=20
        =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Revisio=
n_History"><SPAN=20
        class=3Dtocnumber>11</SPAN> <SPAN class=3Dtoctext>Revision=20
        History</SPAN></A></LI></UL></TD></TR></TBODY></TABLE>
<H1><SPAN id=3DIntroduction class=3Dmw-headline>Introduction =
</SPAN></H1>
<P>The <A class=3D"external text"=20
href=3D"http://www.ecma-international.org/publications/standards/ecma-335=
.htm"=20
rel=3Dnofollow>Common Language Infrastructure</A> (CLI) is designed to =
make it=20
"easy" to interoperate with existing code. In principal, all you need to =
do is=20
create a <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.DllImportAttribute"=20
rel=3Dnofollow>DllImport</A> function declaration for the existing code =
to invoke,=20
and the runtime will handle the rest. For example: </P>
<P>&lt;span id=3D"getpid_example"/&gt; </P><PRE style=3D"FONT-FAMILY: =
monospace" class=3Dcsharp> <SPAN style=3D"COLOR: =
#008000">[</SPAN>DllImport <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #666666">"libc.so"</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">private</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> getpid <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN></PRE>
<P>Please note that most of the classes and enumerations mentioned in =
this=20
document reside in the <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DN%3ASystem.Runtime.Inte=
ropServices"=20
rel=3Dnofollow>System.Runtime.InteropServices</A> namespace. </P>
<P>The above C# function declaration would invoke the POSIX <B>getpid =
</B>(2)=20
system call on platforms that have the <TT>libc.so</TT> library. If=20
<TT>libc.so</TT> exists but doesn't have the <B>getpid</B> export, an <A =

class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.EntryPointNo=
tFoundException"=20
rel=3Dnofollow>EntryPointNotFoundException</A> exception is thrown. If=20
<TT>libc.so</TT> can't be loaded, a <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.DllNotFoundE=
xception"=20
rel=3Dnofollow>DllNotFoundException</A> exception is thrown. Simple.=20
Straightforward. What could be easier? </P>
<P>There are three problems with this: </P>
<OL>
  <LI><A=20
  =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Library=
_Handling">Specifying=20
  the library in the DllImport statement</A>. </LI>
  <LI><A=20
  =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Invokin=
g_Unmanaged_Code">Determining=20
  what function to actually invoke</A>. </LI>
  <LI><A=20
  =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Marshal=
ing">Passing=20
  parameters</A>; most existing code is far more complex. Strings will =
need to=20
  be passed, structures may need to be passed, memory management =
practices will=20
  become involved... </LI></OL>
<P>Existing code is a complex beast, and the interop layer needs to =
support this=20
complexity. </P>
<H1><SPAN id=3DLibrary_Handling class=3Dmw-headline>Library Handling =
</SPAN></H1>
<P>How does the runtime find the library specified in the =
<B>DllImport</B>=20
attribute? This question is inherently platform specific. </P>
<H2><SPAN id=3DWindows_DLL_Search_Path class=3Dmw-headline>Windows DLL =
Search Path=20
</SPAN></H2>
<P>From the MSDN LoadLibrary documentation, the DLLs needed by the =
program are=20
searched for in the following order: </P>
<OL>
  <LI>The directory from which the application loaded. </LI>
  <LI>The current directory </LI>
  <LI>The system directory. Use the <A class=3D"external text"=20
  =
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/sysinfo/base/getsystemdirectory.asp"=20
  rel=3Dnofollow>GetSystemDirectory()</A> function to get the path of =
this=20
  directory. </LI>
  <LI>The 16-bit system directory. </LI>
  <LI>The Windows directory. Use the <A class=3D"external text"=20
  =
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/sysinfo/base/getsystemdirectory.asp"=20
  rel=3Dnofollow>GetWindowsDirectory()</A> function to get the path of =
this=20
  directory. </LI>
  <LI>The directories that are listed in the <TT>PATH</TT> environment =
variable.=20
  </LI></OL>
<P>Of course, reality isn't quite that simple. In practice, the "system" =

directory is actually <TT>%WINDIR%\system32</TT>, except on Windows 9x =
platforms=20
where it's <TT>%WINDIR%\system</TT>. The 16-bit system directory is =
typically=20
<TT>%WINDIR%\system</TT>, but isn't recognized as a separate search =
directory on=20
Windows 9x platforms. </P>
<P>Furthermore, on Windows Server 2003 and Windows XP SP1, the registry =
entry=20
<TT>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session=20
Manager\SafeDllSearchMode</TT> alters the above ordering. If this is =
<TT>1</TT>=20
(the default), then the current directory is searched after the system =
and=20
Windows directories. This is a security feature (it prevents a trojan =
library=20
from being loaded instead of, for example, <TT>OLE32.DLL</TT>), but it =
turns the=20
above list into: 1, 3, 4, 5, 2, 6. </P>
<P>See also: <A class=3D"external text"=20
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/dllproc/base/loadlibrary.asp"=20
rel=3Dnofollow>LoadLibrary() Documentation at MSDN</A> </P>
<H2><SPAN id=3DLinux_Shared_Library_Search_Path =
class=3Dmw-headline>Linux Shared=20
Library Search Path </SPAN></H2>
<P>From the <B>dlopen</B>(3) man page, the necessary shared libraries =
needed by=20
the program are searched for in the following order: </P>
<OL>
  <LI>A colon-separated list of directories in the user's=20
  <TT>LD_LIBRARY_PATH</TT> environment variable. This is a =
frequently-used way=20
  to allow native shared libraries to be found by a CLI program. </LI>
  <LI>The list of libraries cached in <TT>/etc/ld.so.cache</TT>.=20
  <TT>/etc/ld.so.cache</TT> is created by editing =
<TT>/etc/ld.so.conf</TT> and=20
  running <B>ldconfig</B>(8). Editing <TT>/etc/ld.so.conf</TT> is the =
preferred=20
  way to search additional directories, as opposed to using=20
  <TT>LD_LIBRARY_PATH</TT>, as this is more secure (it's more difficult =
to get a=20
  trojan library into <TT>/etc/ld.so.cache</TT> than it is to insert it =
into=20
  <TT>LD_LIBRARY_PATH</TT>). </LI>
  <LI><TT>/lib</TT>, followed by <TT>/usr/lib</TT>. </LI></OL>
<P>As a Mono extension, if the library being loaded is =
<TT>__Internal</TT>, then=20
the main program is searched for method symbols. This is equivalent to =
calling=20
<B>dlopen</B>(3) with a <I>filename</I> of <TT>NULL</TT>. This allows =
you to=20
P/Invoke methods that are within an application that is embedding Mono. =
</P>
<P>See also: the <B>dlopen</B>(3) man page, the <B>ld.so</B>(8) man =
page, <A=20
class=3D"external text"=20
href=3D"http://www-106.ibm.com/developerworks/linux/library/l-shlibs.html=
?ca=3Ddgr-lnxw07SharedLib"=20
rel=3Dnofollow>Dissecting shared libraries</A>. </P>
<H2><SPAN id=3DMac_OS_X_Framework_and_.dylib_Search_Path =
class=3Dmw-headline>Mac OS=20
X Framework and .dylib Search Path </SPAN></H2>
<P>The Framework and library search path is: </P>
<OL>
  <LI>A colon-separated list of directories in the user's=20
  <TT>DYLD_FRAMEWORK_PATH</TT> environment variable. </LI>
  <LI>A colon-separated list of directories in the user's=20
  <TT>DYLD_LIBRARY_PATH</TT> environment variable. </LI>
  <LI>A colon-separated list of directories in the user's=20
  <TT>DYLD_FALLBACK_FRAMEWORK_PATH</TT> environment variable, which =
defaults to=20
  the directories:=20
  <UL>
    <LI><TT>~/Library/Frameworks</TT> </LI>
    <LI><TT>/Library/Frameworks</TT> </LI>
    <LI><TT>/Network/Library/Frameworks</TT> </LI>
    <LI><TT>/System/Library/Frameworks</TT> </LI></UL></LI>
  <LI>A colon-separated list of directories in the user's=20
  <TT>DYLD_FALLBACK_LIBRARY_PATH</TT> environment variable, which =
defaults to=20
  the directories:=20
  <UL>
    <LI><TT>~/lib</TT> </LI>
    <LI><TT>/usr/local/lib</TT> </LI>
    <LI><TT>/lib</TT> </LI>
    <LI><TT>/usr/lib</TT> </LI></UL></LI></OL>
<P>Note: Mono uses GLib to load libraries, and GLib has a bug on Mac OS =
X where=20
it doesn't use a <TT>.dylib</TT> extension, but instead uses the Unix=20
<TT>.so</TT> extension. While this should eventually be fixed, the =
current=20
workaround is to <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Library=
_Names">write=20
a <TT>.config</TT> file which maps to the <TT>.dylib</TT> file</A>, e.g. =
</P><PRE style=3D"FONT-FAMILY: monospace" class=3Dxml> <SPAN =
style=3D"COLOR: #009900"><SPAN style=3D"COLOR: #000000; FONT-WEIGHT: =
bold">&lt;configuration<SPAN style=3D"COLOR: #000000; FONT-WEIGHT: =
bold">&gt;</SPAN></SPAN></SPAN>
   <SPAN style=3D"COLOR: #009900"><SPAN style=3D"COLOR: #000000; =
FONT-WEIGHT: bold">&lt;dllmap</SPAN> <SPAN style=3D"COLOR: =
#000066">dll</SPAN>=3D<SPAN style=3D"COLOR: #ff0000">"mylib"</SPAN> =
<SPAN style=3D"COLOR: #000066">target</SPAN>=3D<SPAN style=3D"COLOR: =
#ff0000">"mylib.dylib"</SPAN> <SPAN style=3D"COLOR: #000000; =
FONT-WEIGHT: bold">/&gt;</SPAN></SPAN>
 <SPAN style=3D"COLOR: #009900"><SPAN style=3D"COLOR: #000000; =
FONT-WEIGHT: bold">&lt;/configuration<SPAN style=3D"COLOR: #000000; =
FONT-WEIGHT: bold">&gt;</SPAN></SPAN></SPAN></PRE>
<P>TODO: Will mono support both frameworks and dylibs? </P>
<P>See also: <A class=3D"external text"=20
href=3D"http://developer.apple.com/documentation/MacOSX/Conceptual/System=
Overview/Frameworks/chapter_7_section_2.html"=20
rel=3Dnofollow>The Framework as a Library Package at Apple</A>, the <A=20
class=3D"external text" href=3D"http://www.hmug.org/man/1/dyld.html"=20
rel=3Dnofollow>dyld(1) man page</A> </P>
<H2><SPAN id=3DLibrary_Names class=3Dmw-headline>Library Names =
</SPAN></H2>
<P>Knowing where to look for the library is only half of the problem. =
Knowing=20
what library to load is the other half. </P>
<P>Different platforms have different naming conventions. Windows =
platforms=20
append <TT>.DLL</TT> to the library name, such as <TT>OLE32.DLL</TT>. =
Linux=20
platforms use a <TT>lib</TT> prefix and a <TT>.so</TT> suffix<SUP><A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#lib-nam=
e-note">1</A></SUP>.=20
Mac OS X platforms have a <TT>lib</TT> prefix and a <TT>.dylib</TT> =
suffix,=20
unless they're a Framework, in which case they're a directory and things =
get=20
more complicated. </P>
<DL>
  <DD><SPAN id=3Dlib-name-note>Note 1</SPAN>: Strictly speaking, Unix =
shared=20
  libraries are typically versioned, and the version number follows the=20
  <TT>.so</TT> suffix. For example, <TT>libfreetype.so.6.3.3</TT> is a =
fully=20
  versioned library. Versioning throws a "wrench" into the works, and is =
best=20
  dealt with through Mono's &lt;dllmap/&gt; mechanism; see below for =
details.=20
  </DD></DL>
<P>If you have control over the library name, keep the above naming =
conventions=20
in mind and don't use a platform-specific library name in the =
<B>DllImport</B>=20
statement. Instead, just use the library name itself, without any =
prefixes or=20
suffixes, and rely on the runtime to find the appropriate library at =
runtime.=20
For example: </P><PRE style=3D"FONT-FAMILY: monospace" class=3Dcsharp> =
<SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN style=3D"COLOR: =
#008000">(</SPAN><SPAN style=3D"COLOR: #666666">"MyLibrary"</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">private</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> Frobnicate <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN></PRE>
<P>Then, you just need to provide <TT>MyLibrary.dll</TT> for Windows =
platforms,=20
<TT>libMyLibrary.so</TT> for Unix platforms, and =
<TT>libMyLibrary.dylib</TT> for=20
Mac OS X platforms. </P>
<DL>
  <DD>Note: Windows will not automatically append a <TT>.dll</TT> =
extension to=20
  library names that already have a period (.) in their name, such as=20
  <TT>libgtk-win32-2.0-0.dll</TT>. If you try to use =
<TT>libgtk-win32-2.0-0</TT>=20
  as the library name, Windows won't automatically append <TT>.dll</TT>, =

  resulting in a <B>DllNotFoundException</B>. Consequently you should =
either=20
  avoid periods in library names or always use the full filename =
(including the=20
  <TT>.dll</TT> extension) and rely on Mono's &lt;dllmap/&gt; mechanism. =

</DD></DL>
<P>What if you don't have the same name across all platforms? For =
example, the=20
GTK+ library name on Windows is <TT>libgtk-win32-2.0-0.dll</TT>, while =
the Unix=20
equivalent library is <TT>libgtk-x11-2.0.so</TT>. How do you write =
portable=20
Platform Invoke (P/Invoke) code that will work cross-platform? </P>
<P>The short answer is that you don't. There is no standard way of =
specifying=20
platform-specific library names. </P>
<P>However, as an extension, Mono provides a library mapping mechanism. =
Two=20
places are searched for library mappings: in the=20
<TT>$prefix/etc/mono/config</TT> XML file, and in a per-assembly=20
<TT>.config</TT> file, located in the same directory as the assembly. =
The=20
.config file must be named like the assembly with ".config" as =
extension, e.g.=20
<TT>MyAssembly.exe.config</TT> or <TT>MyAssembly.dll.config</TT>. These =
files=20
contains <TT>&lt;dllmap/&gt;</TT> elements, which map an input library =
(the=20
library specified in the <B>DllImport</B> statement) to the actual=20
platform-specific library to load. For example: </P><PRE =
style=3D"FONT-FAMILY: monospace" class=3Dxml> <SPAN style=3D"COLOR: =
#009900"><SPAN style=3D"COLOR: #000000; FONT-WEIGHT: =
bold">&lt;configuration<SPAN style=3D"COLOR: #000000; FONT-WEIGHT: =
bold">&gt;</SPAN></SPAN></SPAN>
    <SPAN style=3D"COLOR: #009900"><SPAN style=3D"COLOR: #000000; =
FONT-WEIGHT: bold">&lt;dllmap</SPAN> <SPAN style=3D"COLOR: =
#000066">dll</SPAN>=3D<SPAN style=3D"COLOR: =
#ff0000">"libgtk-win32-2.0-0.dll"</SPAN> <SPAN style=3D"COLOR: =
#000066">target</SPAN>=3D<SPAN style=3D"COLOR: =
#ff0000">"libgtk-x11-2.0.so"</SPAN> <SPAN style=3D"COLOR: #000000; =
FONT-WEIGHT: bold">/&gt;</SPAN></SPAN>
 <SPAN style=3D"COLOR: #009900"><SPAN style=3D"COLOR: #000000; =
FONT-WEIGHT: bold">&lt;/configuration<SPAN style=3D"COLOR: #000000; =
FONT-WEIGHT: bold">&gt;</SPAN></SPAN></SPAN></PRE>
<P>Unlike .NET, Mono permits <TT>.DLL</TT> assemblies to have =
<TT>.config</TT>=20
files, which are <I>only</I> used for this library mapping mechanism. =
</P>
<P>Using this mechanism, the Mono-endorsed way of specifying =
<B>DllImport</B>=20
library names is to always use the Windows library name (as Microsoft =
.NET has=20
no library mapping mechanism), and then provide a mapping in the =
per-assembly=20
<TT>.config</TT> file. This is what the Gtk# library does. </P>
<P>This mechanism can also be used to load strongly-versioned libraries =
on Unix=20
platforms. For example: </P><PRE style=3D"FONT-FAMILY: monospace" =
class=3Dxml> <SPAN style=3D"COLOR: #009900"><SPAN style=3D"COLOR: =
#000000; FONT-WEIGHT: bold">&lt;configuration<SPAN style=3D"COLOR: =
#000000; FONT-WEIGHT: bold">&gt;</SPAN></SPAN></SPAN>
   <SPAN style=3D"COLOR: #009900"><SPAN style=3D"COLOR: #000000; =
FONT-WEIGHT: bold">&lt;dllmap</SPAN> <SPAN style=3D"COLOR: =
#000066">dll</SPAN>=3D<SPAN style=3D"COLOR: =
#ff0000">"gtkhtml-3.0"</SPAN> <SPAN style=3D"COLOR: =
#000066">target</SPAN>=3D<SPAN style=3D"COLOR: =
#ff0000">"libgtkhtml-3.0.so.4"</SPAN> <SPAN style=3D"COLOR: #000000; =
FONT-WEIGHT: bold">/&gt;</SPAN></SPAN>
 <SPAN style=3D"COLOR: #009900"><SPAN style=3D"COLOR: #000000; =
FONT-WEIGHT: bold">&lt;/configuration<SPAN style=3D"COLOR: #000000; =
FONT-WEIGHT: bold">&gt;</SPAN></SPAN></SPAN></PRE>
<H1><SPAN id=3DInvoking_Unmanaged_Code class=3Dmw-headline>Invoking =
Unmanaged Code=20
</SPAN></H1>
<P>As far as managed code is concerned, unmanaged code is invoked merely =
by=20
invoking a method with an associated <B>DllImport</B> attribute. The CLI =
runtime=20
must do more work to actually invoke the unmanaged code. </P>
<P>In principal, this is a straightforward process. The library =
specified in the=20
<B>DllImport</B> attribute is loaded, as described above. Then, the =
specified=20
function is looked up (via <A class=3D"external text"=20
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/dllproc/base/getprocaddress.asp"=20
rel=3Dnofollow>GetProcAddress()</A> or <B>dlsym</B>(3)). Finally, the =
function is=20
invoked. </P>
<P>But what string is used for the function lookup (in =
<TT>GetProcAddress()</TT>=20
or <B>dlopen</B>(3))? By default, the name of the managed code method is =
used,=20
which is why <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#getpid_=
example">getpid()=20
in the above example</A> invokes <B>getpid</B>(2) from the C library. =
</P>
<P>Alternatively, the <B>DllImport</B> attribute's <A class=3D"external =
text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.DllImportAttribute.EntryPoint"=20
rel=3Dnofollow>EntryPoint</A> field can be set, and that string will be =
used=20
instead. </P>
<P>Either way, the string used is assumed to refer to a C ABI-compatible =

function exported by the specified library. On some platforms, this may =
cause a=20
leading underscore to be prefixed to the symbol name. Other platforms =
generate=20
no mangling. </P>
<P>Note that a C ABI is assumed. This makes it nearly impossible to =
directly=20
invoke functions that are not C ABI compatible, such as C++ library =
functions=20
that are not <TT>extern "C"</TT>. Some variation on the C ABI is =
permitted, such=20
as variation in the function's <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.CallingConvention"=20
rel=3Dnofollow>CallingConvention</A>. The default CallingConvention is=20
platform-specific. Under Windows, <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.CallingConvention.Winapi"=20
rel=3Dnofollow>Winapi</A> is the default, as this is used for most Win32 =
API=20
functions. (<B>Winapi</B> is equivalent to <B>Stdcall</B> for Windows 9x =
and=20
Windows NT.) Under Unix platforms, <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.CallingConvention.Cdecl"=20
rel=3Dnofollow>Cdecl</A> is the default. </P>
<P>Calling convention can be specified in C code by using the =
<TT>__stdcall</TT>=20
and <TT>__cdecl </TT>compiler intrinsics under Microsoft Visual C++, and =
by=20
using the <TT>__attribute__((stdcall)) </TT>and =
<TT>__attribute__((cdecl))=20
</TT>compiler intrinsics under GCC. </P>
<P>Does having the default CallingConvention vary between platforms =
cause=20
portability problems? Yes. All the more reason to write as much code as =
possible=20
as managed code, avoiding the whole P/Invoke/marshaling conundrum in the =
first=20
place. </P>
<P>If you need to invoke C++ code, you have two choices: (1) make the =
C++=20
function <TT>extern "C"</TT>, treat it as a C function, and make sure =
that it=20
uses a known calling convention; (2) don't make the function <TT>extern=20
"C"</TT>, but make sure it uses a known calling convention. If you use =
option=20
(2), you'll need to set the <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.DllImportAttribute.EntryPoint"=20
rel=3Dnofollow>DllImport.EntryPoint</A> field to the C++ mangled =
function name,=20
such as <TT>_Z6getpidv</TT>. You can retrieve the mangled name through =
your=20
compiler's binary tools, such as <TT>OBJDUMP.EXE</TT> or <B>nm</B>(1). =
Note that=20
C++ mangled names are <I>highly</I> compiler specific, and will: </P>
<OL>
  <LI>make your .NET assembly platform specific (you'll need a different =

  assembly for each different platform); </LI>
  <LI>require updating the .NET assembly every time you change C++ =
compilers (as=20
  the C++ name mangling scheme varies by compiler and can -- and =
frequently will=20
  -- change); and </LI>
  <LI>be really ugly to maintain because of the above. This option is =
not=20
  recommended. </LI></OL>
<P>If you have lots of C++ code that needs to be wrapped, you might want =
to look=20
into <A class=3D"external text" href=3D"http://www.swig.org/" =
rel=3Dnofollow>SWIG</A>,=20
a code generation program that easily wraps existing C and C++ code for =
use by a=20
multitude of languages, including CLI languages. This makes it easier to =
invoke=20
C++ code from a CLI application. </P>
<P>In case you call a function that is not present in the native library =
(or=20
that is not public) you will get an EntryNotFoundException. In order to =
find out=20
which symbols are available for a library, it's interesting to use the =
following=20
command (the example used is a shared library from Subversion): =
</P><PRE>objdump -T /usr/lib/libsvn_client-1.so.0
</PRE>
<H2><SPAN id=3DRuntime_Exception_Propagation class=3Dmw-headline>Runtime =
Exception=20
Propagation </SPAN></H2>
<P>The above section mentioned a key point: P/Invoke assumes that the =
unmanaged=20
code conforms to the C ABI. C doesn't support exceptions. As such, it is =
assumed=20
that runtime exceptions will not propagate through unmanaged code. </P>
<P>Furthermore, it's fairly simple for an exception to propagate through =

unmanaged code whenever unmanaged code invokes managed code. This =
typically=20
occurs through the use of callbacks -- using a function pointer on the =
unmanaged=20
side which can invoke a delegate on the managed side. It is very =
important that=20
the managed code <I>not</I> propagate <I>any</I> exceptions -- it =
<I>must</I>=20
catch all exceptions, or else the unmanaged code calling the delegate =
will=20
break. </P>
<P>The problem is, again, C doesn't support exceptions. C++ supports =
exceptions,=20
BUT, and this is crucial, the C++ exception mechanism will be different =
from the=20
managed code exception mechanism (with one exception to this rule). =
Since=20
managed code doesn't know about unmanaged code's exception handling =
support (C=20
is assumed, and C doesn't support exceptions), unmanaged exception =
handling=20
support might as well not exist, because it won't be used. </P>
<DL>
  <DD>The one exception to this is when you use <I>both</I> Microsoft =
.NET and=20
  Microsoft Visual C++ to compile the unmanaged code. .NET uses Windows=20
  Structured Exception Handling (SEH) at the P/Invoke layer for its =
exception=20
  handling mechanism, and Microsoft Visual C++ uses SEH to implement C++ =

  exception handling and supports the use of SEH in C as a language =
extension=20
  through the <TT>__try </TT>, <TT>__except </TT>, and <TT>__finally=20
  </TT>keywords. SEH is a Microsoft extension; it does not exist outside =
of=20
  Microsoft and .NET, and as such is not portable. </DD></DL>
<P>Given the above scenario -- unmanaged code invokes function pointer =
which=20
generates a managed exception -- what would happen? The managed =
exception=20
handling mechanism is executed: the stack is searched for an appropriate =

exception handler, then the stack is unwound, with any <TT>finally</TT> =
blocks=20
executed during the stack unwind process. </P>
<P>Note two things: Managed code will be walking the stack, requiring =
that the=20
CPU Stack Pointer and Instruction Pointers be set. Consequently, =
unmanaged code=20
cannot participate in stack unwinding, as it will never be notified that =
a stack=20
unwind is occurring. </P>
<P>Think about that for a minute. If alarms are not sounding in your =
head,=20
you're in deep, deep trouble. Consider this unmanaged C code: </P><PRE =
style=3D"FONT-FAMILY: monospace" class=3Dc> <SPAN style=3D"COLOR: =
#993333">typedef</SPAN> <SPAN style=3D"COLOR: #993333">void</SPAN> <SPAN =
style=3D"COLOR: #009900">(</SPAN><SPAN style=3D"COLOR: =
#339933">*</SPAN>Handler<SPAN style=3D"COLOR: #009900">)</SPAN> <SPAN =
style=3D"COLOR: #009900">(</SPAN><SPAN style=3D"COLOR: =
#993333">const</SPAN> <SPAN style=3D"COLOR: #993333">char</SPAN> <SPAN =
style=3D"COLOR: #339933">*</SPAN>message<SPAN style=3D"COLOR: =
#009900">)</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #993333">void</SPAN> InvokeHandler <SPAN =
style=3D"COLOR: #009900">(</SPAN>Handler handler<SPAN style=3D"COLOR: =
#009900">)</SPAN>
 <SPAN style=3D"COLOR: #009900">{</SPAN>
   <SPAN style=3D"COLOR: #993333">char</SPAN> <SPAN style=3D"COLOR: =
#339933">*</SPAN>message <SPAN style=3D"COLOR: #339933">=3D</SPAN> <SPAN =
style=3D"COLOR: #009900">(</SPAN><SPAN style=3D"COLOR: =
#993333">char</SPAN> <SPAN style=3D"COLOR: #339933">*</SPAN><SPAN =
style=3D"COLOR: #009900">)</SPAN> <A =
href=3D"http://www.opengroup.org/onlinepubs/009695399/functions/malloc.ht=
ml"><SPAN style=3D"COLOR: #000066">malloc</SPAN></A> <SPAN =
style=3D"COLOR: #009900">(</SPAN><SPAN style=3D"COLOR: =
#0000dd">10</SPAN><SPAN style=3D"COLOR: #009900">)</SPAN><SPAN =
style=3D"COLOR: #339933">;</SPAN>
   <A =
href=3D"http://www.opengroup.org/onlinepubs/009695399/functions/strcpy.ht=
ml"><SPAN style=3D"COLOR: #000066">strcpy</SPAN></A> <SPAN =
style=3D"COLOR: #009900">(</SPAN>message<SPAN style=3D"COLOR: =
#339933">,</SPAN> <SPAN style=3D"COLOR: #ff0000">"A Message"</SPAN><SPAN =
style=3D"COLOR: #009900">)</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN>
   <SPAN style=3D"COLOR: #009900">(</SPAN><SPAN style=3D"COLOR: =
#339933">*</SPAN>handler<SPAN style=3D"COLOR: #009900">)</SPAN><SPAN =
style=3D"COLOR: #009900">(</SPAN>message<SPAN style=3D"COLOR: =
#009900">)</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN>
   <A =
href=3D"http://www.opengroup.org/onlinepubs/009695399/functions/free.html=
"><SPAN style=3D"COLOR: #000066">free</SPAN></A> <SPAN style=3D"COLOR: =
#009900">(</SPAN>message<SPAN style=3D"COLOR: #009900">)</SPAN><SPAN =
style=3D"COLOR: #339933">;</SPAN>
 <SPAN style=3D"COLOR: #009900">}</SPAN></PRE>
<P>If <I>handler</I> is a pointer to a managed delegate which may throw =
an=20
exception, then <B>free</B>(3) will <I>not</I> be executed, resulting in =
a=20
memory leak. C++ destructors won't help you either, as destructors still =
require=20
the execution of <I>some</I> code, and that code will never be invoked, =
as it's=20
not C++ which is unwinding the stack, but managed code, which doesn't =
know about=20
C++ exception handling. </P>
<P>Obviously, the flip-side of this scenario -- a C++ exception being =
propagated=20
into managed code -- is equally bad. As long as managed and unmanaged =
code use=20
different exception handling mechanisms, exceptions <I>must not</I> be =
mixed=20
between them. </P>
<P>The moral of this story: don't let exceptions propagate between =
managed and=20
unmanaged code. The results won't be pretty. </P>
<P>This is particularly pertinent when wrapping C++ methods. C++ =
exceptions will=20
need to be mapped into an "out" parameter or a return value, so that =
managed=20
code can know what error occurred, and (optionally) throw a managed =
exception to=20
"propagate" the original C++ exception. </P>
<P>See also: </P>
<UL>
  <LI><A class=3D"external text" href=3D"http://www.swig.org/"=20
  rel=3Dnofollow>SWIG</A>, a code generation program that easily wraps =
existing C=20
  and C++ code for use by a multitude of languages, including CLI =
languages.=20
  This makes it easier to invoke C++ code from a CLI application. </LI>
  <LI><A class=3D"external text"=20
  =
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/vccore98/HTML/_core_exception_handling_topics_.28.seh.29.asp"=20
  rel=3Dnofollow>Structured Exception Handling Topics at MSDN</A> </LI>
  <LI><A class=3D"external text"=20
  href=3D"http://weblogs.asp.net/cbrumme/archive/2003/10/01/51524.aspx"=20
  rel=3Dnofollow>The .NET Exception Model</A>: Another one of Chris =
Brumme's=20
  excellent blog entries. More information than you ever wanted to know =
about=20
  .NET exception handling. </LI></UL>
<H1><SPAN id=3DMarshaling class=3Dmw-headline>Marshaling </SPAN></H1>
<P>How does Platform Invoke work? Given a managed call site (the =
function call),=20
and an unmanaged callee site (the function that's being called), each =
parameter=20
in the call site is "marshaled" (converted) into an unmanaged =
equivalent. The=20
marshaled data is in turn placed on the runtime stack (along with other =
data),=20
and the unmanaged function is invoked. </P>
<P>The complexity is due to the marshaling. For <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Blittab=
le_Types">simple=20
types</A>, such as integers and floating-point numbers, marshaling is a=20
bitwise-copy ("blitting"), just as would be the case for unmanaged code. =
In some=20
cases, marshaling can be avoided, such as when passing structures by =
reference=20
to unmanaged code (a pointer to the structure is copied instead). It's =
also=20
possible to obtain more control over marshaling, through <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Custom_=
Marshaling">custom=20
marshaling</A> and <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Manual_=
Marshaling">manual=20
marshaling</A>. </P>
<P>String types introduce additional complexity, as you need to specify =
the form=20
of string conversion. The runtime stores strings as UTF-16-encoded =
strings, and=20
these will likely need to be marshaled to a more appropriate form (ANSI =
strings,=20
UTF-8 encoded strings, etc.). Strings get some special support. </P>
<P>Default marshaling behavior is controlled through the <A=20
class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.DllImportAttribute"=20
rel=3Dnofollow>DllImport</A> and <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.MarshalAsAttribute"=20
rel=3Dnofollow>MarshalAs</A> attributes. </P>
<H2><SPAN id=3DMemory_Boundaries class=3Dmw-headline>Memory Boundaries =
</SPAN></H2>
<P>Managed and unmanaged memory should be considered to be completely =
separate.=20
Managed memory is typically memory allocated on a garbage-collected =
heap, while=20
unmanaged memory is anything else: the ANSI C memory pool allocated =
through=20
<B>malloc</B>(3), custom memory pools, and garbage-allocated heaps =
outside the=20
control of the CLI implementation (such as a LISP or Scheme memory =
heap). </P>
<P>It is possible to lock a section of the managed heap by using the C#=20
<TT>fixed</TT> statement. This is used so that a section of the managed =
heap can=20
be passed to unmanaged code without worrying that a future GC will move =
the=20
memory that the unmanaged code is operating on. However, this is =
completely=20
under the control of the programmer, and is not how Platform Invoke =
works. </P>
<P>During a P/Invoke call the runtime doesn't mimic the C# =
<TT>fixed</TT>=20
statement. Instead, classes and structures (everything of consequence) =
are=20
marshaled to native code through the following pseudo-process: </P>
<OL>
  <LI><SPAN id=3Dmarshal-step-1>The runtime allocates a chunk of =
unmanaged=20
  memory</SPAN>. </LI>
  <LI><SPAN id=3Dmarshal-step-2>The managed class data is copied into =
the=20
  unmanaged memory</SPAN>. </LI>
  <LI><SPAN id=3Dmarshal-step-3>The unmanaged function is invoked, =
passing it the=20
  unmanaged memory information instead of the managed memory =
information. This=20
  must be done so that if a GC occurs, the unmanaged function doesn't =
need to=20
  worry about it. (And yes, you need to worry about GCs, as the =
unmanaged=20
  function could call back into the runtime, ultimately leading to a GC. =

  Multi-threaded code can also cause a GC while unmanaged code is=20
  executing.)</SPAN> </LI>
  <LI><SPAN id=3Dmarshal-step-4>The unmanaged memory is copied back into =
managed=20
  memory.</SPAN> </LI></OL>
<P>See <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Class_a=
nd_Structure_Marshaling">Class=20
and Structure Marshaling</A> for more detailed information about =
marshaling=20
classes and structures. </P>
<P>There is one key point to keep in mind: the memory management =
specified in=20
the above process is implicit, and there is no way to control how the =
runtime=20
allocates the marshaled memory, or how long it lasts. This is crucial. =
If the=20
runtime marshals a string (e.g. UTF-16 to Ansi conversion), the =
marshaled string=20
will only last as long as the call. The unmanaged code <I>CANNOT</I> =
keep a=20
reference to this memory, as it <I>WILL</I> be freed after the call =
ends.=20
Failure to heed this restriction can result in "strange behavior", =
including=20
memory access violations and process death. This is true for <I>any</I>=20
marshaling process where the runtime allocates memory for the marshal =
process.=20
</P>
<P>The one pseudo-exception to this point is with delegates. The =
unmanaged=20
function pointer that represents the managed delegate lasts as long as =
the=20
managed delegate does. When the delegate is collected by the GC, the =
unmanaged=20
function pointer will also be collected. This is also important: if the =
delegate=20
is collected and unmanaged memory invokes the function pointer, you're =
treading=20
on thin ground. Anything could happen, including a process seg-fault.=20
Consequently, you <I>MUST</I> ensure that the lifetime of the unmanaged =
function=20
pointer is a proper subset of the lifetime of the managed delegate =
instance.=20
</P>
<H2><SPAN id=3DBlittable_Types class=3Dmw-headline>Blittable Types =
</SPAN></H2>
<P>Many types require minimal copying into native memory. Blittable =
types are=20
types that conceptually only require a <B>memcpy</B>(3) or can be passed =
on the=20
run-time stack without translation. These types include: </P>
<TABLE border=3D1>
  <TBODY>
  <TR>
    <TH>C# Type </TH>
    <TH>C Type </TH>
    <TH><B>&lt;stdint.h&gt;</B> Type </TH>
    <TH><B>&lt;glib.h&gt;</B> Type </TH></TR>
  <TR>
    <TD><TT>sbyte</TT> </TD>
    <TD><TT>char</TT> </TD>
    <TD><TT>int8_t</TT> </TD>
    <TD><TT>gint8</TT> </TD></TR>
  <TR>
    <TD><TT>byte</TT> </TD>
    <TD><TT>unsigned char</TT> </TD>
    <TD><TT>uint8_t</TT> </TD>
    <TD><TT>guint8</TT> </TD></TR>
  <TR>
    <TD><TT>short</TT> </TD>
    <TD><TT>short</TT> </TD>
    <TD><TT>int16_t</TT> </TD>
    <TD><TT>gint16</TT> </TD></TR>
  <TR>
    <TD><TT>ushort</TT> </TD>
    <TD><TT>unsigned short</TT> </TD>
    <TD><TT>uint16_t</TT> </TD>
    <TD><TT>guint16</TT> </TD></TR>
  <TR>
    <TD><TT>int</TT> </TD>
    <TD><TT>int</TT>=20
      <P><TT>long</TT> <I>32-bit platforms only</I> </P></TD>
    <TD><TT>int32_t</TT> </TD>
    <TD><TT>gint32</TT> </TD></TR>
  <TR>
    <TD><TT>uint</TT> </TD>
    <TD><TT>unsigned int</TT>=20
      <P><TT>unsigned long</TT> <I>32-bit platforms only</I> </P></TD>
    <TD><TT>uint32_t</TT> </TD>
    <TD><TT>guint32</TT> </TD></TR>
  <TR>
    <TD><TT>long</TT> </TD>
    <TD><TT>long</TT> <I>64-bit platforms only</I>=20
      <P><TT>__int64</TT> <I>MSVC</I> </P>
      <P><TT>long long</TT> <I>GCC</I> </P></TD>
    <TD><TT>int64_t</TT> </TD>
    <TD><TT>gint64</TT> </TD></TR>
  <TR>
    <TD><TT>long</TT> </TD>
    <TD><TT>unsigned long</TT> <I>64-bit platforms only</I>=20
      <P><TT>unsigned __int64</TT> <I>MSVC</I> </P>
      <P><TT>unsigned long long</TT> <I>GCC</I> </P></TD>
    <TD><TT>uint64_t</TT> </TD>
    <TD><TT>guint64</TT> </TD></TR>
  <TR>
    <TD><TT>char</TT> </TD>
    <TD><TT>unsigned short</TT> </TD>
    <TD><TT>uint16_t</TT> </TD>
    <TD><TT>guint16</TT> </TD></TR>
  <TR>
    <TD><TT>float</TT> </TD>
    <TD><TT>float</TT> </TD>
    <TD></TD>
    <TD><TT>gfloat</TT> </TD></TR>
  <TR>
    <TD><TT>double</TT> </TD>
    <TD><TT>double</TT> </TD>
    <TD></TD>
    <TD><TT>gdouble</TT> </TD></TR>
  <TR>
    <TD><TT>bool</TT> </TD>
    <TD><A=20
      =
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Boolean=
_Members">Depends=20
      on context</A> </TD>
    <TD></TD>
    <TD></TD></TR></TBODY></TABLE>
<H2><SPAN id=3DStrings class=3Dmw-headline>Strings </SPAN></H2>
<P><A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.String"=20
rel=3Dnofollow>String</A>s are special. String marshaling behavior is =
also highly=20
platform dependent. </P>
<P>String marshaling for a function call can be specified in the =
function=20
declaration with the <B>DllImport</B> attribute, by setting the <A=20
class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.DllImportAttribute.CharSet"=20
rel=3Dnofollow>CharSet</A> field. The default value for this field is <A =

class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.CharSet.Auto"=20
rel=3Dnofollow>CharSet.Ansi</A> . The <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.CharSet.Auto"=20
rel=3Dnofollow>CharSet.Auto</A> value implies "magic." </P>
<P>Some background. The Microsoft Win32 API supports two forms of =
strings:=20
"ANSI" strings, the native character set, such as ASCII, ISO-8859-1, or =
a Double=20
Byte Character Set such as Shift-JIS; and Unicode strings, originally =
UCS-2, and=20
now UTF-16. Windows supports these string formats by appending an "A" =
for Ansi=20
string APIs and a "W" ("wide") for Unicode string APIs. </P>
<P>Consider this Win32 API description: </P><PRE style=3D"FONT-FAMILY: =
monospace" class=3Dcsharp> <SPAN style=3D"COLOR: =
#008000">[</SPAN>DllImport <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #666666">"gdi32.dll"</SPAN>, CharSet<SPAN =
style=3D"COLOR: #008000">=3D</SPAN>CharSet<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">Auto</SPAN>,=20
      CallingConvention<SPAN style=3D"COLOR: =
#008000">=3D</SPAN>CallingConvention<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">StdCall</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">private</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">bool</SPAN> TextOut <SPAN =
style=3D"COLOR: #008000">(</SPAN>
      <SPAN style=3D"COLOR: #000000">System</SPAN><SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">IntPtr</SPAN> hdc,
      <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> =
nXStart,
      <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> =
nYStart,
      <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">string</SPAN> =
lpString,
      <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> =
cbString<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: =
#008000">;</SPAN></PRE>
<P>When TextOut is called, the "magic" properties of String marshaling =
become=20
apparent. Due to string marshaling, the runtime doesn't just look for an =

unmanaged function with the same name as the specified method, as =
specified in=20
Invoking Unmanaged Code. Other permutations of the function may be =
searched for,=20
depending on the CLI runtime and the host platform. </P>
<P>There are three functions that may be searched for: </P>
<UL>
  <LI>TextOutW for Unicode string marshaling </LI>
  <LI>TextOutA for Ansi string marshaling </LI>
  <LI>TextOut with the platform-default marshaling </LI></UL>
<P>For platforms whose default character set is UCS2 or UTF-16 Unicode =
(all=20
flavors of Windows NT, and Windows XP), the default search path is =
TextOutW,=20
TextOutA, and TextOut. Unicode marshaling is preferred, as (ideally) the =

System.String can be passed as-is to the function, as long as the =
function=20
doesn't modify the string parameter. Windows CE does not look for =
TextOutA, as=20
it has no Ansi APIs. </P>
<P>For platforms whose default character set is Ansi (Windows 9x, =
Windows ME),=20
the default search path is TextOutA and TextOut (TextOutW is not looked =
for).=20
Ansi marshaling will require translating the Unicode string into an =
8-bit or=20
DBCS string in the user's locale. Most (all?) of the time, this WILL NOT =
be=20
UTF-8, so you CAN NOT assume that CharSet.Ansi will generate =
UTF-8-encoded=20
strings. </P>
<P>Mono on all platforms currently uses UTF-8 encoding for all string =
marshaling=20
operations. </P>
<P>If you don't want the runtime to search for the alternate unmanaged=20
functions, specify a CharSet value other than CharSet.Auto. This will =
cause the=20
runtime to look only for the specified function. Note that if you pass a =
wrongly=20
encoded string (e.g. calling MessageBoxW when the CharSet is =
CharSet.Ansi, the=20
default), you are crossing into "undefined" territory. The unmanaged =
function=20
will receive data encoded in ways it wasn't expecting, so you may get =
such=20
bizarre things as Asian text when displaying "Hello, World". </P>
<P>Perhaps in the future the <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.CharSet"=20
rel=3Dnofollow>CharSet</A> enumeration will contain more choices, such =
as=20
UnicodeLE (little-endian), UnicodeBE (big-endian), Utf7, Utf8, and other =
common=20
choices. Additionally, making such a change would also likely require =
changing=20
the UnmanagedType enumeration. However, these would need to go through =
ECMA, so=20
it won't happen next week. (Unless some time has passed since this was=20
originally written, in which case it may very well be next week. But =
don't count=20
on it.) </P>
<H3><SPAN id=3DMore_Control class=3Dmw-headline>More Control =
</SPAN></H3>
<P>Using the <B>DllImport</B> attribute works if you want to control all =
the=20
strings in a function, but what if you need more control? You would need =
more=20
control if a string is a member of a structure, or if the function uses =
multiple=20
different types of strings as parameters. In these circumstances, the=20
<B>MarshalAs</B> attribute can be used, setting the <A class=3D"external =
text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DP%3ASystem.Runtime.Inte=
ropServices.MarshalAsAttribute.Value"=20
rel=3Dnofollow>Value</A> property (which is set in the constructor) to a =
value=20
from the <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.UnmanagedType"=20
rel=3Dnofollow>UnmanagedType</A> enumeration. For example: </P><PRE =
style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN style=3D"COLOR: =
#008000">[</SPAN>DllImport <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #666666">"does-not-exist"</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">private</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> Foo <SPAN =
style=3D"COLOR: #008000">(</SPAN>
      <SPAN style=3D"COLOR: #008000">[</SPAN>MarshalAs<SPAN =
style=3D"COLOR: #008000">(</SPAN>UnmanagedType<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">LPStr</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">string</SPAN> =
ansiString,
      <SPAN style=3D"COLOR: #008000">[</SPAN>MarshalAs<SPAN =
style=3D"COLOR: #008000">(</SPAN>UnmanagedType<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">LPWStr</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">string</SPAN> =
unicodeString,
      <SPAN style=3D"COLOR: #008000">[</SPAN>MarshalAs<SPAN =
style=3D"COLOR: #008000">(</SPAN>UnmanagedType<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">LPTStr</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">string</SPAN> =
platformString<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN></PRE>
<P>As you can guess by reading the example, <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.UnmanagedType.LPStr"=20
rel=3Dnofollow>UnmanagedType.LPStr</A> will marshal the input string =
into an Ansi=20
string, <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.UnmanagedType.LPWStr"=20
rel=3Dnofollow>UnmanagedType.LPWStr</A> will marshal the input string =
into a=20
Unicode string (effectively doing nothing), and <A class=3D"external =
text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.UnmanagedType.LPTStr"=20
rel=3Dnofollow>UnmanagedType.LPTStr</A> will convert the string to the =
platform's=20
default string encoding. </P>
<P>The default platform encoding for all flavors of Windows NT =
(including=20
Windows NT 3.51 and 4.0, Windows 2000, Windows XP, Windows Server 2003) =
is=20
Unicode, while for all Windows 9x flavors (Windows 95, 98, ME) the =
platform=20
default encoding is Ansi. </P>
<P>Mono uses UTF-8 encoding as the default encoding on all platforms. =
</P>
<P>There are other <B>UnmangedType</B> string marshaling options, but =
they're=20
primarily of interest in COM Interop (<A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.UnmanagedType.BStr"=20
rel=3Dnofollow>BStr</A>, <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.UnmanagedType.AnsiBStr"=20
rel=3Dnofollow>AnsiBStr</A>, <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.UnmanagedType.TBStr"=20
rel=3Dnofollow>TBStr</A>). </P>
<P>If <B>UnmanagedType</B> doesn't provide enough flexibility for your =
string=20
marshaling needs (for example, you're wrapping GTK+ and you need to =
marshal=20
strings in UTF-8 format), look at the <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Custom_=
Marshaling">Custom=20
Marshaling</A> or <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Manual_=
Marshaling">Manual=20
Marshaling</A> sections. </P>
<H3><SPAN id=3DPassing_Caller-Modifiable_Strings =
class=3Dmw-headline>Passing=20
Caller-Modifiable Strings </SPAN></H3>
<P>A common C language idiom is for the caller to provide the callee a =
buffer to=20
fill. For example, consider <B>strncpy</B>(3): </P><PRE =
style=3D"FONT-FAMILY: monospace" class=3Dc> <SPAN style=3D"COLOR: =
#993333">char</SPAN><SPAN style=3D"COLOR: #339933">*</SPAN> <A =
href=3D"http://www.opengroup.org/onlinepubs/009695399/functions/strncpy.h=
tml"><SPAN style=3D"COLOR: #000066">strncpy</SPAN></A> <SPAN =
style=3D"COLOR: #009900">(</SPAN><SPAN style=3D"COLOR: =
#993333">char</SPAN> <SPAN style=3D"COLOR: #339933">*</SPAN>dest<SPAN =
style=3D"COLOR: #339933">,</SPAN> <SPAN style=3D"COLOR: =
#993333">const</SPAN> <SPAN style=3D"COLOR: #993333">char</SPAN> <SPAN =
style=3D"COLOR: #339933">*</SPAN>src<SPAN style=3D"COLOR: =
#339933">,</SPAN> <SPAN style=3D"COLOR: #993333">size_t</SPAN> n<SPAN =
style=3D"COLOR: #009900">)</SPAN><SPAN style=3D"COLOR: =
#339933">;</SPAN></PRE>
<P>We can't use <B>System.String</B> for both parameters, as strings are =

immutable. This is OK for <I>src</I>, but <I>dest</I> will be modified, =
and the=20
caller should be able to see the modification. </P>
<P>The solution is to use a <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Text.StringB=
uilder"=20
rel=3Dnofollow>System.Text.StringBuilder</A> , which gets special =
marshaling=20
support from the runtime. This would allow <B>strncpy</B>(3) to be =
wrapped and=20
used as: </P><PRE style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN =
style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN style=3D"COLOR: =
#008000">(</SPAN><SPAN style=3D"COLOR: #666666">"libc.so"</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">private</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> strncpy <SPAN =
style=3D"COLOR: #008000">(</SPAN>StringBuilder dest,=20
      <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">string</SPAN> =
src, <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">uint</SPAN> =
n<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: =
#008000">;</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">private</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> UseStrncpy <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN>
 <SPAN style=3D"COLOR: #008000">{</SPAN>
    StringBuilder sb <SPAN style=3D"COLOR: #008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> StringBuilder <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#ff0000">256</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
    strncpy <SPAN style=3D"COLOR: #008000">(</SPAN>sb, <SPAN =
style=3D"COLOR: #666666">"this is the source string"</SPAN>, sb<SPAN =
style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">Capacity</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
    Console<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">WriteLine</SPAN> <SPAN style=3D"COLOR: #008000">(</SPAN>sb<SPAN =
style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">ToString</SPAN><SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>Some things to note is that the return value of <B>strncpy</B>(3) was =
changed=20
to <I>void</I>, as there is no way to specify that the return value will =
be the=20
same pointer address as the input <I>dest</I> string buffer, and thus it =
doesn't=20
need to be marshaled. If <I>string</I> were used instead, Bad Things =
could=20
happen (the returned string would be freed; see <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Strings=
_as_Return_Values">Strings=20
as Return Values</A> ). The <B>StringBuilder</B> is allocated with the =
correct=20
amount of storage as a constructor parameter, and this amount of storage =
is=20
passed to <B>strncpy</B>(3) to prevent buffer overflow. If you use a=20
<B>StringBuilder</B> instance multiple times, always call=20
[http:/monodoc/M:System.Text.StringBuilder.EnsureCapacity(System.Int32)=20
EnsureCapacity()] before passing it into the native method, as the =
capacity may=20
shrink as a memory optimization over time, leading to unexpectedly =
truncated=20
results. </P>
<P>TODO: How does StringBuilder interact with the specified CharSet? =
</P>
<H3><SPAN id=3DStrings_as_Return_Values class=3Dmw-headline>Strings as =
Return Values=20
</SPAN></H3>
<P>The <B>String</B> type is a class, so <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Classes=
_and_Structures_as_Return_Values">see=20
the section on returning classes from functions</A>. Summary: the =
runtime will=20
attempt to free the returned pointer. The usual symptom is a runtime =
crash like=20
this: =
</P><PRE>=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
Got a SIGSEGV while executing native code. This usually indicates
a fatal error in the mono runtime or one of the native libraries
used by your application.
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D

Stacktrace:

in &lt;0x4&gt; (wrapper managed-to-native) =
System.Object:__icall_wrapper_g_free (intptr)
in &lt;0x6b9d0c&gt; (wrapper managed-to-native) =
System.Object:__icall_wrapper_g_free (intptr)
</PRE>
<P>If you don't want the runtime to free the returned string, either (a) =
don't=20
specify the return value (<A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Passing=
_Caller-Modifiable_Strings">as=20
was done for the <B>strncpy</B>(3) function above</A>), or (b) return an =
<A=20
class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.IntPtr"=20
rel=3Dnofollow>IntPtr</A> and use one of the Marshal.PtrToString* =
functions,=20
depending on the type of string returned. For example, use <A=20
class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DM%3ASystem.Runtime.Inte=
ropServices.Marshal.PtrToStringAnsi"=20
rel=3Dnofollow>Marshal.PtrToStringAnsi</A> to marshal from a Ansi =
string, and use=20
<A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DM%3ASystem.Runtime.Inte=
ropServices.Marshal.PtrToStringUni"=20
rel=3Dnofollow>Marshal.PtrToStringUni</A> to marshal from a Unicode =
string. </P>
<P>See also: </P>
<UL>
  <LI><A class=3D"external text"=20
  href=3D"http://msdn.microsoft.com/en-us/library/s9ts558h(VS.80).aspx"=20
  rel=3Dnofollow>Default marshaling for Strings at MSDN</A> </LI>
  <LI><A class=3D"external text"=20
  =
href=3D"http://msdn.microsoft.com/netframework/default.aspx?pull=3D/libra=
ry/en-us/dndotnet/html/manunmancode.asp"=20
  rel=3Dnofollow>An Overview of Managed/Unmanaged Code =
Interoperability</A>=20
</LI></UL>
<H2><SPAN id=3DClass_and_Structure_Marshaling class=3Dmw-headline>Class =
and=20
Structure Marshaling </SPAN></H2>
<P>The conceptual steps that occur to marshal classes and structures is =
detailed=20
above, in the <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Memory_=
Boundaries">Memory=20
Boundaries</A> section. </P>
<P>The principal difference between class and structure marshaling is =
which, if=20
any, of conceptual steps actually occurs. </P>
<H3><SPAN id=3DClass_Marshaling class=3Dmw-headline>Class Marshaling =
</SPAN></H3>
<P>Remember that classes are heap-allocated and garbage-collected in the =
CLI. As=20
such, you cannot pass classes by value to unmanaged functions, only by=20
reference: </P><PRE style=3D"FONT-FAMILY: monospace" class=3Dc> <SPAN =
style=3D"FONT-STYLE: italic; COLOR: #808080">/* Unmanaged code =
declarations */</SPAN>
 <SPAN style=3D"COLOR: #993333">struct</SPAN> UnmanagedStruct <SPAN =
style=3D"COLOR: #009900">{</SPAN>
    <SPAN style=3D"COLOR: #993333">int</SPAN> a<SPAN style=3D"COLOR: =
#339933">,</SPAN> b<SPAN style=3D"COLOR: #339933">,</SPAN> c<SPAN =
style=3D"COLOR: #339933">;</SPAN>
 <SPAN style=3D"COLOR: #009900">}</SPAN><SPAN style=3D"COLOR: =
#339933">;</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #993333">void</SPAN> WRONG <SPAN style=3D"COLOR: =
#009900">(</SPAN><SPAN style=3D"COLOR: #993333">struct</SPAN> =
UnamangedStruct pass_by_value<SPAN style=3D"COLOR: =
#009900">)</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #993333">void</SPAN> RIGHT <SPAN style=3D"COLOR: =
#009900">(</SPAN><SPAN style=3D"COLOR: #993333">struct</SPAN> =
UnmanagedStruct <SPAN style=3D"COLOR: =
#339933">*</SPAN>pass_by_reference<SPAN style=3D"COLOR: =
#009900">)</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN>
 <SPAN style=3D"COLOR: #993333">void</SPAN> RIGHT2 <SPAN style=3D"COLOR: =
#009900">(</SPAN><SPAN style=3D"COLOR: #993333">struct</SPAN> =
UnmanagedStruct <SPAN style=3D"COLOR: =
#339933">**</SPAN>pass_by_reference_out_or_ref<SPAN style=3D"COLOR: =
#009900">)</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN></PRE>
<P>This means that you cannot use classes to invoke unmanaged functions =
that=20
expect pass-by-value variables (such as the <I>WRONG</I> function, =
above). </P>
<P>There are two other issues with classes. First of all, classes by =
default use=20
<A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.LayoutKind.Auto"=20
rel=3Dnofollow>LayoutKind.Auto</A> layout. This means that the ordering =
of class=20
data members is unknown, and won't be determined until runtime. The =
runtime can=20
rearrange the order of members in any way it chooses, to optimize for =
access=20
time or data layout space. As such, you <I>MUST</I> use the <A=20
class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.StructLayoutAttribute"=20
rel=3Dnofollow>StructLayout</A> attribute and specify a <A =
class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DE%3ASystem.Runtime.Inte=
ropServices.LayoutKind"=20
rel=3Dnofollow>LayoutKind</A> value of <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.LayoutKind.Sequential"=20
rel=3Dnofollow>LayoutKind.Sequential</A> or <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.LayoutKind.Explicit"=20
rel=3Dnofollow>LayoutKind.Explicit</A>. </P>
<P>Secondly, classes (again, by default) only have in-bound marshaling. =
That is,=20
<A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#marshal=
-step-4">Step=20
4</A> (copying the unmanaged memory representation back into managed =
memory) is=20
ommitted. If you need the unmanaged memory to be copied back into =
managed=20
memory, you must addorn the <B>DllImport</B> function declaration =
argument with=20
an <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.OutAttribute"=20
rel=3Dnofollow>Out</A> attribute. You will also need to use the <A=20
class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.InAttribute"=20
rel=3Dnofollow>In</A> attribute if you want copy-in and copy-out =
behavior. To=20
summarize: </P>
<UL>
  <LI>Using <TT>[In]</TT> is equivalent to not specifying any parameter=20
  attributes, and will skip Step 4 (copying unmanaged memory into =
managed=20
  memory). </LI>
  <LI>Using <TT>[Out]</TT> will skip Step 2 (copying managed memory into =

  unmanaged memory). </LI>
  <LI>Use <TT>[In, Out]</TT> to both copy managed memory to unmanaged =
memory=20
  before the unmanaged function call, and then copy unmanaged memory =
back to=20
  managed memory after the function call. </LI></UL>
<P>In some circumstances, the marshaled copy can be omitted. The object =
will=20
simply be pinned in memory and a pointer to the start of the data passed =
to the=20
unmanaged function. </P>
<P>TODO: When can this actually occur? If this happened for any class =
with=20
<B>Sequential</B> layout, you wouldn't need to specify the <B>Out</B> =
attribute,=20
as the unmanaged code would see the actual object. Is there a specific =
set of=20
circumstances for when this can occur? This appears to happen with=20
<B>StringBuilder</B> (my tests don't require an <TT>[Out]</TT> to see =
changes=20
made to the <B>StringBuilder</B> by unmanaged code), but this is the =
only=20
example I can think of. </P>
<P>See Also: </P>
<UL>
  <LI><A class=3D"external text"=20
  =
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/cpguide/html/cpcondirectionalattributes.asp"=20
  rel=3Dnofollow>Directional Attributes (MSDN)</A> </LI></UL>
<H3><SPAN id=3DStructure_Marshaling class=3Dmw-headline>Structure =
Marshaling=20
</SPAN></H3>
<P>There are two primary differences between classes and structures. =
First,=20
structures do not need to be allocated on the heap; they can be =
allocated on the=20
runtime stack. Secondly, they are <B>LayoutKind.Sequential</B> by =
default, so=20
structure declarations do not need any additional attributes to use them =
with=20
unmanaged code (assuming that the default sequential layout rules are =
correct=20
for the unmanaged structure). </P>
<P>These differences permit structures to be passed by-value to =
unmanaged=20
functions, unlike classes. Additionally, if (a) the structure is located =
on the=20
stack, and (b) the structure contains only blittable types, then if you =
pass a=20
structure to an unmanaged function by-reference, the structure will be =
passed=20
directly to the unmanaged function, without an intermediate unmanaged =
memory=20
copy. This means that you may not need to specify the <B>Out</B> =
attribute to=20
see changes made by unmanaged code. </P>
<P>Note that as soon as the structure contains a non-blittable type =
(such as=20
System.Boolean, System.String, or an array), this optimization is no =
longer=20
possible and a copy of the structure must be made as part of the =
marshaling=20
process. </P>
<H3><SPAN id=3DClasses_and_Structures_as_Return_Values =
class=3Dmw-headline>Classes=20
and Structures as Return Values </SPAN></H3>
<P>The differences in allocation behavior between classes and structures =
also=20
affect how they're handled as return values from functions. </P>
<P>Classes can be used as the return value of a function when the =
unmanaged=20
function returns a pointer to an unmanaged structure. Classes cannot be =
used for=20
by-value return types. </P>
<P>Structures can be used when the unmanaged function returns the =
structure=20
by-value. It is not possible to return structures with "ref" or "out", =
so if an=20
unmanaged function returns a pointer to a structure, <B>IntPtr</B> must =
be used=20
for "safe" code, or a pointer to the structure can be used for "unsafe" =
code. If=20
<B>IntPtr</B> is used as the return type, <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DM%3ASystem.Runtime.Inte=
ropServices.Marshal.PtrToStructure"=20
rel=3Dnofollow>Marshal.PtrToStructure</A> can be used to convert the =
unmanaged=20
pointer into a managed structure. </P>
<P>Memory management is also heavily involved. </P>
<H3><SPAN id=3DMemory_Management class=3Dmw-headline>Memory Management =
</SPAN></H3>
<P>It's easy to skim over memory management for most of Platform Invoke =
and=20
marshaling, but for return values the CLI implements some default =
handling which=20
must be considered. </P>
<P>The CLI runtime assumes that, under certain circumstances, the CLI =
runtime is=20
responsible for freeing memory allocated by unmanaged code. Return =
values are=20
one of those circumstances, causing the return value to be a memory =
boundary for=20
control of memory (de)allocation. </P>
<P>The CLI assumes that all memory that is passed between the =
CLI/unmanaged code=20
boundary is allocated via a common memory allocator. The developer does =
not get=20
a choice in which memory allocator is used. For managed code, the <A=20
class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DM%3ASystem.Runtime.Inte=
ropServices.Marshal.AllocCoTaskMem"=20
rel=3Dnofollow>Marshal.AllocCoTaskMem</A> method can be used to allocate =
memory,=20
<A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DM%3ASystem.Runtime.Inte=
ropServices.Marshal.FreeCoTaskMem"=20
rel=3Dnofollow>Marshal.FreeCoTaskMem</A> is used to free the memory =
allocated by=20
<B>Marshal.AllocCoTaskMem</B>, and <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DM%3ASystem.Runtime.Inte=
ropServices.Marshal.ReAllocCoTaskMem"=20
rel=3Dnofollow>Marshal.ReAllocCoTaskMem</A> is used to resize a memory =
region=20
originally allocated by <B>Marshal.AllocCoTaskMem</B>. </P>
<P>Since classes are passed by reference, a pointer is returned, and the =
runtime=20
assumes that it must free this memory to avoid a memory leak. The chain =
of=20
events is thus: </P>
<OL>
  <LI>Managed code invokes unmanaged function that returns a pointer to =
an=20
  unmanaged structure in unmanaged memory. </LI>
  <LI>An instance of the appropriate managed class is instantiated, and =
the=20
  contents of the unmanaged memory is marshaled into the managed class. =
</LI>
  <LI>The unmanaged memory is freed by the runtime "as if" by invoking=20
  <B>Marshal.FreeCoTaskMem()</B>. </LI></OL>
<P>How is <B>Marshal.AllocCoTaskMem</B>, =
<B>Marshal.ReAllocCoTaskMem</B>, and=20
<B>Marshal.FreeCoTaskMem</B> implemented? That's platform-dependent. (So =
much=20
for portable platform-dependent code.) Under Windows, the COM Task =
Memory=20
allocator is used (via <A class=3D"external text"=20
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/com/html/c4cb588d-9482-4f90-a92e-75b604540d5c.asp"=20
rel=3Dnofollow>CoTaskMemAlloc()</A>, <A class=3D"external text"=20
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/com/html/c4cb588d-9482-4f90-a92e-75b604540d5c.asp"=20
rel=3Dnofollow>CoTaskMemReAlloc()</A>, and <A class=3D"external text"=20
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/com/html/c4cb588d-9482-4f90-a92e-75b604540d5c.asp"=20
rel=3Dnofollow>CoTaskMemFree()</A>). Under Unix, the GLib memory =
functions <A=20
class=3D"external text"=20
href=3D"http://developer.gnome.org/doc/API/2.0/glib/glib-Memory-Allocatio=
n.html#g-malloc"=20
rel=3Dnofollow>g_malloc()</A> , <A class=3D"external text"=20
href=3D"http://developer.gnome.org/doc/API/2.0/glib/glib-Memory-Allocatio=
n.html#g-realloc"=20
rel=3Dnofollow>g_realloc()</A> , and <A class=3D"external text"=20
href=3D"http://developer.gnome.org/doc/API/2.0/glib/glib-Memory-Allocatio=
n.html#g-free"=20
rel=3Dnofollow>g_free()</A> functions are used. Typically, these =
correspond to the=20
ANSI C functions <B>malloc</B>(3), <B>realloc</B>(3), and =
<B>free</B>(3), but=20
this is not necessarily the case as GLib can use different memory =
allocators;=20
see <A class=3D"external text"=20
href=3D"http://developer.gnome.org/doc/API/2.0/glib/glib-Memory-Allocatio=
n.html#g-mem-set-vtable"=20
rel=3Dnofollow>g_mem_set_vtable()</A> and <A class=3D"external text"=20
href=3D"http://developer.gnome.org/doc/API/2.0/glib/glib-Memory-Allocatio=
n.html#g-mem-is-system-malloc"=20
rel=3Dnofollow>g_mem_is_system_malloc()</A> . </P>
<P>What do you do if you don't want the runtime to free the memory? =
Don't return=20
a class. Instead, return an IntPtr (the moral equivalent of a C =
<TT>void*</TT>=20
pointer), and then use the <B>Marshal</B> class methods to manipulate =
that=20
pointer, such as <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DM%3ASystem.Runtime.Inte=
ropServices.Marshal.PtrToStructure"=20
rel=3Dnofollow>Marshal.PtrToStructure</A>, which works for both C# =
<B>struct</B>=20
types and <B>class</B> types marked=20
<TT>[StructLayout(LayoutKind.Sequential)]</TT>. </P>
<H3><SPAN id=3DChoosing_between_Classes_and_Structures =
class=3Dmw-headline>Choosing=20
between Classes and Structures </SPAN></H3>
<P>So which should be used when wrapping unmanaged code, classes or =
structures?=20
</P>
<P>Generally, the answer to this question depends upon what the =
unmanaged code=20
requires. If you require pass-by-value semantics, you must use =
structures. If=20
you want to return a pointer to an unmanaged type without resorting to =
"unsafe"=20
or manual code, you must use classes (assuming that the default <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Memory_=
Management">memory=20
allocation rules</A> are appropriate). </P>
<P>For the large intersection of unmanaged code that doesn't have =
pass-by-value=20
structures or return pointers to structures from functions? Use =
whichever is=20
more convenient for the end user. Not all languages support passing =
types by=20
reference (Java, for example), so using classes will permit a larger =
body of=20
languages to use the wrapper library. Furthermore, Microsoft suggests =
that=20
structure sizes not exceed 16 bytes. </P>
<H2><SPAN id=3DSummary class=3Dmw-headline>Summary </SPAN></H2>
<P>It's always easier to show the code, so... Given the following =
unmanaged code=20
declarations: </P><PRE style=3D"FONT-FAMILY: monospace" class=3Dc> <SPAN =
style=3D"FONT-STYLE: italic; COLOR: #808080">/* unmanaged code =
declarations */</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #993333">struct</SPAN> UnmanagedStruct <SPAN =
style=3D"COLOR: #009900">{</SPAN>
    <SPAN style=3D"COLOR: #993333">int</SPAN> n<SPAN style=3D"COLOR: =
#339933">;</SPAN>
 <SPAN style=3D"COLOR: #009900">}</SPAN><SPAN style=3D"COLOR: =
#339933">;</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #993333">void</SPAN> PassByValue <SPAN =
style=3D"COLOR: #009900">(</SPAN><SPAN style=3D"COLOR: =
#993333">struct</SPAN> UnmanagedStruct s<SPAN style=3D"COLOR: =
#009900">)</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #993333">void</SPAN> PassByReferenceIn <SPAN =
style=3D"COLOR: #009900">(</SPAN><SPAN style=3D"COLOR: =
#993333">struct</SPAN> UnmanagedStruct <SPAN style=3D"COLOR: =
#339933">*</SPAN>s<SPAN style=3D"COLOR: #009900">)</SPAN><SPAN =
style=3D"COLOR: #339933">;</SPAN>
 <SPAN style=3D"COLOR: #993333">void</SPAN> PassByReferenceOut <SPAN =
style=3D"COLOR: #009900">(</SPAN><SPAN style=3D"COLOR: =
#993333">struct</SPAN> UnmanagedStruct <SPAN style=3D"COLOR: =
#339933">*</SPAN>s<SPAN style=3D"COLOR: #009900">)</SPAN><SPAN =
style=3D"COLOR: #339933">;</SPAN>
 <SPAN style=3D"COLOR: #993333">void</SPAN> PassByReferenceInOut <SPAN =
style=3D"COLOR: #009900">(</SPAN><SPAN style=3D"COLOR: =
#993333">struct</SPAN> UnmanagedStruct <SPAN style=3D"COLOR: =
#339933">*</SPAN>s<SPAN style=3D"COLOR: #009900">)</SPAN><SPAN =
style=3D"COLOR: #339933">;</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #993333">struct</SPAN> UnmanagedStruct =
ReturnByValue <SPAN style=3D"COLOR: #009900">(</SPAN><SPAN =
style=3D"COLOR: #009900">)</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN>
 <SPAN style=3D"COLOR: #993333">struct</SPAN> UnmanagedStruct<SPAN =
style=3D"COLOR: #339933">*</SPAN> ReturnByReference <SPAN =
style=3D"COLOR: #009900">(</SPAN><SPAN style=3D"COLOR: =
#009900">)</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #993333">void</SPAN> DoubleIndirection <SPAN =
style=3D"COLOR: #009900">(</SPAN><SPAN style=3D"COLOR: =
#993333">struct</SPAN> UnmanagedStruct <SPAN style=3D"COLOR: =
#339933">**</SPAN>s<SPAN style=3D"COLOR: #009900">)</SPAN><SPAN =
style=3D"COLOR: #339933">;</SPAN></PRE>
<P>The class wrapper could be: </P><PRE style=3D"FONT-FAMILY: monospace" =
class=3Dcsharp> <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* =
note: sequential layout */</SPAN>
 <SPAN style=3D"COLOR: #008000">[</SPAN>StructLayout <SPAN =
style=3D"COLOR: #008000">(</SPAN>LayoutKind<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">Sequential</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
 <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">class</SPAN> =
ClassWrapper <SPAN style=3D"COLOR: #008000">{</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> n<SPAN =
style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* cannot wrap =
function PassByValue */</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* =
PassByReferenceIn */</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"mylib"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN>=20
       <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> =
PassByReferenceIn <SPAN style=3D"COLOR: #008000">(</SPAN>ClassWrapper =
s<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: =
#008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* =
PassByReferenceOut */</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"mylib"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN>=20
       <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> =
PassByReferenceOut <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">[</SPAN><SPAN style=3D"COLOR: #0600ff; =
FONT-WEIGHT: bold">Out</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN> =
ClassWrapper s<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* =
PassByReferenceInOut */</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"mylib"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN>=20
       <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> =
PassByReferenceInOut <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">[</SPAN><SPAN style=3D"COLOR: #0600ff; =
FONT-WEIGHT: bold">In</SPAN>, <SPAN style=3D"COLOR: #0600ff; =
FONT-WEIGHT: bold">Out</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN> =
ClassWrapper s<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* cannot wrap =
function ReturnByValue */</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* =
ReturnByReference */</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"mylib"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> ClassWrapper =
ReturnByReference <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
       <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* note: this =
causes returned pointer to be freed=20
          by runtime */</SPAN>
     <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* =
DoubleIndirection */</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"mylib"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN>=20
       <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> =
DoubeIndirection <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">ref</SPAN> ClassWrapper =
s<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: =
#008000">;</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>While the structure wrapper could be: </P><PRE style=3D"FONT-FAMILY: =
monospace" class=3Dcsharp> <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: =
bold">struct</SPAN> StructWrapper <SPAN style=3D"COLOR: =
#008000">{</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> n<SPAN =
style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* PassByValue =
*/</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"mylib"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> PassByValue =
<SPAN style=3D"COLOR: #008000">(</SPAN>StructWrapper s<SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* =
PassByReferenceIn */</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"mylib"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> =
PassByReferenceIn <SPAN style=3D"COLOR: #008000">(</SPAN>
       <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">ref</SPAN> =
StructWrapper s<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* =
PassByReferenceOut */</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"mylib"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> =
PassByReferenceOut <SPAN style=3D"COLOR: #008000">(</SPAN>
       <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">out</SPAN> =
StructWrapper s<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* =
PassByReferenceInOut */</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"mylib"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> =
PassByReferenceInOut <SPAN style=3D"COLOR: #008000">(</SPAN>
       <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">ref</SPAN> =
StructWrapper s<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* ReturnByValue =
*/</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"mylib"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> StructWrapper =
ReturnByValue <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* =
ReturnByReference: CLS-compliant way */</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"mylib"</SPAN>, EntryPoint<SPAN style=3D"COLOR: =
#008000">=3D</SPAN><SPAN style=3D"COLOR: =
#666666">"ReturnByReference"</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> IntPtr =
ReturnByReferenceCLS <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
       <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* note: this =
DOES NOT cause returned pointer to be=20
          freed by the runtime, so it's not identical to
          ClassWrapper.ReturnByReference.
          Use Marshal.PtrToStructure() to access the=20
          underlying structure. */</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* =
ReturnByReference: "unsafe" way */</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"mylib"</SPAN>, EntryPoint<SPAN style=3D"COLOR: =
#008000">=3D</SPAN><SPAN style=3D"COLOR: =
#666666">"ReturnByReference"</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">unsafe</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> =
StructWrapper<SPAN style=3D"COLOR: #008000">*</SPAN>=20
       ReturnByReferenceUnsafe <SPAN style=3D"COLOR: =
#008000">(</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
       <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* note: this =
DOES NOT cause returned pointer to be=20
          freed by the runtime, so it's not identical to
          ClassWrapper.ReturnByReference */</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* =
DoubleIndirection: CLS-compliant way */</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"mylib"</SPAN>, EntryPoint<SPAN style=3D"COLOR: =
#008000">=3D</SPAN><SPAN style=3D"COLOR: =
#666666">"DoubleIndirection"</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN>=20
       <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> =
DoubeIndirectionCLS <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">ref</SPAN> IntPtr s<SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
       <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* note: this =
is similar to ReturnByReferenceCLS().
          Pass a `ref IntPtr' to the function, then use
          Marshal.PtrToStructure() to access the=20
          underlying structure. */</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* =
DoubleIndirection: "unsafe" way */</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"mylib"</SPAN>, EntryPoint<SPAN style=3D"COLOR: =
#008000">=3D</SPAN><SPAN style=3D"COLOR: =
#666666">"DoubleIndirection"</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">unsafe</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN>=20
       <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> =
DoubeIndirectionUnsafe <SPAN style=3D"COLOR: =
#008000">(</SPAN>StructWrapper <SPAN style=3D"COLOR: =
#008000">**</SPAN>s<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<H2><SPAN id=3DMarshaling_Class_and_Structure_Members =
class=3Dmw-headline>Marshaling=20
Class and Structure Members </SPAN></H2>
<P>Aside from the major differences between classes and structures =
outlined=20
above, the members of classes and structures are marshaled identically. =
</P>
<P>The general rule of advice is this: never pass classes or structures=20
containing members of reference type (classes) to unmanaged code. This =
is=20
because unmanaged code can't do anything safely with the unmanaged =
reference=20
(pointer), and the CLI runtime doesn't do a "deep marshal" (marshal =
members of=20
marshaled classes, and their members, ad infinitum). </P>
<P>The immediate net effect of this is that you can't have array members =
in=20
marshaled classes, and (as we've seen before) handling strings can be =
"wonky"=20
(as strings are also a reference type). </P>
<P>Furthermore, the default string marshaling is the <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#More_Co=
ntrol">platform=20
default</A> , though this can be changed by setting the <A =
class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.StructLayoutAttribute.CharSet"=20
rel=3Dnofollow>StructLayoutAttribute.CharSet</A> field, which defaults =
to=20
<B>CharSet.Auto</B>. Alternatively, you can adorn string members with =
the=20
<B>MarshalAs</B> attribute to specify what kind of string they are. </P>
<H3><SPAN id=3DBoolean_Members class=3Dmw-headline>Boolean Members =
</SPAN></H3>
<P>The <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Boolean"=20
rel=3Dnofollow>System.Boolean</A> (<B>bool</B> in C#) type is special. =
(FUBAR=20
might be more appropriate.) A <TT>bool</TT> within a structure is =
marshaled as=20
an <TT>int</TT> (a 4-byte integer), with 0 being <TT>false </TT>and =
non-zero=20
being <TT>true</TT>; see <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.UnmanagedType.Bool"=20
rel=3Dnofollow>UnmanagedType.Bool</A> . A <TT>bool</TT> passed as an =
argument to a=20
function is marshaled as a <TT>short</TT> (a 2-byte integer), with 0 =
being=20
<TT>false</TT> and -1 being <TT>true</TT> (as all bits are set); see <A=20
class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.UnmanagedType.VariantBool"=20
rel=3Dnofollow>UnmanagedType.VariantBool</A> . </P>
<P>You can always explicitly specify the marshaling to use by using the=20
<B>MarshalAsAttribute</B> on the boolean member, but there are only =
three legal=20
UnmanagedType values: <B>UnmanagedType.Bool</B>,=20
<B>UnmanagedType.VariantBool</B>, and <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.UnmanagedType.U1"=20
rel=3Dnofollow>UnmanagedType.U1</A>. <B>UnmanagedType.U1</B> , the only=20
un-discssed type, is a 1-byte integer where 1 represents <TT>true</TT> =
and 0=20
represents <TT>false</TT>. </P>
<P>If you need to marshal as another data type, you should overload the =
method=20
accepting the boolean parameter, and manually convert the boolean to =
your=20
desired type: </P><PRE style=3D"FONT-FAMILY: monospace" class=3Dc> <SPAN =
style=3D"FONT-STYLE: italic; COLOR: #666666">// Unmanaged C =
declaration:</SPAN>
 <SPAN style=3D"COLOR: #993333">void</SPAN> DoSomething <SPAN =
style=3D"COLOR: #009900">(</SPAN><SPAN style=3D"COLOR: =
#993333">int</SPAN> boolean<SPAN style=3D"COLOR: #009900">)</SPAN><SPAN =
style=3D"COLOR: #339933">;</SPAN></PRE><PRE style=3D"FONT-FAMILY: =
monospace" class=3Dcsharp> <SPAN style=3D"FONT-STYLE: italic; COLOR: =
#008080">// Managed declaration:</SPAN>
 <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN style=3D"COLOR: =
#008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"SomeLibrary"</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">private</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> DoSomething =
<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">int</SPAN> boolean<SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> DoSomething =
<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">bool</SPAN> boolean<SPAN style=3D"COLOR: =
#008000">)</SPAN>
 <SPAN style=3D"COLOR: #008000">{</SPAN>
    DoSomething <SPAN style=3D"COLOR: #008000">(</SPAN>boolean <SPAN =
style=3D"COLOR: #008000">?</SPAN> <SPAN style=3D"COLOR: =
#ff0000">1</SPAN> <SPAN style=3D"COLOR: #008000">:</SPAN> <SPAN =
style=3D"COLOR: #ff0000">0</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>See also: <A class=3D"external text"=20
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/cpguide/html/cpcondefaultmarshalingforbooleans.asp"=20
rel=3Dnofollow>Default Marshaling for Boolean Types</A> </P>
<H3><SPAN id=3DUnions class=3Dmw-headline>Unions </SPAN></H3>
<P>A C union (in which multiple members share the same offset into a =
structure)=20
can be simulated by using the <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.FieldOffsetAttribute"=20
rel=3Dnofollow>FieldOffset</A> attribute and specifying the same offset =
for the=20
union members. </P>
<H3><SPAN id=3DLongs class=3Dmw-headline>Longs </SPAN></H3>
<P>The C 'long' type is difficult to marshal as a struct member, since =
there is=20
no CLR type which matches it, i.e. 'int' is 32 bit, 'long' is 64 bit, =
while C's=20
'long' can be 32 bit or 64 bit, dependending on the platform. There are =
two=20
possible solutions: </P>
<UL>
  <LI>Using two sets of structures, one for 32 bit and one for 64 bit =
platforms.=20
  </LI>
  <LI>Mapping C 'long' to 'IntPtr'. This will work on all 32 bit and 64 =
bit=20
  platforms, _except_ 64 bit windows, where sizeof(long)=3D=3D4 and=20
  sizeof(void*)=3D=3D8. See <A class=3D"external text"=20
  =
href=3D"http://stackoverflow.com/questions/384502/what-is-the-bit-size-of=
-long-on-64-bit-windows"=20
  rel=3Dnofollow>This</A>. </LI></UL>
<H3><SPAN id=3DArrays_Embedded_Within_Structures =
class=3Dmw-headline>Arrays Embedded=20
Within Structures </SPAN></H3>
<P>Inline arrays can be marshaled by using a <B>MarshalAs</B> attribute =
with=20
<B>UnmanagedType.ByValArray</B> and specifying the <A class=3D"external =
text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.MarshalAsAttribute.SizeConst"=20
rel=3Dnofollow>MarshalAsAttribute.SizeConst</A> field to the size of the =
array to=20
marshal. Inline arrays which contain strings can use=20
<B>UnmanagedType.ByValTStr</B> for a string. </P>
<P>However, the runtime doesn't automatically allocate arrays specified =
as=20
<B>UnmanagedType.ByValArray</B>. The programmer is still responsible for =

allocating the managed array. See the <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#marshal=
ing-members-summary">summary</A>=20
for more information. </P>
<P>TODO: Bernie Solomon says that for <TT>out</TT> parameters, the =
runtime will=20
allocate the inline array memory. Check this out. </P>
<P>For example, the unmanaged structure: </P><PRE style=3D"FONT-FAMILY: =
monospace" class=3Dc> <SPAN style=3D"COLOR: #993333">struct</SPAN> =
UnmanagedStruct <SPAN style=3D"COLOR: #009900">{</SPAN>
    <SPAN style=3D"COLOR: #993333">int</SPAN> data<SPAN style=3D"COLOR: =
#009900">[</SPAN><SPAN style=3D"COLOR: #0000dd">10</SPAN><SPAN =
style=3D"COLOR: #009900">]</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN>
    <SPAN style=3D"COLOR: #993333">char</SPAN> name<SPAN style=3D"COLOR: =
#009900">[</SPAN><SPAN style=3D"COLOR: #0000dd">32</SPAN><SPAN =
style=3D"COLOR: #009900">]</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN>
 <SPAN style=3D"COLOR: #009900">}</SPAN><SPAN style=3D"COLOR: =
#339933">;</SPAN></PRE>
<P><I>Can</I> be represented in C# as: </P><PRE style=3D"FONT-FAMILY: =
monospace" class=3Dcsharp> <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: =
bold">struct</SPAN> ManagedStruct_Slow <SPAN style=3D"COLOR: =
#008000">{</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>MarshalAs <SPAN =
style=3D"COLOR: #008000">(</SPAN>UnmanagedType<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">ByValArray</SPAN>, =
SizeConst<SPAN style=3D"COLOR: #008000">=3D</SPAN><SPAN style=3D"COLOR: =
#ff0000">10</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN><SPAN =
style=3D"COLOR: #008000">[</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN> =
 data<SPAN style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>MarshalAs <SPAN =
style=3D"COLOR: #008000">(</SPAN>UnmanagedType<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">ByValTStr</SPAN>, =
SizeConst<SPAN style=3D"COLOR: #008000">=3D</SPAN><SPAN style=3D"COLOR: =
#ff0000">32</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">string</SPAN> =
name<SPAN style=3D"COLOR: #008000">;</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>Of course, the managed structure can be declared in other ways, with =
varying=20
performance and usage tradeoffs. The previous declaration is the most=20
straightforward to use, but has the worst performance characteristics. =
The=20
following structure will marshal faster, but will be more difficult to =
work=20
with: </P><PRE style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">struct</SPAN> =
ManagedStruct_Fast_1 <SPAN style=3D"COLOR: #008000">{</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN>  data_0, =
data_1, data_2, data_3, data_4,
                data_5, data_6, data_7, data_8, data_9<SPAN =
style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">byte</SPAN> name_00, =
name_01, name_02, name_03, name_04,=20
                name_05, name_06, name_07, name_08, name_09,
                name_10, name_11, name_12, name_13, name_14,
                name_15, name_16, name_17, name_18, name_19,
                name_20, name_21, name_22, name_23, name_24,
                name_25, name_26, name_27, name_28, name_29,
                name_30, name_31,
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>Yet another alternative is to directly specify the size of the =
structure,=20
instead of letting the structure contents dictate the structure size. =
This is=20
done via the <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.StructLayout.Size"=20
rel=3Dnofollow>StructLayout.Size</A> field. This makes the structure =
terribly=20
annoying to deal with, as pointer arithmetic must be used to deal with =
the=20
<TT>name</TT> member: </P><PRE style=3D"FONT-FAMILY: monospace" =
class=3Dcsharp> <SPAN style=3D"COLOR: #008000">[</SPAN>StructLayout<SPAN =
style=3D"COLOR: #008000">(</SPAN>LayoutKind<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">Sequential</SPAN>, =
Size<SPAN style=3D"COLOR: #008000">=3D</SPAN><SPAN style=3D"COLOR: =
#ff0000">72</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
 <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">struct</SPAN> =
ManagedStruct_Fast_2 <SPAN style=3D"COLOR: #008000">{</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN>  data_0, =
data_1, data_2, data_3, data_4,
                data_5, data_6, data_7, data_8, data_9<SPAN =
style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">byte</SPAN> name<SPAN =
style=3D"COLOR: #008000">;</SPAN> <SPAN style=3D"FONT-STYLE: italic; =
COLOR: #008080">/* first byte of name */</SPAN>
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* Size property =
specifies that 31 bytes of nameless
       "space" is placed here. */</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<H4><SPAN id=3DC.23_2.0_Functionality class=3Dmw-headline>C# 2.0 =
Functionality=20
</SPAN></H4>
<P>C# 2.0 adds language features to deal with inline arrays, using a=20
<B>fixed</B> array syntax. This allows the previous structure to be =
declard as:=20
</P><PRE style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">struct</SPAN> =
ManagedStruct_v2 <SPAN style=3D"COLOR: #008000">{</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">fixed</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN>  data<SPAN =
style=3D"COLOR: #008000">[</SPAN><SPAN style=3D"COLOR: =
#ff0000">10</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">fixed</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">byte</SPAN> name<SPAN =
style=3D"COLOR: #008000">[</SPAN><SPAN style=3D"COLOR: =
#ff0000">32</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>Fixed array syntax is still "unsafe", and requires elevated privilege =
to=20
execute. </P>
<H4><SPAN id=3DReal_World_Experience class=3Dmw-headline>Real World =
Experience=20
</SPAN></H4>
<P>This might be of use. From David Jesk ( <A class=3D"external free"=20
href=3D"http://www.chat.net/~jeske/" =
rel=3Dnofollow>http://www.chat.net/~jeske/</A>=20
): </P>
<BLOCKQUOTE>This time I have some PInvoke information to share, so that =
when=20
  someone else runs into this issue they can see what I've done. In my=20
  ClearSilver (www.clearsilver.net, an HTML template system) C# wrapper, =
I=20
  wanted to access this C-struct: <PRE style=3D"FONT-FAMILY: monospace" =
class=3Dc> <SPAN style=3D"COLOR: #993333">typedef</SPAN> <SPAN =
style=3D"COLOR: #993333">struct</SPAN> _neo_err
 <SPAN style=3D"COLOR: #009900">{</SPAN>
   <SPAN style=3D"COLOR: #993333">int</SPAN> error<SPAN style=3D"COLOR: =
#339933">;</SPAN>
   <SPAN style=3D"COLOR: #993333">int</SPAN> err_stack<SPAN =
style=3D"COLOR: #339933">;</SPAN>
   <SPAN style=3D"COLOR: #993333">int</SPAN> flags<SPAN style=3D"COLOR: =
#339933">;</SPAN>
   <SPAN style=3D"COLOR: #993333">char</SPAN> desc<SPAN style=3D"COLOR: =
#009900">[</SPAN><SPAN style=3D"COLOR: #0000dd">256</SPAN><SPAN =
style=3D"COLOR: #009900">]</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN>
   <SPAN style=3D"COLOR: #993333">const</SPAN> <SPAN style=3D"COLOR: =
#993333">char</SPAN> <SPAN style=3D"COLOR: #339933">*</SPAN>file<SPAN =
style=3D"COLOR: #339933">;</SPAN>
   <SPAN style=3D"COLOR: #993333">const</SPAN> <SPAN style=3D"COLOR: =
#993333">char</SPAN> <SPAN style=3D"COLOR: #339933">*</SPAN>func<SPAN =
style=3D"COLOR: #339933">;</SPAN>
   <SPAN style=3D"COLOR: #993333">int</SPAN> lineno<SPAN style=3D"COLOR: =
#339933">;</SPAN>
   <SPAN style=3D"FONT-STYLE: italic; COLOR: #808080">/* internal use =
only */</SPAN>
   <SPAN style=3D"COLOR: #993333">struct</SPAN> _neo_err <SPAN =
style=3D"COLOR: #339933">*</SPAN>next<SPAN style=3D"COLOR: =
#339933">;</SPAN>
 <SPAN style=3D"COLOR: #009900">}</SPAN> NEOERR<SPAN style=3D"COLOR: =
#339933">;</SPAN></PRE>
  <P>My philosophy of using unsafe struct pointers, and just accessing =
the=20
  struct out in unmanaged memory is great, and it's exactly what I want =
to do.=20
  However, handling "char dest[256]" is not straightforward. </P>
  <P>In C# arrays are reference types. Using one makes the struct a =
managed=20
  type, and I can't put the array size in. The following is conceptually =
what I=20
  want to do, however, it's obviously invalid: </P><PRE =
style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN style=3D"COLOR: =
#008000">[</SPAN>StructLayout<SPAN style=3D"COLOR: =
#008000">(</SPAN>LayoutKind<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">Sequential</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">unsafe</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">struct</SPAN> NEOERR <SPAN =
style=3D"COLOR: #008000">{</SPAN>
   <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> error<SPAN =
style=3D"COLOR: #008000">;</SPAN>
   <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> err_stack<SPAN =
style=3D"COLOR: #008000">;</SPAN>
   <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> flags<SPAN =
style=3D"COLOR: #008000">;</SPAN>
   <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">byte</SPAN><SPAN =
style=3D"COLOR: #008000">[</SPAN><SPAN style=3D"COLOR: =
#ff0000">256</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN> desc<SPAN =
style=3D"COLOR: #008000">;</SPAN>  <SPAN style=3D"FONT-STYLE: italic; =
COLOR: #008080">// this is invalid, </SPAN>
                           <SPAN style=3D"FONT-STYLE: italic; COLOR: =
#008080">// can't contain size</SPAN>
   <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">const</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">byte</SPAN> <SPAN =
style=3D"COLOR: #008000">*</SPAN>file<SPAN style=3D"COLOR: =
#008000">;</SPAN>=20
   <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">const</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">byte</SPAN> <SPAN =
style=3D"COLOR: #008000">*</SPAN>func<SPAN style=3D"COLOR: =
#008000">;</SPAN>=20
   <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> lineno<SPAN =
style=3D"COLOR: #008000">;</SPAN>
&nbsp;
   <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* internal use =
only */</SPAN>
   <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">private</SPAN> =
NEOERR <SPAN style=3D"COLOR: #008000">*</SPAN>next<SPAN style=3D"COLOR: =
#008000">;</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
  <P>This dosn't work either: </P><PRE style=3D"FONT-FAMILY: monospace" =
class=3Dcsharp> <SPAN style=3D"COLOR: #008000">[</SPAN>MarshalAs <SPAN =
style=3D"COLOR: #008000">(</SPAN>UnmanagedType<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">LPStr</SPAN>, =
SizeConst<SPAN style=3D"COLOR: #008000">=3D</SPAN><SPAN style=3D"COLOR: =
#ff0000">256</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>=20
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">string</SPAN> desc<SPAN =
style=3D"COLOR: #008000">;</SPAN></PRE>
  <P>Because in this case, I don't want to marshal the data. I just want =
to talk=20
  to it in place. The solution I could come up with is this: </P><PRE =
style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN style=3D"COLOR: =
#008000">[</SPAN>StructLayout<SPAN style=3D"COLOR: =
#008000">(</SPAN>LayoutKind<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">Explicit</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">unsafe</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">struct</SPAN> NEOERR <SPAN =
style=3D"COLOR: #008000">{</SPAN>
   <SPAN style=3D"COLOR: #008000">[</SPAN>FieldOffset<SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#ff0000">0</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN> <SPAN style=3D"COLOR: #0600ff; =
FONT-WEIGHT: bold">public</SPAN> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">int</SPAN> error<SPAN style=3D"COLOR: =
#008000">;</SPAN>
   <SPAN style=3D"COLOR: #008000">[</SPAN>FieldOffset<SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#ff0000">4</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN> <SPAN style=3D"COLOR: #0600ff; =
FONT-WEIGHT: bold">public</SPAN> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">int</SPAN> err_stack<SPAN style=3D"COLOR: =
#008000">;</SPAN>
   <SPAN style=3D"COLOR: #008000">[</SPAN>FieldOffset<SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#ff0000">8</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN> <SPAN style=3D"COLOR: #0600ff; =
FONT-WEIGHT: bold">public</SPAN> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">int</SPAN> flags<SPAN style=3D"COLOR: =
#008000">;</SPAN>
   <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// public =
byte[256] dest;  // not representable</SPAN>
&nbsp;
   <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// use this as an =
address??</SPAN>
   <SPAN style=3D"COLOR: #008000">[</SPAN>FieldOffset<SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#ff0000">12</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN> <SPAN style=3D"COLOR: #0600ff; =
FONT-WEIGHT: bold">public</SPAN> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">byte</SPAN> dest_first_char<SPAN style=3D"COLOR: =
#008000">;</SPAN>
   <SPAN style=3D"COLOR: #008000">[</SPAN>FieldOffset<SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#ff0000">268</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN> <SPAN style=3D"COLOR: #0600ff; =
FONT-WEIGHT: bold">public</SPAN> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">byte</SPAN> <SPAN style=3D"COLOR: =
#008000">*</SPAN>file<SPAN style=3D"COLOR: #008000">;</SPAN> <SPAN =
style=3D"FONT-STYLE: italic; COLOR: #008080">// const</SPAN>
   <SPAN style=3D"COLOR: #008000">[</SPAN>FieldOffset<SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#ff0000">272</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN> <SPAN style=3D"COLOR: #0600ff; =
FONT-WEIGHT: bold">public</SPAN> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">byte</SPAN> <SPAN style=3D"COLOR: =
#008000">*</SPAN>func<SPAN style=3D"COLOR: #008000">;</SPAN> <SPAN =
style=3D"FONT-STYLE: italic; COLOR: #008080">// const</SPAN>
   <SPAN style=3D"COLOR: #008000">[</SPAN>FieldOffset<SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#ff0000">276</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN> <SPAN style=3D"COLOR: #0600ff; =
FONT-WEIGHT: bold">public</SPAN> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">int</SPAN> lineno<SPAN style=3D"COLOR: =
#008000">;</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
  <P>UGH! First, this is obviously annoying. Second, the only way I can =
figure=20
  to get access to "char dest[256]" is to use "char* dest =3D=20
  &amp;nerr-&gt;dest_first_char;" and then just use dest as a pointer to =
the=20
  string. I've dug through the documentation, and I can't find any =
better=20
  solution. </P>
  <P>Obviously it would be ideal if there were a way to represent a =
value-type=20
  array. I wonder how Managed C++ handles "char foo[256];" in a struct.=20
</P></BLOCKQUOTE>
<P>See also: </P>
<UL>
  <LI><A class=3D"external text"=20
  href=3D"http://weblogs.asp.net/ericgu/archive/2004/08/12/213676.aspx"=20
  rel=3Dnofollow>Eric Gunnerson's C# Blog: Arrays inside of =
structures</A>=20
</LI></UL>
<H3><SPAN id=3DSummary_2 class=3Dmw-headline><SPAN=20
id=3Dmarshaling-members-summary>Summary</SPAN> </SPAN></H3>
<P>Again, example native code... </P><PRE style=3D"FONT-FAMILY: =
monospace" class=3Dc> <SPAN style=3D"FONT-STYLE: italic; COLOR: =
#808080">/* original code */</SPAN>
 <SPAN style=3D"COLOR: #993333">struct</SPAN> UnmanagedInformation <SPAN =
style=3D"COLOR: #009900">{</SPAN>
    <SPAN style=3D"COLOR: #993333">int</SPAN> num<SPAN style=3D"COLOR: =
#339933">;</SPAN>
    <SPAN style=3D"COLOR: #993333">char</SPAN><SPAN style=3D"COLOR: =
#339933">*</SPAN> string<SPAN style=3D"COLOR: #339933">;</SPAN>
    <SPAN style=3D"COLOR: #993333">int</SPAN> array<SPAN style=3D"COLOR: =
#009900">[</SPAN><SPAN style=3D"COLOR: #0000dd">32</SPAN><SPAN =
style=3D"COLOR: #009900">]</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN>
&nbsp;
    <SPAN style=3D"COLOR: #993333">union</SPAN> <SPAN style=3D"COLOR: =
#009900">{</SPAN>
       <SPAN style=3D"COLOR: #993333">int64_t</SPAN> addr<SPAN =
style=3D"COLOR: #339933">;</SPAN>  <SPAN style=3D"FONT-STYLE: italic; =
COLOR: #808080">/* from &lt;stdint.h&gt;, C99 */</SPAN>
       <SPAN style=3D"COLOR: #993333">double</SPAN> other<SPAN =
style=3D"COLOR: #339933">;</SPAN>
    <SPAN style=3D"COLOR: #009900">}</SPAN> stuff<SPAN style=3D"COLOR: =
#339933">;</SPAN>
 <SPAN style=3D"COLOR: #009900">}</SPAN><SPAN style=3D"COLOR: =
#339933">;</SPAN></PRE>
<P>And the possible corresponding managed code: </P><PRE =
style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN =
style=3D"FONT-STYLE: italic; COLOR: #008080">/* managed representation =
*/</SPAN>
 <SPAN style=3D"COLOR: #008000">[</SPAN>StructLayout <SPAN =
style=3D"COLOR: #008000">(</SPAN>LayoutKind<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">Explicit</SPAN>, CharSet<SPAN style=3D"COLOR: =
#008000">=3D</SPAN>CharSet<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">Ansi</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
 <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">struct</SPAN> =
ManagedInformation <SPAN style=3D"COLOR: #008000">{</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>FieldOffset <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#ff0000">0</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">int</SPAN> num<SPAN style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>FieldOffset <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#ff0000">4</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">string</SPAN> str<SPAN style=3D"COLOR: =
#008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>FieldOffset <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#ff0000">8</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN>,=20
       MarshalAs <SPAN style=3D"COLOR: =
#008000">(</SPAN>UnmanagedType<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">ByValArray</SPAN>, =
SizeConst<SPAN style=3D"COLOR: #008000">=3D</SPAN><SPAN style=3D"COLOR: =
#ff0000">32</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN><SPAN =
style=3D"COLOR: #008000">[</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN> =
array<SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">/* union members =
*/</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>FieldOffset <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#ff0000">136</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">long</SPAN> stuff_addr<SPAN style=3D"COLOR: =
#008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>FieldOffset <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#ff0000">136</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">double</SPAN> stuff_other<SPAN style=3D"COLOR: =
#008000">;</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>Note that this isn't an exact match to the unmanaged code. This =
structure=20
must be built in two phases to match the unmanaged representation: (1) =
create=20
the structure, and (2) allocate memory for ManagedInformation.array. For =

example: </P><PRE style=3D"FONT-FAMILY: monospace" class=3Dcsharp> =
ManagedInformation info <SPAN style=3D"COLOR: #008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> ManagedInformation <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
 info<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">array</SPAN> <SPAN style=3D"COLOR: #008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">int</SPAN><SPAN style=3D"COLOR: =
#008000">[</SPAN><SPAN style=3D"COLOR: #ff0000">32</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN><SPAN style=3D"COLOR: =
#008000">;</SPAN></PRE>
<H3><SPAN id=3DA_Warning_about_FieldOffset class=3Dmw-headline>A Warning =
about=20
FieldOffset </SPAN></H3>
<P>The <B>FieldOffset</B> attribute has one major pitfall: it makes =
offsets of=20
types explicit. This is liable to break if (when) (1) the =
class/structure=20
contains a pointer, reference, or array, and (2) you change the bitsize =
of your=20
processor (move from a 32-bit processor to a 64-bit processor). It is =
preferable=20
to use <B>LayoutKind.Sequential</B> if at all possible, as the runtime =
will take=20
care of updating the structural offsets when the size of pointers =
changes. </P>
<P>TODO: include MSDN examples using the more esotoric <B>MarshalAs</B> =
fields,=20
such as <B>SizeParamIndex</B>, <B>ArraySubType</B>, etc. </P>
<P>See also: *<A class=3D"external text"=20
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/cpguide/html/cpconmarshalingdatawithplatforminvoke.asp"=20
rel=3Dnofollow>Marshaling Data with Platform Invoke at MSDN</A>, *<A=20
class=3D"external text"=20
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/cpguide/html/cpconarrayssample.asp"=20
rel=3Dnofollow>Arrays Sample at MSDN</A> </P>
<H3><SPAN id=3DMarshaling_Pointers class=3Dmw-headline>Marshaling =
Pointers=20
</SPAN></H3>
<P>Didn't we start using a managed execution environment to <I>avoid=20
</I>pointers? But I digress... </P>
<P>Alas, pointers are a fact of life in unmanaged code. As the <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Avoidin=
g_Marshaling">Avoiding=20
Marshaling</A> section points out, there are two ways to represent =
pointers: the=20
"safe" way, using <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.IntPtr"=20
rel=3Dnofollow>System.IntPtr</A> or <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.UIntPtr"=20
rel=3Dnofollow>System.UIntPtr</A> , and the "unsafe" way, by using =
<TT>unsafe</TT>=20
code and pointers. </P>
<H4><SPAN id=3DMarshaling_Embedded_Strings =
class=3Dmw-headline>Marshaling Embedded=20
Strings </SPAN></H4>
<P><I>Behold the topic that just won't die!</I> "Inline" strings -- in =
which the=20
storage for the string is part of the structure itself -- were covered =
<A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Arrays_=
Embedded_Within_Structures">previously</A>.=20
Obviously, and likely more commonly, strings are not always allocated =
within the=20
structure; typically a pointer to a null-terminated string is stored. =
</P>
<P>The typical approach is to map the string as an IntPtr, and use <A=20
class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DM%3ASystem.Runtime.Inte=
ropServices.Marshal.PtrToStringAnsi"=20
rel=3Dnofollow>Marshal.PtrToStringAnsi</A> and similar functions to =
manually=20
marshal the string. </P>
<P>Why manually marshal? Because you typically use a custom memory =
allocator=20
(such as <B>malloc</B>(3)), and don't want the runtime incorrectly =
freeing the=20
memory that the string references. In this case, it's <I>essential</I> =
that you=20
manually marshal the string to avoid memory corruption. </P>
<H2><SPAN id=3DCustom_Marshaling class=3Dmw-headline>Custom Marshaling =
</SPAN></H2>
<P>The <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.ICustomMarshaler"=20
rel=3Dnofollow>ICustomMarshaler</A> interface allows the CLI to invoke =
custom code=20
as part of the P/Invoke call. Normal P/Invoke calls follow the =
structure: </P>
<BLOCKQUOTE>
  <P>Method invocation =E2=86=92 CLI P/Invoke Default Marshaler =
=E2=86=92 Unmanaged method call=20
  </P></BLOCKQUOTE>
<P>Custom marshaling allows this to become </P>
<BLOCKQUOTE>
  <P>Method invocation =E2=86=92 CLI P/Invoke Default Marshaler =
=E2=86=92 custom marshaler =E2=86=92 CLI=20
  P/Invoke marshaler =E2=86=92 Unmanaged method call </P></BLOCKQUOTE>
<P>In order for the custom marshaler to be invoked, </P>
<OL>
  <LI>the custom marshaler must implement the <B>ICustomMarshaler</B> =
interface,=20
  and </LI>
  <LI>the custom marshaler must provide a static <B>GetInstance</B> =
method which=20
  takes a string and returns a <B>ICustomMarshaler</B> instance: =
</LI></OL>
<DL>
  <DD><PRE style=3D"FONT-FAMILY: monospace" class=3Dcsharp><SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> =
ICustomMarshaler GetInstance <SPAN style=3D"COLOR: =
#008000">(</SPAN><SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: =
bold">string</SPAN> s<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN></PRE></DD></DL>
<OL>
  <LI>The <B>DllImport</B> declaration must have a parameter with a=20
  <B>MarshalAs</B> attribute specifying <A class=3D"external text"=20
  =
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.UnmanagedType.CustomMarshaler"=20
  rel=3Dnofollow>UnmanagedType.CustomMarshaler</A> and:=20
  <UL>
    <LI>The <A class=3D"external text"=20
    =
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.MarshalAsAttribute.MarshalTypeRef"=20
    rel=3Dnofollow>MarshalTypeRef</A> or <A class=3D"external text"=20
    =
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.MarshalAsAttribute.MarshalType"=20
    rel=3Dnofollow>MarshalType</A> fields. </LI>
    <LI>(Optionally) The <A class=3D"external text"=20
    =
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Runtime.Inte=
ropServices.MarshalAsAttribute.MarshalCookie"=20
    rel=3Dnofollow>MarshalCookie</A> field. This string is passed to=20
    <B>GetInstance</B>. </LI></UL></LI></OL>
<P>An example custom marshaler can be found in the=20
<B>Mono.Unix.Native.FileNameMarshaler</B> (<A class=3D"external text"=20
href=3D"http://anonsvn.mono-project.com/viewvc/trunk/mcs/class/Mono.Posix=
/Mono.Unix.Native/FileNameMarshaler.cs"=20
rel=3Dnofollow>FileNameMarshaler.cs</A>) and in the Mono unit tests (<A=20
class=3D"external text"=20
href=3D"http://anonsvn.mono-project.com/viewvc/trunk/mono/mono/tests/mars=
hal9.cs"=20
rel=3Dnofollow>marshal9.cs</A>). </P>
<P>Given all the work involved with custom marshaling, such as the =
required=20
<B>ICustomMarshaler</B> class implementation and <B>MarshalAs</B> =
attributes,=20
what is the advantage of custom marshaling over <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#Manual_=
Marshaling">manual=20
marshaling</A>? Maintenance. For only one method, manual marshaling is =
simpler:=20
</P><PRE style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN =
style=3D"FONT-STYLE: italic; COLOR: #008080">// Custom Marshaling with =
Mono.Unix.Native.FileNameMarshaler.cs</SPAN>
 <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport<SPAN style=3D"COLOR: =
#008000">(</SPAN>LIB<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> open <SPAN =
style=3D"COLOR: #008000">(</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>MarshalAs <SPAN =
style=3D"COLOR: #008000">(</SPAN>UnmanagedType<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">CustomMarshaler</SPAN>,=20
       MarshalTypeRef<SPAN style=3D"COLOR: #008000">=3D</SPAN><A =
href=3D"http://www.google.com/search?q=3Dtypeof+msdn.microsoft.com"><SPAN=
 style=3D"COLOR: #008000">typeof</SPAN></A><SPAN style=3D"COLOR: =
#008000">(</SPAN>Mono<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">Unix</SPAN><SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">Native</SPAN><SPAN =
style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">FileNameMarshaler</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">string</SPAN> =
pathname,=20
    <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> flags
 <SPAN style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: =
#008000">;</SPAN></PRE>
<P>And the manual marshaler implementation: </P><PRE =
style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN =
style=3D"FONT-STYLE: italic; COLOR: #008080">// Use Manual =
Marshaling</SPAN>
 <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport<SPAN style=3D"COLOR: =
#008000">(</SPAN>LIB<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">private</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> open <SPAN =
style=3D"COLOR: #008000">(</SPAN>IntPtr pathname, <SPAN style=3D"COLOR: =
#6666cc; FONT-WEIGHT: bold">int</SPAN> flags<SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> open <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">string</SPAN> pathname, <SPAN style=3D"COLOR: =
#6666cc; FONT-WEIGHT: bold">int</SPAN> flags<SPAN style=3D"COLOR: =
#008000">)</SPAN>
 <SPAN style=3D"COLOR: #008000">{</SPAN>
    IntPtr _pathname <SPAN style=3D"COLOR: #008000">=3D</SPAN> =
UnixMarshal<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">StringToHeap</SPAN> <SPAN style=3D"COLOR: =
#008000">(</SPAN>pathname,=20
          UnixEncoding<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">Instance</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">try</SPAN> <SPAN =
style=3D"COLOR: #008000">{</SPAN>
       <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">return</SPAN> =
open <SPAN style=3D"COLOR: #008000">(</SPAN>_pathname, flags<SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">finally</SPAN> =
<SPAN style=3D"COLOR: #008000">{</SPAN>
       UnixMarshal<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">FreeHeap</SPAN> <SPAN style=3D"COLOR: =
#008000">(</SPAN>_pathname<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>However, as the number of methods that require essentially identical=20
marshaling increases, it becomes easier to maintain the custom marshaler =
than to=20
maintain the <I>N</I> separate manual marshal copies that would =
otherwise be=20
necessary. </P>
<P><BR>See also: *<A class=3D"external text"=20
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/cpref/html/frlrfsystemruntimeinteropservicesicustommarshalerclasstopic.=
asp"=20
rel=3Dnofollow>ICustomMarshal Interface at MSDN</A> </P>
<H2><SPAN id=3DManual_Marshaling class=3Dmw-headline>Manual Marshaling =
</SPAN></H2>
<P>What do you do when the default marshaling rules (amid all the =
variations=20
that the <B>DllImport</B> and <B>MarshalAs</B> attributes permit) don't =
allow=20
you to invoke a given function? You do it manually by making extensive =
use of=20
the <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.Marshal"=20
rel=3Dnofollow>Marshal</A> class methods. </P>
<P>TODO: finish. </P>
<H3><SPAN id=3DMarshaling_char.2A.2A class=3Dmw-headline>Marshaling =
char**=20
</SPAN></H3>
<P>Note: The original howto can be found here: <A class=3D"external =
free"=20
href=3D"http://hisham.cc/files/howto/marshalling_strings/"=20
rel=3Dnofollow>http://hisham.cc/files/howto/marshalling_strings/</A> =
</P>
<P>The key in the following tutorial is System.Runtime.InteropServices, =
where we=20
can find the Marshal class. That class is very useful because it bridges =
created=20
managed objects and unmanaged ones. Its functionalities are very similar =
to=20
blocks, unsafe, and more. For example, let's say that all pointer types =
in .NET=20
are saved in an instance of the type IntPtr. With the Marshal class, we =
can=20
perform any operation like adding a determined number of bytes in order =
to point=20
to other objects, and converting things that are there in a structure or =
a chain=20
(other thing is if in that memory direction is something with sense or =
not).=20
</P>
<P>Using this piece of code, we can see how to put data into an =
unmanaged=20
structure through a pointer obtained from a function or an external =
public=20
structure of a native library. </P>
<P>By default C#, establishes the order that is most optimized for the =
structure=20
fields in memory. Nevertheless, if we want to dump the contents of the =
unmanaged=20
pointer in our structure correctly, all the fields must maintain their =
order and=20
size (in bytes). To solve this problem, we apply the attribute=20
StructLayout(LayoutKind.Sequential) on the structure. </P><PRE =
style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN style=3D"COLOR: =
#008000">[</SPAN>StructLayout<SPAN style=3D"COLOR: =
#008000">(</SPAN>LayoutKind<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">Sequential</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN>
   <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">class</SPAN> =
_EcoreEventDndEnter
     <SPAN style=3D"COLOR: #008000">{</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
IntPtr win<SPAN style=3D"COLOR: #008000">;</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
IntPtr src<SPAN style=3D"COLOR: #008000">;</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
IntPtr types<SPAN style=3D"COLOR: #008000">;</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> =
num_types<SPAN style=3D"COLOR: #008000">;</SPAN>=20
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
_EcoreEventDndEnter<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN>=20
          <SPAN style=3D"COLOR: #008000">{</SPAN><SPAN style=3D"COLOR: =
#008000">}</SPAN>
     <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>The structure has two pointers to X windows, a pointer to a character =
matrix=20
(a string table), and an integer that defines the number of present =
chains. It=20
seems to be a complex structure, but it isn't. </P>
<P>We want to create a class from that structure. So, we have a =
constructor with=20
a parameter that points to the unmarshalled structure. Afterwards, we =
use the=20
Marshal class in order to utilize its basic types. Everything is =
straight=20
forward except for the matrix that couldn't be converted without =
producing an=20
error. The Mono.UnixMarshal class solves that problem, which was =
basically a=20
portability issue: </P><PRE style=3D"FONT-FAMILY: monospace" =
class=3Dcsharp>   <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">public</SPAN> <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: =
bold">class</SPAN> EcoreEventDndEnter
     <SPAN style=3D"COLOR: #008000">{</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
Window win<SPAN style=3D"COLOR: #008000">;</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
Window src<SPAN style=3D"COLOR: #008000">;</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">string</SPAN><SPAN =
style=3D"COLOR: #008000">[</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN> =
types<SPAN style=3D"COLOR: #008000">;</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> =
num_types<SPAN style=3D"COLOR: #008000">;</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
EcoreEventDndEnter<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN>
          <SPAN style=3D"COLOR: #008000">{</SPAN><SPAN style=3D"COLOR: =
#008000">}</SPAN>
&nbsp;
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
EcoreEventDndEnter<SPAN style=3D"COLOR: #008000">(</SPAN>IntPtr =
EventInfo<SPAN style=3D"COLOR: #008000">)</SPAN>
          <SPAN style=3D"COLOR: #008000">{</SPAN>
             _EcoreEventDndEnter e <SPAN style=3D"COLOR: =
#008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> _EcoreEventDndEnter<SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
             e <SPAN style=3D"COLOR: #008000">=3D</SPAN> <SPAN =
style=3D"COLOR: #008000">(</SPAN>_EcoreEventDndEnter<SPAN =
style=3D"COLOR: #008000">)</SPAN>Marshal<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">PtrToStructure</SPAN><SPAN style=3D"COLOR: =
#008000">(</SPAN>EventInfo, <A =
href=3D"http://www.google.com/search?q=3Dtypeof+msdn.microsoft.com"><SPAN=
 style=3D"COLOR: #008000">typeof</SPAN></A><SPAN style=3D"COLOR: =
#008000">(</SPAN>_EcoreEventDndEnter<SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
             win <SPAN style=3D"COLOR: #008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> Window<SPAN style=3D"COLOR: =
#008000">(</SPAN>e<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">win</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
             src <SPAN style=3D"COLOR: #008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> Window<SPAN style=3D"COLOR: =
#008000">(</SPAN>e<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">src</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
             types <SPAN style=3D"COLOR: #008000">=3D</SPAN> Mono<SPAN =
style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">Unix</SPAN><SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">UnixMarshal</SPAN><SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">PtrToStringArray</SPAN><SPAN style=3D"COLOR: =
#008000">(</SPAN>e<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">types</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
             num_types <SPAN style=3D"COLOR: #008000">=3D</SPAN> e<SPAN =
style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">num_types</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
          <SPAN style=3D"COLOR: #008000">}</SPAN>
     <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>The fact that Mono is open-source helped understand that MonoUnix is =
merely=20
an extension of System.Runtime.InteropServices.Marshal, using the same =
methods=20
of the Marshal class. This means that we can put the necessary code of=20
UnixMarshal in the project in order to guarantee its portability from =
Windows=20
Mono or even .NET. Here's the piece of code: </P><PRE =
style=3D"FONT-FAMILY: monospace" class=3Dcsharp>&nbsp;
   <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">class</SPAN> Common
     <SPAN style=3D"COLOR: #008000">{</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">string</SPAN> PtrToString =
<SPAN style=3D"COLOR: #008000">(</SPAN>IntPtr p<SPAN style=3D"COLOR: =
#008000">)</SPAN>
          <SPAN style=3D"COLOR: #008000">{</SPAN>
             <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// TODO: =
deal with character set issues.  Will PtrToStringAnsi always</SPAN>
             <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// "Do =
The Right Thing"?</SPAN>
             <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">if</SPAN> =
<SPAN style=3D"COLOR: #008000">(</SPAN>p <SPAN style=3D"COLOR: =
#008000">=3D=3D</SPAN> IntPtr<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">Zero</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN>
               <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">return</SPAN> <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">null</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
             <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">return</SPAN> Marshal<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">PtrToStringAnsi</SPAN> <SPAN style=3D"COLOR: =
#008000">(</SPAN>p<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
          <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
&nbsp;
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">string</SPAN><SPAN =
style=3D"COLOR: #008000">[</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN> =
PtrToStringArray <SPAN style=3D"COLOR: #008000">(</SPAN>IntPtr =
stringArray<SPAN style=3D"COLOR: #008000">)</SPAN>
          <SPAN style=3D"COLOR: #008000">{</SPAN>
             <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">if</SPAN> =
<SPAN style=3D"COLOR: #008000">(</SPAN>stringArray <SPAN style=3D"COLOR: =
#008000">=3D=3D</SPAN> IntPtr<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">Zero</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN>
               <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">return</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">string</SPAN><SPAN style=3D"COLOR: =
#008000">[</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN><SPAN =
style=3D"COLOR: #008000">{</SPAN><SPAN style=3D"COLOR: =
#008000">}</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
&nbsp;
             <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: =
bold">int</SPAN> argc <SPAN style=3D"COLOR: #008000">=3D</SPAN> =
CountStrings <SPAN style=3D"COLOR: #008000">(</SPAN>stringArray<SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
             <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">return</SPAN> PtrToStringArray <SPAN style=3D"COLOR: =
#008000">(</SPAN>argc, stringArray<SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
          <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">private</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> CountStrings =
<SPAN style=3D"COLOR: #008000">(</SPAN>IntPtr stringArray<SPAN =
style=3D"COLOR: #008000">)</SPAN>
          <SPAN style=3D"COLOR: #008000">{</SPAN>
             <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: =
bold">int</SPAN> count <SPAN style=3D"COLOR: #008000">=3D</SPAN> <SPAN =
style=3D"COLOR: #ff0000">0</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
             <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">while</SPAN> <SPAN style=3D"COLOR: #008000">(</SPAN>Marshal<SPAN =
style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">ReadIntPtr</SPAN> <SPAN style=3D"COLOR: =
#008000">(</SPAN>stringArray, count<SPAN style=3D"COLOR: =
#008000">*</SPAN>IntPtr<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">Size</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN> <SPAN style=3D"COLOR: #008000">!=3D</SPAN> IntPtr<SPAN =
style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">Zero</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN>
               <SPAN style=3D"COLOR: #008000">++</SPAN>count<SPAN =
style=3D"COLOR: #008000">;</SPAN>
             <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">return</SPAN> count<SPAN style=3D"COLOR: #008000">;</SPAN>
          <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
&nbsp;
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">string</SPAN><SPAN =
style=3D"COLOR: #008000">[</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN> =
PtrToStringArray <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> count, IntPtr =
stringArray<SPAN style=3D"COLOR: #008000">)</SPAN>
          <SPAN style=3D"COLOR: #008000">{</SPAN>
             <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">if</SPAN> =
<SPAN style=3D"COLOR: #008000">(</SPAN>count <SPAN style=3D"COLOR: =
#008000">&lt;</SPAN> <SPAN style=3D"COLOR: #ff0000">0</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN>
               <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">throw</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> ArgumentOutOfRangeException =
<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"count"</SPAN>, <SPAN style=3D"COLOR: #666666">"&lt; =
0"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: =
#008000">;</SPAN>
             <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">if</SPAN> =
<SPAN style=3D"COLOR: #008000">(</SPAN>stringArray <SPAN style=3D"COLOR: =
#008000">=3D=3D</SPAN> IntPtr<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">Zero</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN>
               <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">return</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">string</SPAN><SPAN style=3D"COLOR: =
#008000">[</SPAN>count<SPAN style=3D"COLOR: #008000">]</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
&nbsp;
&nbsp;
             <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: =
bold">string</SPAN><SPAN style=3D"COLOR: #008000">[</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN> members <SPAN style=3D"COLOR: =
#008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> <SPAN style=3D"COLOR: #6666cc; =
FONT-WEIGHT: bold">string</SPAN><SPAN style=3D"COLOR: =
#008000">[</SPAN>count<SPAN style=3D"COLOR: #008000">]</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
             <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">for</SPAN> <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> i <SPAN =
style=3D"COLOR: #008000">=3D</SPAN> <SPAN style=3D"COLOR: =
#ff0000">0</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN> i <SPAN =
style=3D"COLOR: #008000">&lt;</SPAN> count<SPAN style=3D"COLOR: =
#008000">;</SPAN> <SPAN style=3D"COLOR: #008000">++</SPAN>i<SPAN =
style=3D"COLOR: #008000">)</SPAN> <SPAN style=3D"COLOR: =
#008000">{</SPAN>
                IntPtr s <SPAN style=3D"COLOR: #008000">=3D</SPAN> =
Marshal<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">ReadIntPtr</SPAN> <SPAN style=3D"COLOR: =
#008000">(</SPAN>stringArray, i <SPAN style=3D"COLOR: #008000">*</SPAN> =
IntPtr<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">Size</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
                members<SPAN style=3D"COLOR: #008000">[</SPAN>i<SPAN =
style=3D"COLOR: #008000">]</SPAN> <SPAN style=3D"COLOR: =
#008000">=3D</SPAN> PtrToString <SPAN style=3D"COLOR: =
#008000">(</SPAN>s<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
             <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
&nbsp;
             <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">return</SPAN> members<SPAN style=3D"COLOR: #008000">;</SPAN>
          <SPAN style=3D"COLOR: #008000">}</SPAN>
     <SPAN style=3D"COLOR: #008000">}</SPAN></PRE><PRE>After the =
following step, the final class is completely portable:
</PRE><PRE style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">class</SPAN> =
EcoreEventDndEnter
     <SPAN style=3D"COLOR: #008000">{</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
Window win<SPAN style=3D"COLOR: #008000">;</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
Window src<SPAN style=3D"COLOR: #008000">;</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">string</SPAN><SPAN =
style=3D"COLOR: #008000">[</SPAN><SPAN style=3D"COLOR: #008000">]</SPAN> =
types<SPAN style=3D"COLOR: #008000">;</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> =
num_types<SPAN style=3D"COLOR: #008000">;</SPAN>
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
EcoreEventDndEnter<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN>
          <SPAN style=3D"COLOR: #008000">{</SPAN><SPAN style=3D"COLOR: =
#008000">}</SPAN>
&nbsp;
        <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
EcoreEventDndEnter<SPAN style=3D"COLOR: #008000">(</SPAN>IntPtr =
EventInfo<SPAN style=3D"COLOR: #008000">)</SPAN>
          <SPAN style=3D"COLOR: #008000">{</SPAN>
             _EcoreEventDndEnter e <SPAN style=3D"COLOR: =
#008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> _EcoreEventDndEnter<SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
             e <SPAN style=3D"COLOR: #008000">=3D</SPAN> <SPAN =
style=3D"COLOR: #008000">(</SPAN>_EcoreEventDndEnter<SPAN =
style=3D"COLOR: #008000">)</SPAN>Marshal<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">PtrToStructure</SPAN><SPAN style=3D"COLOR: =
#008000">(</SPAN>EventInfo, <A =
href=3D"http://www.google.com/search?q=3Dtypeof+msdn.microsoft.com"><SPAN=
 style=3D"COLOR: #008000">typeof</SPAN></A><SPAN style=3D"COLOR: =
#008000">(</SPAN>_EcoreEventDndEnter<SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
             win <SPAN style=3D"COLOR: #008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> Window<SPAN style=3D"COLOR: =
#008000">(</SPAN>e<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">win</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
             src <SPAN style=3D"COLOR: #008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> Window<SPAN style=3D"COLOR: =
#008000">(</SPAN>e<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">src</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
             types <SPAN style=3D"COLOR: #008000">=3D</SPAN> Common<SPAN =
style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">PtrToStringArray</SPAN><SPAN style=3D"COLOR: =
#008000">(</SPAN>e<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">types</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
             num_types <SPAN style=3D"COLOR: #008000">=3D</SPAN> e<SPAN =
style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">num_types</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
          <SPAN style=3D"COLOR: #008000">}</SPAN>
     <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<H1><SPAN id=3DAvoiding_Marshaling class=3Dmw-headline>Avoiding =
Marshaling=20
</SPAN></H1>
<P>Marshaling is no panacea, as marshaling implies copying data. =
Marshaling may=20
be problematic because the data translation is a complex, time-consuming =

process. Alternatively, it may be problematic because it isn't possible =
to copy=20
the data, as the data isn't known or is likely to change. </P>
<P>An example of the latter would be the GTK+ libraries. GTK+ is an=20
object-oriented toolkit written in C. As with all object-oriented =
libraries,=20
there can be an unknown number of derived classes, each of which having =
a=20
different class size. Furthermore, class instances are typically =
accessed=20
through pointers. As such, marshaling the entire class between managed =
and=20
unmanaged memory is not an option, as a copy isn't desired, access to =
the same=20
instance is. </P>
<P>Another example is when using "opaque" data types; that is, types =
through=20
which interaction is solely through pointers, and nothing about the =
internals of=20
the type is public. This describes a large portion of the Win32 API, =
where=20
HANDLE is used to represent most objects. </P>
<P>There are two ways to handle this in C#: the "type-safe" way, which =
involves=20
using pointers and the "unsafe" C# language features, and the =
CLS-compliant way,=20
which uses System.IntPtr to stand in for a void pointer. </P>
<P>In both cases, the separation between managed and unmanaged memory is =
made=20
explicit. Managed memory remains type-safe, while unmanaged memory is =
not (since=20
<A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.IntPtr"=20
rel=3Dnofollow>System.IntPtr</A> is used to point into unmanaged memory, =
and there=20
is no way to ensure the actual type of what the System.IntPtr refers =
to). </P>
<P>Be warned that this may not be safe, if the "unmanaged" memory is =
itself=20
garbage collected. This may be the case if the unmanaged memory is =
handled by a=20
different runtime system (Python, Ruby, Lisp, etc.) or a garbage =
collector is=20
being used (Boehm). If the unmanaged memory is garbage collected, then =
the=20
System.IntPtr won't be updated when unmanaged memory undergoes a garbage =

collection, resulting in memory corruption. </P>
<P>For example, given the unmanaged API: </P><PRE style=3D"FONT-FAMILY: =
monospace" class=3Dc> <SPAN style=3D"COLOR: #993333">typedef</SPAN> =
<SPAN style=3D"COLOR: #993333">void</SPAN><SPAN style=3D"COLOR: =
#339933">*</SPAN> HANDLE<SPAN style=3D"COLOR: #339933">;</SPAN>
&nbsp;
 bool CreateItem <SPAN style=3D"COLOR: #009900">(</SPAN>HANDLE <SPAN =
style=3D"COLOR: #339933">*</SPAN>item<SPAN style=3D"COLOR: =
#009900">)</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN>
 <SPAN style=3D"COLOR: #993333">void</SPAN> DestroyItem <SPAN =
style=3D"COLOR: #009900">(</SPAN>HANDLE item<SPAN style=3D"COLOR: =
#009900">)</SPAN><SPAN style=3D"COLOR: #339933">;</SPAN>
 <SPAN style=3D"COLOR: #993333">int</SPAN> GetInfo <SPAN style=3D"COLOR: =
#009900">(</SPAN>HANDLE item<SPAN style=3D"COLOR: #009900">)</SPAN><SPAN =
style=3D"COLOR: #339933">;</SPAN></PRE>
<P>The "type-safe" C# wrapper (using "unsafe" code) is: </P><PRE =
style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN style=3D"COLOR: =
#6666cc; FONT-WEIGHT: bold">struct</SPAN> Item <SPAN style=3D"COLOR: =
#008000">{</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"library"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">unsafe</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN>=20
       <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">bool</SPAN> =
CreateItem <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#0600ff; FONT-WEIGHT: bold">out</SPAN> Item<SPAN style=3D"COLOR: =
#008000">*</SPAN> item<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"library"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">unsafe</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> DestroyItem =
<SPAN style=3D"COLOR: #008000">(</SPAN>Item<SPAN style=3D"COLOR: =
#008000">*</SPAN> item<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"library"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">unsafe</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> GetInfo <SPAN =
style=3D"COLOR: #008000">(</SPAN>Item<SPAN style=3D"COLOR: =
#008000">*</SPAN> item<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">class</SPAN> =
ExampleUsage <SPAN style=3D"COLOR: #008000">{</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">unsafe</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> Main <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN>
    <SPAN style=3D"COLOR: #008000">{</SPAN>
       Item<SPAN style=3D"COLOR: #008000">*</SPAN> item<SPAN =
style=3D"COLOR: #008000">;</SPAN>
       Item<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">CreateItem</SPAN> <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">out</SPAN> item<SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
       <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> n =
<SPAN style=3D"COLOR: #008000">=3D</SPAN> Item<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">GetInfo</SPAN> <SPAN =
style=3D"COLOR: #008000">(</SPAN>item<SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
       <SPAN style=3D"COLOR: #000000">System</SPAN><SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">Console</SPAN><SPAN =
style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">WriteLine</SPAN> <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #666666">"item count: {0}"</SPAN>,=20
          n<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">ToString</SPAN><SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
       Item<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">DestroyItem</SPAN> <SPAN style=3D"COLOR: =
#008000">(</SPAN>item<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>This is "type-safe" in that you can't pass arbitrary memory locations =
to the=20
static Item functions, you must pass a pointer to an Item structure. =
This isn't=20
a strict amount of type safety, but it is likely to minimize accidental =
memory=20
corruption. It's biggest problem is that it uses "unsafe" code, and thus =
may not=20
be usable from other .NET languages, such as Visual Basic .NET and =
JavaScript.=20
</P>
<P>The CLS compliant version uses System.IntPtr to refer to unmanaged =
memory.=20
This is similar to what the <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.Marshal"=20
rel=3Dnofollow>Marshal</A> class does to interoperate with unmanaged =
memory. </P><PRE style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">class</SPAN> Item <SPAN =
style=3D"COLOR: #008000">{</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"library"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">bool</SPAN>=20
       CreateItem <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">out</SPAN> <SPAN =
style=3D"COLOR: #000000">System</SPAN><SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">IntPtr</SPAN> item<SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"library"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> DestroyItem =
<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#000000">System</SPAN><SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">IntPtr</SPAN> item<SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"library"</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> GetInfo <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#000000">System</SPAN><SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">IntPtr</SPAN> item<SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">class</SPAN> =
ExampleUsage <SPAN style=3D"COLOR: #008000">{</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">unsafe</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> Main <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN>
    <SPAN style=3D"COLOR: #008000">{</SPAN>
       <SPAN style=3D"COLOR: #000000">System</SPAN><SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">IntPtr</SPAN> item <SPAN =
style=3D"COLOR: #008000">=3D</SPAN> <SPAN style=3D"COLOR: #0600ff; =
FONT-WEIGHT: bold">null</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
       Item<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">CreateItem</SPAN> <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">out</SPAN> item<SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
       <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">int</SPAN> n =
<SPAN style=3D"COLOR: #008000">=3D</SPAN> Item<SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">GetInfo</SPAN> <SPAN =
style=3D"COLOR: #008000">(</SPAN>item<SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
       <SPAN style=3D"COLOR: #000000">System</SPAN><SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">Console</SPAN><SPAN =
style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">WriteLine</SPAN> <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #666666">"item count: {0}"</SPAN>,=20
          n<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">ToString</SPAN><SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
       Item<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">DestroyItem</SPAN> <SPAN style=3D"COLOR: =
#008000">(</SPAN>item<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>This is "unsafe" in that it is easier to accidentally mis-use =
pointers. For=20
example, if you're using two different libraries and wrapping them using =

System.IntPtr, it is possible to pass an object allocated from one =
library to a=20
function exported by the other library, and the CLI Runtime will not =
catch this=20
error, while the "unsafe" C# code would catch this error. </P>
<P>However, this isn't normally considered a problem, as most managed =
code=20
shouldn't interact with P/Invoke code, but should instead interact with =
managed=20
wrappers for the unmanaged code, which can provide a more natural =
interface to=20
managed clients. </P>
<H2><SPAN id=3DGC-Safe_P.2FInvoke_code class=3Dmw-headline>GC-Safe =
P/Invoke code=20
</SPAN></H2>
<P>There's one problem with the wrapper code described above: a =
race-condition=20
between user code and the runtime Garbage Collector (GC). </P>
<P>The GC that .NET uses is not conservative. It knows all types =
involved, and=20
can distinguish between an integer that looks like a pointer and an =
actual=20
pointer value. It knows all stack-allocated variables, and what the =
scope of=20
those variables is. Finally, the GC does not see into unmanaged code. =
</P>
<P>The result of this is that it's possible the the GC to collect a =
class=20
instance <I>while a method of the instance is still executing </I>. </P>
<P>How is this possible? If the method no longer references class data =
(instance=20
members), and no other code refers to it, the GC may collect the class. =
After=20
all, if no instance members are used and no one is using the instance, =
what's it=20
matter if the instance is collected? </P>
<P>It matters a lot if unmanaged code thinks that the instance is still =
alive.=20
Or, if the class has a finalizer, which could be executed while native =
code is=20
executing from within the native method. </P>
<P>Here is an example adapted from Chris Brumme's blog: </P><PRE =
style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN style=3D"COLOR: =
#6666cc; FONT-WEIGHT: bold">class</SPAN> C <SPAN style=3D"COLOR: =
#008000">{</SPAN>
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// handle into =
unmanaged memory, for an unmanaged object</SPAN>
    IntPtr _handle<SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// performs some =
operation on h</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"..."</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> OperateOnHandle =
<SPAN style=3D"COLOR: #008000">(</SPAN>IntPtr h<SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// frees =
resources of h</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"..."</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> DeleteHandle =
<SPAN style=3D"COLOR: #008000">(</SPAN>IntPtr h<SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    ~C<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN>
    <SPAN style=3D"COLOR: #008000">{</SPAN>
       DeleteHandle<SPAN style=3D"COLOR: #008000">(</SPAN>h<SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> m<SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN>
    <SPAN style=3D"COLOR: #008000">{</SPAN>
       OperateOnHandle<SPAN style=3D"COLOR: =
#008000">(</SPAN>_handle<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
       <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// no further =
references to _handle</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">class</SPAN> Other
 <SPAN style=3D"COLOR: #008000">{</SPAN>
    <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> =
work<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN>
    <SPAN style=3D"COLOR: #008000">{</SPAN>
       C c <SPAN style=3D"COLOR: #008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> C<SPAN style=3D"COLOR: =
#008000">(</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
       c<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">m</SPAN><SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
       <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// no further =
references to c.  </SPAN>
       <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// c is now =
eligable for collection.</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>Consider this: <TT>Other.work </TT>invokes <TT>C.m </TT>, which =
invokes the=20
unmanaged code <TT>C.OperateOnHandle </TT>. Note that <TT>Other.work=20
</TT>doesn't use <TT>c </TT>anymore, so <TT>c </TT>is eligible to be =
collected,=20
and is placed on the GC finalization queue. </P>
<P>This would normally be reasonable, except for the interplay with =
unmanaged=20
code. The unmanaged code <TT>C.OperateOnHandle </TT>is still using a =
member held=20
by the instance <TT>c </TT>, but the GC doesn't -- and <I>can't </I>-- =
know=20
this. </P>
<P>This introduces the possibility that, although unlikely, =
<TT>C.DeleteHandle=20
</TT>will be invoked (from the GC finalization thread) <I>while=20
</I><TT>C.OperateOnHandle </TT>is still operating. </P>
<P>It's fair to assume that the unmanaged code won't appreciate this. =
It's fair=20
to assume that this could cause major problems for the process, =
including a=20
segmentation fault. </P>
<P>In fact, a bug very similar to this exists in .NET v1.0, in one of =
the=20
Registry wrapper classes. </P>
<P>How do you avoid this problem? Don't use raw IntPtrs. With the IntPtr =
being=20
used, the GC has no way of knowing that the class still needs to hang =
around. To=20
avoid the bug, we avoid IntPtrs. </P>
<P>Instead of using IntPtr, we use <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.HandleRef"=20
rel=3Dnofollow>HandleRef</A> . This is a structure which holds both a =
reference to=20
the containing class, as well as the pointer value. </P>
<P>Next, instead of having the P/Invoke code accept IntPtr parameters, =
the=20
P/Invoke code accepts HandleRefs. HandleRefs are special to the runtime =
and GC=20
system, and during a marshal operation they "collapse" into an IntPtr. =
</P>
<P>This allows us to write the safe code: </P><PRE style=3D"FONT-FAMILY: =
monospace" class=3Dcsharp> <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: =
bold">class</SPAN> C <SPAN style=3D"COLOR: #008000">{</SPAN>
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// handle into =
unmanaged memory, for an unmanaged object</SPAN>
    HandleRef _handle<SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// performs some =
operation on h</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"..."</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> OperateOnHandle =
<SPAN style=3D"COLOR: #008000">(</SPAN>HandleRef h<SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// frees =
resources of h</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"..."</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> DeleteHandle =
<SPAN style=3D"COLOR: #008000">(</SPAN>HandleRef h<SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// Creates =
Resource</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"..."</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> IntPtr =
CreateHandle <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
C<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN>
    <SPAN style=3D"COLOR: #008000">{</SPAN>
       IntPtr h <SPAN style=3D"COLOR: #008000">=3D</SPAN> =
CreateHandle<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
       _handle <SPAN style=3D"COLOR: #008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> HandleRef<SPAN style=3D"COLOR: =
#008000">(</SPAN><SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">this</SPAN>, h<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
    ~C<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN>
    <SPAN style=3D"COLOR: #008000">{</SPAN>
       DeleteHandle<SPAN style=3D"COLOR: #008000">(</SPAN>h<SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> m <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN>
    <SPAN style=3D"COLOR: #008000">{</SPAN>
       OperateOnHandle<SPAN style=3D"COLOR: =
#008000">(</SPAN>_handle<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
       <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// no further =
references to _handle</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">class</SPAN> Other
 <SPAN style=3D"COLOR: #008000">{</SPAN>
    <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> work =
<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN>
    <SPAN style=3D"COLOR: #008000">{</SPAN>
       <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// Note: no =
change to client</SPAN>
       C c <SPAN style=3D"COLOR: #008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> C<SPAN style=3D"COLOR: =
#008000">(</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
       c<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">m</SPAN><SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>See also: <A class=3D"external text"=20
href=3D"http://blogs.msdn.com/cbrumme/archive/2003/04/19/51365.aspx"=20
rel=3Dnofollow>Chris Brumme's Blog: Lifetime, GC.KeepAlive, handle =
recycling</A>=20
</P>
<H3><SPAN id=3D.NET_2.0_and_SafeHandles class=3Dmw-headline>.NET 2.0 and =
SafeHandles=20
</SPAN></H3>
<P>In .NET 2.0, a new mechanism for wrapping unmanaged handles was =
introduced.=20
This new mechanism is exposed by the <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Runtime.Inte=
ropServices.SafeHandle"=20
rel=3Dnofollow>SafeHandle</A> class. SafeHandles encapsulate a handle in =
the form=20
of an IntPtr, but by exposing it as a subclass of the SafeHandle class =
(for=20
example <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3AMicrosoft.Win32.Saf=
eFileHandle"=20
rel=3Dnofollow>SafeFileHandle</A> or <A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3AMicrosoft.Win32.Saf=
eWaitHandle"=20
rel=3Dnofollow>SafeWaitHandle</A>) developers gain type safety. </P>
<P>SafeHandles in addition provide a mechanism to avoid inadvertent =
handle=20
recycling (for references <A class=3D"external autonumber"=20
href=3D"http://blogs.msdn.com/cbrumme/archive/2004/02/20/77460.aspx"=20
rel=3Dnofollow>[1]</A> <A class=3D"external autonumber"=20
href=3D"http://blogs.msdn.com/bclteam/archive/2005/03/15/396335.aspx"=20
rel=3Dnofollow>[2]</A>). </P>
<P>The runtime treats SafeHandles specially and will automatically =
provide=20
marshalling of these when used in P/Invoke calls. The behavior depends =
on its=20
use: </P>
<UL>
  <LI>On outgoing parameters, the SafeHandle's handle is passed. </LI>
  <LI>On return values, a new instance of the concrete SafeHandle class =
is=20
  created, and the handle value is set to the returned IntPtr value. =
</LI>
  <LI>On ref SafeHandles, the outgoing value is ignored (must be zero) =
and the=20
  returned value is turned into a proper SafeHandle. </LI>
  <LI>On structure fields, the SafeHandle's handle is passed. </LI></UL>
<P>For the actual implementation details in Mono, see the <A =
title=3DSafeHandles=20
href=3D"http://www.mono-project.com/SafeHandles">SafeHandles</A> =
document. </P>
<H2><SPAN id=3DProperly_Disposing_of_Resources =
class=3Dmw-headline>Properly=20
Disposing of Resources </SPAN></H2>
<P>When avoiding marshaling, you're referencing unmanaged memory and =
other=20
resources from managed code. This confers a great deal of =
responsibility. It=20
also creates a great deal of concern, as more things can "go wrong" in =
managed=20
code, particularly because of exceptions and related complexity. When =
any=20
function can throw an exception, ensuring that resources are properly =
disposed=20
of can be a tricky matter. </P>
<P>As suggested in the <A=20
href=3D"http://www.mono-project.com/Interop_with_Native_Libraries#GC-Safe=
_P.2FInvoke_code">previous=20
section</A>, a simple way to ensure that resources are eventually =
disposed is to=20
wrap the resource within a class containing a finalizer. The finalizer =
can then=20
free the resource. </P>
<P>There are two problems with that approach, both of which have to do =
with the=20
garbage collector: </P>
<OL>
  <LI>The garbage collector cannot see into unmanaged memory, it only =
deals with=20
  managed memory. Thus, if you have a large amount of memory in =
unmanaged memory=20
  (such as images or video data), all the GC will see is the =
<B>IntPtr</B>(s)=20
  that refer to this data, and not the size of the unmanaged memory =
"held" by=20
  the managed code. Consequently, the GC won't know that a collection =
should be=20
  executed (there won't be any "memory pressure" to cause a collection). =

  <P>This is partially fixed in .NET 2.0 by using the <A =
class=3D"external text"=20
  =
href=3D"http://msdn2.microsoft.com/en-us/library/system.gc.addmemorypress=
ure.aspx"=20
  rel=3Dnofollow>System.GC.AddMemoryPressure(long)</A> method, which can =
be used=20
  to tell the GC how much unmanaged memory a managed object is =
referencing,=20
  which can improve the GC heuristics. However, code needs to be =
modified to=20
  support this approach and does not work with .NET 1.1 code.</P></LI>
  <LI>The .NET garbage collector does not execute an object's finalizer =
when the=20
  object is collected. Instead, the object is promoted a generation, and =
the=20
  object's finalizer is executed the next time that generation is =
collected.=20
  <P>For example, if a Generation 0 object with a finalizer is eligible =
for=20
  collection (i.e. no objects reference it), the object is promoted a=20
  generation, and placed on the Generation 1 finalization queue. The =
next time=20
  Generation 1 is collected, the object's finalizer will be=20
executed.</P></LI></OL>
<P>Problem 2 is a real killer, as collection frequency is inversely =
proportional=20
to the generation number. Generation 0 is (typically) collected 10 times =
as=20
frequently as Generation 1, which in turn is collected 10 times as =
frequently as=20
Generation 2. Generation 2 is intended to be <I>rarely </I>collected, as =
these=20
should be long-term objects that persist through the life of the =
application.=20
</P>
<P>Given that the soonest a finalizer is collected is after two =
collections, one=20
for Generation 0 and one for Generation 1 (which occurs after ~10 =
Generation 0=20
collections), it can be a <I>long time</I> before a finalizer is =
executed.=20
Relying on finalizers for resource disposal and collection is a <I>BAD =
IDEA</I>,=20
even before considering that finalizers are not guaranteed to be =
executed,=20
especially at program shutdown. </P>
<P>Fortunately, there is a simple pattern used throughout the .NET Class =

Libraries to help ensure that resources are disposed of quickly: </P>
<UL>
  <LI>Implement the <A class=3D"external text"=20
  =
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.IDisposable"=
=20
  rel=3Dnofollow>System.IDisposable</A> interface. </LI>
  <LI>Call <A class=3D"external text"=20
  =
href=3D"http://docs.go-mono.com/index.aspx?link=3DM%3ASystem.IDisposable.=
Dispose"=20
  rel=3Dnofollow>Dispose</A> when finished with the resource. The =
implementation=20
  for <B>Dispose</B> does two things:=20
  <OL>
    <LI>dispose of the resource, and </LI>
    <LI>call <A class=3D"external text"=20
    =
href=3D"http://docs.go-mono.com/index.aspx?link=3DM%3ASystem.GC.SuppressF=
inalize"=20
    rel=3Dnofollow>GC.SuppressFinalize</A> . </LI></OL></LI></UL>
<P><B>SuppressFinalize</B> informs the GC that the object's finalizer =
doesn't=20
need to be invoked, allowing the object to be freed during the first =
collection,=20
and not after a considerable delay. A sample implementation is: </P><PRE =
style=3D"FONT-FAMILY: monospace" class=3Dcsharp> <SPAN =
style=3D"FONT-STYLE: italic; COLOR: #008080">// for IntPtr, =
IDisposable</SPAN>
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">using</SPAN> <SPAN =
style=3D"COLOR: #008080">System</SPAN><SPAN style=3D"COLOR: =
#008000">;</SPAN>
&nbsp;
 <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// for HandleRef, =
DllImport</SPAN>
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">using</SPAN> <SPAN =
style=3D"COLOR: #008080">System.Runtime.InteropServices</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
&nbsp;
 <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">sealed</SPAN> <SPAN =
style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">class</SPAN> =
UnmanagedResource <SPAN style=3D"COLOR: #008000">:</SPAN> IDisposable
 <SPAN style=3D"COLOR: #008000">{</SPAN>
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"..."</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">private</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN> IntPtr =
CreateResource <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"COLOR: #008000">[</SPAN>DllImport <SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#666666">"..."</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">]</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">private</SPAN> =
<SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">static</SPAN> <SPAN =
style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">extern</SPAN>=20
       <SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> =
DeleteResource <SPAN style=3D"COLOR: #008000">(</SPAN>HandleRef =
handle<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: =
#008000">;</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// Use a =
HandleRef to avoid race conditions; </SPAN>
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// see the =
GC-Safe P/Invoke Code section</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">private</SPAN> =
HandleRef _handle<SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
UnmanagedResource <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN>
    <SPAN style=3D"COLOR: #008000">{</SPAN>
       IntPtr h <SPAN style=3D"COLOR: #008000">=3D</SPAN> CreateResource =
<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
       _handle <SPAN style=3D"COLOR: #008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> HandleRef <SPAN style=3D"COLOR: =
#008000">(</SPAN><SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">this</SPAN>, h<SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// Provide access =
to 3rd party code</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
HandleRef Handle <SPAN style=3D"COLOR: #008000">{</SPAN>
       get <SPAN style=3D"COLOR: #008000">{</SPAN><SPAN style=3D"COLOR: =
#0600ff; FONT-WEIGHT: bold">return</SPAN> _handle<SPAN style=3D"COLOR: =
#008000">;</SPAN><SPAN style=3D"COLOR: #008000">}</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// Dispose of the =
resource</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">public</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> Dispose =
<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN>
    <SPAN style=3D"COLOR: #008000">{</SPAN>
       Cleanup <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
       <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// Prevent the =
object from being placed on the </SPAN>
       <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// =
finalization queue</SPAN>
       <SPAN style=3D"COLOR: #000000">System</SPAN><SPAN style=3D"COLOR: =
#008000">.</SPAN><SPAN style=3D"COLOR: #0000ff">GC</SPAN><SPAN =
style=3D"COLOR: #008000">.</SPAN><SPAN style=3D"COLOR: =
#0000ff">SuppressFinalize</SPAN> <SPAN style=3D"COLOR: =
#008000">(</SPAN><SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">this</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN><SPAN =
style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// Finalizer =
provided in case Dispose isn't called.</SPAN>
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// This is a =
fallback mechanism, but shouldn't be </SPAN>
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// relied upon =
(see previous discussion).</SPAN>
    ~UnmanagedResource <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN>
    <SPAN style=3D"COLOR: #008000">{</SPAN>
       Cleanup <SPAN style=3D"COLOR: #008000">(</SPAN><SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
&nbsp;
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// Really dispose =
of the resource</SPAN>
    <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: bold">private</SPAN> =
<SPAN style=3D"COLOR: #6666cc; FONT-WEIGHT: bold">void</SPAN> Cleanup =
<SPAN style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN>
    <SPAN style=3D"COLOR: #008000">{</SPAN>
       DeleteResource <SPAN style=3D"COLOR: #008000">(</SPAN>Handle<SPAN =
style=3D"COLOR: #008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
&nbsp;
       <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// Don't =
permit the handle to be used again.</SPAN>
       _handle <SPAN style=3D"COLOR: #008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> HandleRef <SPAN style=3D"COLOR: =
#008000">(</SPAN><SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">this</SPAN>, IntPtr<SPAN style=3D"COLOR: #008000">.</SPAN><SPAN =
style=3D"COLOR: #0000ff">Zero</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">;</SPAN>
    <SPAN style=3D"COLOR: #008000">}</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>Frequently <B>IDisposable</B> examples will provide a virtual=20
<TT>Dispose(bool)</TT> method, which both <B>Dispose</B> and the =
finalizer=20
delegate to, as opposed to the <TT>Cleanup()</TT> method used above. =
However,=20
providing both a a virtual function and a non-<TT>sealed</TT> class is=20
advertising the ability/desire to subclass, which is a potentially bad =
idea.=20
</P>
<P>It's a potentially bad idea, again, because of the garbage collector. =
When an=20
object is promoted a GC generation, <I>all</I> objects it refers to are=20
<I>also</I> promoted a generation, recursively. So if your finalizable =
object=20
contains an <B>ArrayList</B> of other objects, both the =
<B>ArrayList</B>, all=20
objects it contains, and all objects <I>those</I> objects reference=20
(recursively) will be promoted. This can be a potentially large amount =
of=20
managed memory which is promoted a generation. </P>
<P>Given the GC promotion rules, it is highly recommended that =
finalizable=20
classes be "leaf" nodes; that is, objects that don't refer to other =
objects=20
within the managed memory "tree". For this reason, it is highly =
suggested that=20
finalizable objects be sealed to prevent subclassing, to minimize the =
number of=20
managed objects that the finalizable object refers to. Rico Mariani =
discusses=20
this in "Almost-rule #2: Never have finalizers". </P>
<P>Implementing the <B>IDisposable</B> interface isn't a complete =
solution, as=20
it requires that users remember to invoke the <B>Dispose</B> method. The =
C#=20
<I>using</I> block can be used to ensure that <B>Dispose</B> is invoked =
at the=20
end of the block: </P><PRE style=3D"FONT-FAMILY: monospace" =
class=3Dcsharp> <SPAN style=3D"COLOR: #0600ff; FONT-WEIGHT: =
bold">using</SPAN> <SPAN style=3D"COLOR: =
#008000">(</SPAN>UnmanagedResource ur <SPAN style=3D"COLOR: =
#008000">=3D</SPAN> <A =
href=3D"http://www.google.com/search?q=3Dnew+msdn.microsoft.com"><SPAN =
style=3D"COLOR: #008000">new</SPAN></A> UnmanagedResource<SPAN =
style=3D"COLOR: #008000">(</SPAN><SPAN style=3D"COLOR: =
#008000">)</SPAN><SPAN style=3D"COLOR: #008000">)</SPAN> <SPAN =
style=3D"COLOR: #008000">{</SPAN>
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// Use the =
unmanaged resource.  It will be automatically</SPAN>
    <SPAN style=3D"FONT-STYLE: italic; COLOR: #008080">// disposed of at =
the end of this block.</SPAN>
 <SPAN style=3D"COLOR: #008000">}</SPAN></PRE>
<P>See also: </P>
<UL>
  <LI><A class=3D"external text"=20
  href=3D"http://blogs.msdn.com/ricom/archive/2003/12/02/40780.aspx"=20
  rel=3Dnofollow>Rico Mariani's Blog: Two things to avoid for better =
memory=20
  usage</A>. </LI></UL>
<H1><SPAN id=3DMiscellaneous_Topics class=3Dmw-headline>Miscellaneous =
Topics=20
</SPAN></H1>
<P>Topics that didn't seem to fit in anywhere else, but might be useful. =
</P>
<H2><SPAN id=3DMeaning_of_.22Unsafe.22 class=3Dmw-headline>Meaning of =
"Unsafe"=20
</SPAN></H2>
<P>A "problem" is that "unsafe" is an overloaded term. It can refer to =
the use=20
of the "unsafe" C# keyword, and it can be used as "anything that isn't =
safe",=20
which may not require the "unsafe" keyword. </P>
<P>So, "unsafe" can mean (a) C# keyword; (b) violates .NET type system =
(similar=20
to (a)); (c) may be insecure (reading files from a web client); (d) =
capable of=20
causing a segfault. There are likely other meanings people can dream up =
as well.=20
Note that (d) doesn't imply (b), as far as .NET is concerned. The =
runtime could=20
itself have a bug that generates a segfault, but this doesn't violate =
the type=20
system. </P>
<P>IntPtr doesn't require a violation of the type system, as you can't =
get the=20
address of a .NET object (unless you "pin" it, which would require the=20
appropriate Security rights), and is thus principally useful for =
interacting=20
with unmanaged code, which exists outside of the .NET type system. </P>
<P>Surely, this is pure semantics, but I can see the designers =
perspective. </P>
<H2><SPAN id=3DSecurity class=3Dmw-headline>Security </SPAN></H2>
<P>.NET has a highly flexible security system. You can't invoke =
DllImported=20
functions unless your app has the appropriate security rights -- =
generally, that=20
the app is running on the local machine. If you're running it from a =
network=20
share, or from a web site (similar to Java Applets), then your app will =
get a=20
SecurityException. </P>
<P>You can get lots of security exceptions for various things, actually. =
Opening=20
files can generate a security exception, for example. </P>
<P><A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DT%3ASystem.Security.Per=
missions.SecurityPermission"=20
rel=3Dnofollow>System.Security.Permissions.SecurityPermission</A> is =
needed with=20
<A class=3D"external text"=20
href=3D"http://docs.go-mono.com/index.aspx?link=3DF%3ASystem.Security.Per=
missions.SecurityPermissionFlag.UnmanagedCode"=20
rel=3Dnofollow>SecurityPermissionFlag.UnmanagedCode</A> specified in =
order to=20
perform a P/Invoke. </P>
<P>Programs can't specify this permission; they can only request it (or =
demand=20
it, and if they can't get it, a SecurityException is thrown). </P>
<P>Administrators are the people who specify what permissions an =
application=20
actually receives. </P>
<P>That's about the limits of my knowledge -- Security isn't my forte. =
You might=20
find the following topics interesting. </P>
<UL>
  <LI><A class=3D"external text"=20
  =
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/cpguide/html/cpconrequestingpermissions.asp"=20
  rel=3Dnofollow>Requesting Permissions at MSDN</A> </LI>
  <LI><A class=3D"external text"=20
  =
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/cpguide/html/cpconsecuritysyntax.asp"=20
  rel=3Dnofollow>Security Syntax at MSDN</A> </LI>
  <LI><A class=3D"external text"=20
  =
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/cpguide/html/cpconcodeaccesssecurity.asp"=20
  rel=3Dnofollow>Code Access Security at MSDN</A> </LI>
  <LI><A class=3D"external text"=20
  =
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/cpguide/html/cpconinheritancedemands.asp"=20
  rel=3Dnofollow>Inheritance Demands at MSDN</A> </LI></UL>
<P>See also: <A class=3D"external text"=20
href=3D"http://msdn.microsoft.com/library/default.asp?url=3D/library/en-u=
s/csspec/html/vclrfcsharpspec_A_2.asp"=20
rel=3Dnofollow>Unsafe Code at MSDN</A> </P>
<H1><SPAN id=3DTroubleshooting class=3Dmw-headline>Troubleshooting =
</SPAN></H1>
<P>In Unix, sometimes P/Invoking a library can fail due to a number of =
reasons:=20
</P>
<UL>
  <LI>The Library being P/Invoked not being in the LD_LIBRARY_PATH </LI>
  <LI>The Library being P/Invoked has a different name </LI>
  <LI>The library being P/Invoked has different casing (MONO_IOMAP does =
not=20
  apply here) </LI>
  <LI>The library could depend on symbols from another library that has =
not been=20
  loaded. </LI></UL>
<P>To identify the source of the problem if you get an error in your =
P/Invoke=20
run Mono like this: </P><PRE style=3D"FONT-FAMILY: monospace" =
class=3Dbash><SPAN style=3D"COLOR: #666666">bash$ </SPAN><SPAN =
style=3D"COLOR: #007800">MONO_LOG_LEVEL</SPAN>=3D<SPAN style=3D"COLOR: =
#ff0000">"debug"</SPAN> <SPAN style=3D"COLOR: =
#007800">MONO_LOG_MASK</SPAN>=3D<SPAN style=3D"COLOR: =
#ff0000">"dll"</SPAN> mono glue.exe</PRE>
<H1><SPAN id=3DCommentary class=3Dmw-headline>Commentary </SPAN></H1>
<P>Interesting commentary that doesn't really belong elsewhere, but is =
still=20
good to know. </P>
<H2><SPAN id=3DP.2FInvoke_Specification class=3Dmw-headline>P/Invoke =
Specification=20
</SPAN></H2>
<P>From Paolo Molaro: </P>
<DL>
  <DD>Yes, the P/Invoke specification (or lack thereof) is a mess. It =
was done=20
  by people that didn't [think] through the portability issues and this =
is=20
  probably one of the reasons the MS CLR is not really supported on =
9x-based=20
  platforms. Note: P/Invoke is intrinsically non-portable, the main =
issue is=20
  that P/Invoke is poorly defined in a non-win32 system. Think of =
Charset: they=20
  allow Ansi and Unicode (with Auto meaning one or the other according =
to the=20
  platform), but the world uses also other encodings. At the very least =
they=20
  should have added a Charset.Encoding or something, with the actual =
encoding=20
  specified separately as a string, for example (good luck, though, =
finding a=20
  UCS4 encoding implementation in the base assemblies...). </DD></DL>
<H1><SPAN id=3DThanks class=3Dmw-headline>Thanks </SPAN></H1>
<P>Portions of this document were generated as a result of a mono-list=20
discussion between Jonathan Pryor and David Jeske. See: <A =
class=3D"external free"=20
href=3D"http://lists.ximian.com/archives/public/mono-list/2003-July/01488=
6.html"=20
rel=3Dnofollow>http://lists.ximian.com/archives/public/mono-list/2003-Jul=
y/014886.html</A>=20
. </P>
<P>Thanks also to Paolo Molaro, Bernie Solomon, and Marcus for reviews =
and=20
comments. </P>
<H1><SPAN id=3DCopyright class=3Dmw-headline>Copyright </SPAN></H1>
<P>To the greatest extent possible, this document is dedicated to the =
Public=20
Domain. Please properly document <A class=3D"external text"=20
href=3D"mailto:jonpryor@vt.edu" rel=3Dnofollow>Jonathan Pryor</A> as the =
original=20
author (you don't go quoting Mark Twain without mentioning him even =
though his=20
works are all Public Domain), but I fully expect that this document can =
(and=20
will) be massaged for other mediums. </P>
<P>Note that some portions of this document are quotations from others; =
the=20
original author is mentioned when quotations are made. </P>
<H1><SPAN id=3DRevision_History class=3Dmw-headline>Revision History =
</SPAN></H1>
<DL>
  <DT>August 15, 2005</DT>
  <DD>Added char** marshalling tutorial </DD></DL>
<DL>
  <DT>April 12, 2005&nbsp;</DT>
  <DD>Moved into the wiki. </DD></DL>
<DL>
  <DT>February 3, 2005 &nbsp;</DT>
  <DD>Revised navigation menu to show 1st and 2nd level links. =
Documented Mono's=20
  __Internal library name extension for importing symbols from within =
the=20
  loading program. Added Marshaling Arrays section, which clarifies =
array=20
  marshaling issues and includes the David Jesk commentary (which =
shouldn't have=20
  been in the "Avoiding Marshaling" section anyway). Added boolean =
marshaling=20
  information. Added Marshaling Embedded Strings information. Minor =
corrections,=20
  additional links to blogs and articles. </DD></DL>
<DL>
  <DT>June 14, 2004 &nbsp;</DT>
  <DD>Added Properly Disposing of Resources section; changed title to =
clarify=20
  document's intent. </DD></DL>
<DL>
  <DT>June 6, 2004&nbsp;</DT>
  <DD>Mono properly frees the memory of class-typed return values now. =
Remove=20
  comment stating otherwise. (miguel) </DD></DL>
<DL>
  <DT>May 15, 2004&nbsp;</DT>
  <DD>Added Exception Propogation section, updated Mono's .config file =
handling;=20
  spelling correction: s/marshalling/marshaling/g (this matches MSDN =
spelling=20
  conventions). </DD></DL>
<DL>
  <DT>March 20, 2004&nbsp;</DT>
  <DD>Added Memory Boundaries section based on suggestions from Marcus;=20
  formatting changes. </DD></DL>
<DL>
  <DT>August-October 2003 &nbsp;</DT>
  <DD>Initial Version. </DD></DL><!-- =0A=
NewPP limit report=0A=
Preprocessor node count: 607/1000000=0A=
Post-expand include size: 0/2097152 bytes=0A=
Template argument size: 0/2097152 bytes=0A=
Expensive parser function count: 0/100=0A=
--><!-- Saved in parser cache with key =
monoframework_mediawiki:pcache:idhash:1028-0!*!0!!en!*!edit=3D0 and =
timestamp 20121120095510 -->
<DIV=20
class=3Dprintfooter></DIV><!-- END MAIN CONTENT =
--></DIV><!--#content--></DIV><!--#wrapper--></DIV><!--#page-->
<DIV id=3Dfooter-hr></DIV>
<DIV id=3Dfooter>
<UL id=3Dfooter-menu>
  <LI><A href=3D"http://xamarin.com/">Xamarin</A>=20
  <UL>
    <LI style=3D"MARGIN-TOP: 15px"><A=20
    href=3D"http://creativecommons.org/licenses/by-sa/3.0/us/" =
rel=3Dlicense>
    <DIV id=3Dby-sa></DIV></A></LI>
    <LI><A href=3D"http://creativecommons.org/licenses/by-nc-nd/3.0/us/" =

    rel=3Dlicense>
    <DIV id=3Dby-nc-nd></DIV></A></LI>
    <LI><A href=3D"http://www.mono-project.com/Legal">Legal =
Notices</A></LI>
    <LI><A title=3DSpecial:UserLogin=20
    href=3D"http://www.mono-project.com/Special:UserLogin">Editor =
Login</A>=20
  </LI></UL></LI>
  <LI>Mono=20
  <UL>
    <LI><A href=3D"http://www.mono-project.com/About">About</A></LI>
    <LI><A href=3D"http://www.mono-project.com/Roadmap">Roadmap</A></LI>
    <LI><A =
href=3D"http://www.mono-project.com/Plans">Technologies</A></LI>
    <LI><A =
href=3D"http://www.mono-project.com/Screenshots">Screenshots</A></LI>
    <LI><A =
href=3D"http://www.mono-project.com/FAQ:_General">FAQ</A></LI>
    <LI><A =
href=3D"http://www.mono-project.com/Contact">Contact</A></LI></UL></LI>
  <LI>Download=20
  <UL>
    <LI><A =
href=3D"http://www.go-mono.com/mono-downloads/download.html">Latest=20
    Release</A></LI>
    <LI><A href=3D"http://mono.ximian.com/daily/">Daily =
Snapshots</A></LI>
    <LI><A href=3D"http://www.mono-project.com/OldReleases">Previous=20
    Releases</A></LI>
    <LI><A href=3D"http://monodevelop.com/Download">MonoDevelop</A></LI>
    <LI><A href=3D"http://www.mono-project.com/MoMA">Mono Migration=20
    Analyzer</A></LI>
    <LI><A href=3D"http://www.go-mono.com/moonlight/">Moonlight</A></LI>
    <LI><A href=3D"http://xamarin.com/trial">MonoTouch</A></LI>
    <LI><A href=3D"http://xamarin.com/trial">Mono for =
Android</A></LI></UL></LI>
  <LI>Documentation=20
  <UL>
    <LI><A href=3D"http://www.mono-project.com/Start">Getting =
Started</A></LI>
    <LI><A href=3D"http://www.go-mono.com/docs/">API Reference</A></LI>
    <LI><A =
href=3D"http://www.mono-project.com/Articles">Articles</A></LI></UL></LI>=

  <LI>Community=20
  <UL>
    <LI><A href=3D"http://www.mono-project.com/Mailing_Lists">Mailing=20
    Lists</A></LI>
    <LI><A href=3D"http://www.go-mono.com/forums">Forums</A></LI>
    <LI><A class=3Dexternal=20
    href=3D"http://www.mono-project.com/IRC">Chat/IRC</A></LI>
    <LI><A =
href=3D"http://www.go-mono.com/monologue">Blogs</A></LI></UL></LI>
  <LI>Contribute=20
  <UL>
    <LI><A =
href=3D"http://www.mono-project.com/Contributing">Contributing=20
    Guide</A></LI>
    <LI><A href=3D"http://www.mono-project.com/Bugs">Report =
Bugs</A></LI>
    <LI><A href=3D"http://www.mono-project.com/SVN">Source =
Code</A></LI><!--<li><a =
href=3D"http://wrench.mono-project.com/builds">Build Status</a></li>-->
    <LI><A href=3D"http://go-mono.com/status/">Class =
Status</A></LI></UL></LI></UL>
<DIV style=3D"CLEAR: both"></DIV></DIV>
<SCRIPT type=3Dtext/javascript>=0A=
            /* <![CDATA[ */=0A=
            var google_conversion_id =3D 1015730972;=0A=
            var google_conversion_language =3D "en";=0A=
            var google_conversion_format =3D "3";=0A=
            var google_conversion_color =3D "ffffff";=0A=
            var google_conversion_label =3D "j0fWCOywugIQnKar5AM";=0A=
            var google_conversion_value =3D 0;=0A=
            /* ]]> */=0A=
        </SCRIPT>

<SCRIPT type=3Dtext/javascript=20
src=3D"http://www.googleadservices.com/pagead/conversion.js"></SCRIPT>
<NOSCRIPT>
<DIV style=3D"DISPLAY: inline"><IMG=20
style=3D"BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; =
BORDER-TOP-STYLE: none; BORDER-LEFT-STYLE: none"=20
alt=3D""=20
src=3D"http://www.googleadservices.com/pagead/conversion/1015730972/?labe=
l=3Dj0fWCOywugIQnKar5AM&amp;guid=3DON&amp;script=3D0"=20
width=3D1 height=3D1> </DIV></NOSCRIPT></BODY></HTML>

------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: application/octet-stream
Content-Transfer-Encoding: base64
Content-Location: http://www.googleadservices.com/pagead/conversion/1015730972/?label=j0fWCOywugIQnKar5AM&guid=ON&script=0

R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7

------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: text/css;
	charset="koi8-r"
Content-Transfer-Encoding: quoted-printable
Content-Location: http://www.mono-project.com/skins/common/commonPrint.css

A.stub {
	COLOR: #ba0000; TEXT-DECORATION: none
}
A.new {
	COLOR: #ba0000; TEXT-DECORATION: none
}
#toc {
	BORDER-BOTTOM: #aaaaaa 1px solid; BORDER-LEFT: #aaaaaa 1px solid; =
PADDING-BOTTOM: 5px; BACKGROUND-COLOR: #f9f9f9; PADDING-LEFT: 5px; =
PADDING-RIGHT: 5px; BORDER-TOP: #aaaaaa 1px solid; BORDER-RIGHT: #aaaaaa =
1px solid; PADDING-TOP: 5px
}
.tocindent {
	MARGIN-LEFT: 2em
}
.tocline {
	MARGIN-BOTTOM: 0px
}
DIV.floatright {
	POSITION: relative; MARGIN: 0.5em 0px 0.8em 1.4em; FLOAT: right; CLEAR: =
right
}
DIV.floatright P {
	FONT-STYLE: italic
}
DIV.floatleft {
	POSITION: relative; MARGIN: 0.5em 1.4em 0.8em 0px; FLOAT: left; CLEAR: =
left
}
DIV.floatleft P {
	FONT-STYLE: italic
}
DIV.center {
	TEXT-ALIGN: center
}
DIV.thumb {
	BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; BACKGROUND-COLOR: =
transparent; MARGIN-TOP: 0.5em; WIDTH: auto; MARGIN-BOTTOM: 0.8em; =
BORDER-TOP: medium none; BORDER-RIGHT: medium none
}
DIV.thumbinner {
	BORDER-BOTTOM: #cccccc 1px solid; TEXT-ALIGN: center; BORDER-LEFT: =
#cccccc 1px solid; PADDING-BOTTOM: 3px !important; BACKGROUND-COLOR: =
white; PADDING-LEFT: 3px !important; PADDING-RIGHT: 3px !important; =
FONT-SIZE: 94%; OVERFLOW: hidden; BORDER-TOP: #cccccc 1px solid; =
BORDER-RIGHT: #cccccc 1px solid; PADDING-TOP: 3px !important
}
HTML .thumbimage {
	BORDER-BOTTOM: #cccccc 1px solid; BORDER-LEFT: #cccccc 1px solid; =
BORDER-TOP: #cccccc 1px solid; BORDER-RIGHT: #cccccc 1px solid
}
HTML .thumbcaption {
	BORDER-BOTTOM: medium none; TEXT-ALIGN: left; BORDER-LEFT: medium none; =
PADDING-BOTTOM: 3px !important; LINE-HEIGHT: 1.4em; PADDING-LEFT: 3px =
!important; PADDING-RIGHT: 3px !important; FONT-SIZE: 94%; BORDER-TOP: =
medium none; BORDER-RIGHT: medium none; PADDING-TOP: 3px !important
}
DIV.magnify {
	DISPLAY: none
}
DIV.tright {
	MARGIN: 0.5em 0px 0.8em 1.4em; FLOAT: right; CLEAR: right
}
DIV.tleft {
	MARGIN: 0.5em 1.4em 0.8em 0px; FLOAT: left; CLEAR: left
}
IMG.thumbborder {
	BORDER-BOTTOM: #dddddd 1px solid; BORDER-LEFT: #dddddd 1px solid; =
BORDER-TOP: #dddddd 1px solid; BORDER-RIGHT: #dddddd 1px solid
}
TABLE.rimage {
	POSITION: relative; TEXT-ALIGN: center; WIDTH: 1pt; MARGIN-BOTTOM: 1em; =
FLOAT: right; MARGIN-LEFT: 1em
}
BODY {
	PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: =
0px; BACKGROUND: white; COLOR: black; PADDING-TOP: 0px
}
.noprint {
	DISPLAY: none
}
DIV#jump-to-nav {
	DISPLAY: none
}
DIV.top {
	DISPLAY: none
}
DIV#column-one {
	DISPLAY: none
}
#colophon {
	DISPLAY: none
}
.editsection {
	DISPLAY: none
}
.toctoggle {
	DISPLAY: none
}
.tochidden {
	DISPLAY: none
}
DIV#f-poweredbyico {
	DISPLAY: none
}
DIV#f-copyrightico {
	DISPLAY: none
}
LI#viewcount {
	DISPLAY: none
}
LI#about {
	DISPLAY: none
}
LI#disclaimer {
	DISPLAY: none
}
LI#privacy {
	DISPLAY: none
}
#footer-places {
	DISPLAY: none
}
#mw-hidden-catlinks {
	DISPLAY: none
}
UL {
	LIST-STYLE-TYPE: square
}
#content {
	BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; PADDING-BOTTOM: =
0px !important; MARGIN: 0px; PADDING-LEFT: 0px !important; =
PADDING-RIGHT: 0px !important; BACKGROUND: none transparent scroll =
repeat 0% 0%; BORDER-TOP: medium none; BORDER-RIGHT: medium none; =
PADDING-TOP: 0px !important
}
#footer {
	BACKGROUND: white; COLOR: black; BORDER-TOP: black 1px solid
}
H1 {
	FONT-WEIGHT: bold
}
H2 {
	FONT-WEIGHT: bold
}
H3 {
	FONT-WEIGHT: bold
}
H4 {
	FONT-WEIGHT: bold
}
H5 {
	FONT-WEIGHT: bold
}
H6 {
	FONT-WEIGHT: bold
}
P {
	LINE-HEIGHT: 1.2em; MARGIN: 1em 0px
}
.documentDescription {
	LINE-HEIGHT: 1.2em; MARGIN: 1em 0px
}
.tocindent P {
	MARGIN: 0px
}
PRE {
	BORDER-BOTTOM: black 1pt dashed; BORDER-LEFT: black 1pt dashed; =
PADDING-BOTTOM: 1em; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; WHITE-SPACE: =
pre; BACKGROUND: white; COLOR: black; FONT-SIZE: 8pt; OVERFLOW: auto; =
BORDER-TOP: black 1pt dashed; BORDER-RIGHT: black 1pt dashed; =
PADDING-TOP: 1em
}
TABLE.listing {
	BORDER-BOTTOM: black 1pt solid; BORDER-LEFT: black 1pt solid; =
BORDER-COLLAPSE: collapse; BORDER-TOP: black 1pt solid; BORDER-RIGHT: =
black 1pt solid
}
TABLE.listing TD {
	BORDER-BOTTOM: black 1pt solid; BORDER-LEFT: black 1pt solid; =
BORDER-COLLAPSE: collapse; BORDER-TOP: black 1pt solid; BORDER-RIGHT: =
black 1pt solid
}
A {
	PADDING-BOTTOM: 0px !important; PADDING-LEFT: 0px !important; =
PADDING-RIGHT: 0px !important; BACKGROUND: none transparent scroll =
repeat 0% 0%; COLOR: black !important; PADDING-TOP: 0px !important
}
A:link {
	BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: #520; =
TEXT-DECORATION: underline
}
A:visited {
	BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: #520; =
TEXT-DECORATION: underline
}
#content A.text.external:after {
	CONTENT: " (" attr(href) ") "
}
#content A.autonumber.external:after {
	CONTENT: " (" attr(href) ") "
}
#globalWrapper {
	MIN-WIDTH: 0px !important; WIDTH: 100% !important
}
#content {
	BACKGROUND: white; COLOR: black
}
#column-content {
	MARGIN: 0px
}
#column-content #content {
	PADDING-BOTTOM: 1em; MARGIN: 0px; PADDING-LEFT: 1em; PADDING-RIGHT: =
1em; PADDING-TOP: 1em
}
A {
	COLOR: black !important; TEXT-DECORATION: none !important
}
A.external {
	COLOR: black !important; TEXT-DECORATION: none !important
}
A.new {
	COLOR: black !important; TEXT-DECORATION: none !important
}
A.stub {
	COLOR: black !important; TEXT-DECORATION: none !important
}
A {
	COLOR: inherit !important; TEXT-DECORATION: inherit !important
}
A.external {
	COLOR: inherit !important; TEXT-DECORATION: inherit !important
}
A.new {
	COLOR: inherit !important; TEXT-DECORATION: inherit !important
}
A.stub {
	COLOR: inherit !important; TEXT-DECORATION: inherit !important
}
IMG {
	BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; VERTICAL-ALIGN: =
middle; BORDER-TOP: medium none; BORDER-RIGHT: medium none
}
SPAN.texhtml {
	FONT-FAMILY: serif
}
#siteNotice {
	DISPLAY: none
}
LI.gallerybox {
	BORDER-BOTTOM: white 2px solid; BORDER-LEFT: white 2px solid; =
BACKGROUND-COLOR: #f9f9f9; DISPLAY: inline-block; VERTICAL-ALIGN: top; =
BORDER-TOP: white 2px solid; BORDER-RIGHT: white 2px solid
}
UL.gallery {
	ZOOM: 1
}
LI.gallerybox {
	ZOOM: 1
}
UL.gallery {
	PADDING-BOTTOM: 2px; MARGIN: 2px; PADDING-LEFT: 2px; PADDING-RIGHT: =
2px; DISPLAY: block; PADDING-TOP: 2px
}
LI.gallerycaption {
	TEXT-ALIGN: center; DISPLAY: block; WORD-WRAP: break-word; FONT-WEIGHT: =
bold
}
LI.gallerybox DIV.thumb {
	BORDER-BOTTOM: #ccc 1px solid; TEXT-ALIGN: center; BORDER-LEFT: #ccc =
1px solid; MARGIN: 2px; BORDER-TOP: #ccc 1px solid; BORDER-RIGHT: #ccc =
1px solid
}
DIV.gallerytext {
	PADDING-BOTTOM: 2px; PADDING-LEFT: 4px; PADDING-RIGHT: 4px; WORD-WRAP: =
break-word; FONT-SIZE: 94%; OVERFLOW: hidden; PADDING-TOP: 2px
}
TABLE.diff {
	BACKGROUND: white
}
TD.diff-otitle {
	BACKGROUND: #ffffff
}
TD.diff-ntitle {
	BACKGROUND: #ffffff
}
TD.diff-addedline {
	BORDER-BOTTOM: black 2px solid; BORDER-LEFT: black 2px solid; =
BACKGROUND: #ccffcc; FONT-SIZE: smaller; BORDER-TOP: black 2px solid; =
BORDER-RIGHT: black 2px solid
}
TD.diff-deletedline {
	BORDER-BOTTOM: black 2px dotted; BORDER-LEFT: black 2px dotted; =
BACKGROUND: #ffffaa; FONT-SIZE: smaller; BORDER-TOP: black 2px dotted; =
BORDER-RIGHT: black 2px dotted
}
TD.diff-context {
	BACKGROUND: #eeeeee; FONT-SIZE: smaller
}
.diffchange {
	COLOR: silver; FONT-WEIGHT: bold; TEXT-DECORATION: underline
}
TABLE.wikitable {
	BORDER-BOTTOM: #aaa 1px solid; BORDER-LEFT: #aaa 1px solid; MARGIN: 1em =
1em 1em 0px; BORDER-COLLAPSE: collapse; BACKGROUND: white; BORDER-TOP: =
#aaa 1px solid; BORDER-RIGHT: #aaa 1px solid
}
.wikitable TH {
	BORDER-BOTTOM: #aaa 1px solid; BORDER-LEFT: #aaa 1px solid; =
PADDING-BOTTOM: 0.2em; PADDING-LEFT: 0.2em; PADDING-RIGHT: 0.2em; =
BORDER-TOP: #aaa 1px solid; BORDER-RIGHT: #aaa 1px solid; PADDING-TOP: =
0.2em
}
.wikitable TD {
	BORDER-BOTTOM: #aaa 1px solid; BORDER-LEFT: #aaa 1px solid; =
PADDING-BOTTOM: 0.2em; PADDING-LEFT: 0.2em; PADDING-RIGHT: 0.2em; =
BORDER-TOP: #aaa 1px solid; BORDER-RIGHT: #aaa 1px solid; PADDING-TOP: =
0.2em
}
.wikitable TH {
	TEXT-ALIGN: center; BACKGROUND: white; FONT-WEIGHT: bold
}
.wikitable CAPTION {
	FONT-WEIGHT: bold
}
A.sortheader {
	MARGIN: 0px 0.3em
}
.wikitable {
	PAGE-BREAK-INSIDE: avoid
}
.thumb {
	PAGE-BREAK-INSIDE: avoid
}
IMG {
	PAGE-BREAK-INSIDE: avoid
}
H2 {
	PAGE-BREAK-AFTER: avoid
}
H3 {
	PAGE-BREAK-AFTER: avoid
}
H4 {
	PAGE-BREAK-AFTER: avoid
}
H5 {
	PAGE-BREAK-AFTER: avoid
}
H6 {
	PAGE-BREAK-AFTER: avoid
}
h7 {
	PAGE-BREAK-AFTER: avoid
}
P {
	WIDOWS: 3; ORPHANS: 3
}

------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: text/css;
	charset="koi8-r"
Content-Transfer-Encoding: quoted-printable
Content-Location: http://www.mono-project.com/layout.css

BODY {
	BACKGROUND-COLOR: #fff; MARGIN: 0px
}
IMG {
	BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; BORDER-TOP: =
medium none; BORDER-RIGHT: medium none
}
#page {
	TEXT-ALIGN: left; PADDING-BOTTOM: 0px; MARGIN: 10px auto 0px; =
PADDING-LEFT: 0px; WIDTH: 940px; PADDING-RIGHT: 0px; PADDING-TOP: 0px
}
#header {
	BORDER-BOTTOM: #bbb 2px solid; PADDING-BOTTOM: 0px; PADDING-LEFT: 0px; =
PADDING-RIGHT: 0px; BACKGROUND: url(images/header-shade.png) #fff =
repeat-y right top; PADDING-TOP: 0px
}
#header .wrapper {
	POSITION: relative; MARGIN: 0px auto; WIDTH: 940px; HEIGHT: 90px
}
#header H1 {
	DISPLAY: none
}
#header A IMG {
	BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; MARGIN-TOP: 12px; =
MARGIN-LEFT: 8px; BORDER-TOP: medium none; BORDER-RIGHT: medium none
}
#search {
	POSITION: absolute; MARGIN-TOP: 1em; TOP: 8px; RIGHT: 0px
}
#search INPUT[type=3D'text'] {
	BORDER-BOTTOM: #aaa 1px solid; BORDER-LEFT: #aaa 1px solid; =
PADDING-BOTTOM: 4px; PADDING-LEFT: 23px; WIDTH: 150px; PADDING-RIGHT: =
4px; BACKGROUND: url(images/mp-search-background.png) repeat-x 0px =
-17px; COLOR: #888; FONT-SIZE: 0.85em; VERTICAL-ALIGN: top; BORDER-TOP: =
#aaa 1px solid; BORDER-RIGHT: #aaa 1px solid; PADDING-TOP: 4px; =
-moz-border-radius: 4px; -khtml-border-radius: 4px; =
-webkit-border-radius: 4px; border-radius: 4px
}
#search INPUT.text {
	BORDER-BOTTOM: #aaa 1px solid; BORDER-LEFT: #aaa 1px solid; =
PADDING-BOTTOM: 4px; PADDING-LEFT: 23px; WIDTH: 150px; PADDING-RIGHT: =
4px; BACKGROUND: url(images/mp-search-background.png) repeat-x 0px =
-17px; COLOR: #888; FONT-SIZE: 0.85em; VERTICAL-ALIGN: top; BORDER-TOP: =
#aaa 1px solid; BORDER-RIGHT: #aaa 1px solid; PADDING-TOP: 4px; =
-moz-border-radius: 4px; -khtml-border-radius: 4px; =
-webkit-border-radius: 4px; border-radius: 4px
}
#search INPUT[type=3D'text']:focus {
	COLOR: black
}
#search INPUT.button {
	DISPLAY: none
}
#mono-logo {
	POSITION: absolute; WIDTH: 167px; BACKGROUND: =
url(images/mp-mono-logo.png) no-repeat 0px 0px; HEIGHT: 41px; TOP: 22px; =
LEFT: 10px
}
#by-sa {
	PADDING-BOTTOM: 4px; PADDING-LEFT: 0px; WIDTH: 88px; PADDING-RIGHT: =
0px; BACKGROUND: url(images/88x31_002.png) no-repeat; HEIGHT: 31px; =
PADDING-TOP: 0px
}
#by-nc-nd {
	PADDING-BOTTOM: 4px; PADDING-LEFT: 0px; WIDTH: 88px; PADDING-RIGHT: =
0px; BACKGROUND: url(images/88x31.png) no-repeat; HEIGHT: 31px; =
PADDING-TOP: 0px
}
#footer {
	PADDING-BOTTOM: 30px; MARGIN: 0px; MIN-HEIGHT: 300px; PADDING-LEFT: =
0px; WIDTH: auto; PADDING-RIGHT: 0px; BACKGROUND: =
url(images/mp-bg-footer.png) #d7d7d7 no-repeat center top; CLEAR: both; =
FONT-SIZE: 11px; OVERFLOW: hidden; PADDING-TOP: 30px
}
#footer-hr {
	PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; WIDTH: 100%; =
PADDING-RIGHT: 0px; BACKGROUND: url(images/footer-hr.png) repeat-x =
center bottom; HEIGHT: 20px; PADDING-TOP: 0px
}
#footer TD {
	VERTICAL-ALIGN: middle
}
#footer TD.text {
	PADDING-BOTTOM: 0px; PADDING-LEFT: 15px; PADDING-RIGHT: 15px; =
PADDING-TOP: 0px
}
#footer TD.text P {
	PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: =
0px; PADDING-TOP: 0px
}
#footer-menu {
	PADDING-BOTTOM: 0px; MARGIN: 10px auto 0px; PADDING-LEFT: 10px; WIDTH: =
920px; PADDING-RIGHT: 10px; OVERFLOW: hidden; PADDING-TOP: 0px
}
#footer-menu UL {
	PADDING-BOTTOM: 0px; LIST-STYLE-TYPE: none; MARGIN: 0px 0px 0px 15px; =
PADDING-LEFT: 0px; PADDING-RIGHT: 0px; PADDING-TOP: 0px; LEFT: auto
}
#footer-menu LI {
	POSITION: relative; PADDING-BOTTOM: 0px; LIST-STYLE-TYPE: none; MARGIN: =
0px 8px 0px 0px; PADDING-LEFT: 0px; WIDTH: 140px; PADDING-RIGHT: 0px; =
DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; =
FLOAT: left; COLOR: #666; FONT-WEIGHT: bold; PADDING-TOP: 0px
}
#footer-menu LI UL {
	MARGIN: 0.5em 0px 2em
}
#footer-menu UL LI {
	PADDING-BOTTOM: 0.4em; MARGIN: 0px; PADDING-LEFT: 0px; WIDTH: auto; =
PADDING-RIGHT: 0px; DISPLAY: block; FLOAT: none; FONT-SIZE: 85%; =
FONT-WEIGHT: normal; PADDING-TOP: 0px
}
#footer-menu LI A {
	COLOR: #666; FONT-WEIGHT: bold
}
#footer-menu LI UL A {
	FONT-WEIGHT: normal
}
#footer-menu LI A:hover {
	COLOR: #666; TEXT-DECORATION: underline
}
#novell-logo {
	WIDTH: 51px; MARGIN-BOTTOM: 25px; BACKGROUND: =
url(images/mp-novell-logo.png) no-repeat 0px 0px; HEIGHT: 12px
}
#wrapper {
=09
}
.wide#wrapper {
=09
}
#content-header {
	POSITION: absolute; DISPLAY: table; HEIGHT: 55px; VERTICAL-ALIGN: =
middle
}
.short#content-header {
	HEIGHT: 15px !important
}
#titlebar {
	BACKGROUND-IMAGE: url(images/mp-bg-blue-bar.png); WIDTH: 100%; HEIGHT: =
55px
}
#content {
	PADDING-BOTTOM: 2em; PADDING-LEFT: 15px; PADDING-RIGHT: 15px; DISPLAY: =
block; PADDING-TOP: 2em
}
#sidebar {
	PADDING-BOTTOM: 8px; MARGIN: 0px; PADDING-LEFT: 8px; WIDTH: 200px; =
PADDING-RIGHT: 8px; DISPLAY: block; FLOAT: right; PADDING-TOP: 8px
}
#sidebar .box UL {
	PADDING-BOTTOM: 1em
}
DIV.download-button {
	BACKGROUND-IMAGE: =
url(http://www.go-mono.com/monovs/Images/mp-download-blue.png); WIDTH: =
171px; BACKGROUND-REPEAT: no-repeat; HEIGHT: 47px
}
DIV.download-button A {
	LINE-HEIGHT: 45px; COLOR: transparent; FONT-SIZE: 30px
}

------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: text/css;
	charset="koi8-r"
Content-Transfer-Encoding: quoted-printable
Content-Location: http://www.mono-project.com/menu.css

#header UL {
	POSITION: absolute; TEXT-TRANSFORM: lowercase; LIST-STYLE-TYPE: none; =
MARGIN: 0px; BOTTOM: -1px; DISPLAY: block; LETTER-SPACING: -0.05em; =
OVERFLOW: hidden; RIGHT: 0px; FONT-WEIGHT: bold; LIST-STYLE-IMAGE: none
}
#header LI {
	DISPLAY: block; FLOAT: left; COLOR: black; TEXT-DECORATION: none
}
#header LI A:hover {
	BORDER-BOTTOM: #0d71c0 3px solid; PADDING-BOTTOM: 3px
}
#header .current_page_item {
	BORDER-BOTTOM: #888 5px solid; COLOR: #888
}
#header .current_page_item A {
	COLOR: #888; TEXT-DECORATION: none
}
#sidebar .menu UL {
	LINE-HEIGHT: 1.2em; LIST-STYLE-TYPE: none; FONT-SIZE: 0.85em; =
LIST-STYLE-IMAGE: none
}
#sidebar .menu UL LI {
	BORDER-BOTTOM: #eee 1px solid; PADDING-BOTTOM: 5px; PADDING-LEFT: 0px; =
PADDING-RIGHT: 0px; PADDING-TOP: 5px
}
#sidebar .menu UL LI A {
	DISPLAY: block
}
#sidebar .menu UL LI.current_page_item A {
	COLOR: #333
}

------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: text/css;
	charset="koi8-r"
Content-Transfer-Encoding: quoted-printable
Content-Location: http://www.mono-project.com/text.css

BODY {
	FONT: 1em "Corbel", sans-serif
}
#content-header H2 {
	FONT: 160% "Myriad", "Calibri", "DejaVu Sans", "Bitstream Vera Sans", =
Verdana, sans-serif; TEXT-DECORATION: none
}
#content-header H2 A {
	FONT: 160% "Myriad", "Calibri", "DejaVu Sans", "Bitstream Vera Sans", =
Verdana, sans-serif; TEXT-DECORATION: none
}
#content-header H2 A:hover {
	FONT: 160% "Myriad", "Calibri", "DejaVu Sans", "Bitstream Vera Sans", =
Verdana, sans-serif; TEXT-DECORATION: none
}
#content {
	COLOR: #333
}
A {
	COLOR: #0d71c0; TEXT-DECORATION: none
}
A:hover {
	COLOR: #274e80
}
#content UL {
	LIST-STYLE-IMAGE: url(images/bullet.png)
}
.home-icon-link {
	PADDING-BOTTOM: 6px; PADDING-LEFT: 28px; PADDING-RIGHT: 0px; DISPLAY: =
block; PADDING-TOP: 0px
}
.news-link {
	MARGIN-TOP: 2em; BACKGROUND: url(images/news.png) no-repeat
}
.rss-link {
	BACKGROUND: url(images/rss.png) no-repeat
}
TT {
	BORDER-BOTTOM: #eee 1px solid; BORDER-LEFT: #eee 1px solid; FONT: 1em =
"Consolas", "Courier", "DejaVu Sans Mono", monospace; BACKGROUND: =
#f8f8f8; BORDER-TOP: #eee 1px solid; BORDER-RIGHT: #eee 1px solid
}
CODE {
	BORDER-BOTTOM: #eee 1px solid; BORDER-LEFT: #eee 1px solid; FONT: 1em =
"Consolas", "Courier", "DejaVu Sans Mono", monospace; BACKGROUND: =
#f8f8f8; BORDER-TOP: #eee 1px solid; BORDER-RIGHT: #eee 1px solid
}
PRE {
	BORDER-BOTTOM: #eee 1px solid; BORDER-LEFT: #eee 1px solid; FONT: 1em =
"Consolas", "Courier", "DejaVu Sans Mono", monospace; BACKGROUND: =
#f8f8f8; BORDER-TOP: #eee 1px solid; BORDER-RIGHT: #eee 1px solid
}
PRE {
	BORDER-BOTTOM-COLOR: #ddd; PADDING-BOTTOM: 5px; BORDER-RIGHT-WIDTH: =
1px; BORDER-TOP-COLOR: #ddd; MARGIN: 1em; PADDING-LEFT: 5px; =
PADDING-RIGHT: 5px; BORDER-TOP-WIDTH: 1px; BORDER-BOTTOM-WIDTH: 1px; =
BORDER-RIGHT-COLOR: #ddd; BORDER-LEFT-COLOR: #ddd; BORDER-LEFT-WIDTH: =
5px; PADDING-TOP: 5px
}
#footer {
	LINE-HEIGHT: 1.3em; COLOR: #a1bfe2; FONT-SIZE: 0.85em
}
#footer A {
	COLOR: #6093ce; FONT-WEIGHT: normal
}
H1 {
	BORDER-BOTTOM: #99b9e1 1px solid; MARGIN-TOP: 1.25em; COLOR: #274e80; =
FONT-SIZE: 1.8em; FONT-WEIGHT: normal
}
H2 {
	LINE-HEIGHT: 1.5em; MARGIN-TOP: 0.25em; COLOR: #19194b; FONT-SIZE: =
1.4em; FONT-WEIGHT: normal
}
H3 {
	COLOR: #274e80; FONT-SIZE: 1.2em; FONT-WEIGHT: bold
}
H5 {
	MARGIN-BOTTOM: 0.25em
}
P.latest-version {
	BORDER-BOTTOM: #fc0 1px solid; BORDER-LEFT: #fc0 1px solid; =
PADDING-BOTTOM: 0.5em; MARGIN-TOP: 10px; PADDING-LEFT: 0.5em; =
PADDING-RIGHT: 0.5em; BACKGROUND: #ffc; FONT-SIZE: 1.15em; BORDER-TOP: =
#fc0 1px solid; FONT-WEIGHT: bold; BORDER-RIGHT: #fc0 1px solid; =
PADDING-TOP: 0.5em
}
P.latest-version SPAN.downloads-monovs {
	MARGIN-TOP: -21px; FLOAT: right; FONT-SIZE: 1em
}
UL {
	PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: =
0px; PADDING-TOP: 0px
}
OL {
	PADDING-BOTTOM: 0px; MARGIN: 0px 0px 0px 0.5em; PADDING-LEFT: 0px; =
PADDING-RIGHT: 0px; PADDING-TOP: 0px
}
LI {
	MARGIN-LEFT: 1.5em
}
#news .date {
	FONT-STYLE: italic; COLOR: #666
}
#news P A {
	COLOR: #333 !important; FONT-WEIGHT: normal !important
}
DL DT {
	MARGIN-TOP: 1em; FONT-WEIGHT: bold
}
DL DD {
	FONT-STYLE: italic; MARGIN: 0px
}
DL.quotes DT {
	MARGIN-TOP: 1em
}
DL.quotes DT A:before {
	CONTENT: open-quote
}
DL.quotes DT A:after {
	CONTENT: close-quote
}
DL.quotes DD {
	FONT-STYLE: italic; MARGIN: 0px
}
DL.faq DD {
	FONT-STYLE: normal; MARGIN-BOTTOM: 1.5em
}
DIV.release-shot DIV {
	LINE-HEIGHT: 1.3em; FONT-STYLE: italic; COLOR: #666; FONT-SIZE: 0.85em
}
BLOCKQUOTE {
	FONT-STYLE: italic
}
#sidebar {
	FONT-SIZE: 0.8em
}
#sidebar H5 {
	PADDING-BOTTOM: 0px; MARGIN: 1.5em 0px 0.75em; PADDING-LEFT: 0px; =
PADDING-RIGHT: 0px; COLOR: #152d47; FONT-SIZE: 1.3em; FONT-WEIGHT: bold; =
PADDING-TOP: 0px
}
#sidebar H5:first-child {
	MARGIN-TOP: 0px !important
}

------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: text/css;
	charset="koi8-r"
Content-Transfer-Encoding: quoted-printable
Content-Location: http://www.mono-project.com/home.css

TABLE#home {
	WIDTH: 100%
}
TABLE#home TD {
	VERTICAL-ALIGN: top
}
TABLE#home TD.first {
	WIDTH: 40%
}
TABLE#home TD.second {
	PADDING-LEFT: 30px; WIDTH: 40%
}
TABLE#home TD.third {
	PADDING-LEFT: 30px; WIDTH: 20%
}
TABLE#home TD.blurb {
	HEIGHT: 100%
}
DL.features {
	PADDING-BOTTOM: 0px; LINE-HEIGHT: 1.2em; MARGIN: 0px; PADDING-LEFT: =
0px; PADDING-RIGHT: 0px; PADDING-TOP: 0px
}
DL.features DT {
	BACKGROUND: url(images/bullet.png) no-repeat left 50%; FONT-WEIGHT: =
bold
}
DL.features DT {
	PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 14px; PADDING-RIGHT: =
0px; PADDING-TOP: 0px
}
DL.features DD {
	PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 14px; PADDING-RIGHT: =
0px; PADDING-TOP: 0px
}
DL.features DD {
	MARGIN-BOTTOM: 1em; COLOR: #555; FONT-SIZE: 0.85em
}
DL.features DT IMG {
	DISPLAY: none
}
DL.features SPAN.new {
	PADDING-LEFT: 6px; COLOR: #2f9bf0; FONT-SIZE: 0.75em; FONT-WEIGHT: =
normal
}
#news {
	PADDING-BOTTOM: 0px; LINE-HEIGHT: 1.2em; LIST-STYLE-TYPE: none; MARGIN: =
0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; FONT-SIZE: 0.85em; =
PADDING-TOP: 0px
}
#news LI {
	PADDING-BOTTOM: 0px; MARGIN: 0px 0px 0px 0.5em; PADDING-LEFT: 0px; =
PADDING-RIGHT: 0px; PADDING-TOP: 0px
}
#news H4 {
	MARGIN-BOTTOM: 0px; FONT-SIZE: 1.2em
}
#news P {
	MARGIN-TOP: 0.5em; MARGIN-BOTTOM: 3em
}
.rssfeed .rssmore {
	DISPLAY: none
}
#home-intro {
	LINE-HEIGHT: 125%; WIDTH: 940px
}
#home-intro-banner {
	PADDING-LEFT: 30px; PADDING-RIGHT: 30px; HEIGHT: 271px; PADDING-TOP: =
80px
}
#home-intro-banner TABLE {
	WIDTH: 880px
}
TD.square {
	POSITION: relative; DISPLAY: block
}
#home-intro-banner TABLE TR TD.square {
	WIDTH: 271px; BACKGROUND: url(images/mp-white-square.png) no-repeat =
center top; HEIGHT: 181px; VERTICAL-ALIGN: top
}
.learn {
	POSITION: absolute; BOTTOM: 20px; DISPLAY: block; FONT-SIZE: 80%; =
FONT-WEIGHT: bold; LEFT: 20px
}
.try {
	POSITION: absolute; BOTTOM: 40px; DISPLAY: block; FONT-SIZE: 80%; =
RIGHT: 20px; FONT-WEIGHT: bold
}
.buy {
	POSITION: absolute; BOTTOM: 20px; DISPLAY: block; FONT-SIZE: 80%; =
RIGHT: 20px; FONT-WEIGHT: bold
}
.download {
	POSITION: absolute; BOTTOM: 20px; DISPLAY: block; FONT-SIZE: 80%; =
RIGHT: 20px; FONT-WEIGHT: bold
}
#home-intro-banner A {
	COLOR: #eef
}
#home-intro-banner A:hover {
	COLOR: #0d71c0
}
* HTML #home-intro-banner TABLE TR TD.square {
	BORDER-BOTTOM: #666 1px solid; BORDER-LEFT: #666 1px solid; BACKGROUND: =
none transparent scroll repeat 0% 0%; BORDER-TOP: #666 1px solid; =
BORDER-RIGHT: #666 1px solid
}
* HTML #home-intro-banner TABLE TR TD IMG {
	BORDER-BOTTOM: white 5px solid; BORDER-LEFT: white 5px solid; =
PADDING-BOTTOM: 0px !important; BACKGROUND-COLOR: white; MARGIN: 0px; =
PADDING-LEFT: 0px !important; PADDING-RIGHT: 0px !important; BORDER-TOP: =
white 5px solid; BORDER-RIGHT: white 5px solid; PADDING-TOP: 0px =
!important
}
#home-intro-banner TABLE TR TD IMG {
	PADDING-RIGHT: 8px; FLOAT: right; PADDING-TOP: 2px
}
#home-sub-banner {
	MARGIN-TOP: 6em; PADDING-LEFT: 30px; PADDING-RIGHT: 30px
}
#home-sub-banner TABLE {
	WIDTH: 880px
}
#home-sub-banner TABLE TR TD.square {
	WIDTH: 271px; BACKGROUND: url(images/mp-gray-square.png) no-repeat =
center top; HEIGHT: 181px; VERTICAL-ALIGN: top
}
#home-sub-banner TABLE TR TD IMG {
	PADDING-RIGHT: 8px; FLOAT: right; PADDING-TOP: 2px
}
#home-sub-banner A {
	COLOR: #0d71c0
}
#home-sub-banner A:hover {
	COLOR: #99f
}
DIV.home-caption {
	POSITION: absolute; MAX-WIDTH: 200px; COLOR: #274e80; FONT-SIZE: 1em; =
TOP: 10px; FONT-WEIGHT: bold; LEFT: 20px
}
DIV.home-content {
	MARGIN: 50px 20px 0px; WIDTH: 230px; COLOR: #19194b; FONT-SIZE: 0.9em
}
#splash-bg {
	Z-INDEX: -1; POSITION: absolute; BACKGROUND-COLOR: #34679d; HEIGHT: =
400px; TOP: 91px; RIGHT: 0px; LEFT: 0px
}
#splash-bg .wrapper {
	POSITION: relative; MARGIN: 0px auto; WIDTH: 940px; HEIGHT: 400px
}
#splash-img {
	POSITION: absolute; WIDTH: 100%; DISPLAY: block; HEIGHT: 400px
}
#splash-bg H1 {
	BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; COLOR: #fff; =
FONT-SIZE: 185%; BORDER-TOP: 0px; TOP: 20px; BORDER-RIGHT: 0px; LEFT: =
37px; opacity: 0.5
}
#splash-bg H2 {
	POSITION: absolute; BOTTOM: 15px; COLOR: #fff; FONT-SIZE: 125%; LEFT: =
337px
}
#platform-logos {
	POSITION: absolute; WIDTH: 300px; BOTTOM: -20px; DISPLAY: block; =
BACKGROUND: url(images/platform-logos-big.png) no-repeat center center; =
HEIGHT: 100px; LEFT: 33px
}

------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: text/css;
	charset="koi8-r"
Content-Transfer-Encoding: quoted-printable
Content-Location: http://www.mono-project.com/wiki.css

#toc {
	BORDER-LEFT: #c8daee 1px solid; BACKGROUND-COLOR: white; PADDING-LEFT: =
5px; DISPLAY: none; FONT-SIZE: 0.9em
}
#toc DIV.tocindent {
	PADDING-LEFT: 10px
}
#toc .toclevel-1 {
	PADDING-LEFT: 1px
}
#toc .toclevel-2 {
	PADDING-LEFT: 10px
}
#toc .toclevel-3 {
	PADDING-LEFT: 10px
}
#toc .toclevel-4 {
	PADDING-LEFT: 10px
}
#toc LI {
	LINE-HEIGHT: 2.2em; LIST-STYLE-TYPE: none; MARGIN-LEFT: 0px !important; =
LIST-STYLE-IMAGE: none
}
#toc A {
	COLOR: #234974; FONT-WEIGHT: normal
}
#toc A:hover {
	COLOR: #666
}
.tocnumber {
	PADDING-BOTTOM: 1px; PADDING-LEFT: 3px; PADDING-RIGHT: 3px; BACKGROUND: =
#b6cee9; COLOR: #5d91cd; PADDING-TOP: 1px; -moz-border-radius: 3px; =
-khtml-border-radius: 3px; -webkit-border-radius: 3px
}
A:hover .tocnumber {
	BACKGROUND: #5d91cd; COLOR: #274e80
}
#utility-bar {
	Z-INDEX: 10000; POSITION: absolute; DISPLAY: block; TOP: 0px; RIGHT: =
0px
}
#utility-bar-contents {
	BORDER-BOTTOM: #dd9 2px solid; BORDER-LEFT: #dd9 2px solid; =
PADDING-BOTTOM: 0.75em; LINE-HEIGHT: 1.3em; PADDING-LEFT: 1em; =
PADDING-RIGHT: 1em; DISPLAY: none; BACKGROUND: url(wiki-images/edit.png) =
#ffe no-repeat center 10px; BORDER-TOP: #dd9 0px solid; BORDER-RIGHT: =
#dd9 0px solid; PADDING-TOP: 85px
}
#utility-bar-toggle {
	POSITION: absolute; PADDING-BOTTOM: 0px; PADDING-LEFT: 0px; =
PADDING-RIGHT: 6px; TOP: 0px; RIGHT: 0px; PADDING-TOP: 4px
}
#utility-bar-toggle A {
	PADDING-BOTTOM: 0px; PADDING-LEFT: 2px; PADDING-RIGHT: 2px; =
FONT-WEIGHT: bold; PADDING-TOP: 0px
}
#utility-bar-toggle A:hover {
	TEXT-DECORATION: none !important
}
#utility-bar H4 {
	MARGIN: 0.7em 0px 0px
}
#utility-bar UL {
	PADDING-BOTTOM: 0px; LIST-STYLE-TYPE: none; MARGIN: 0px; PADDING-LEFT: =
0px; PADDING-RIGHT: 0px; LIST-STYLE-IMAGE: none; PADDING-TOP: 0px
}
#utility-bar LI {
	PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: =
0px; PADDING-TOP: 0px
}
#utility-bar A {
	TEXT-DECORATION: none
}
#utility-bar A:hover {
	TEXT-DECORATION: underline
}
.urlexpansion {
	DISPLAY: none
}
.split-half {
	MARGIN: 0px 4% 0px 0px; WIDTH: 42%; FLOAT: left
}
.split-half + .split-half {
	MARGIN: 0px 0px 0px 4%
}
.content-half {
	DISPLAY: table; MARGIN-LEFT: 5px
}
DIV.floatright {
	BORDER-BOTTOM: 0px; POSITION: relative; BORDER-LEFT: 0px; MARGIN: 0px =
0px 0.5em 0.5em; FLOAT: right; CLEAR: right; BORDER-TOP: 0px; =
BORDER-RIGHT: 0px
}
TABLE.floatright {
	BORDER-BOTTOM: 0px; POSITION: relative; BORDER-LEFT: 0px; MARGIN: 0px =
0px 0.5em 0.5em; FLOAT: right; CLEAR: right; BORDER-TOP: 0px; =
BORDER-RIGHT: 0px
}
DIV.floatright P {
	FONT-STYLE: italic
}
DIV.floatleft {
	BORDER-BOTTOM: 0px; POSITION: relative; BORDER-LEFT: 0px; MARGIN: 0px =
0.5em 0.5em 0px; FLOAT: left; BORDER-TOP: 0px; BORDER-RIGHT: 0px
}
TABLE.floatleft {
	BORDER-BOTTOM: 0px; POSITION: relative; BORDER-LEFT: 0px; MARGIN: 0px =
0.5em 0.5em 0px; FLOAT: left; BORDER-TOP: 0px; BORDER-RIGHT: 0px
}
DIV.floatleft P {
	FONT-STYLE: italic
}
DIV.thumb {
	BORDER-BOTTOM-STYLE: solid; BORDER-BOTTOM-COLOR: white; =
BORDER-RIGHT-STYLE: solid; BORDER-TOP-COLOR: white; WIDTH: auto; =
BORDER-TOP-STYLE: solid; MARGIN-BOTTOM: 0.5em; BORDER-RIGHT-COLOR: =
white; BORDER-LEFT-STYLE: solid; BORDER-LEFT-COLOR: white
}
DIV.thumb DIV {
	BORDER-BOTTOM: #cccccc 1px solid; TEXT-ALIGN: center; BORDER-LEFT: =
#cccccc 1px solid; PADDING-BOTTOM: 3px !important; BACKGROUND-COLOR: =
#f9f9f9; PADDING-LEFT: 3px !important; PADDING-RIGHT: 3px !important; =
FONT-SIZE: 94%; OVERFLOW: hidden; BORDER-TOP: #cccccc 1px solid; =
BORDER-RIGHT: #cccccc 1px solid; PADDING-TOP: 3px !important
}
DIV.thumb DIV A IMG {
	BORDER-BOTTOM: #cccccc 1px solid; BORDER-LEFT: #cccccc 1px solid; =
BORDER-TOP: #cccccc 1px solid; BORDER-RIGHT: #cccccc 1px solid
}
DIV.thumb DIV DIV.thumbcaption {
	BORDER-BOTTOM: medium none; TEXT-ALIGN: left; BORDER-LEFT: medium none; =
PADDING-BOTTOM: 0.1em; LINE-HEIGHT: 1.4em; PADDING-LEFT: 0px; =
PADDING-RIGHT: 0px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; =
PADDING-TOP: 0.3em
}
DIV.magnify {
	BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; BACKGROUND: none =
transparent scroll repeat 0% 0%; FLOAT: right; BORDER-TOP: medium none; =
BORDER-RIGHT: medium none
}
DIV.magnify A {
	BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; DISPLAY: block; =
BACKGROUND: none transparent scroll repeat 0% 0%; BORDER-TOP: medium =
none; BORDER-RIGHT: medium none
}
DIV.magnify IMG {
	BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; DISPLAY: block; =
BACKGROUND: none transparent scroll repeat 0% 0%; BORDER-TOP: medium =
none; BORDER-RIGHT: medium none
}
DIV.tright {
	BORDER-RIGHT-WIDTH: 0px; FLOAT: right; BORDER-TOP-WIDTH: 0.5em; =
BORDER-BOTTOM-WIDTH: 0.8em; CLEAR: right; BORDER-LEFT-WIDTH: 1.4em
}
DIV.tleft {
	BORDER-RIGHT-WIDTH: 1.4em; FLOAT: left; BORDER-TOP-WIDTH: 0.5em; =
BORDER-BOTTOM-WIDTH: 0.8em; BORDER-LEFT-WIDTH: 0px; MARGIN-RIGHT: 0.5em
}

------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: text/css;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
Content-Location: http://www.mono-project.com/skins/MonoWaveWide/screen.css

@import url( layout.css );
@import url( menu.css );
@import url( text.css );
@import url( home.css );
@import url( wiki.css );

------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: application/octet-stream
Content-Transfer-Encoding: quoted-printable
Content-Location: http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js

/*!=0A=
 * jQuery JavaScript Library v1.6.2=0A=
 * http://jquery.com/=0A=
 *=0A=
 * Copyright 2011, John Resig=0A=
 * Dual licensed under the MIT or GPL Version 2 licenses.=0A=
 * http://jquery.org/license=0A=
 *=0A=
 * Includes Sizzle.js=0A=
 * http://sizzlejs.com/=0A=
 * Copyright 2011, The Dojo Foundation=0A=
 * Released under the MIT, BSD, and GPL Licenses.=0A=
 *=0A=
 * Date: Thu Jun 30 14:16:56 2011 -0400=0A=
 */=0A=
(function(a,b){function cv(a){return =
f.isWindow(a)?a:a.nodeType=3D=3D=3D9?a.defaultView||a.parentWindow:!1}fun=
ction cs(a){if(!cg[a]){var =
b=3Dc.body,d=3Df("<"+a+">").appendTo(b),e=3Dd.css("display");d.remove();i=
f(e=3D=3D=3D"none"||e=3D=3D=3D""){ch||(ch=3Dc.createElement("iframe"),ch.=
frameBorder=3Dch.width=3Dch.height=3D0),b.appendChild(ch);if(!ci||!ch.cre=
ateElement)ci=3D(ch.contentWindow||ch.contentDocument).document,ci.write(=
(c.compatMode=3D=3D=3D"CSS1Compat"?"<!doctype =
html>":"")+"<html><body>"),ci.close();d=3Dci.createElement(a),ci.body.app=
endChild(d),e=3Df.css(d,"display"),b.removeChild(ch)}cg[a]=3De}return =
cg[a]}function cr(a,b){var =
c=3D{};f.each(cm.concat.apply([],cm.slice(0,b)),function(){c[this]=3Da});=
return c}function cq(){cn=3Db}function cp(){setTimeout(cq,0);return =
cn=3Df.now()}function cf(){try{return new =
a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ce(){try{return =
new a.XMLHttpRequest}catch(b){}}function =
b$(a,c){a.dataFilter&&(c=3Da.dataFilter(c,a.dataType));var =
d=3Da.dataTypes,e=3D{},g,h,i=3Dd.length,j,k=3Dd[0],l,m,n,o,p;for(g=3D1;g<=
i;g++){if(g=3D=3D=3D1)for(h in a.converters)typeof =
h=3D=3D"string"&&(e[h.toLowerCase()]=3Da.converters[h]);l=3Dk,k=3Dd[g];if=
(k=3D=3D=3D"*")k=3Dl;else if(l!=3D=3D"*"&&l!=3D=3Dk){m=3Dl+" =
"+k,n=3De[m]||e["* "+k];if(!n){p=3Db;for(o in e){j=3Do.split(" =
");if(j[0]=3D=3D=3Dl||j[0]=3D=3D=3D"*"){p=3De[j[1]+" =
"+k];if(p){o=3De[o],o=3D=3D=3D!0?n=3Dp:p=3D=3D=3D!0&&(n=3Do);break}}}}!n&=
&!p&&f.error("No conversion from "+m.replace(" "," to =
")),n!=3D=3D!0&&(c=3Dn?n(c):p(o(c)))}}return c}function bZ(a,c,d){var =
e=3Da.contents,f=3Da.dataTypes,g=3Da.responseFields,h,i,j,k;for(i in g)i =
in =
d&&(c[g[i]]=3Dd[i]);while(f[0]=3D=3D=3D"*")f.shift(),h=3D=3D=3Db&&(h=3Da.=
mimeType||c.getResponseHeader("content-type"));if(h)for(i in =
e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in =
d)j=3Df[0];else{for(i in d){if(!f[0]||a.converters[i+" =
"+f[0]]){j=3Di;break}k||(k=3Di)}j=3Dj||k}if(j){j!=3D=3Df[0]&&f.unshift(j)=
;return d[j]}}function =
bY(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bC.test(a)?d(a,e):b=
Y(a+"["+(typeof e=3D=3D"object"||f.isArray(e)?b:"")+"]",e,c,d)});else =
if(!c&&b!=3Dnull&&typeof b=3D=3D"object")for(var e in =
b)bY(a+"["+e+"]",b[e],c,d);else d(a,b)}function =
bX(a,c,d,e,f,g){f=3Df||c.dataTypes[0],g=3Dg||{},g[f]=3D!0;var =
h=3Da[f],i=3D0,j=3Dh?h.length:0,k=3Da=3D=3D=3DbR,l;for(;i<j&&(k||!l);i++)=
l=3Dh[i](c,d,e),typeof =
l=3D=3D"string"&&(!k||g[l]?l=3Db:(c.dataTypes.unshift(l),l=3DbX(a,c,d,e,l=
,g)));(k||!l)&&!g["*"]&&(l=3DbX(a,c,d,e,"*",g));return l}function =
bW(a){return function(b,c){typeof =
b!=3D"string"&&(c=3Db,b=3D"*");if(f.isFunction(c)){var =
d=3Db.toLowerCase().split(bN),e=3D0,g=3Dd.length,h,i,j;for(;e<g;e++)h=3Dd=
[e],j=3D/^\+/.test(h),j&&(h=3Dh.substr(1)||"*"),i=3Da[h]=3Da[h]||[],i[j?"=
unshift":"push"](c)}}}function bA(a,b,c){var =
d=3Db=3D=3D=3D"width"?a.offsetWidth:a.offsetHeight,e=3Db=3D=3D=3D"width"?=
bv:bw;if(d>0){c!=3D=3D"border"&&f.each(e,function(){c||(d-=3DparseFloat(f=
.css(a,"padding"+this))||0),c=3D=3D=3D"margin"?d+=3DparseFloat(f.css(a,c+=
this))||0:d-=3DparseFloat(f.css(a,"border"+this+"Width"))||0});return =
d+"px"}d=3Dbx(a,b,b);if(d<0||d=3D=3Dnull)d=3Da.style[b]||0;d=3DparseFloat=
(d)||0,c&&f.each(e,function(){d+=3DparseFloat(f.css(a,"padding"+this))||0=
,c!=3D=3D"padding"&&(d+=3DparseFloat(f.css(a,"border"+this+"Width"))||0),=
c=3D=3D=3D"margin"&&(d+=3DparseFloat(f.css(a,c+this))||0)});return =
d+"px"}function =
bm(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval=
((b.text||b.textContent||b.innerHTML||"").replace(be,"/*$0*/")),b.parentN=
ode&&b.parentNode.removeChild(b)}function =
bl(a){f.nodeName(a,"input")?bk(a):"getElementsByTagName"in =
a&&f.grep(a.getElementsByTagName("input"),bk)}function =
bk(a){if(a.type=3D=3D=3D"checkbox"||a.type=3D=3D=3D"radio")a.defaultCheck=
ed=3Da.checked}function bj(a){return"getElementsByTagName"in =
a?a.getElementsByTagName("*"):"querySelectorAll"in =
a?a.querySelectorAll("*"):[]}function bi(a,b){var =
c;if(b.nodeType=3D=3D=3D1){b.clearAttributes&&b.clearAttributes(),b.merge=
Attributes&&b.mergeAttributes(a),c=3Db.nodeName.toLowerCase();if(c=3D=3D=3D=
"object")b.outerHTML=3Da.outerHTML;else =
if(c!=3D=3D"input"||a.type!=3D=3D"checkbox"&&a.type!=3D=3D"radio"){if(c=3D=
=3D=3D"option")b.selected=3Da.defaultSelected;else =
if(c=3D=3D=3D"input"||c=3D=3D=3D"textarea")b.defaultValue=3Da.defaultValu=
e}else =
a.checked&&(b.defaultChecked=3Db.checked=3Da.checked),b.value!=3D=3Da.val=
ue&&(b.value=3Da.value);b.removeAttribute(f.expando)}}function =
bh(a,b){if(b.nodeType=3D=3D=3D1&&!!f.hasData(a)){var =
c=3Df.expando,d=3Df.data(a),e=3Df.data(b,d);if(d=3Dd[c]){var =
g=3Dd.events;e=3De[c]=3Df.extend({},d);if(g){delete =
e.handle,e.events=3D{};for(var h in g)for(var =
i=3D0,j=3Dg[h].length;i<j;i++)f.event.add(b,h+(g[h][i].namespace?".":"")+=
g[h][i].namespace,g[h][i],g[h][i].data)}}}}function bg(a,b){return =
f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a=
.ownerDocument.createElement("tbody")):a}function =
W(a,b,c){b=3Db||0;if(f.isFunction(b))return f.grep(a,function(a,d){var =
e=3D!!b.call(a,d,a);return e=3D=3D=3Dc});if(b.nodeType)return =
f.grep(a,function(a,d){return a=3D=3D=3Db=3D=3D=3Dc});if(typeof =
b=3D=3D"string"){var d=3Df.grep(a,function(a){return =
a.nodeType=3D=3D=3D1});if(R.test(b))return =
f.filter(b,d,!c);b=3Df.filter(b,d)}return f.grep(a,function(a,d){return =
f.inArray(a,b)>=3D0=3D=3D=3Dc})}function =
V(a){return!a||!a.parentNode||a.parentNode.nodeType=3D=3D=3D11}function =
N(a,b){return(a&&a!=3D=3D"*"?a+".":"")+b.replace(z,"`").replace(A,"&")}fu=
nction M(a){var =
b,c,d,e,g,h,i,j,k,l,m,n,o,p=3D[],q=3D[],r=3Df._data(this,"events");if(!(a=
.liveFired=3D=3D=3Dthis||!r||!r.live||a.target.disabled||a.button&&a.type=
=3D=3D=3D"click")){a.namespace&&(n=3Dnew =
RegExp("(^|\\.)"+a.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)"))=
,a.liveFired=3Dthis;var =
s=3Dr.live.slice(0);for(i=3D0;i<s.length;i++)g=3Ds[i],g.origType.replace(=
x,"")=3D=3D=3Da.type?q.push(g.selector):s.splice(i--,1);e=3Df(a.target).c=
losest(q,a.currentTarget);for(j=3D0,k=3De.length;j<k;j++){m=3De[j];for(i=3D=
0;i<s.length;i++){g=3Ds[i];if(m.selector=3D=3D=3Dg.selector&&(!n||n.test(=
g.namespace))&&!m.elem.disabled){h=3Dm.elem,d=3Dnull;if(g.preType=3D=3D=3D=
"mouseenter"||g.preType=3D=3D=3D"mouseleave")a.type=3Dg.preType,d=3Df(a.r=
elatedTarget).closest(g.selector)[0],d&&f.contains(h,d)&&(d=3Dh);(!d||d!=3D=
=3Dh)&&p.push({elem:h,handleObj:g,level:m.level})}}}for(j=3D0,k=3Dp.lengt=
h;j<k;j++){e=3Dp[j];if(c&&e.level>c)break;a.currentTarget=3De.elem,a.data=
=3De.handleObj.data,a.handleObj=3De.handleObj,o=3De.handleObj.origHandler=
.apply(e.elem,arguments);if(o=3D=3D=3D!1||a.isPropagationStopped()){c=3De=
.level,o=3D=3D=3D!1&&(b=3D!1);if(a.isImmediatePropagationStopped())break}=
}return b}}function K(a,c,d){var =
e=3Df.extend({},d[0]);e.type=3Da,e.originalEvent=3D{},e.liveFired=3Db,f.e=
vent.handle.call(c,e),e.isDefaultPrevented()&&d[0].preventDefault()}funct=
ion E(){return!0}function D(){return!1}function m(a,c,d){var =
e=3Dc+"defer",g=3Dc+"queue",h=3Dc+"mark",i=3Df.data(a,e,b,!0);i&&(d=3D=3D=
=3D"queue"||!f.data(a,g,b,!0))&&(d=3D=3D=3D"mark"||!f.data(a,h,b,!0))&&se=
tTimeout(function(){!f.data(a,g,b,!0)&&!f.data(a,h,b,!0)&&(f.removeData(a=
,e,!0),i.resolve())},0)}function l(a){for(var b in =
a)if(b!=3D=3D"toJSON")return!1;return!0}function =
k(a,c,d){if(d=3D=3D=3Db&&a.nodeType=3D=3D=3D1){var =
e=3D"data-"+c.replace(j,"$1-$2").toLowerCase();d=3Da.getAttribute(e);if(t=
ypeof =
d=3D=3D"string"){try{d=3Dd=3D=3D=3D"true"?!0:d=3D=3D=3D"false"?!1:d=3D=3D=
=3D"null"?null:f.isNaN(d)?i.test(d)?f.parseJSON(d):d:parseFloat(d)}catch(=
g){}f.data(a,c,d)}else d=3Db}return d}var =
c=3Da.document,d=3Da.navigator,e=3Da.location,f=3Dfunction(){function =
J(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTim=
eout(J,1);return}e.ready()}}var e=3Dfunction(a,b){return new =
e.fn.init(a,b,h)},f=3Da.jQuery,g=3Da.$,h,i=3D/^(?:[^<]*(<[\w\W]+>)[^>]*$|=
#([\w\-]*)$)/,j=3D/\S/,k=3D/^\s+/,l=3D/\s+$/,m=3D/\d/,n=3D/^<(\w+)\s*\/?>=
(?:<\/\1>)?$/,o=3D/^[\],:{}\s]*$/,p=3D/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})=
/g,q=3D/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g=
,r=3D/(?:^|:|,)(?:\s*\[)+/g,s=3D/(webkit)[ =
\/]([\w.]+)/,t=3D/(opera)(?:.*version)?[ \/]([\w.]+)/,u=3D/(msie) =
([\w.]+)/,v=3D/(mozilla)(?:.*? =
rv:([\w.]+))?/,w=3D/-([a-z])/ig,x=3Dfunction(a,b){return =
b.toUpperCase()},y=3Dd.userAgent,z,A,B,C=3DObject.prototype.toString,D=3D=
Object.prototype.hasOwnProperty,E=3DArray.prototype.push,F=3DArray.protot=
ype.slice,G=3DString.prototype.trim,H=3DArray.prototype.indexOf,I=3D{};e.=
fn=3De.prototype=3D{constructor:e,init:function(a,d,f){var =
g,h,j,k;if(!a)return =
this;if(a.nodeType){this.context=3Dthis[0]=3Da,this.length=3D1;return =
this}if(a=3D=3D=3D"body"&&!d&&c.body){this.context=3Dc,this[0]=3Dc.body,t=
his.selector=3Da,this.length=3D1;return this}if(typeof =
a=3D=3D"string"){a.charAt(0)!=3D=3D"<"||a.charAt(a.length-1)!=3D=3D">"||a=
.length<3?g=3Di.exec(a):g=3D[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=3D=
d instanceof =
e?d[0]:d,k=3Dd?d.ownerDocument||d:c,j=3Dn.exec(a),j?e.isPlainObject(d)?(a=
=3D[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=3D[k.createElement(j=
[1])]:(j=3De.buildFragment([g[1]],[k]),a=3D(j.cacheable?e.clone(j.fragmen=
t):j.fragment).childNodes);return =
e.merge(this,a)}h=3Dc.getElementById(g[2]);if(h&&h.parentNode){if(h.id!=3D=
=3Dg[2])return =
f.find(a);this.length=3D1,this[0]=3Dh}this.context=3Dc,this.selector=3Da;=
return =
this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.i=
sFunction(a))return =
f.ready(a);a.selector!=3D=3Db&&(this.selector=3Da.selector,this.context=3D=
a.context);return =
e.makeArray(a,this)},selector:"",jquery:"1.6.2",length:0,size:function(){=
return this.length},toArray:function(){return =
F.call(this,0)},get:function(a){return =
a=3D=3Dnull?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:fun=
ction(a,b,c){var =
d=3Dthis.constructor();e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObjec=
t=3Dthis,d.context=3Dthis.context,b=3D=3D=3D"find"?d.selector=3Dthis.sele=
ctor+(this.selector?" =
":"")+c:b&&(d.selector=3Dthis.selector+"."+b+"("+c+")");return =
d},each:function(a,b){return =
e.each(this,a,b)},ready:function(a){e.bindReady(),A.done(a);return =
this},eq:function(a){return =
a=3D=3D=3D-1?this.slice(a):this.slice(a,+a+1)},first:function(){return =
this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return =
this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","=
))},map:function(a){return =
this.pushStack(e.map(this,function(b,c){return =
a.call(b,c,b)}))},end:function(){return =
this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].sp=
lice},e.fn.init.prototype=3De.fn,e.extend=3De.fn.extend=3Dfunction(){var =
a,c,d,f,g,h,i=3Darguments[0]||{},j=3D1,k=3Darguments.length,l=3D!1;typeof=
 i=3D=3D"boolean"&&(l=3Di,i=3Darguments[1]||{},j=3D2),typeof =
i!=3D"object"&&!e.isFunction(i)&&(i=3D{}),k=3D=3D=3Dj&&(i=3Dthis,--j);for=
(;j<k;j++)if((a=3Darguments[j])!=3Dnull)for(c in =
a){d=3Di[c],f=3Da[c];if(i=3D=3D=3Df)continue;l&&f&&(e.isPlainObject(f)||(=
g=3De.isArray(f)))?(g?(g=3D!1,h=3Dd&&e.isArray(d)?d:[]):h=3Dd&&e.isPlainO=
bject(d)?d:{},i[c]=3De.extend(l,h,f)):f!=3D=3Db&&(i[c]=3Df)}return =
i},e.extend({noConflict:function(b){a.$=3D=3D=3De&&(a.$=3Dg),b&&a.jQuery=3D=
=3D=3De&&(a.jQuery=3Df);return =
e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!=
0)},ready:function(a){if(a=3D=3D=3D!0&&!--e.readyWait||a!=3D=3D!0&&!e.isR=
eady){if(!c.body)return =
setTimeout(e.ready,1);e.isReady=3D!0;if(a!=3D=3D!0&&--e.readyWait>0)retur=
n;A.resolveWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").unbind("ready"=
)}},bindReady:function(){if(!A){A=3De._Deferred();if(c.readyState=3D=3D=3D=
"complete")return =
setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMConten=
tLoaded",B,!1),a.addEventListener("load",e.ready,!1);else =
if(c.attachEvent){c.attachEvent("onreadystatechange",B),a.attachEvent("on=
load",e.ready);var =
b=3D!1;try{b=3Da.frameElement=3D=3Dnull}catch(d){}c.documentElement.doScr=
oll&&b&&J()}}},isFunction:function(a){return =
e.type(a)=3D=3D=3D"function"},isArray:Array.isArray||function(a){return =
e.type(a)=3D=3D=3D"array"},isWindow:function(a){return a&&typeof =
a=3D=3D"object"&&"setInterval"in a},isNaN:function(a){return =
a=3D=3Dnull||!m.test(a)||isNaN(a)},type:function(a){return =
a=3D=3Dnull?String(a):I[C.call(a)]||"object"},isPlainObject:function(a){i=
f(!a||e.type(a)!=3D=3D"object"||a.nodeType||e.isWindow(a))return!1;if(a.c=
onstructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"is=
PrototypeOf"))return!1;var c;for(c in a);return =
c=3D=3D=3Db||D.call(a,c)},isEmptyObject:function(a){for(var b in =
a)return!1;return!0},error:function(a){throw =
a},parseJSON:function(b){if(typeof b!=3D"string"||!b)return =
null;b=3De.trim(b);if(a.JSON&&a.JSON.parse)return =
a.JSON.parse(b);if(o.test(b.replace(p,"@").replace(q,"]").replace(r,"")))=
return(new Function("return "+b))();e.error("Invalid JSON: =
"+b)},parseXML:function(b,c,d){a.DOMParser?(d=3Dnew =
DOMParser,c=3Dd.parseFromString(b,"text/xml")):(c=3Dnew =
ActiveXObject("Microsoft.XMLDOM"),c.async=3D"false",c.loadXML(b)),d=3Dc.d=
ocumentElement,(!d||!d.nodeName||d.nodeName=3D=3D=3D"parsererror")&&e.err=
or("Invalid XML: "+b);return =
c},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||=
function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return =
a.replace(w,x)},nodeName:function(a,b){return =
a.nodeName&&a.nodeName.toUpperCase()=3D=3D=3Db.toUpperCase()},each:functi=
on(a,c,d){var =
f,g=3D0,h=3Da.length,i=3Dh=3D=3D=3Db||e.isFunction(a);if(d){if(i){for(f =
in a)if(c.apply(a[f],d)=3D=3D=3D!1)break}else =
for(;g<h;)if(c.apply(a[g++],d)=3D=3D=3D!1)break}else if(i){for(f in =
a)if(c.call(a[f],f,a[f])=3D=3D=3D!1)break}else =
for(;g<h;)if(c.call(a[g],g,a[g++])=3D=3D=3D!1)break;return =
a},trim:G?function(a){return =
a=3D=3Dnull?"":G.call(a)}:function(a){return =
a=3D=3Dnull?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b=
){var c=3Db||[];if(a!=3Dnull){var =
d=3De.type(a);a.length=3D=3Dnull||d=3D=3D=3D"string"||d=3D=3D=3D"function=
"||d=3D=3D=3D"regexp"||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return =
c},inArray:function(a,b){if(H)return H.call(b,a);for(var =
c=3D0,d=3Db.length;c<d;c++)if(b[c]=3D=3D=3Da)return =
c;return-1},merge:function(a,c){var d=3Da.length,e=3D0;if(typeof =
c.length=3D=3D"number")for(var f=3Dc.length;e<f;e++)a[d++]=3Dc[e];else =
while(c[e]!=3D=3Db)a[d++]=3Dc[e++];a.length=3Dd;return =
a},grep:function(a,b,c){var d=3D[],e;c=3D!!c;for(var =
f=3D0,g=3Da.length;f<g;f++)e=3D!!b(a[f],f),c!=3D=3De&&d.push(a[f]);return=
 d},map:function(a,c,d){var f,g,h=3D[],i=3D0,j=3Da.length,k=3Da =
instanceof e||j!=3D=3Db&&typeof =
j=3D=3D"number"&&(j>0&&a[0]&&a[j-1]||j=3D=3D=3D0||e.isArray(a));if(k)for(=
;i<j;i++)f=3Dc(a[i],i,d),f!=3Dnull&&(h[h.length]=3Df);else for(g in =
a)f=3Dc(a[g],g,d),f!=3Dnull&&(h[h.length]=3Df);return =
h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof =
c=3D=3D"string"){var d=3Da[c];c=3Da,a=3Dd}if(!e.isFunction(a))return =
b;var f=3DF.call(arguments,2),g=3Dfunction(){return =
a.apply(c,f.concat(F.call(arguments)))};g.guid=3Da.guid=3Da.guid||g.guid|=
|e.guid++;return g},access:function(a,c,d,f,g,h){var =
i=3Da.length;if(typeof c=3D=3D"object"){for(var j in =
c)e.access(a,j,c[j],f,g,d);return =
a}if(d!=3D=3Db){f=3D!h&&f&&e.isFunction(d);for(var =
k=3D0;k<i;k++)g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h);return a}return =
i?g(a[0],c):b},now:function(){return(new =
Date).getTime()},uaMatch:function(a){a=3Da.toLowerCase();var =
b=3Ds.exec(a)||t.exec(a)||u.exec(a)||a.indexOf("compatible")<0&&v.exec(a)=
||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function =
a(b,c){return new =
a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=3Dthis,a.fn=3Da.prototype=
=3Dthis(),a.fn.constructor=3Da,a.sub=3Dthis.sub,a.fn.init=3Dfunction(d,f)=
{f&&f instanceof e&&!(f instanceof a)&&(f=3Da(f));return =
e.fn.init.call(this,d,f,b)},a.fn.init.prototype=3Da.fn;var =
b=3Da(c);return a},browser:{}}),e.each("Boolean Number String Function =
Array Date RegExp Object".split(" "),function(a,b){I["[object =
"+b+"]"]=3Db.toLowerCase()}),z=3De.uaMatch(y),z.browser&&(e.browser[z.bro=
wser]=3D!0,e.browser.version=3Dz.version),e.browser.webkit&&(e.browser.sa=
fari=3D!0),j.test("=C2=A0")&&(k=3D/^[\s\xA0]+/,l=3D/[\s\xA0]+$/),h=3De(c)=
,c.addEventListener?B=3Dfunction(){c.removeEventListener("DOMContentLoade=
d",B,!1),e.ready()}:c.attachEvent&&(B=3Dfunction(){c.readyState=3D=3D=3D"=
complete"&&(c.detachEvent("onreadystatechange",B),e.ready())});return =
e}(),g=3D"done fail isResolved isRejected promise then always =
pipe".split(" "),h=3D[].slice;f.extend({_Deferred:function(){var =
a=3D[],b,c,d,e=3D{done:function(){if(!d){var =
c=3Darguments,g,h,i,j,k;b&&(k=3Db,b=3D0);for(g=3D0,h=3Dc.length;g<h;g++)i=
=3Dc[g],j=3Df.type(i),j=3D=3D=3D"array"?e.done.apply(e,i):j=3D=3D=3D"func=
tion"&&a.push(i);k&&e.resolveWith(k[0],k[1])}return =
this},resolveWith:function(e,f){if(!d&&!b&&!c){f=3Df||[],c=3D1;try{while(=
a[0])a.shift().apply(e,f)}finally{b=3D[e,f],c=3D0}}return =
this},resolve:function(){e.resolveWith(this,arguments);return =
this},isResolved:function(){return!!c||!!b},cancel:function(){d=3D1,a=3D[=
];return this}};return e},Deferred:function(a){var =
b=3Df._Deferred(),c=3Df._Deferred(),d;f.extend(b,{then:function(a,c){b.do=
ne(a).fail(c);return this},always:function(){return =
b.done.apply(b,arguments).fail.apply(this,arguments)},fail:c.done,rejectW=
ith:c.resolveWith,reject:c.resolve,isRejected:c.isResolved,pipe:function(=
a,c){return =
f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[c,"reject"]},func=
tion(a,c){var =
e=3Dc[0],g=3Dc[1],h;f.isFunction(e)?b[a](function(){h=3De.apply(this,argu=
ments),h&&f.isFunction(h.promise)?h.promise().then(d.resolve,d.reject):d[=
g](h)}):b[a](d[g])})}).promise()},promise:function(a){if(a=3D=3Dnull){if(=
d)return d;d=3Da=3D{}}var =
c=3Dg.length;while(c--)a[g[c]]=3Db[g[c]];return =
a}}),b.done(c.cancel).fail(b.cancel),delete =
b.cancel,a&&a.call(b,b);return b},when:function(a){function i(a){return =
function(c){b[a]=3Darguments.length>1?h.call(arguments,0):c,--e||g.resolv=
eWith(g,h.call(b,0))}}var =
b=3Darguments,c=3D0,d=3Db.length,e=3Dd,g=3Dd<=3D1&&a&&f.isFunction(a.prom=
ise)?a:f.Deferred();if(d>1){for(;c<d;c++)b[c]&&f.isFunction(b[c].promise)=
?b[c].promise().then(i(c),g.reject):--e;e||g.resolveWith(g,b)}else =
g!=3D=3Da&&g.resolveWith(g,d?[a]:[]);return =
g.promise()}}),f.support=3Dfunction(){var =
a=3Dc.createElement("div"),b=3Dc.documentElement,d,e,g,h,i,j,k,l,m,n,o,p,=
q,r,s,t,u;a.setAttribute("className","t"),a.innerHTML=3D"   =
<link/><table></table><a href=3D'/a' =
style=3D'top:1px;float:left;opacity:.55;'>a</a><input =
type=3D'checkbox'/>",d=3Da.getElementsByTagName("*"),e=3Da.getElementsByT=
agName("a")[0];if(!d||!d.length||!e)return{};g=3Dc.createElement("select"=
),h=3Dg.appendChild(c.createElement("option")),i=3Da.getElementsByTagName=
("input")[0],k=3D{leadingWhitespace:a.firstChild.nodeType=3D=3D=3D3,tbody=
:!a.getElementsByTagName("tbody").length,htmlSerialize:!!a.getElementsByT=
agName("link").length,style:/top/.test(e.getAttribute("style")),hrefNorma=
lized:e.getAttribute("href")=3D=3D=3D"/a",opacity:/^0.55$/.test(e.style.o=
pacity),cssFloat:!!e.style.cssFloat,checkOn:i.value=3D=3D=3D"on",optSelec=
ted:h.selected,getSetAttribute:a.className!=3D=3D"t",submitBubbles:!0,cha=
ngeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBl=
ockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},i.checked=3D=
!0,k.noCloneChecked=3Di.cloneNode(!0).checked,g.disabled=3D!0,k.optDisabl=
ed=3D!h.disabled;try{delete =
a.test}catch(v){k.deleteExpando=3D!1}!a.addEventListener&&a.attachEvent&&=
a.fireEvent&&(a.attachEvent("onclick",function(){k.noCloneEvent=3D!1}),a.=
cloneNode(!0).fireEvent("onclick")),i=3Dc.createElement("input"),i.value=3D=
"t",i.setAttribute("type","radio"),k.radioValue=3Di.value=3D=3D=3D"t",i.s=
etAttribute("checked","checked"),a.appendChild(i),l=3Dc.createDocumentFra=
gment(),l.appendChild(a.firstChild),k.checkClone=3Dl.cloneNode(!0).cloneN=
ode(!0).lastChild.checked,a.innerHTML=3D"",a.style.width=3Da.style.paddin=
gLeft=3D"1px",m=3Dc.getElementsByTagName("body")[0],o=3Dc.createElement(m=
?"div":"body"),p=3D{visibility:"hidden",width:0,height:0,border:0,margin:=
0},m&&f.extend(p,{position:"absolute",left:-1e3,top:-1e3});for(t in =
p)o.style[t]=3Dp[t];o.appendChild(a),n=3Dm||b,n.insertBefore(o,n.firstChi=
ld),k.appendChecked=3Di.checked,k.boxModel=3Da.offsetWidth=3D=3D=3D2,"zoo=
m"in =
a.style&&(a.style.display=3D"inline",a.style.zoom=3D1,k.inlineBlockNeedsL=
ayout=3Da.offsetWidth=3D=3D=3D2,a.style.display=3D"",a.innerHTML=3D"<div =
style=3D'width:4px;'></div>",k.shrinkWrapBlocks=3Da.offsetWidth!=3D=3D2),=
a.innerHTML=3D"<table><tr><td =
style=3D'padding:0;border:0;display:none'></td><td>t</td></tr></table>",q=
=3Da.getElementsByTagName("td"),u=3Dq[0].offsetHeight=3D=3D=3D0,q[0].styl=
e.display=3D"",q[1].style.display=3D"none",k.reliableHiddenOffsets=3Du&&q=
[0].offsetHeight=3D=3D=3D0,a.innerHTML=3D"",c.defaultView&&c.defaultView.=
getComputedStyle&&(j=3Dc.createElement("div"),j.style.width=3D"0",j.style=
.marginRight=3D"0",a.appendChild(j),k.reliableMarginRight=3D(parseInt((c.=
defaultView.getComputedStyle(j,null)||{marginRight:0}).marginRight,10)||0=
)=3D=3D=3D0),o.innerHTML=3D"",n.removeChild(o);if(a.attachEvent)for(t =
in{submit:1,change:1,focusin:1})s=3D"on"+t,u=3Ds in =
a,u||(a.setAttribute(s,"return;"),u=3Dtypeof =
a[s]=3D=3D"function"),k[t+"Bubbles"]=3Du;o=3Dl=3Dg=3Dh=3Dm=3Dj=3Da=3Di=3D=
null;return k}(),f.boxModel=3Df.support.boxModel;var =
i=3D/^(?:\{.*\}|\[.*\])$/,j=3D/([a-z])([A-Z])/g;f.extend({cache:{},uuid:0=
,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{e=
mbed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},ha=
sData:function(a){a=3Da.nodeType?f.cache[a[f.expando]]:a[f.expando];retur=
n!!a&&!l(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var =
g=3Df.expando,h=3Dtypeof =
c=3D=3D"string",i,j=3Da.nodeType,k=3Dj?f.cache:a,l=3Dj?a[f.expando]:a[f.e=
xpando]&&f.expando;if((!l||e&&l&&!k[l][g])&&h&&d=3D=3D=3Db)return;l||(j?a=
[f.expando]=3Dl=3D++f.uuid:l=3Df.expando),k[l]||(k[l]=3D{},j||(k[l].toJSO=
N=3Df.noop));if(typeof c=3D=3D"object"||typeof =
c=3D=3D"function")e?k[l][g]=3Df.extend(k[l][g],c):k[l]=3Df.extend(k[l],c)=
;i=3Dk[l],e&&(i[g]||(i[g]=3D{}),i=3Di[g]),d!=3D=3Db&&(i[f.camelCase(c)]=3D=
d);if(c=3D=3D=3D"events"&&!i[c])return i[g]&&i[g].events;return =
h?i[f.camelCase(c)]||i[c]:i}},removeData:function(b,c,d){if(!!f.acceptDat=
a(b)){var =
e=3Df.expando,g=3Db.nodeType,h=3Dg?f.cache:b,i=3Dg?b[f.expando]:f.expando=
;if(!h[i])return;if(c){var j=3Dd?h[i][e]:h[i];if(j){delete =
j[c];if(!l(j))return}}if(d){delete h[i][e];if(!l(h[i]))return}var =
k=3Dh[i][e];f.support.deleteExpando||h!=3Da?delete =
h[i]:h[i]=3Dnull,k?(h[i]=3D{},g||(h[i].toJSON=3Df.noop),h[i][e]=3Dk):g&&(=
f.support.deleteExpando?delete =
b[f.expando]:b.removeAttribute?b.removeAttribute(f.expando):b[f.expando]=3D=
null)}},_data:function(a,b,c){return =
f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var =
b=3Df.noData[a.nodeName.toLowerCase()];if(b)return =
b!=3D=3D!0&&a.getAttribute("classid")=3D=3D=3Db}return!0}}),f.fn.extend({=
data:function(a,c){var d=3Dnull;if(typeof =
a=3D=3D"undefined"){if(this.length){d=3Df.data(this[0]);if(this[0].nodeTy=
pe=3D=3D=3D1){var e=3Dthis[0].attributes,g;for(var =
h=3D0,i=3De.length;h<i;h++)g=3De[h].name,g.indexOf("data-")=3D=3D=3D0&&(g=
=3Df.camelCase(g.substring(5)),k(this[0],g,d[g]))}}return d}if(typeof =
a=3D=3D"object")return this.each(function(){f.data(this,a)});var =
j=3Da.split(".");j[1]=3Dj[1]?"."+j[1]:"";if(c=3D=3D=3Db){d=3Dthis.trigger=
Handler("getData"+j[1]+"!",[j[0]]),d=3D=3D=3Db&&this.length&&(d=3Df.data(=
this[0],a),d=3Dk(this[0],a,d));return =
d=3D=3D=3Db&&j[1]?this.data(j[0]):d}return this.each(function(){var =
b=3Df(this),d=3D[j[0],c];b.triggerHandler("setData"+j[1]+"!",d),f.data(th=
is,a,c),b.triggerHandler("changeData"+j[1]+"!",d)})},removeData:function(=
a){return =
this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a=
,c){a&&(c=3D(c||"fx")+"mark",f.data(a,c,(f.data(a,c,b,!0)||0)+1,!0))},_un=
mark:function(a,c,d){a!=3D=3D!0&&(d=3Dc,c=3Da,a=3D!1);if(c){d=3Dd||"fx";v=
ar =
e=3Dd+"mark",g=3Da?0:(f.data(c,e,b,!0)||1)-1;g?f.data(c,e,g,!0):(f.remove=
Data(c,e,!0),m(c,d,"mark"))}},queue:function(a,c,d){if(a){c=3D(c||"fx")+"=
queue";var =
e=3Df.data(a,c,b,!0);d&&(!e||f.isArray(d)?e=3Df.data(a,c,f.makeArray(d),!=
0):e.push(d));return e||[]}},dequeue:function(a,b){b=3Db||"fx";var =
c=3Df.queue(a,b),d=3Dc.shift(),e;d=3D=3D=3D"inprogress"&&(d=3Dc.shift()),=
d&&(b=3D=3D=3D"fx"&&c.unshift("inprogress"),d.call(a,function(){f.dequeue=
(a,b)})),c.length||(f.removeData(a,b+"queue",!0),m(a,b,"queue"))}}),f.fn.=
extend({queue:function(a,c){typeof =
a!=3D"string"&&(c=3Da,a=3D"fx");if(c=3D=3D=3Db)return =
f.queue(this[0],a);return this.each(function(){var =
b=3Df.queue(this,a,c);a=3D=3D=3D"fx"&&b[0]!=3D=3D"inprogress"&&f.dequeue(=
this,a)})},dequeue:function(a){return =
this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=3Df.fx?f.=
fx.speeds[a]||a:a,b=3Db||"fx";return this.queue(b,function(){var =
c=3Dthis;setTimeout(function(){f.dequeue(c,b)},a)})},clearQueue:function(=
a){return this.queue(a||"fx",[])},promise:function(a,c){function =
m(){--h||d.resolveWith(e,[e])}typeof =
a!=3D"string"&&(c=3Da,a=3Db),a=3Da||"fx";var =
d=3Df.Deferred(),e=3Dthis,g=3De.length,h=3D1,i=3Da+"defer",j=3Da+"queue",=
k=3Da+"mark",l;while(g--)if(l=3Df.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)=
||f.data(e[g],k,b,!0))&&f.data(e[g],i,f._Deferred(),!0))h++,l.done(m);m()=
;return d.promise()}});var =
n=3D/[\n\t\r]/g,o=3D/\s+/,p=3D/\r/g,q=3D/^(?:button|input)$/i,r=3D/^(?:bu=
tton|input|object|select|textarea)$/i,s=3D/^a(?:rea)?$/i,t=3D/^(?:autofoc=
us|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|op=
en|readonly|required|scoped|selected)$/i,u=3D/\:|^on/,v,w;f.fn.extend({at=
tr:function(a,b){return =
f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return =
this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return =
f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=3Df.propFix[a]||a;=
return this.each(function(){try{this[a]=3Db,delete =
this[a]}catch(c){}})},addClass:function(a){var =
b,c,d,e,g,h,i;if(f.isFunction(a))return =
this.each(function(b){f(this).addClass(a.call(this,b,this.className))});i=
f(a&&typeof =
a=3D=3D"string"){b=3Da.split(o);for(c=3D0,d=3Dthis.length;c<d;c++){e=3Dth=
is[c];if(e.nodeType=3D=3D=3D1)if(!e.className&&b.length=3D=3D=3D1)e.class=
Name=3Da;else{g=3D" "+e.className+" =
";for(h=3D0,i=3Db.length;h<i;h++)~g.indexOf(" "+b[h]+" ")||(g+=3Db[h]+" =
");e.className=3Df.trim(g)}}}return this},removeClass:function(a){var =
c,d,e,g,h,i,j;if(f.isFunction(a))return =
this.each(function(b){f(this).removeClass(a.call(this,b,this.className))}=
);if(a&&typeof =
a=3D=3D"string"||a=3D=3D=3Db){c=3D(a||"").split(o);for(d=3D0,e=3Dthis.len=
gth;d<e;d++){g=3Dthis[d];if(g.nodeType=3D=3D=3D1&&g.className)if(a){h=3D(=
" "+g.className+" ").replace(n," =
");for(i=3D0,j=3Dc.length;i<j;i++)h=3Dh.replace(" "+c[i]+" "," =
");g.className=3Df.trim(h)}else g.className=3D""}}return =
this},toggleClass:function(a,b){var c=3Dtypeof a,d=3Dtypeof =
b=3D=3D"boolean";if(f.isFunction(a))return =
this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b)=
,b)});return this.each(function(){if(c=3D=3D=3D"string"){var =
e,g=3D0,h=3Df(this),i=3Db,j=3Da.split(o);while(e=3Dj[g++])i=3Dd?i:!h.hasC=
lass(e),h[i?"addClass":"removeClass"](e)}else =
if(c=3D=3D=3D"undefined"||c=3D=3D=3D"boolean")this.className&&f._data(thi=
s,"__className__",this.className),this.className=3Dthis.className||a=3D=3D=
=3D!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var =
b=3D" "+a+" ";for(var c=3D0,d=3Dthis.length;c<d;c++)if((" =
"+this[c].className+" ").replace(n," =
").indexOf(b)>-1)return!0;return!1},val:function(a){var =
c,d,e=3Dthis[0];if(!arguments.length){if(e){c=3Df.valHooks[e.nodeName.toL=
owerCase()]||f.valHooks[e.type];if(c&&"get"in =
c&&(d=3Dc.get(e,"value"))!=3D=3Db)return d;d=3De.value;return typeof =
d=3D=3D"string"?d.replace(p,""):d=3D=3Dnull?"":d}return b}var =
g=3Df.isFunction(a);return this.each(function(d){var =
e=3Df(this),h;if(this.nodeType=3D=3D=3D1){g?h=3Da.call(this,d,e.val()):h=3D=
a,h=3D=3Dnull?h=3D"":typeof =
h=3D=3D"number"?h+=3D"":f.isArray(h)&&(h=3Df.map(h,function(a){return =
a=3D=3Dnull?"":a+""})),c=3Df.valHooks[this.nodeName.toLowerCase()]||f.val=
Hooks[this.type];if(!c||!("set"in =
c)||c.set(this,h,"value")=3D=3D=3Db)this.value=3Dh}})}}),f.extend({valHoo=
ks:{option:{get:function(a){var =
b=3Da.attributes.value;return!b||b.specified?a.value:a.text}},select:{get=
:function(a){var =
b,c=3Da.selectedIndex,d=3D[],e=3Da.options,g=3Da.type=3D=3D=3D"select-one=
";if(c<0)return null;for(var h=3Dg?c:0,i=3Dg?c+1:e.length;h<i;h++){var =
j=3De[h];if(j.selected&&(f.support.optDisabled?!j.disabled:j.getAttribute=
("disabled")=3D=3D=3Dnull)&&(!j.parentNode.disabled||!f.nodeName(j.parent=
Node,"optgroup"))){b=3Df(j).val();if(g)return =
b;d.push(b)}}if(g&&!d.length&&e.length)return f(e[c]).val();return =
d},set:function(a,b){var =
c=3Df.makeArray(b);f(a).find("option").each(function(){this.selected=3Df.=
inArray(f(this).val(),c)>=3D0}),c.length||(a.selectedIndex=3D-1);return =
c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,off=
set:!0},attrFix:{tabindex:"tabIndex"},attr:function(a,c,d,e){var =
g=3Da.nodeType;if(!a||g=3D=3D=3D3||g=3D=3D=3D8||g=3D=3D=3D2)return =
b;if(e&&c in f.attrFn)return f(a)[c](d);if(!("getAttribute"in a))return =
f.prop(a,c,d);var =
h,i,j=3Dg!=3D=3D1||!f.isXMLDoc(a);j&&(c=3Df.attrFix[c]||c,i=3Df.attrHooks=
[c],i||(t.test(c)?i=3Dw:v&&c!=3D=3D"className"&&(f.nodeName(a,"form")||u.=
test(c))&&(i=3Dv)));if(d!=3D=3Db){if(d=3D=3D=3Dnull){f.removeAttr(a,c);re=
turn b}if(i&&"set"in i&&j&&(h=3Di.set(a,d,c))!=3D=3Db)return =
h;a.setAttribute(c,""+d);return d}if(i&&"get"in =
i&&j&&(h=3Di.get(a,c))!=3D=3Dnull)return h;h=3Da.getAttribute(c);return =
h=3D=3D=3Dnull?b:h},removeAttr:function(a,b){var =
c;a.nodeType=3D=3D=3D1&&(b=3Df.attrFix[b]||b,f.support.getSetAttribute?a.=
removeAttribute(b):(f.attr(a,b,""),a.removeAttributeNode(a.getAttributeNo=
de(b))),t.test(b)&&(c=3Df.propFix[b]||b)in =
a&&(a[c]=3D!1))},attrHooks:{type:{set:function(a,b){if(q.test(a.nodeName)=
&&a.parentNode)f.error("type property can't be changed");else =
if(!f.support.radioValue&&b=3D=3D=3D"radio"&&f.nodeName(a,"input")){var =
c=3Da.value;a.setAttribute("type",b),c&&(a.value=3Dc);return =
b}}},tabIndex:{get:function(a){var =
c=3Da.getAttributeNode("tabIndex");return =
c&&c.specified?parseInt(c.value,10):r.test(a.nodeName)||s.test(a.nodeName=
)&&a.href?0:b}},value:{get:function(a,b){if(v&&f.nodeName(a,"button"))ret=
urn v.get(a,b);return b in =
a?a.value:null},set:function(a,b,c){if(v&&f.nodeName(a,"button"))return =
v.set(a,b,c);a.value=3Db}}},propFix:{tabindex:"tabIndex",readonly:"readOn=
ly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing=
:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSp=
an",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEdi=
table"},prop:function(a,c,d){var =
e=3Da.nodeType;if(!a||e=3D=3D=3D3||e=3D=3D=3D8||e=3D=3D=3D2)return b;var =
g,h,i=3De!=3D=3D1||!f.isXMLDoc(a);i&&(c=3Df.propFix[c]||c,h=3Df.propHooks=
[c]);return d!=3D=3Db?h&&"set"in =
h&&(g=3Dh.set(a,d,c))!=3D=3Db?g:a[c]=3Dd:h&&"get"in =
h&&(g=3Dh.get(a,c))!=3D=3Db?g:a[c]},propHooks:{}}),w=3D{get:function(a,c)=
{return f.prop(a,c)?c.toLowerCase():b},set:function(a,b,c){var =
d;b=3D=3D=3D!1?f.removeAttr(a,c):(d=3Df.propFix[c]||c,d in =
a&&(a[d]=3D!0),a.setAttribute(c,c.toLowerCase()));return =
c}},f.support.getSetAttribute||(f.attrFix=3Df.propFix,v=3Df.attrHooks.nam=
e=3Df.attrHooks.title=3Df.valHooks.button=3D{get:function(a,c){var =
d;d=3Da.getAttributeNode(c);return =
d&&d.nodeValue!=3D=3D""?d.nodeValue:b},set:function(a,b,c){var =
d=3Da.getAttributeNode(c);if(d){d.nodeValue=3Db;return =
b}}},f.each(["width","height"],function(a,b){f.attrHooks[b]=3Df.extend(f.=
attrHooks[b],{set:function(a,c){if(c=3D=3D=3D""){a.setAttribute(b,"auto")=
;return =
c}}})})),f.support.hrefNormalized||f.each(["href","src","width","height"]=
,function(a,c){f.attrHooks[c]=3Df.extend(f.attrHooks[c],{get:function(a){=
var d=3Da.getAttribute(c,2);return =
d=3D=3D=3Dnull?b:d}})}),f.support.style||(f.attrHooks.style=3D{get:functi=
on(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return =
a.style.cssText=3D""+b}}),f.support.optSelected||(f.propHooks.selected=3D=
f.extend(f.propHooks.selected,{get:function(a){var =
b=3Da.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedI=
ndex)}})),f.support.checkOn||f.each(["radio","checkbox"],function(){f.val=
Hooks[this]=3D{get:function(a){return =
a.getAttribute("value")=3D=3D=3Dnull?"on":a.value}}}),f.each(["radio","ch=
eckbox"],function(){f.valHooks[this]=3Df.extend(f.valHooks[this],{set:fun=
ction(a,b){if(f.isArray(b))return =
a.checked=3Df.inArray(f(a).val(),b)>=3D0}})});var =
x=3D/\.(.*)$/,y=3D/^(?:textarea|input|select)$/i,z=3D/\./g,A=3D/ =
/g,B=3D/[^\w\s.|`]/g,C=3Dfunction(a){return =
a.replace(B,"\\$&")};f.event=3D{add:function(a,c,d,e){if(a.nodeType!=3D=3D=
3&&a.nodeType!=3D=3D8){if(d=3D=3D=3D!1)d=3DD;else if(!d)return;var =
g,h;d.handler&&(g=3Dd,d=3Dg.handler),d.guid||(d.guid=3Df.guid++);var =
i=3Df._data(a);if(!i)return;var =
j=3Di.events,k=3Di.handle;j||(i.events=3Dj=3D{}),k||(i.handle=3Dk=3Dfunct=
ion(a){return typeof =
f!=3D"undefined"&&(!a||f.event.triggered!=3D=3Da.type)?f.event.handle.app=
ly(k.elem,arguments):b}),k.elem=3Da,c=3Dc.split(" ");var =
l,m=3D0,n;while(l=3Dc[m++]){h=3Dg?f.extend({},g):{handler:d,data:e},l.ind=
exOf(".")>-1?(n=3Dl.split("."),l=3Dn.shift(),h.namespace=3Dn.slice(0).sor=
t().join(".")):(n=3D[],h.namespace=3D""),h.type=3Dl,h.guid||(h.guid=3Dd.g=
uid);var =
o=3Dj[l],p=3Df.event.special[l]||{};if(!o){o=3Dj[l]=3D[];if(!p.setup||p.s=
etup.call(a,e,n,k)=3D=3D=3D!1)a.addEventListener?a.addEventListener(l,k,!=
1):a.attachEvent&&a.attachEvent("on"+l,k)}p.add&&(p.add.call(a,h),h.handl=
er.guid||(h.handler.guid=3Dd.guid)),o.push(h),f.event.global[l]=3D!0}a=3D=
null}},global:{},remove:function(a,c,d,e){if(a.nodeType!=3D=3D3&&a.nodeTy=
pe!=3D=3D8){d=3D=3D=3D!1&&(d=3DD);var =
g,h,i,j,k=3D0,l,m,n,o,p,q,r,s=3Df.hasData(a)&&f._data(a),t=3Ds&&s.events;=
if(!s||!t)return;c&&c.type&&(d=3Dc.handler,c=3Dc.type);if(!c||typeof =
c=3D=3D"string"&&c.charAt(0)=3D=3D=3D"."){c=3Dc||"";for(h in =
t)f.event.remove(a,h+c);return}c=3Dc.split(" =
");while(h=3Dc[k++]){r=3Dh,q=3Dnull,l=3Dh.indexOf(".")<0,m=3D[],l||(m=3Dh=
.split("."),h=3Dm.shift(),n=3Dnew =
RegExp("(^|\\.)"+f.map(m.slice(0).sort(),C).join("\\.(?:.*\\.)?")+"(\\.|$=
)")),p=3Dt[h];if(!p)continue;if(!d){for(j=3D0;j<p.length;j++){q=3Dp[j];if=
(l||n.test(q.namespace))f.event.remove(a,r,q.handler,j),p.splice(j--,1)}c=
ontinue}o=3Df.event.special[h]||{};for(j=3De||0;j<p.length;j++){q=3Dp[j];=
if(d.guid=3D=3D=3Dq.guid){if(l||n.test(q.namespace))e=3D=3Dnull&&p.splice=
(j--,1),o.remove&&o.remove.call(a,q);if(e!=3Dnull)break}}if(p.length=3D=3D=
=3D0||e!=3Dnull&&p.length=3D=3D=3D1)(!o.teardown||o.teardown.call(a,m)=3D=
=3D=3D!1)&&f.removeEvent(a,h,s.handle),g=3Dnull,delete =
t[h]}if(f.isEmptyObject(t)){var u=3Ds.handle;u&&(u.elem=3Dnull),delete =
s.events,delete =
s.handle,f.isEmptyObject(s)&&f.removeData(a,b,!0)}}},customEvent:{getData=
:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){var =
h=3Dc.type||c,i=3D[],j;h.indexOf("!")>=3D0&&(h=3Dh.slice(0,-1),j=3D!0),h.=
indexOf(".")>=3D0&&(i=3Dh.split("."),h=3Di.=0A=
shift(),i.sort());if(!!e&&!f.event.customEvent[h]||!!f.event.global[h]){c=
=3Dtypeof c=3D=3D"object"?c[f.expando]?c:new f.Event(h,c):new =
f.Event(h),c.type=3Dh,c.exclusive=3Dj,c.namespace=3Di.join("."),c.namespa=
ce_re=3Dnew =
RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)");if(g||!e)c.preventDef=
ault(),c.stopPropagation();if(!e){f.each(f.cache,function(){var =
a=3Df.expando,b=3Dthis[a];b&&b.events&&b.events[h]&&f.event.trigger(c,d,b=
.handle.elem)});return}if(e.nodeType=3D=3D=3D3||e.nodeType=3D=3D=3D8)retu=
rn;c.result=3Db,c.target=3De,d=3Dd!=3Dnull?f.makeArray(d):[],d.unshift(c)=
;var k=3De,l=3Dh.indexOf(":")<0?"on"+h:"";do{var =
m=3Df._data(k,"handle");c.currentTarget=3Dk,m&&m.apply(k,d),l&&f.acceptDa=
ta(k)&&k[l]&&k[l].apply(k,d)=3D=3D=3D!1&&(c.result=3D!1,c.preventDefault(=
)),k=3Dk.parentNode||k.ownerDocument||k=3D=3D=3Dc.target.ownerDocument&&a=
}while(k&&!c.isPropagationStopped());if(!c.isDefaultPrevented()){var =
n,o=3Df.event.special[h]||{};if((!o._default||o._default.call(e.ownerDocu=
ment,c)=3D=3D=3D!1)&&(h!=3D=3D"click"||!f.nodeName(e,"a"))&&f.acceptData(=
e)){try{l&&e[h]&&(n=3De[l],n&&(e[l]=3Dnull),f.event.triggered=3Dh,e[h]())=
}catch(p){}n&&(e[l]=3Dn),f.event.triggered=3Db}}return =
c.result}},handle:function(c){c=3Df.event.fix(c||a.event);var =
d=3D((f._data(this,"events")||{})[c.type]||[]).slice(0),e=3D!c.exclusive&=
&!c.namespace,g=3DArray.prototype.slice.call(arguments,0);g[0]=3Dc,c.curr=
entTarget=3Dthis;for(var h=3D0,i=3Dd.length;h<i;h++){var =
j=3Dd[h];if(e||c.namespace_re.test(j.namespace)){c.handler=3Dj.handler,c.=
data=3Dj.data,c.handleObj=3Dj;var =
k=3Dj.handler.apply(this,g);k!=3D=3Db&&(c.result=3Dk,k=3D=3D=3D!1&&(c.pre=
ventDefault(),c.stopPropagation()));if(c.isImmediatePropagationStopped())=
break}}return c.result},props:"altKey attrChange attrName bubbles button =
cancelable charCode clientX clientY ctrlKey currentTarget data detail =
eventPhase fromElement handler keyCode layerX layerY metaKey newValue =
offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX =
screenY shiftKey srcElement target toElement view wheelDelta =
which".split(" "),fix:function(a){if(a[f.expando])return a;var =
d=3Da;a=3Df.Event(d);for(var =
e=3Dthis.props.length,g;e;)g=3Dthis.props[--e],a[g]=3Dd[g];a.target||(a.t=
arget=3Da.srcElement||c),a.target.nodeType=3D=3D=3D3&&(a.target=3Da.targe=
t.parentNode),!a.relatedTarget&&a.fromElement&&(a.relatedTarget=3Da.fromE=
lement=3D=3D=3Da.target?a.toElement:a.fromElement);if(a.pageX=3D=3Dnull&&=
a.clientX!=3Dnull){var =
h=3Da.target.ownerDocument||c,i=3Dh.documentElement,j=3Dh.body;a.pageX=3D=
a.clientX+(i&&i.scrollLeft||j&&j.scrollLeft||0)-(i&&i.clientLeft||j&&j.cl=
ientLeft||0),a.pageY=3Da.clientY+(i&&i.scrollTop||j&&j.scrollTop||0)-(i&&=
i.clientTop||j&&j.clientTop||0)}a.which=3D=3Dnull&&(a.charCode!=3Dnull||a=
.keyCode!=3Dnull)&&(a.which=3Da.charCode!=3Dnull?a.charCode:a.keyCode),!a=
.metaKey&&a.ctrlKey&&(a.metaKey=3Da.ctrlKey),!a.which&&a.button!=3D=3Db&&=
(a.which=3Da.button&1?1:a.button&2?3:a.button&4?2:0);return =
a},guid:1e8,proxy:f.proxy,special:{ready:{setup:f.bindReady,teardown:f.no=
op},live:{add:function(a){f.event.add(this,N(a.origType,a.selector),f.ext=
end({},a,{handler:M,guid:a.handler.guid}))},remove:function(a){f.event.re=
move(this,N(a.origType,a.selector),a)}},beforeunload:{setup:function(a,b,=
c){f.isWindow(this)&&(this.onbeforeunload=3Dc)},teardown:function(a,b){th=
is.onbeforeunload=3D=3D=3Db&&(this.onbeforeunload=3Dnull)}}}},f.removeEve=
nt=3Dc.removeEventListener?function(a,b,c){a.removeEventListener&&a.remov=
eEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"=
+b,c)},f.Event=3Dfunction(a,b){if(!this.preventDefault)return new =
f.Event(a,b);a&&a.type?(this.originalEvent=3Da,this.type=3Da.type,this.is=
DefaultPrevented=3Da.defaultPrevented||a.returnValue=3D=3D=3D!1||a.getPre=
ventDefault&&a.getPreventDefault()?E:D):this.type=3Da,b&&f.extend(this,b)=
,this.timeStamp=3Df.now(),this[f.expando]=3D!0},f.Event.prototype=3D{prev=
entDefault:function(){this.isDefaultPrevented=3DE;var =
a=3Dthis.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnV=
alue=3D!1)},stopPropagation:function(){this.isPropagationStopped=3DE;var =
a=3Dthis.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.canc=
elBubble=3D!0)},stopImmediatePropagation:function(){this.isImmediatePropa=
gationStopped=3DE,this.stopPropagation()},isDefaultPrevented:D,isPropagat=
ionStopped:D,isImmediatePropagationStopped:D};var F=3Dfunction(a){var =
b=3Da.relatedTarget,c=3D!1,d=3Da.type;a.type=3Da.data,b!=3D=3Dthis&&(b&&(=
c=3Df.contains(this,b)),c||(f.event.handle.apply(this,arguments),a.type=3D=
d))},G=3Dfunction(a){a.type=3Da.data,f.event.handle.apply(this,arguments)=
};f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.e=
vent.special[a]=3D{setup:function(c){f.event.add(this,b,c&&c.selector?G:F=
,a)},teardown:function(a){f.event.remove(this,b,a&&a.selector?G:F)}}}),f.=
support.submitBubbles||(f.event.special.submit=3D{setup:function(a,b){if(=
!f.nodeName(this,"form"))f.event.add(this,"click.specialSubmit",function(=
a){var =
b=3Da.target,c=3Db.type;(c=3D=3D=3D"submit"||c=3D=3D=3D"image")&&f(b).clo=
sest("form").length&&K("submit",this,arguments)}),f.event.add(this,"keypr=
ess.specialSubmit",function(a){var =
b=3Da.target,c=3Db.type;(c=3D=3D=3D"text"||c=3D=3D=3D"password")&&f(b).cl=
osest("form").length&&a.keyCode=3D=3D=3D13&&K("submit",this,arguments)});=
else =
return!1},teardown:function(a){f.event.remove(this,".specialSubmit")}});i=
f(!f.support.changeBubbles){var H,I=3Dfunction(a){var =
b=3Da.type,c=3Da.value;b=3D=3D=3D"radio"||b=3D=3D=3D"checkbox"?c=3Da.chec=
ked:b=3D=3D=3D"select-multiple"?c=3Da.selectedIndex>-1?f.map(a.options,fu=
nction(a){return =
a.selected}).join("-"):"":f.nodeName(a,"select")&&(c=3Da.selectedIndex);r=
eturn c},J=3Dfunction(c){var =
d=3Dc.target,e,g;if(!!y.test(d.nodeName)&&!d.readOnly){e=3Df._data(d,"_ch=
ange_data"),g=3DI(d),(c.type!=3D=3D"focusout"||d.type!=3D=3D"radio")&&f._=
data(d,"_change_data",g);if(e=3D=3D=3Db||g=3D=3D=3De)return;if(e!=3Dnull|=
|g)c.type=3D"change",c.liveFired=3Db,f.event.trigger(c,arguments[1],d)}};=
f.event.special.change=3D{filters:{focusout:J,beforedeactivate:J,click:fu=
nction(a){var =
b=3Da.target,c=3Df.nodeName(b,"input")?b.type:"";(c=3D=3D=3D"radio"||c=3D=
=3D=3D"checkbox"||f.nodeName(b,"select"))&&J.call(this,a)},keydown:functi=
on(a){var =
b=3Da.target,c=3Df.nodeName(b,"input")?b.type:"";(a.keyCode=3D=3D=3D13&&!=
f.nodeName(b,"textarea")||a.keyCode=3D=3D=3D32&&(c=3D=3D=3D"checkbox"||c=3D=
=3D=3D"radio")||c=3D=3D=3D"select-multiple")&&J.call(this,a)},beforeactiv=
ate:function(a){var =
b=3Da.target;f._data(b,"_change_data",I(b))}},setup:function(a,b){if(this=
.type=3D=3D=3D"file")return!1;for(var c in =
H)f.event.add(this,c+".specialChange",H[c]);return =
y.test(this.nodeName)},teardown:function(a){f.event.remove(this,".special=
Change");return =
y.test(this.nodeName)}},H=3Df.event.special.change.filters,H.focus=3DH.be=
foreactivate}f.support.focusinBubbles||f.each({focus:"focusin",blur:"focu=
sout"},function(a,b){function e(a){var =
c=3Df.event.fix(a);c.type=3Db,c.originalEvent=3D{},f.event.trigger(c,null=
,c.target),c.isDefaultPrevented()&&a.preventDefault()}var =
d=3D0;f.event.special[b]=3D{setup:function(){d++=3D=3D=3D0&&c.addEventLis=
tener(a,e,!0)},teardown:function(){--d=3D=3D=3D0&&c.removeEventListener(a=
,e,!0)}}}),f.each(["bind","one"],function(a,c){f.fn[c]=3Dfunction(a,d,e){=
var g;if(typeof a=3D=3D"object"){for(var h in =
a)this[c](h,d,a[h],e);return =
this}if(arguments.length=3D=3D=3D2||d=3D=3D=3D!1)e=3Dd,d=3Db;c=3D=3D=3D"o=
ne"?(g=3Dfunction(a){f(this).unbind(a,g);return =
e.apply(this,arguments)},g.guid=3De.guid||f.guid++):g=3De;if(a=3D=3D=3D"u=
nload"&&c!=3D=3D"one")this.one(a,d,e);else for(var =
i=3D0,j=3Dthis.length;i<j;i++)f.event.add(this[i],a,g,d);return =
this}}),f.fn.extend({unbind:function(a,b){if(typeof =
a=3D=3D"object"&&!a.preventDefault)for(var c in =
a)this.unbind(c,a[c]);else for(var =
d=3D0,e=3Dthis.length;d<e;d++)f.event.remove(this[d],a,b);return =
this},delegate:function(a,b,c,d){return =
this.live(b,c,d,a)},undelegate:function(a,b,c){return =
arguments.length=3D=3D=3D0?this.unbind("live"):this.die(b,null,c,a)},trig=
ger:function(a,b){return =
this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function=
(a,b){if(this[0])return =
f.event.trigger(a,b,this[0],!0)},toggle:function(a){var =
b=3Darguments,c=3Da.guid||f.guid++,d=3D0,e=3Dfunction(c){var =
e=3D(f.data(this,"lastToggle"+a.guid)||0)%d;f.data(this,"lastToggle"+a.gu=
id,e+1),c.preventDefault();return =
b[e].apply(this,arguments)||!1};e.guid=3Dc;while(d<b.length)b[d++].guid=3D=
c;return this.click(e)},hover:function(a,b){return =
this.mouseenter(a).mouseleave(b||a)}});var =
L=3D{focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"m=
ouseout"};f.each(["live","die"],function(a,c){f.fn[c]=3Dfunction(a,d,e,g)=
{var =
h,i=3D0,j,k,l,m=3Dg||this.selector,n=3Dg?this:f(this.context);if(typeof =
a=3D=3D"object"&&!a.preventDefault){for(var o in =
a)n[c](o,d,a[o],m);return =
this}if(c=3D=3D=3D"die"&&!a&&g&&g.charAt(0)=3D=3D=3D"."){n.unbind(g);retu=
rn =
this}if(d=3D=3D=3D!1||f.isFunction(d))e=3Dd||D,d=3Db;a=3D(a||"").split(" =
");while((h=3Da[i++])!=3Dnull){j=3Dx.exec(h),k=3D"",j&&(k=3Dj[0],h=3Dh.re=
place(x,""));if(h=3D=3D=3D"hover"){a.push("mouseenter"+k,"mouseleave"+k);=
continue}l=3Dh,L[h]?(a.push(L[h]+k),h=3Dh+k):h=3D(L[h]||h)+k;if(c=3D=3D=3D=
"live")for(var =
p=3D0,q=3Dn.length;p<q;p++)f.event.add(n[p],"live."+N(h,m),{data:d,select=
or:m,handler:e,origType:h,origHandler:e,preType:l});else =
n.unbind("live."+N(h,m),e)}return this}}),f.each("blur focus focusin =
focusout load resize scroll unload click dblclick mousedown mouseup =
mousemove mouseover mouseout mouseenter mouseleave change select submit =
keydown keypress keyup error".split(" =
"),function(a,b){f.fn[b]=3Dfunction(a,c){c=3D=3Dnull&&(c=3Da,a=3Dnull);re=
turn =
arguments.length>0?this.bind(b,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[=
b]=3D!0)}),function(){function u(a,b,c,d,e,f){for(var =
g=3D0,h=3Dd.length;g<h;g++){var i=3Dd[g];if(i){var =
j=3D!1;i=3Di[a];while(i){if(i.sizcache=3D=3D=3Dc){j=3Dd[i.sizset];break}i=
f(i.nodeType=3D=3D=3D1){f||(i.sizcache=3Dc,i.sizset=3Dg);if(typeof =
b!=3D"string"){if(i=3D=3D=3Db){j=3D!0;break}}else =
if(k.filter(b,[i]).length>0){j=3Di;break}}i=3Di[a]}d[g]=3Dj}}}function =
t(a,b,c,d,e,f){for(var g=3D0,h=3Dd.length;g<h;g++){var =
i=3Dd[g];if(i){var =
j=3D!1;i=3Di[a];while(i){if(i.sizcache=3D=3D=3Dc){j=3Dd[i.sizset];break}i=
.nodeType=3D=3D=3D1&&!f&&(i.sizcache=3Dc,i.sizset=3Dg);if(i.nodeName.toLo=
werCase()=3D=3D=3Db){j=3Di;break}i=3Di[a]}d[g]=3Dj}}}var =
a=3D/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[=
\]'"]+)+\]|\\.|[^ =
>+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d=3D0,e=3DObject.prototype=
.toString,g=3D!1,h=3D!0,i=3D/\\/g,j=3D/\W/;[0,0].sort(function(){h=3D!1;r=
eturn 0});var k=3Dfunction(b,d,f,g){f=3Df||[],d=3Dd||c;var =
h=3Dd;if(d.nodeType!=3D=3D1&&d.nodeType!=3D=3D9)return[];if(!b||typeof =
b!=3D"string")return f;var =
i,j,n,o,q,r,s,t,u=3D!0,w=3Dk.isXML(d),x=3D[],y=3Db;do{a.exec(""),i=3Da.ex=
ec(y);if(i){y=3Di[3],x.push(i[1]);if(i[2]){o=3Di[3];break}}}while(i);if(x=
.length>1&&m.exec(b))if(x.length=3D=3D=3D2&&l.relative[x[0]])j=3Dv(x[0]+x=
[1],d);else{j=3Dl.relative[x[0]]?[d]:k(x.shift(),d);while(x.length)b=3Dx.=
shift(),l.relative[b]&&(b+=3Dx.shift()),j=3Dv(b,j)}else{!g&&x.length>1&&d=
.nodeType=3D=3D=3D9&&!w&&l.match.ID.test(x[0])&&!l.match.ID.test(x[x.leng=
th-1])&&(q=3Dk.find(x.shift(),d,w),d=3Dq.expr?k.filter(q.expr,q.set)[0]:q=
.set[0]);if(d){q=3Dg?{expr:x.pop(),set:p(g)}:k.find(x.pop(),x.length=3D=3D=
=3D1&&(x[0]=3D=3D=3D"~"||x[0]=3D=3D=3D"+")&&d.parentNode?d.parentNode:d,w=
),j=3Dq.expr?k.filter(q.expr,q.set):q.set,x.length>0?n=3Dp(j):u=3D!1;whil=
e(x.length)r=3Dx.pop(),s=3Dr,l.relative[r]?s=3Dx.pop():r=3D"",s=3D=3Dnull=
&&(s=3Dd),l.relative[r](n,s,w)}else =
n=3Dx=3D[]}n||(n=3Dj),n||k.error(r||b);if(e.call(n)=3D=3D=3D"[object =
Array]")if(!u)f.push.apply(f,n);else =
if(d&&d.nodeType=3D=3D=3D1)for(t=3D0;n[t]!=3Dnull;t++)n[t]&&(n[t]=3D=3D=3D=
!0||n[t].nodeType=3D=3D=3D1&&k.contains(d,n[t]))&&f.push(j[t]);else =
for(t=3D0;n[t]!=3Dnull;t++)n[t]&&n[t].nodeType=3D=3D=3D1&&f.push(j[t]);el=
se p(n,f);o&&(k(o,h,f,g),k.uniqueSort(f));return =
f};k.uniqueSort=3Dfunction(a){if(r){g=3Dh,a.sort(r);if(g)for(var =
b=3D1;b<a.length;b++)a[b]=3D=3D=3Da[b-1]&&a.splice(b--,1)}return =
a},k.matches=3Dfunction(a,b){return =
k(a,null,null,b)},k.matchesSelector=3Dfunction(a,b){return =
k(b,null,null,[a]).length>0},k.find=3Dfunction(a,b,c){var =
d;if(!a)return[];for(var e=3D0,f=3Dl.order.length;e<f;e++){var =
g,h=3Dl.order[e];if(g=3Dl.leftMatch[h].exec(a)){var =
j=3Dg[1];g.splice(1,1);if(j.substr(j.length-1)!=3D=3D"\\"){g[1]=3D(g[1]||=
"").replace(i,""),d=3Dl.find[h](g,b,c);if(d!=3Dnull){a=3Da.replace(l.matc=
h[h],"");break}}}}d||(d=3Dtypeof =
b.getElementsByTagName!=3D"undefined"?b.getElementsByTagName("*"):[]);ret=
urn{set:d,expr:a}},k.filter=3Dfunction(a,c,d,e){var =
f,g,h=3Da,i=3D[],j=3Dc,m=3Dc&&c[0]&&k.isXML(c[0]);while(a&&c.length){for(=
var n in l.filter)if((f=3Dl.leftMatch[n].exec(a))!=3Dnull&&f[2]){var =
o,p,q=3Dl.filter[n],r=3Df[1];g=3D!1,f.splice(1,1);if(r.substr(r.length-1)=
=3D=3D=3D"\\")continue;j=3D=3D=3Di&&(i=3D[]);if(l.preFilter[n]){f=3Dl.pre=
Filter[n](f,j,d,i,e,m);if(!f)g=3Do=3D!0;else =
if(f=3D=3D=3D!0)continue}if(f)for(var =
s=3D0;(p=3Dj[s])!=3Dnull;s++)if(p){o=3Dq(p,f,s,j);var =
t=3De^!!o;d&&o!=3Dnull?t?g=3D!0:j[s]=3D!1:t&&(i.push(p),g=3D!0)}if(o!=3D=3D=
b){d||(j=3Di),a=3Da.replace(l.match[n],"");if(!g)return[];break}}if(a=3D=3D=
=3Dh)if(g=3D=3Dnull)k.error(a);else break;h=3Da}return =
j},k.error=3Dfunction(a){throw"Syntax error, unrecognized expression: =
"+a};var =
l=3Dk.selectors=3D{order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\u=
FFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=3D[=
'"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFF=
F\-]|\\.)+)\s*(?:(\S?=3D)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\=
.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|=
last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-=
]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))=
?(?=3D[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\(=
[^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","f=
or":"htmlFor"},attrHandle:{href:function(a){return =
a.getAttribute("href")},type:function(a){return =
a.getAttribute("type")}},relative:{"+":function(a,b){var c=3Dtypeof =
b=3D=3D"string",d=3Dc&&!j.test(b),e=3Dc&&!d;d&&(b=3Db.toLowerCase());for(=
var =
f=3D0,g=3Da.length,h;f<g;f++)if(h=3Da[f]){while((h=3Dh.previousSibling)&&=
h.nodeType!=3D=3D1);a[f]=3De||h&&h.nodeName.toLowerCase()=3D=3D=3Db?h||!1=
:h=3D=3D=3Db}e&&k.filter(b,a,!0)},">":function(a,b){var c,d=3Dtypeof =
b=3D=3D"string",e=3D0,f=3Da.length;if(d&&!j.test(b)){b=3Db.toLowerCase();=
for(;e<f;e++){c=3Da[e];if(c){var =
g=3Dc.parentNode;a[e]=3Dg.nodeName.toLowerCase()=3D=3D=3Db?g:!1}}}else{fo=
r(;e<f;e++)c=3Da[e],c&&(a[e]=3Dd?c.parentNode:c.parentNode=3D=3D=3Db);d&&=
k.filter(b,a,!0)}},"":function(a,b,c){var e,f=3Dd++,g=3Du;typeof =
b=3D=3D"string"&&!j.test(b)&&(b=3Db.toLowerCase(),e=3Db,g=3Dt),g("parentN=
ode",b,f,a,e,c)},"~":function(a,b,c){var e,f=3Dd++,g=3Du;typeof =
b=3D=3D"string"&&!j.test(b)&&(b=3Db.toLowerCase(),e=3Db,g=3Dt),g("previou=
sSibling",b,f,a,e,c)}},find:{ID:function(a,b,c){if(typeof =
b.getElementById!=3D"undefined"&&!c){var =
d=3Db.getElementById(a[1]);return =
d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof =
b.getElementsByName!=3D"undefined"){var =
c=3D[],d=3Db.getElementsByName(a[1]);for(var =
e=3D0,f=3Dd.length;e<f;e++)d[e].getAttribute("name")=3D=3D=3Da[1]&&c.push=
(d[e]);return c.length=3D=3D=3D0?null:c}},TAG:function(a,b){if(typeof =
b.getElementsByTagName!=3D"undefined")return =
b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=3D=
" "+a[1].replace(i,"")+" ";if(f)return a;for(var =
g=3D0,h;(h=3Db[g])!=3Dnull;g++)h&&(e^(h.className&&(" "+h.className+" =
").replace(/[\t\n\r]/g," =
").indexOf(a)>=3D0)?c||d.push(h):c&&(b[g]=3D!1));return!1},ID:function(a)=
{return a[1].replace(i,"")},TAG:function(a,b){return =
a[1].replace(i,"").toLowerCase()},CHILD:function(a){if(a[1]=3D=3D=3D"nth"=
){a[2]||k.error(a[0]),a[2]=3Da[2].replace(/^\+|\s*/g,"");var =
b=3D/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]=3D=3D=3D"even"&&"2n"||a[2]=3D=3D=
=3D"odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=3Db[1]+(b[2]||=
1)-0,a[3]=3Db[3]-0}else a[2]&&k.error(a[0]);a[0]=3Dd++;return =
a},ATTR:function(a,b,c,d,e,f){var =
g=3Da[1]=3Da[1].replace(i,"");!f&&l.attrMap[g]&&(a[1]=3Dl.attrMap[g]),a[4=
]=3D(a[4]||a[5]||"").replace(i,""),a[2]=3D=3D=3D"~=3D"&&(a[4]=3D" =
"+a[4]+" ");return =
a},PSEUDO:function(b,c,d,e,f){if(b[1]=3D=3D=3D"not")if((a.exec(b[3])||"")=
.length>1||/^\w/.test(b[3]))b[3]=3Dk(b[3],null,null,c);else{var =
g=3Dk.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else =
if(l.match.POS.test(b[0])||l.match.CHILD.test(b[0]))return!0;return =
b},POS:function(a){a.unshift(!0);return =
a}},filters:{enabled:function(a){return =
a.disabled=3D=3D=3D!1&&a.type!=3D=3D"hidden"},disabled:function(a){return=
 a.disabled=3D=3D=3D!0},checked:function(a){return =
a.checked=3D=3D=3D!0},selected:function(a){a.parentNode&&a.parentNode.sel=
ectedIndex;return =
a.selected=3D=3D=3D!0},parent:function(a){return!!a.firstChild},empty:fun=
ction(a){return!a.firstChild},has:function(a,b,c){return!!k(c[3],a).lengt=
h},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var=
 b=3Da.getAttribute("type"),c=3Da.type;return =
a.nodeName.toLowerCase()=3D=3D=3D"input"&&"text"=3D=3D=3Dc&&(b=3D=3D=3Dc|=
|b=3D=3D=3Dnull)},radio:function(a){return =
a.nodeName.toLowerCase()=3D=3D=3D"input"&&"radio"=3D=3D=3Da.type},checkbo=
x:function(a){return =
a.nodeName.toLowerCase()=3D=3D=3D"input"&&"checkbox"=3D=3D=3Da.type},file=
:function(a){return =
a.nodeName.toLowerCase()=3D=3D=3D"input"&&"file"=3D=3D=3Da.type},password=
:function(a){return =
a.nodeName.toLowerCase()=3D=3D=3D"input"&&"password"=3D=3D=3Da.type},subm=
it:function(a){var =
b=3Da.nodeName.toLowerCase();return(b=3D=3D=3D"input"||b=3D=3D=3D"button"=
)&&"submit"=3D=3D=3Da.type},image:function(a){return =
a.nodeName.toLowerCase()=3D=3D=3D"input"&&"image"=3D=3D=3Da.type},reset:f=
unction(a){var =
b=3Da.nodeName.toLowerCase();return(b=3D=3D=3D"input"||b=3D=3D=3D"button"=
)&&"reset"=3D=3D=3Da.type},button:function(a){var =
b=3Da.nodeName.toLowerCase();return =
b=3D=3D=3D"input"&&"button"=3D=3D=3Da.type||b=3D=3D=3D"button"},input:fun=
ction(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:fu=
nction(a){return =
a=3D=3D=3Da.ownerDocument.activeElement}},setFilters:{first:function(a,b)=
{return b=3D=3D=3D0},last:function(a,b,c,d){return =
b=3D=3D=3Dd.length-1},even:function(a,b){return =
b%2=3D=3D=3D0},odd:function(a,b){return =
b%2=3D=3D=3D1},lt:function(a,b,c){return =
b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return =
c[3]-0=3D=3D=3Db},eq:function(a,b,c){return =
c[3]-0=3D=3D=3Db}},filter:{PSEUDO:function(a,b,c,d){var =
e=3Db[1],f=3Dl.filters[e];if(f)return =
f(a,c,b,d);if(e=3D=3D=3D"contains")return(a.textContent||a.innerText||k.g=
etText([a])||"").indexOf(b[3])>=3D0;if(e=3D=3D=3D"not"){var =
g=3Db[3];for(var =
h=3D0,i=3Dg.length;h<i;h++)if(g[h]=3D=3D=3Da)return!1;return!0}k.error(e)=
},CHILD:function(a,b){var =
c=3Db[1],d=3Da;switch(c){case"only":case"first":while(d=3Dd.previousSibli=
ng)if(d.nodeType=3D=3D=3D1)return!1;if(c=3D=3D=3D"first")return!0;d=3Da;c=
ase"last":while(d=3Dd.nextSibling)if(d.nodeType=3D=3D=3D1)return!1;return=
!0;case"nth":var =
e=3Db[2],f=3Db[3];if(e=3D=3D=3D1&&f=3D=3D=3D0)return!0;var =
g=3Db[0],h=3Da.parentNode;if(h&&(h.sizcache!=3D=3Dg||!a.nodeIndex)){var =
i=3D0;for(d=3Dh.firstChild;d;d=3Dd.nextSibling)d.nodeType=3D=3D=3D1&&(d.n=
odeIndex=3D++i);h.sizcache=3Dg}var j=3Da.nodeIndex-f;return =
e=3D=3D=3D0?j=3D=3D=3D0:j%e=3D=3D=3D0&&j/e>=3D0}},ID:function(a,b){return=
 =
a.nodeType=3D=3D=3D1&&a.getAttribute("id")=3D=3D=3Db},TAG:function(a,b){r=
eturn =
b=3D=3D=3D"*"&&a.nodeType=3D=3D=3D1||a.nodeName.toLowerCase()=3D=3D=3Db},=
CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" =
").indexOf(b)>-1},ATTR:function(a,b){var =
c=3Db[1],d=3Dl.attrHandle[c]?l.attrHandle[c](a):a[c]!=3Dnull?a[c]:a.getAt=
tribute(c),e=3Dd+"",f=3Db[2],g=3Db[4];return =
d=3D=3Dnull?f=3D=3D=3D"!=3D":f=3D=3D=3D"=3D"?e=3D=3D=3Dg:f=3D=3D=3D"*=3D"=
?e.indexOf(g)>=3D0:f=3D=3D=3D"~=3D"?(" "+e+" =
").indexOf(g)>=3D0:g?f=3D=3D=3D"!=3D"?e!=3D=3Dg:f=3D=3D=3D"^=3D"?e.indexO=
f(g)=3D=3D=3D0:f=3D=3D=3D"$=3D"?e.substr(e.length-g.length)=3D=3D=3Dg:f=3D=
=3D=3D"|=3D"?e=3D=3D=3Dg||e.substr(0,g.length+1)=3D=3D=3Dg+"-":!1:e&&d!=3D=
=3D!1},POS:function(a,b,c,d){var =
e=3Db[2],f=3Dl.setFilters[e];if(f)return =
f(a,c,b,d)}}},m=3Dl.match.POS,n=3Dfunction(a,b){return"\\"+(b-0+1)};for(v=
ar o in l.match)l.match[o]=3Dnew =
RegExp(l.match[o].source+/(?![^\[]*\])(?![^\(]*\))/.source),l.leftMatch[o=
]=3Dnew =
RegExp(/(^(?:.|\r|\n)*?)/.source+l.match[o].source.replace(/\\(\d+)/g,n))=
;var =
p=3Dfunction(a,b){a=3DArray.prototype.slice.call(a,0);if(b){b.push.apply(=
b,a);return b}return =
a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].node=
Type}catch(q){p=3Dfunction(a,b){var =
c=3D0,d=3Db||[];if(e.call(a)=3D=3D=3D"[object =
Array]")Array.prototype.push.apply(d,a);else if(typeof =
a.length=3D=3D"number")for(var f=3Da.length;c<f;c++)d.push(a[c]);else =
for(;a[c];c++)d.push(a[c]);return d}}var =
r,s;c.documentElement.compareDocumentPosition?r=3Dfunction(a,b){if(a=3D=3D=
=3Db){g=3D!0;return =
0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return =
a.compareDocumentPosition?-1:1;return =
a.compareDocumentPosition(b)&4?-1:1}:(r=3Dfunction(a,b){if(a=3D=3D=3Db){g=
=3D!0;return 0}if(a.sourceIndex&&b.sourceIndex)return =
a.sourceIndex-b.sourceIndex;var =
c,d,e=3D[],f=3D[],h=3Da.parentNode,i=3Db.parentNode,j=3Dh;if(h=3D=3D=3Di)=
return s(a,b);if(!h)return-1;if(!i)return =
1;while(j)e.unshift(j),j=3Dj.parentNode;j=3Di;while(j)f.unshift(j),j=3Dj.=
parentNode;c=3De.length,d=3Df.length;for(var =
k=3D0;k<c&&k<d;k++)if(e[k]!=3D=3Df[k])return s(e[k],f[k]);return =
k=3D=3D=3Dc?s(a,f[k],-1):s(e[k],b,1)},s=3Dfunction(a,b,c){if(a=3D=3D=3Db)=
return c;var =
d=3Da.nextSibling;while(d){if(d=3D=3D=3Db)return-1;d=3Dd.nextSibling}retu=
rn 1}),k.getText=3Dfunction(a){var b=3D"",c;for(var =
d=3D0;a[d];d++)c=3Da[d],c.nodeType=3D=3D=3D3||c.nodeType=3D=3D=3D4?b+=3Dc=
.nodeValue:c.nodeType!=3D=3D8&&(b+=3Dk.getText(c.childNodes));return =
b},function(){var a=3Dc.createElement("div"),d=3D"script"+(new =
Date).getTime(),e=3Dc.documentElement;a.innerHTML=3D"<a =
name=3D'"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(l.=
find.ID=3Dfunction(a,c,d){if(typeof =
c.getElementById!=3D"undefined"&&!d){var =
e=3Dc.getElementById(a[1]);return e?e.id=3D=3D=3Da[1]||typeof =
e.getAttributeNode!=3D"undefined"&&e.getAttributeNode("id").nodeValue=3D=3D=
=3Da[1]?[e]:b:[]}},l.filter.ID=3Dfunction(a,b){var c=3Dtypeof =
a.getAttributeNode!=3D"undefined"&&a.getAttributeNode("id");return =
a.nodeType=3D=3D=3D1&&c&&c.nodeValue=3D=3D=3Db}),e.removeChild(a),e=3Da=3D=
null}(),function(){var =
a=3Dc.createElement("div");a.appendChild(c.createComment("")),a.getElemen=
tsByTagName("*").length>0&&(l.find.TAG=3Dfunction(a,b){var =
c=3Db.getElementsByTagName(a[1]);if(a[1]=3D=3D=3D"*"){var d=3D[];for(var =
e=3D0;c[e];e++)c[e].nodeType=3D=3D=3D1&&d.push(c[e]);c=3Dd}return =
c}),a.innerHTML=3D"<a href=3D'#'></a>",a.firstChild&&typeof =
a.firstChild.getAttribute!=3D"undefined"&&a.firstChild.getAttribute("href=
")!=3D=3D"#"&&(l.attrHandle.href=3Dfunction(a){return =
a.getAttribute("href",2)}),a=3Dnull}(),c.querySelectorAll&&function(){var=
 a=3Dk,b=3Dc.createElement("div"),d=3D"__sizzle__";b.innerHTML=3D"<p =
class=3D'TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").=
length!=3D=3D0){k=3Dfunction(b,e,f,g){e=3De||c;if(!g&&!k.isXML(e)){var =
h=3D/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType=3D=3D=3D=
1||e.nodeType=3D=3D=3D9)){if(h[1])return =
p(e.getElementsByTagName(b),f);if(h[2]&&l.find.CLASS&&e.getElementsByClas=
sName)return =
p(e.getElementsByClassName(h[2]),f)}if(e.nodeType=3D=3D=3D9){if(b=3D=3D=3D=
"body"&&e.body)return p([e.body],f);if(h&&h[3]){var =
i=3De.getElementById(h[3]);if(!i||!i.parentNode)return =
p([],f);if(i.id=3D=3D=3Dh[3])return p([i],f)}try{return =
p(e.querySelectorAll(b),f)}catch(j){}}else =
if(e.nodeType=3D=3D=3D1&&e.nodeName.toLowerCase()!=3D=3D"object"){var =
m=3De,n=3De.getAttribute("id"),o=3Dn||d,q=3De.parentNode,r=3D/^\s*[+~]/.t=
est(b);n?o=3Do.replace(/'/g,"\\$&"):e.setAttribute("id",o),r&&q&&(e=3De.p=
arentNode);try{if(!r||q)return p(e.querySelectorAll("[id=3D'"+o+"'] =
"+b),f)}catch(s){}finally{n||m.removeAttribute("id")}}}return =
a(b,e,f,g)};for(var e in a)k[e]=3Da[e];b=3Dnull}}(),function(){var =
a=3Dc.documentElement,b=3Da.matchesSelector||a.mozMatchesSelector||a.webk=
itMatchesSelector||a.msMatchesSelector;if(b){var =
d=3D!b.call(c.createElement("div"),"div"),e=3D!1;try{b.call(c.documentEle=
ment,"[test!=3D'']:sizzle")}catch(f){e=3D!0}k.matchesSelector=3Dfunction(=
a,c){c=3Dc.replace(/\=3D\s*([^'"\]]*)\s*\]/g,"=3D'$1']");if(!k.isXML(a))t=
ry{if(e||!l.match.PSEUDO.test(c)&&!/!=3D/.test(c)){var =
f=3Db.call(a,c);if(f||!d||a.document&&a.document.nodeType!=3D=3D11)return=
 f}}catch(g){}return k(c,null,null,[a]).length>0}}}(),function(){var =
a=3Dc.createElement("div");a.innerHTML=3D"<div class=3D'test =
e'></div><div =
class=3D'test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClas=
sName("e").length!=3D=3D0){a.lastChild.className=3D"e";if(a.getElementsBy=
ClassName("e").length=3D=3D=3D1)return;l.order.splice(1,0,"CLASS"),l.find=
.CLASS=3Dfunction(a,b,c){if(typeof =
b.getElementsByClassName!=3D"undefined"&&!c)return =
b.getElementsByClassName(a[1])},a=3Dnull}}(),c.documentElement.contains?k=
.contains=3Dfunction(a,b){return =
a!=3D=3Db&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocume=
ntPosition?k.contains=3Dfunction(a,b){return!!(a.compareDocumentPosition(=
b)&16)}:k.contains=3Dfunction(){return!1},k.isXML=3Dfunction(a){var =
b=3D(a?a.ownerDocument||a:0).documentElement;return =
b?b.nodeName!=3D=3D"HTML":!1};var v=3Dfunction(a,b){var =
c,d=3D[],e=3D"",f=3Db.nodeType?[b]:b;while(c=3Dl.match.PSEUDO.exec(a))e+=3D=
c[0],a=3Da.replace(l.match.PSEUDO,"");a=3Dl.relative[a]?a+"*":a;for(var =
g=3D0,h=3Df.length;g<h;g++)k(a,f[g],d);return =
k.filter(e,d)};f.find=3Dk,f.expr=3Dk.selectors,f.expr[":"]=3Df.expr.filte=
rs,f.unique=3Dk.uniqueSort,f.text=3Dk.getText,f.isXMLDoc=3Dk.isXML,f.cont=
ains=3Dk.contains}();var =
O=3D/Until$/,P=3D/^(?:parents|prevUntil|prevAll)/,Q=3D/,/,R=3D/^.[^:#\[\.=
,]*$/,S=3DArray.prototype.slice,T=3Df.expr.match.POS,U=3D{children:!0,con=
tents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var =
b=3Dthis,c,d;if(typeof a!=3D"string")return =
f(a).filter(function(){for(c=3D0,d=3Db.length;c<d;c++)if(f.contains(b[c],=
this))return!0});var =
e=3Dthis.pushStack("","find",a),g,h,i;for(c=3D0,d=3Dthis.length;c<d;c++){=
g=3De.length,f.find(a,this[c],e);if(c>0)for(h=3Dg;h<e.length;h++)for(i=3D=
0;i<g;i++)if(e[i]=3D=3D=3De[h]){e.splice(h--,1);break}}return =
e},has:function(a){var b=3Df(a);return this.filter(function(){for(var =
a=3D0,c=3Db.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:funct=
ion(a){return =
this.pushStack(W(this,a,!1),"not",a)},filter:function(a){return =
this.pushStack(W(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeo=
f =
a=3D=3D"string"?f.filter(a,this).length>0:this.filter(a).length>0)},close=
st:function(a,b){var c=3D[],d,e,g=3Dthis[0];if(f.isArray(a)){var =
h,i,j=3D{},k=3D1;if(g&&a.length){for(d=3D0,e=3Da.length;d<e;d++)i=3Da[d],=
j[i]||(j[i]=3DT.test(i)?f(i,b||this.context):i);while(g&&g.ownerDocument&=
&g!=3D=3Db){for(i in =
j)h=3Dj[i],(h.jquery?h.index(g)>-1:f(g).is(h))&&c.push({selector:i,elem:g=
,level:k});g=3Dg.parentNode,k++}}return c}var l=3DT.test(a)||typeof =
a!=3D"string"?f(a,b||this.context):0;for(d=3D0,e=3Dthis.length;d<e;d++){g=
=3Dthis[d];while(g){if(l?l.index(g)>-1:f.find.matchesSelector(g,a)){c.pus=
h(g);break}g=3Dg.parentNode;if(!g||!g.ownerDocument||g=3D=3D=3Db||g.nodeT=
ype=3D=3D=3D11)break}}c=3Dc.length>1?f.unique(c):c;return =
this.pushStack(c,"closest",a)},index:function(a){if(!a||typeof =
a=3D=3D"string")return =
f.inArray(this[0],a?f(a):this.parent().children());return =
f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=3Dtypeof =
a=3D=3D"string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=3Df.merge(this.=
get(),c);return =
this.pushStack(V(c[0])||V(d[0])?d:f.unique(d))},andSelf:function(){return=
 this.add(this.prevObject)}}),f.each({parent:function(a){var =
b=3Da.parentNode;return =
b&&b.nodeType!=3D=3D11?b:null},parents:function(a){return =
f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return =
f.dir(a,"parentNode",c)},next:function(a){return =
f.nth(a,2,"nextSibling")},prev:function(a){return =
f.nth(a,2,"previousSibling")},nextAll:function(a){return =
f.dir(a,"nextSibling")},prevAll:function(a){return =
f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return =
f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return =
f.dir(a,"previousSibling",c)},siblings:function(a){return =
f.sibling(a.parentNode.firstChild,a)},children:function(a){return =
f.sibling(a.firstChild)},contents:function(a){return =
f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.make=
Array(a.childNodes)}},function(a,b){f.fn[a]=3Dfunction(c,d){var =
e=3Df.map(this,b,c),g=3DS.call(arguments);O.test(a)||(d=3Dc),d&&typeof =
d=3D=3D"string"&&(e=3Df.filter(d,e)),e=3Dthis.length>1&&!U[a]?f.unique(e)=
:e,(this.length>1||Q.test(d))&&P.test(a)&&(e=3De.reverse());return =
this.pushStack(e,a,g.join(","))}}),f.extend({filter:function(a,b,c){c&&(a=
=3D":not("+a+")");return =
b.length=3D=3D=3D1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matche=
s(a,b)},dir:function(a,c,d){var =
e=3D[],g=3Da[c];while(g&&g.nodeType!=3D=3D9&&(d=3D=3D=3Db||g.nodeType!=3D=
=3D1||!f(g).is(d)))g.nodeType=3D=3D=3D1&&e.push(g),g=3Dg[c];return =
e},nth:function(a,b,c,d){b=3Db||1;var =
e=3D0;for(;a;a=3Da[c])if(a.nodeType=3D=3D=3D1&&++e=3D=3D=3Db)break;return=
 a},sibling:function(a,b){var =
c=3D[];for(;a;a=3Da.nextSibling)a.nodeType=3D=3D=3D1&&a!=3D=3Db&&c.push(a=
);return c}});var X=3D/ =
jQuery\d+=3D"(?:\d+|null)"/g,Y=3D/^\s+/,Z=3D/<(?!area|br|col|embed|hr|img=
|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,$=3D/<([\w:]+)/,_=3D/<tbody/=
i,ba=3D/<|&#?\w+;/,bb=3D/<(?:script|object|embed|option|style)/i,bc=3D/ch=
ecked\s*(?:[^=3D]|=3D\s*.checked.)/i,bd=3D/\/(java|ecma)script/i,be=3D/^\=
s*<!(?:\[CDATA\[|\-\-)/,bf=3D{option:[1,"<select =
multiple=3D'multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"=
],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>=
"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tb=
ody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],=
_default:[0,"",""]};bf.optgroup=3Dbf.option,bf.tbody=3Dbf.tfoot=3Dbf.colg=
roup=3Dbf.caption=3Dbf.thead,bf.th=3Dbf.td,f.support.htmlSerialize||(bf._=
default=3D[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isF=
unction(a))return this.each(function(b){var =
c=3Df(this);c.text(a.call(this,b,c.text()))});if(typeof =
a!=3D"object"&&a!=3D=3Db)return =
this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a)=
);return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return =
this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var =
b=3Df(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.inse=
rtBefore(this[0]),b.map(function(){var =
a=3Dthis;while(a.firstChild&&a.firstChild.nodeType=3D=3D=3D1)a=3Da.firstC=
hild;return a}).append(this)}return =
this},wrapInner:function(a){if(f.isFunction(a))return =
this.each(function(b){f(this).wrapInner(a.call(this,b))});return =
this.each(function(){var =
b=3Df(this),c=3Db.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:fu=
nction(a){return =
this.each(function(){f(this).wrapAll(a)})},unwrap:function(){return =
this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWit=
h(this.childNodes)}).end()},append:function(){return =
this.domManip(arguments,!0,function(a){this.nodeType=3D=3D=3D1&&this.appe=
ndChild(a)})},prepend:function(){return =
this.domManip(arguments,!0,function(a){this.nodeType=3D=3D=3D1&&this.inse=
rtBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].pare=
ntNode)return =
this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,thi=
s)});if(arguments.length){var =
a=3Df(arguments[0]);a.push.apply(a,this.toArray());return =
this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[=
0].parentNode)return =
this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,thi=
s.nextSibling)});if(arguments.length){var =
a=3Dthis.pushStack(this,"after",arguments);a.push.apply(a,f(arguments[0])=
.toArray());return a}},remove:function(a,b){for(var =
c=3D0,d;(d=3Dthis[c])!=3Dnull;c++)if(!a||f.filter(a,[d]).length)!b&&d.nod=
eType=3D=3D=3D1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d=
])),d.parentNode&&d.parentNode.removeChild(d);return =
this},empty:function(){for(var =
a=3D0,b;(b=3Dthis[a])!=3Dnull;a++){b.nodeType=3D=3D=3D1&&f.cleanData(b.ge=
tElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}r=
eturn =
this},clone:function(a,b){a=3Da=3D=3Dnull?!1:a,b=3Db=3D=3Dnull?a:b;return=
 this.map(function(){return =
f.clone(this,a,b)})},html:function(a){if(a=3D=3D=3Db)return =
this[0]&&this[0].nodeType=3D=3D=3D1?this[0].innerHTML.replace(X,""):null;=
if(typeof =
a=3D=3D"string"&&!bb.test(a)&&(f.support.leadingWhitespace||!Y.test(a))&&=
!bf[($.exec(a)||["",""])[1].toLowerCase()]){a=3Da.replace(Z,"<$1></$2>");=
try{for(var =
c=3D0,d=3Dthis.length;c<d;c++)this[c].nodeType=3D=3D=3D1&&(f.cleanData(th=
is[c].getElementsByTagName("*")),this[c].innerHTML=3Da)}catch(e){this.emp=
ty().append(a)}}else f.isFunction(a)?this.each(function(b){var =
c=3Df(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);retu=
rn =
this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunc=
tion(a))return this.each(function(b){var =
c=3Df(this),d=3Dc.html();c.replaceWith(a.call(this,b,d))});typeof =
a!=3D"string"&&(a=3Df(a).detach());return this.each(function(){var =
b=3Dthis.nextSibling,c=3Dthis.parentNode;f(this).remove(),b?f(b).before(a=
):f(c).append(a)})}return =
this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this=
},detach:function(a){return =
this.remove(a,!0)},domManip:function(a,c,d){var =
e,g,h,i,j=3Da[0],k=3D[];if(!f.support.checkClone&&arguments.length=3D=3D=3D=
3&&typeof j=3D=3D"string"&&bc.test(j))return =
this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))retu=
rn this.each(function(e){var =
g=3Df(this);a[0]=3Dj.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(thi=
s[0]){i=3Dj&&j.parentNode,f.support.parentNode&&i&&i.nodeType=3D=3D=3D11&=
&i.childNodes.length=3D=3D=3Dthis.length?e=3D{fragment:i}:e=3Df.buildFrag=
ment(a,this,k),h=3De.fragment,h.childNodes.length=3D=3D=3D1?g=3Dh=3Dh.fir=
stChild:g=3Dh.firstChild;if(g){c=3Dc&&f.nodeName(g,"tr");for(var =
l=3D0,m=3Dthis.length,n=3Dm-1;l<m;l++)d.call(c?bg(this[l],g):this[l],e.ca=
cheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,bm)}return =
this}}),f.buildFragment=3Dfunction(a,b,d){var =
e,g,h,i;b&&b[0]&&(i=3Db[0].ownerDocument||b[0]),i.createDocumentFragment|=
|(i=3Dc),a.length=3D=3D=3D1&&typeof =
a[0]=3D=3D"string"&&a[0].length<512&&i=3D=3D=3Dc&&a[0].charAt(0)=3D=3D=3D=
"<"&&!bb.test(a[0])&&(f.support.checkClone||!bc.test(a[0]))&&(g=3D!0,h=3D=
f.fragments[a[0]],h&&h!=3D=3D1&&(e=3Dh)),e||(e=3Di.createDocumentFragment=
(),f.clean(a,i,e,d)),g&&(f.fragments[a[0]]=3Dh?e:1);return{fragment:e,cac=
heable:g}},f.fragments=3D{},f.each({appendTo:"append",prependTo:"prepend"=
,insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},func=
tion(a,b){f.fn[a]=3Dfunction(c){var =
d=3D[],e=3Df(c),g=3Dthis.length=3D=3D=3D1&&this[0].parentNode;if(g&&g.nod=
eType=3D=3D=3D11&&g.childNodes.length=3D=3D=3D1&&e.length=3D=3D=3D1){e[b]=
(this[0]);return this}for(var h=3D0,i=3De.length;h<i;h++){var =
j=3D(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=3Dd.concat(j=0A=
)}return =
this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var =
d=3Da.cloneNode(!0),e,g,h;if((!f.support.noCloneEvent||!f.support.noClone=
Checked)&&(a.nodeType=3D=3D=3D1||a.nodeType=3D=3D=3D11)&&!f.isXMLDoc(a)){=
bi(a,d),e=3Dbj(a),g=3Dbj(d);for(h=3D0;e[h];++h)bi(e[h],g[h])}if(b){bh(a,d=
);if(c){e=3Dbj(a),g=3Dbj(d);for(h=3D0;e[h];++h)bh(e[h],g[h])}}e=3Dg=3Dnul=
l;return d},clean:function(a,b,d,e){var g;b=3Db||c,typeof =
b.createElement=3D=3D"undefined"&&(b=3Db.ownerDocument||b[0]&&b[0].ownerD=
ocument||c);var h=3D[],i;for(var j=3D0,k;(k=3Da[j])!=3Dnull;j++){typeof =
k=3D=3D"number"&&(k+=3D"");if(!k)continue;if(typeof =
k=3D=3D"string")if(!ba.test(k))k=3Db.createTextNode(k);else{k=3Dk.replace=
(Z,"<$1></$2>");var =
l=3D($.exec(k)||["",""])[1].toLowerCase(),m=3Dbf[l]||bf._default,n=3Dm[0]=
,o=3Db.createElement("div");o.innerHTML=3Dm[1]+k+m[2];while(n--)o=3Do.las=
tChild;if(!f.support.tbody){var =
p=3D_.test(k),q=3Dl=3D=3D=3D"table"&&!p?o.firstChild&&o.firstChild.childN=
odes:m[1]=3D=3D=3D"<table>"&&!p?o.childNodes:[];for(i=3Dq.length-1;i>=3D0=
;--i)f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.r=
emoveChild(q[i])}!f.support.leadingWhitespace&&Y.test(k)&&o.insertBefore(=
b.createTextNode(Y.exec(k)[0]),o.firstChild),k=3Do.childNodes}var =
r;if(!f.support.appendChecked)if(k[0]&&typeof =
(r=3Dk.length)=3D=3D"number")for(i=3D0;i<r;i++)bl(k[i]);else =
bl(k);k.nodeType?h.push(k):h=3Df.merge(h,k)}if(d){g=3Dfunction(a){return!=
a.type||bd.test(a.type)};for(j=3D0;h[j];j++)if(e&&f.nodeName(h[j],"script=
")&&(!h[j].type||h[j].type.toLowerCase()=3D=3D=3D"text/javascript"))e.pus=
h(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j]);else{if(h[j].no=
deType=3D=3D=3D1){var =
s=3Df.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0=
].concat(s))}d.appendChild(h[j])}}return h},cleanData:function(a){var =
b,c,d=3Df.cache,e=3Df.expando,g=3Df.event.special,h=3Df.support.deleteExp=
ando;for(var =
i=3D0,j;(j=3Da[i])!=3Dnull;i++){if(j.nodeName&&f.noData[j.nodeName.toLowe=
rCase()])continue;c=3Dj[f.expando];if(c){b=3Dd[c]&&d[c][e];if(b&&b.events=
){for(var k in =
b.events)g[k]?f.event.remove(j,k):f.removeEvent(j,k,b.handle);b.handle&&(=
b.handle.elem=3Dnull)}h?delete =
j[f.expando]:j.removeAttribute&&j.removeAttribute(f.expando),delete =
d[c]}}}});var =
bn=3D/alpha\([^)]*\)/i,bo=3D/opacity=3D([^)]*)/,bp=3D/([A-Z]|^ms)/g,bq=3D=
/^-?\d+(?:px)?$/i,br=3D/^-?\d/,bs=3D/^[+\-]=3D/,bt=3D/[^+\-\.\de]+/g,bu=3D=
{position:"absolute",visibility:"hidden",display:"block"},bv=3D["Left","R=
ight"],bw=3D["Top","Bottom"],bx,by,bz;f.fn.css=3Dfunction(a,c){if(argumen=
ts.length=3D=3D=3D2&&c=3D=3D=3Db)return this;return =
f.access(this,a,c,!0,function(a,c,d){return =
d!=3D=3Db?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:f=
unction(a,b){if(b){var c=3Dbx(a,"opacity","opacity");return =
c=3D=3D=3D""?"1":c}return =
a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,=
opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.su=
pport.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a=
.nodeType!=3D=3D3&&a.nodeType!=3D=3D8&&!!a.style){var =
g,h,i=3Df.camelCase(c),j=3Da.style,k=3Df.cssHooks[i];c=3Df.cssProps[i]||i=
;if(d=3D=3D=3Db){if(k&&"get"in k&&(g=3Dk.get(a,!1,e))!=3D=3Db)return =
g;return j[c]}h=3Dtypeof =
d;if(h=3D=3D=3D"number"&&isNaN(d)||d=3D=3Dnull)return;h=3D=3D=3D"string"&=
&bs.test(d)&&(d=3D+d.replace(bt,"")+parseFloat(f.css(a,c)),h=3D"number"),=
h=3D=3D=3D"number"&&!f.cssNumber[i]&&(d+=3D"px");if(!k||!("set"in =
k)||(d=3Dk.set(a,d))!=3D=3Db)try{j[c]=3Dd}catch(l){}}},css:function(a,c,d=
){var =
e,g;c=3Df.camelCase(c),g=3Df.cssHooks[c],c=3Df.cssProps[c]||c,c=3D=3D=3D"=
cssFloat"&&(c=3D"float");if(g&&"get"in =
g&&(e=3Dg.get(a,!0,d))!=3D=3Db)return e;if(bx)return =
bx(a,c)},swap:function(a,b,c){var d=3D{};for(var e in =
b)d[e]=3Da.style[e],a.style[e]=3Db[e];c.call(a);for(e in =
b)a.style[e]=3Dd[e]}}),f.curCSS=3Df.css,f.each(["height","width"],functio=
n(a,b){f.cssHooks[b]=3D{get:function(a,c,d){var =
e;if(c){if(a.offsetWidth!=3D=3D0)return =
bA(a,b,d);f.swap(a,bu,function(){e=3DbA(a,b,d)});return =
e}},set:function(a,b){if(!bq.test(b))return =
b;b=3DparseFloat(b);if(b>=3D0)return =
b+"px"}}}),f.support.opacity||(f.cssHooks.opacity=3D{get:function(a,b){re=
turn =
bo.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?par=
seFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var =
c=3Da.style,d=3Da.currentStyle;c.zoom=3D1;var =
e=3Df.isNaN(b)?"":"alpha(opacity=3D"+b*100+")",g=3Dd&&d.filter||c.filter|=
|"";c.filter=3Dbn.test(g)?g.replace(bn,e):g+" =
"+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRigh=
t=3D{get:function(a,b){var =
c;f.swap(a,{display:"inline-block"},function(){b?c=3Dbx(a,"margin-right",=
"marginRight"):c=3Da.style.marginRight});return =
c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(by=3Dfunction(a,c)=
{var =
d,e,g;c=3Dc.replace(bp,"-$1").toLowerCase();if(!(e=3Da.ownerDocument.defa=
ultView))return =
b;if(g=3De.getComputedStyle(a,null))d=3Dg.getPropertyValue(c),d=3D=3D=3D"=
"&&!f.contains(a.ownerDocument.documentElement,a)&&(d=3Df.style(a,c));ret=
urn d}),c.documentElement.currentStyle&&(bz=3Dfunction(a,b){var =
c,d=3Da.currentStyle&&a.currentStyle[b],e=3Da.runtimeStyle&&a.runtimeStyl=
e[b],f=3Da.style;!bq.test(d)&&br.test(d)&&(c=3Df.left,e&&(a.runtimeStyle.=
left=3Da.currentStyle.left),f.left=3Db=3D=3D=3D"fontSize"?"1em":d||0,d=3D=
f.pixelLeft+"px",f.left=3Dc,e&&(a.runtimeStyle.left=3De));return =
d=3D=3D=3D""?"auto":d}),bx=3Dby||bz,f.expr&&f.expr.filters&&(f.expr.filte=
rs.hidden=3Dfunction(a){var b=3Da.offsetWidth,c=3Da.offsetHeight;return =
b=3D=3D=3D0&&c=3D=3D=3D0||!f.support.reliableHiddenOffsets&&(a.style.disp=
lay||f.css(a,"display"))=3D=3D=3D"none"},f.expr.filters.visible=3Dfunctio=
n(a){return!f.expr.filters.hidden(a)});var =
bB=3D/%20/g,bC=3D/\[\]$/,bD=3D/\r?\n/g,bE=3D/#.*$/,bF=3D/^(.*?):[ =
\t]*([^\r\n]*)\r?$/mg,bG=3D/^(?:color|date|datetime|email|hidden|month|nu=
mber|password|range|search|tel|text|time|url|week)$/i,bH=3D/^(?:about|app=
|app\-storage|.+\-extension|file|widget):$/,bI=3D/^(?:GET|HEAD)$/,bJ=3D/^=
\/\//,bK=3D/\?/,bL=3D/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/g=
i,bM=3D/^(?:select|textarea)/i,bN=3D/\s+/,bO=3D/([?&])_=3D[^&]*/,bP=3D/^(=
[\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bQ=3Df.fn.load,bR=3D{},bS=3D=
{},bT,bU;try{bT=3De.href}catch(bV){bT=3Dc.createElement("a"),bT.href=3D""=
,bT=3DbT.href}bU=3DbP.exec(bT.toLowerCase())||[],f.fn.extend({load:functi=
on(a,c,d){if(typeof a!=3D"string"&&bQ)return =
bQ.apply(this,arguments);if(!this.length)return this;var e=3Da.indexOf(" =
");if(e>=3D0){var g=3Da.slice(e,a.length);a=3Da.slice(0,e)}var =
h=3D"GET";c&&(f.isFunction(c)?(d=3Dc,c=3Db):typeof =
c=3D=3D"object"&&(c=3Df.param(c,f.ajaxSettings.traditional),h=3D"POST"));=
var =
i=3Dthis;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,=
b,c){c=3Da.responseText,a.isResolved()&&(a.done(function(a){c=3Da}),i.htm=
l(g?f("<div>").append(c.replace(bL,"")).find(g):c)),d&&i.each(d,[c,b,a])}=
});return this},serialize:function(){return =
f.param(this.serializeArray())},serializeArray:function(){return =
this.map(function(){return =
this.elements?f.makeArray(this.elements):this}).filter(function(){return =
this.name&&!this.disabled&&(this.checked||bM.test(this.nodeName)||bG.test=
(this.type))}).map(function(a,b){var c=3Df(this).val();return =
c=3D=3Dnull?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,va=
lue:a.replace(bD,"\r\n")}}):{name:b.name,value:c.replace(bD,"\r\n")}}).ge=
t()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess =
ajaxSend".split(" "),function(a,b){f.fn[b]=3Dfunction(a){return =
this.bind(b,a)}}),f.each(["get","post"],function(a,c){f[c]=3Dfunction(a,d=
,e,g){f.isFunction(d)&&(g=3Dg||e,e=3Dd,d=3Db);return =
f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript=
:function(a,c){return =
f.get(a,b,c,"script")},getJSON:function(a,b,c){return =
f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?f.extend(!0,a,f.ajaxSettin=
gs,b):(b=3Da,a=3Df.extend(!0,f.ajaxSettings,b));for(var c =
in{context:1,url:1})c in b?a[c]=3Db[c]:c in =
f.ajaxSettings&&(a[c]=3Df.ajaxSettings[c]);return =
a},ajaxSettings:{url:bT,isLocal:bH.test(bU[1]),global:!0,type:"GET",conte=
ntType:"application/x-www-form-urlencoded",processData:!0,async:!0,accept=
s:{xml:"application/xml, =
text/xml",html:"text/html",text:"text/plain",json:"application/json, =
text/javascript","*":"*/*"},contents:{xml:/xml/,html:/html/,json:/json/},=
responseFields:{xml:"responseXML",text:"responseText"},converters:{"* =
text":a.String,"text html":!0,"text json":f.parseJSON,"text =
xml":f.parseXML}},ajaxPrefilter:bW(bR),ajaxTransport:bW(bS),ajax:function=
(a,c){function =
w(a,c,l,m){if(s!=3D=3D2){s=3D2,q&&clearTimeout(q),p=3Db,n=3Dm||"",v.ready=
State=3Da?4:0;var =
o,r,u,w=3Dl?bZ(d,v,l):b,x,y;if(a>=3D200&&a<300||a=3D=3D=3D304){if(d.ifMod=
ified){if(x=3Dv.getResponseHeader("Last-Modified"))f.lastModified[k]=3Dx;=
if(y=3Dv.getResponseHeader("Etag"))f.etag[k]=3Dy}if(a=3D=3D=3D304)c=3D"no=
tmodified",o=3D!0;else =
try{r=3Db$(d,w),c=3D"success",o=3D!0}catch(z){c=3D"parsererror",u=3Dz}}el=
se{u=3Dc;if(!c||a)c=3D"error",a<0&&(a=3D0)}v.status=3Da,v.statusText=3Dc,=
o?h.resolveWith(e,[r,c,v]):h.rejectWith(e,[v,c,u]),v.statusCode(j),j=3Db,=
t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.resolveWith(e,[v=
,c]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("aja=
xStop"))}}typeof a=3D=3D"object"&&(c=3Da,a=3Db),c=3Dc||{};var =
d=3Df.ajaxSetup({},c),e=3Dd.context||d,g=3De!=3D=3Dd&&(e.nodeType||e =
instanceof =
f)?f(e):f.event,h=3Df.Deferred(),i=3Df._Deferred(),j=3Dd.statusCode||{},k=
,l=3D{},m=3D{},n,o,p,q,r,s=3D0,t,u,v=3D{readyState:0,setRequestHeader:fun=
ction(a,b){if(!s){var =
c=3Da.toLowerCase();a=3Dm[c]=3Dm[c]||a,l[a]=3Db}return =
this},getAllResponseHeaders:function(){return =
s=3D=3D=3D2?n:null},getResponseHeader:function(a){var =
c;if(s=3D=3D=3D2){if(!o){o=3D{};while(c=3DbF.exec(n))o[c[1].toLowerCase()=
]=3Dc[2]}c=3Do[a.toLowerCase()]}return =
c=3D=3D=3Db?null:c},overrideMimeType:function(a){s||(d.mimeType=3Da);retu=
rn this},abort:function(a){a=3Da||"abort",p&&p.abort(a),w(0,a);return =
this}};h.promise(v),v.success=3Dv.done,v.error=3Dv.fail,v.complete=3Di.do=
ne,v.statusCode=3Dfunction(a){if(a){var b;if(s<2)for(b in =
a)j[b]=3D[j[b],a[b]];else b=3Da[v.status],v.then(b,b)}return =
this},d.url=3D((a||d.url)+"").replace(bE,"").replace(bJ,bU[1]+"//"),d.dat=
aTypes=3Df.trim(d.dataType||"*").toLowerCase().split(bN),d.crossDomain=3D=
=3Dnull&&(r=3DbP.exec(d.url.toLowerCase()),d.crossDomain=3D!(!r||r[1]=3D=3D=
bU[1]&&r[2]=3D=3DbU[2]&&(r[3]||(r[1]=3D=3D=3D"http:"?80:443))=3D=3D(bU[3]=
||(bU[1]=3D=3D=3D"http:"?80:443)))),d.data&&d.processData&&typeof =
d.data!=3D"string"&&(d.data=3Df.param(d.data,d.traditional)),bX(bR,d,c,v)=
;if(s=3D=3D=3D2)return!1;t=3Dd.global,d.type=3Dd.type.toUpperCase(),d.has=
Content=3D!bI.test(d.type),t&&f.active++=3D=3D=3D0&&f.event.trigger("ajax=
Start");if(!d.hasContent){d.data&&(d.url+=3D(bK.test(d.url)?"&":"?")+d.da=
ta),k=3Dd.url;if(d.cache=3D=3D=3D!1){var =
x=3Df.now(),y=3Dd.url.replace(bO,"$1_=3D"+x);d.url=3Dy+(y=3D=3D=3Dd.url?(=
bK.test(d.url)?"&":"?")+"_=3D"+x:"")}}(d.data&&d.hasContent&&d.contentTyp=
e!=3D=3D!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentTy=
pe),d.ifModified&&(k=3Dk||d.url,f.lastModified[k]&&v.setRequestHeader("If=
-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-Non=
e-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accept=
s[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=3D=3D"*"?", =
*/*; q=3D0.01":""):d.accepts["*"]);for(u in =
d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSe=
nd.call(e,v,d)=3D=3D=3D!1||s=3D=3D=3D2)){v.abort();return!1}for(u =
in{success:1,error:1,complete:1})v[u](d[u]);p=3DbX(bS,d,c,v);if(!p)w(-1,"=
No =
Transport");else{v.readyState=3D1,t&&g.trigger("ajaxSend",[v,d]),d.async&=
&d.timeout>0&&(q=3DsetTimeout(function(){v.abort("timeout")},d.timeout));=
try{s=3D1,p.send(l,w)}catch(z){status<2?w(-1,z):f.error(z)}}return =
v},param:function(a,c){var =
d=3D[],e=3Dfunction(a,b){b=3Df.isFunction(b)?b():b,d[d.length]=3DencodeUR=
IComponent(a)+"=3D"+encodeURIComponent(b)};c=3D=3D=3Db&&(c=3Df.ajaxSettin=
gs.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,f=
unction(){e(this.name,this.value)});else for(var g in =
a)bY(g,a[g],c,e);return =
d.join("&").replace(bB,"+")}}),f.extend({active:0,lastModified:{},etag:{}=
});var =
b_=3Df.now(),ca=3D/(\=3D)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jso=
npCallback:function(){return f.expando+"_"+b_++}}),f.ajaxPrefilter("json =
jsonp",function(b,c,d){var =
e=3Db.contentType=3D=3D=3D"application/x-www-form-urlencoded"&&typeof =
b.data=3D=3D"string";if(b.dataTypes[0]=3D=3D=3D"jsonp"||b.jsonp!=3D=3D!1&=
&(ca.test(b.url)||e&&ca.test(b.data))){var =
g,h=3Db.jsonpCallback=3Df.isFunction(b.jsonpCallback)?b.jsonpCallback():b=
.jsonpCallback,i=3Da[h],j=3Db.url,k=3Db.data,l=3D"$1"+h+"$2";b.jsonp!=3D=3D=
!1&&(j=3Dj.replace(ca,l),b.url=3D=3D=3Dj&&(e&&(k=3Dk.replace(ca,l)),b.dat=
a=3D=3D=3Dk&&(j+=3D(/\?/.test(j)?"&":"?")+b.jsonp+"=3D"+h))),b.url=3Dj,b.=
data=3Dk,a[h]=3Dfunction(a){g=3D[a]},d.always(function(){a[h]=3Di,g&&f.is=
Function(i)&&a[h](g[0])}),b.converters["script =
json"]=3Dfunction(){g||f.error(h+" was not called");return =
g[0]},b.dataTypes[0]=3D"json";return"script"}}),f.ajaxSetup({accepts:{scr=
ipt:"text/javascript, application/javascript, application/ecmascript, =
application/x-ecmascript"},contents:{script:/javascript|ecmascript/},conv=
erters:{"text script":function(a){f.globalEval(a);return =
a}}}),f.ajaxPrefilter("script",function(a){a.cache=3D=3D=3Db&&(a.cache=3D=
!1),a.crossDomain&&(a.type=3D"GET",a.global=3D!1)}),f.ajaxTransport("scri=
pt",function(a){if(a.crossDomain){var =
d,e=3Dc.head||c.getElementsByTagName("head")[0]||c.documentElement;return=
{send:function(f,g){d=3Dc.createElement("script"),d.async=3D"async",a.scr=
iptCharset&&(d.charset=3Da.scriptCharset),d.src=3Da.url,d.onload=3Dd.onre=
adystatechange=3Dfunction(a,c){if(c||!d.readyState||/loaded|complete/.tes=
t(d.readyState))d.onload=3Dd.onreadystatechange=3Dnull,e&&d.parentNode&&e=
.removeChild(d),d=3Db,c||g(200,"success")},e.insertBefore(d,e.firstChild)=
},abort:function(){d&&d.onload(0,1)}}}});var =
cb=3Da.ActiveXObject?function(){for(var a in =
cd)cd[a](0,1)}:!1,cc=3D0,cd;f.ajaxSettings.xhr=3Da.ActiveXObject?function=
(){return!this.isLocal&&ce()||cf()}:ce,function(a){f.extend(f.support,{aj=
ax:!!a,cors:!!a&&"withCredentials"in =
a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if=
(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var =
h=3Dc.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.passw=
ord):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in =
c.xhrFields)h[j]=3Dc.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overr=
ideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Req=
uested-With"]=3D"XMLHttpRequest");try{for(j in =
e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null)=
,d=3Dfunction(a,e){var =
j,k,l,m,n;try{if(d&&(e||h.readyState=3D=3D=3D4)){d=3Db,i&&(h.onreadystate=
change=3Df.noop,cb&&delete =
cd[i]);if(e)h.readyState!=3D=3D4&&h.abort();else{j=3Dh.status,l=3Dh.getAl=
lResponseHeaders(),m=3D{},n=3Dh.responseXML,n&&n.documentElement&&(m.xml=3D=
n),m.text=3Dh.responseText;try{k=3Dh.statusText}catch(o){k=3D""}!j&&c.isL=
ocal&&!c.crossDomain?j=3Dm.text?200:404:j=3D=3D=3D1223&&(j=3D204)}}}catch=
(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState=3D=3D=3D4?d():(i=3D+=
+cc,cb&&(cd||(cd=3D{},f(a).unload(cb)),cd[i]=3Dd),h.onreadystatechange=3D=
d)},abort:function(){d&&d(0,1)}}}});var =
cg=3D{},ch,ci,cj=3D/^(?:toggle|show|hide)$/,ck=3D/^([+\-]=3D)?([\d+.\-]+)=
([a-z%]*)$/i,cl,cm=3D[["height","marginTop","marginBottom","paddingTop","=
paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddin=
gRight"],["opacity"]],cn,co=3Da.webkitRequestAnimationFrame||a.mozRequest=
AnimationFrame||a.oRequestAnimationFrame;f.fn.extend({show:function(a,b,c=
){var d,e;if(a||a=3D=3D=3D0)return =
this.animate(cr("show",3),a,b,c);for(var =
g=3D0,h=3Dthis.length;g<h;g++)d=3Dthis[g],d.style&&(e=3Dd.style.display,!=
f._data(d,"olddisplay")&&e=3D=3D=3D"none"&&(e=3Dd.style.display=3D""),e=3D=
=3D=3D""&&f.css(d,"display")=3D=3D=3D"none"&&f._data(d,"olddisplay",cs(d.=
nodeName)));for(g=3D0;g<h;g++){d=3Dthis[g];if(d.style){e=3Dd.style.displa=
y;if(e=3D=3D=3D""||e=3D=3D=3D"none")d.style.display=3Df._data(d,"olddispl=
ay")||""}}return this},hide:function(a,b,c){if(a||a=3D=3D=3D0)return =
this.animate(cr("hide",3),a,b,c);for(var =
d=3D0,e=3Dthis.length;d<e;d++)if(this[d].style){var =
g=3Df.css(this[d],"display");g!=3D=3D"none"&&!f._data(this[d],"olddisplay=
")&&f._data(this[d],"olddisplay",g)}for(d=3D0;d<e;d++)this[d].style&&(thi=
s[d].style.display=3D"none");return =
this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=3Dtypeof =
a=3D=3D"boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this=
,arguments):a=3D=3Dnull||d?this.each(function(){var =
b=3Dd?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(c=
r("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return =
this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},=
a,c,d)},animate:function(a,b,c,d){var =
e=3Df.speed(b,c,d);if(f.isEmptyObject(a))return =
this.each(e.complete,[!1]);a=3Df.extend({},a);return =
this[e.queue=3D=3D=3D!1?"each":"queue"](function(){e.queue=3D=3D=3D!1&&f.=
_mark(this);var =
b=3Df.extend({},e),c=3Dthis.nodeType=3D=3D=3D1,d=3Dc&&f(this).is(":hidden=
"),g,h,i,j,k,l,m,n,o;b.animatedProperties=3D{};for(i in =
a){g=3Df.camelCase(i),i!=3D=3Dg&&(a[g]=3Da[i],delete =
a[i]),h=3Da[g],f.isArray(h)?(b.animatedProperties[g]=3Dh[1],h=3Da[g]=3Dh[=
0]):b.animatedProperties[g]=3Db.specialEasing&&b.specialEasing[g]||b.easi=
ng||"swing";if(h=3D=3D=3D"hide"&&d||h=3D=3D=3D"show"&&!d)return =
b.complete.call(this);c&&(g=3D=3D=3D"height"||g=3D=3D=3D"width")&&(b.over=
flow=3D[this.style.overflow,this.style.overflowX,this.style.overflowY],f.=
css(this,"display")=3D=3D=3D"inline"&&f.css(this,"float")=3D=3D=3D"none"&=
&(f.support.inlineBlockNeedsLayout?(j=3Dcs(this.nodeName),j=3D=3D=3D"inli=
ne"?this.style.display=3D"inline-block":(this.style.display=3D"inline",th=
is.style.zoom=3D1)):this.style.display=3D"inline-block"))}b.overflow!=3Dn=
ull&&(this.style.overflow=3D"hidden");for(i in a)k=3Dnew =
f.fx(this,b,i),h=3Da[i],cj.test(h)?k[h=3D=3D=3D"toggle"?d?"show":"hide":h=
]():(l=3Dck.exec(h),m=3Dk.cur(),l?(n=3DparseFloat(l[2]),o=3Dl[3]||(f.cssN=
umber[i]?"":"px"),o!=3D=3D"px"&&(f.style(this,i,(n||1)+o),m=3D(n||1)/k.cu=
r()*m,f.style(this,i,m+o)),l[1]&&(n=3D(l[1]=3D=3D=3D"-=3D"?-1:1)*n+m),k.c=
ustom(m,n,o)):k.custom(m,h,""));return!0})},stop:function(a,b){a&&this.qu=
eue([]),this.each(function(){var =
a=3Df.timers,c=3Da.length;b||f._unmark(!0,this);while(c--)a[c].elem=3D=3D=
=3Dthis&&(b&&a[c](!0),a.splice(c,1))}),b||this.dequeue();return =
this}}),f.each({slideDown:cr("show",1),slideUp:cr("hide",1),slideToggle:c=
r("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle=
:{opacity:"toggle"}},function(a,b){f.fn[a]=3Dfunction(a,c,d){return =
this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var =
d=3Da&&typeof =
a=3D=3D"object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,dur=
ation:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=3Df.fx.off?0:type=
of d.duration=3D=3D"number"?d.duration:d.duration in =
f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default,d.old=3Dd.comple=
te,d.complete=3Dfunction(a){f.isFunction(d.old)&&d.old.call(this),d.queue=
!=3D=3D!1?f.dequeue(this):a!=3D=3D!1&&f._unmark(this)};return =
d},easing:{linear:function(a,b,c,d){return =
c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},ti=
mers:[],fx:function(a,b,c){this.options=3Db,this.elem=3Da,this.prop=3Dc,b=
.orig=3Db.orig||{}}}),f.fx.prototype=3D{update:function(){this.options.st=
ep&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]=
||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=3Dnu=
ll&&(!this.elem.style||this.elem.style[this.prop]=3D=3Dnull))return =
this.elem[this.prop];var a,b=3Df.css(this.elem,this.prop);return =
isNaN(a=3DparseFloat(b))?!b||b=3D=3D=3D"auto"?0:b:a},custom:function(a,b,=
c){function h(a){return d.step(a)}var =
d=3Dthis,e=3Df.fx,g;this.startTime=3Dcn||cp(),this.start=3Da,this.end=3Db=
,this.unit=3Dc||this.unit||(f.cssNumber[this.prop]?"":"px"),this.now=3Dth=
is.start,this.pos=3Dthis.state=3D0,h.elem=3Dthis.elem,h()&&f.timers.push(=
h)&&!cl&&(co?(cl=3D!0,g=3Dfunction(){cl&&(co(g),e.tick())},co(g)):cl=3Dse=
tInterval(e.tick,e.interval))},show:function(){this.options.orig[this.pro=
p]=3Df.style(this.elem,this.prop),this.options.show=3D!0,this.custom(this=
.prop=3D=3D=3D"width"||this.prop=3D=3D=3D"height"?1:0,this.cur()),f(this.=
elem).show()},hide:function(){this.options.orig[this.prop]=3Df.style(this=
.elem,this.prop),this.options.hide=3D!0,this.custom(this.cur(),0)},step:f=
unction(a){var =
b=3Dcn||cp(),c=3D!0,d=3Dthis.elem,e=3Dthis.options,g,h;if(a||b>=3De.durat=
ion+this.startTime){this.now=3Dthis.end,this.pos=3Dthis.state=3D1,this.up=
date(),e.animatedProperties[this.prop]=3D!0;for(g in =
e.animatedProperties)e.animatedProperties[g]!=3D=3D!0&&(c=3D!1);if(c){e.o=
verflow!=3Dnull&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],functio=
n(a,b){d.style["overflow"+b]=3De.overflow[a]}),e.hide&&f(d).hide();if(e.h=
ide||e.show)for(var i in =
e.animatedProperties)f.style(d,i,e.orig[i]);e.complete.call(d)}return!1}e=
.duration=3D=3DInfinity?this.now=3Db:(h=3Db-this.startTime,this.state=3Dh=
/e.duration,this.pos=3Df.easing[e.animatedProperties[this.prop]](this.sta=
te,h,0,1,e.duration),this.now=3Dthis.start+(this.end-this.start)*this.pos=
),this.update();return!0}},f.extend(f.fx,{tick:function(){for(var =
a=3Df.timers,b=3D0;b<a.length;++b)a[b]()||a.splice(b--,1);a.length||f.fx.=
stop()},interval:13,stop:function(){clearInterval(cl),cl=3Dnull},speeds:{=
slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,=
"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]=
!=3Dnull?a.elem.style[a.prop]=3D(a.prop=3D=3D=3D"width"||a.prop=3D=3D=3D"=
height"?Math.max(0,a.now):a.now)+a.unit:a.elem[a.prop]=3Da.now}}}),f.expr=
&&f.expr.filters&&(f.expr.filters.animated=3Dfunction(a){return =
f.grep(f.timers,function(b){return a=3D=3D=3Db.elem}).length});var =
ct=3D/^t(?:able|d|h)$/i,cu=3D/^(?:body|html)$/i;"getBoundingClientRect"in=
 c.documentElement?f.fn.offset=3Dfunction(a){var =
b=3Dthis[0],c;if(a)return =
this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocum=
ent)return null;if(b=3D=3D=3Db.ownerDocument.body)return =
f.offset.bodyOffset(b);try{c=3Db.getBoundingClientRect()}catch(d){}var =
e=3Db.ownerDocument,g=3De.documentElement;if(!c||!f.contains(g,b))return =
c?{top:c.top,left:c.left}:{top:0,left:0};var =
h=3De.body,i=3Dcv(e),j=3Dg.clientTop||h.clientTop||0,k=3Dg.clientLeft||h.=
clientLeft||0,l=3Di.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrol=
lTop,m=3Di.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=3D=
c.top+l-j,o=3Dc.left+m-k;return{top:n,left:o}}:f.fn.offset=3Dfunction(a){=
var b=3Dthis[0];if(a)return =
this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocum=
ent)return null;if(b=3D=3D=3Db.ownerDocument.body)return =
f.offset.bodyOffset(b);f.offset.initialize();var =
c,d=3Db.offsetParent,e=3Db,g=3Db.ownerDocument,h=3Dg.documentElement,i=3D=
g.body,j=3Dg.defaultView,k=3Dj?j.getComputedStyle(b,null):b.currentStyle,=
l=3Db.offsetTop,m=3Db.offsetLeft;while((b=3Db.parentNode)&&b!=3D=3Di&&b!=3D=
=3Dh){if(f.offset.supportsFixedPosition&&k.position=3D=3D=3D"fixed")break=
;c=3Dj?j.getComputedStyle(b,null):b.currentStyle,l-=3Db.scrollTop,m-=3Db.=
scrollLeft,b=3D=3D=3Dd&&(l+=3Db.offsetTop,m+=3Db.offsetLeft,f.offset.does=
NotAddBorder&&(!f.offset.doesAddBorderForTableAndCells||!ct.test(b.nodeNa=
me))&&(l+=3DparseFloat(c.borderTopWidth)||0,m+=3DparseFloat(c.borderLeftW=
idth)||0),e=3Dd,d=3Db.offsetParent),f.offset.subtractsBorderForOverflowNo=
tVisible&&c.overflow!=3D=3D"visible"&&(l+=3DparseFloat(c.borderTopWidth)|=
|0,m+=3DparseFloat(c.borderLeftWidth)||0),k=3Dc}if(k.position=3D=3D=3D"re=
lative"||k.position=3D=3D=3D"static")l+=3Di.offsetTop,m+=3Di.offsetLeft;f=
.offset.supportsFixedPosition&&k.position=3D=3D=3D"fixed"&&(l+=3DMath.max=
(h.scrollTop,i.scrollTop),m+=3DMath.max(h.scrollLeft,i.scrollLeft));retur=
n{top:l,left:m}},f.offset=3D{initialize:function(){var =
a=3Dc.body,b=3Dc.createElement("div"),d,e,g,h,i=3DparseFloat(f.css(a,"mar=
ginTop"))||0,j=3D"<div =
style=3D'position:absolute;top:0;left:0;margin:0;border:5px solid =
#000;padding:0;width:1px;height:1px;'><div></div></div><table =
style=3D'position:absolute;top:0;left:0;margin:0;border:5px solid =
#000;padding:0;width:1px;height:1px;' cellpadding=3D'0' =
cellspacing=3D'0'><tr><td></td></tr></table>";f.extend(b.style,{position:=
"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibi=
lity:"hidden"}),b.innerHTML=3Dj,a.insertBefore(b,a.firstChild),d=3Db.firs=
tChild,e=3Dd.firstChild,h=3Dd.nextSibling.firstChild.firstChild,this.does=
NotAddBorder=3De.offsetTop!=3D=3D5,this.doesAddBorderForTableAndCells=3Dh=
.offsetTop=3D=3D=3D5,e.style.position=3D"fixed",e.style.top=3D"20px",this=
.supportsFixedPosition=3De.offsetTop=3D=3D=3D20||e.offsetTop=3D=3D=3D15,e=
.style.position=3De.style.top=3D"",d.style.overflow=3D"hidden",d.style.po=
sition=3D"relative",this.subtractsBorderForOverflowNotVisible=3De.offsetT=
op=3D=3D=3D-5,this.doesNotIncludeMarginInBodyOffset=3Da.offsetTop!=3D=3Di=
,a.removeChild(b),f.offset.initialize=3Df.noop},bodyOffset:function(a){va=
r =
b=3Da.offsetTop,c=3Da.offsetLeft;f.offset.initialize(),f.offset.doesNotIn=
cludeMarginInBodyOffset&&(b+=3DparseFloat(f.css(a,"marginTop"))||0,c+=3Dp=
arseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:func=
tion(a,b,c){var =
d=3Df.css(a,"position");d=3D=3D=3D"static"&&(a.style.position=3D"relative=
");var =
e=3Df(a),g=3De.offset(),h=3Df.css(a,"top"),i=3Df.css(a,"left"),j=3D(d=3D=3D=
=3D"absolute"||d=3D=3D=3D"fixed")&&f.inArray("auto",[h,i])>-1,k=3D{},l=3D=
{},m,n;j?(l=3De.position(),m=3Dl.top,n=3Dl.left):(m=3DparseFloat(h)||0,n=3D=
parseFloat(i)||0),f.isFunction(b)&&(b=3Db.call(a,c,g)),b.top!=3Dnull&&(k.=
top=3Db.top-g.top+m),b.left!=3Dnull&&(k.left=3Db.left-g.left+n),"using"in=
 =
b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[=
0])return null;var =
a=3Dthis[0],b=3Dthis.offsetParent(),c=3Dthis.offset(),d=3Dcu.test(b[0].no=
deName)?{top:0,left:0}:b.offset();c.top-=3DparseFloat(f.css(a,"marginTop"=
))||0,c.left-=3DparseFloat(f.css(a,"marginLeft"))||0,d.top+=3DparseFloat(=
f.css(b[0],"borderTopWidth"))||0,d.left+=3DparseFloat(f.css(b[0],"borderL=
eftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:f=
unction(){return this.map(function(){var =
a=3Dthis.offsetParent||c.body;while(a&&!cu.test(a.nodeName)&&f.css(a,"pos=
ition")=3D=3D=3D"static")a=3Da.offsetParent;return =
a})}}),f.each(["Left","Top"],function(a,c){var =
d=3D"scroll"+c;f.fn[d]=3Dfunction(c){var =
e,g;if(c=3D=3D=3Db){e=3Dthis[0];if(!e)return null;g=3Dcv(e);return =
g?"pageXOffset"in =
g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documen=
tElement[d]||g.document.body[d]:e[d]}return =
this.each(function(){g=3Dcv(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:=
f(g).scrollTop()):this[d]=3Dc})}}),f.each(["Height","Width"],function(a,c=
){var d=3Dc.toLowerCase();f.fn["inner"+c]=3Dfunction(){var =
a=3Dthis[0];return =
a&&a.style?parseFloat(f.css(a,d,"padding")):null},f.fn["outer"+c]=3Dfunct=
ion(a){var b=3Dthis[0];return =
b&&b.style?parseFloat(f.css(b,d,a?"margin":"border")):null},f.fn[d]=3Dfun=
ction(a){var e=3Dthis[0];if(!e)return =
a=3D=3Dnull?null:this;if(f.isFunction(a))return =
this.each(function(b){var =
c=3Df(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var =
g=3De.document.documentElement["client"+c];return =
e.document.compatMode=3D=3D=3D"CSS1Compat"&&g||e.document.body["client"+c=
]||g}if(e.nodeType=3D=3D=3D9)return =
Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentEleme=
nt["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a=3D=3D=
=3Db){var h=3Df.css(e,d),i=3DparseFloat(h);return f.isNaN(i)?h:i}return =
this.css(d,typeof =
a=3D=3D"string"?a:a+"px")}}),a.jQuery=3Da.$=3Df})(window);
------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: application/octet-stream
Content-Transfer-Encoding: quoted-printable
Content-Location: http://www.mono-project.com/skins/MonoWaveWide/prototype.js

/*  Prototype JavaScript framework, version 1.6.0.3=0A=
 *  (c) 2005-2008 Sam Stephenson=0A=
 *=0A=
 *  Prototype is freely distributable under the terms of an MIT-style =
license.=0A=
 *  For details, see the Prototype web site: http://www.prototypejs.org/=0A=
 *=0A=
 =
*------------------------------------------------------------------------=
--*/=0A=
=0A=
var Prototype =3D {=0A=
  Version: '1.6.0.3',=0A=
=0A=
  Browser: {=0A=
    IE:     !!(window.attachEvent &&=0A=
      navigator.userAgent.indexOf('Opera') =3D=3D=3D -1),=0A=
    Opera:  navigator.userAgent.indexOf('Opera') > -1,=0A=
    WebKit: navigator.userAgent.indexOf('AppleWebKit/') > -1,=0A=
    Gecko:  navigator.userAgent.indexOf('Gecko') > -1 &&=0A=
      navigator.userAgent.indexOf('KHTML') =3D=3D=3D -1,=0A=
    MobileSafari: !!navigator.userAgent.match(/Apple.*Mobile.*Safari/)=0A=
  },=0A=
=0A=
  BrowserFeatures: {=0A=
    XPath: !!document.evaluate,=0A=
    SelectorsAPI: !!document.querySelector,=0A=
    ElementExtensions: !!window.HTMLElement,=0A=
    SpecificElementExtensions:=0A=
      document.createElement('div')['__proto__'] &&=0A=
      document.createElement('div')['__proto__'] !=3D=3D=0A=
        document.createElement('form')['__proto__']=0A=
  },=0A=
=0A=
  ScriptFragment: '<script[^>]*>([\\S\\s]*?)<\/script>',=0A=
  JSONFilter: /^\/\*-secure-([\s\S]*)\*\/\s*$/,=0A=
=0A=
  emptyFunction: function() { },=0A=
  K: function(x) { return x }=0A=
};=0A=
=0A=
if (Prototype.Browser.MobileSafari)=0A=
  Prototype.BrowserFeatures.SpecificElementExtensions =3D false;=0A=
=0A=
=0A=
/* Based on Alex Arnell's inheritance implementation. */=0A=
var Class =3D {=0A=
  create: function() {=0A=
    var parent =3D null, properties =3D $A(arguments);=0A=
    if (Object.isFunction(properties[0]))=0A=
      parent =3D properties.shift();=0A=
=0A=
    function klass() {=0A=
      this.initialize.apply(this, arguments);=0A=
    }=0A=
=0A=
    Object.extend(klass, Class.Methods);=0A=
    klass.superclass =3D parent;=0A=
    klass.subclasses =3D [];=0A=
=0A=
    if (parent) {=0A=
      var subclass =3D function() { };=0A=
      subclass.prototype =3D parent.prototype;=0A=
      klass.prototype =3D new subclass;=0A=
      parent.subclasses.push(klass);=0A=
    }=0A=
=0A=
    for (var i =3D 0; i < properties.length; i++)=0A=
      klass.addMethods(properties[i]);=0A=
=0A=
    if (!klass.prototype.initialize)=0A=
      klass.prototype.initialize =3D Prototype.emptyFunction;=0A=
=0A=
    klass.prototype.constructor =3D klass;=0A=
=0A=
    return klass;=0A=
  }=0A=
};=0A=
=0A=
Class.Methods =3D {=0A=
  addMethods: function(source) {=0A=
    var ancestor   =3D this.superclass && this.superclass.prototype;=0A=
    var properties =3D Object.keys(source);=0A=
=0A=
    if (!Object.keys({ toString: true }).length)=0A=
      properties.push("toString", "valueOf");=0A=
=0A=
    for (var i =3D 0, length =3D properties.length; i < length; i++) {=0A=
      var property =3D properties[i], value =3D source[property];=0A=
      if (ancestor && Object.isFunction(value) &&=0A=
          value.argumentNames().first() =3D=3D "$super") {=0A=
        var method =3D value;=0A=
        value =3D (function(m) {=0A=
          return function() { return ancestor[m].apply(this, arguments) =
};=0A=
        })(property).wrap(method);=0A=
=0A=
        value.valueOf =3D method.valueOf.bind(method);=0A=
        value.toString =3D method.toString.bind(method);=0A=
      }=0A=
      this.prototype[property] =3D value;=0A=
    }=0A=
=0A=
    return this;=0A=
  }=0A=
};=0A=
=0A=
var Abstract =3D { };=0A=
=0A=
Object.extend =3D function(destination, source) {=0A=
  for (var property in source)=0A=
    destination[property] =3D source[property];=0A=
  return destination;=0A=
};=0A=
=0A=
Object.extend(Object, {=0A=
  inspect: function(object) {=0A=
    try {=0A=
      if (Object.isUndefined(object)) return 'undefined';=0A=
      if (object =3D=3D=3D null) return 'null';=0A=
      return object.inspect ? object.inspect() : String(object);=0A=
    } catch (e) {=0A=
      if (e instanceof RangeError) return '...';=0A=
      throw e;=0A=
    }=0A=
  },=0A=
=0A=
  toJSON: function(object) {=0A=
    var type =3D typeof object;=0A=
    switch (type) {=0A=
      case 'undefined':=0A=
      case 'function':=0A=
      case 'unknown': return;=0A=
      case 'boolean': return object.toString();=0A=
    }=0A=
=0A=
    if (object =3D=3D=3D null) return 'null';=0A=
    if (object.toJSON) return object.toJSON();=0A=
    if (Object.isElement(object)) return;=0A=
=0A=
    var results =3D [];=0A=
    for (var property in object) {=0A=
      var value =3D Object.toJSON(object[property]);=0A=
      if (!Object.isUndefined(value))=0A=
        results.push(property.toJSON() + ': ' + value);=0A=
    }=0A=
=0A=
    return '{' + results.join(', ') + '}';=0A=
  },=0A=
=0A=
  toQueryString: function(object) {=0A=
    return $H(object).toQueryString();=0A=
  },=0A=
=0A=
  toHTML: function(object) {=0A=
    return object && object.toHTML ? object.toHTML() : =
String.interpret(object);=0A=
  },=0A=
=0A=
  keys: function(object) {=0A=
    var keys =3D [];=0A=
    for (var property in object)=0A=
      keys.push(property);=0A=
    return keys;=0A=
  },=0A=
=0A=
  values: function(object) {=0A=
    var values =3D [];=0A=
    for (var property in object)=0A=
      values.push(object[property]);=0A=
    return values;=0A=
  },=0A=
=0A=
  clone: function(object) {=0A=
    return Object.extend({ }, object);=0A=
  },=0A=
=0A=
  isElement: function(object) {=0A=
    return !!(object && object.nodeType =3D=3D 1);=0A=
  },=0A=
=0A=
  isArray: function(object) {=0A=
    return object !=3D null && typeof object =3D=3D "object" &&=0A=
      'splice' in object && 'join' in object;=0A=
  },=0A=
=0A=
  isHash: function(object) {=0A=
    return object instanceof Hash;=0A=
  },=0A=
=0A=
  isFunction: function(object) {=0A=
    return typeof object =3D=3D "function";=0A=
  },=0A=
=0A=
  isString: function(object) {=0A=
    return typeof object =3D=3D "string";=0A=
  },=0A=
=0A=
  isNumber: function(object) {=0A=
    return typeof object =3D=3D "number";=0A=
  },=0A=
=0A=
  isUndefined: function(object) {=0A=
    return typeof object =3D=3D "undefined";=0A=
  }=0A=
});=0A=
=0A=
Object.extend(Function.prototype, {=0A=
  argumentNames: function() {=0A=
    var names =3D =
this.toString().match(/^[\s\(]*function[^(]*\(([^\)]*)\)/)[1]=0A=
      .replace(/\s+/g, '').split(',');=0A=
    return names.length =3D=3D 1 && !names[0] ? [] : names;=0A=
  },=0A=
=0A=
  bind: function() {=0A=
    if (arguments.length < 2 && Object.isUndefined(arguments[0])) return =
this;=0A=
    var __method =3D this, args =3D $A(arguments), object =3D =
args.shift();=0A=
    return function() {=0A=
      return __method.apply(object, args.concat($A(arguments)));=0A=
    }=0A=
  },=0A=
=0A=
  bindAsEventListener: function() {=0A=
    var __method =3D this, args =3D $A(arguments), object =3D =
args.shift();=0A=
    return function(event) {=0A=
      return __method.apply(object, [event || =
window.event].concat(args));=0A=
    }=0A=
  },=0A=
=0A=
  curry: function() {=0A=
    if (!arguments.length) return this;=0A=
    var __method =3D this, args =3D $A(arguments);=0A=
    return function() {=0A=
      return __method.apply(this, args.concat($A(arguments)));=0A=
    }=0A=
  },=0A=
=0A=
  delay: function() {=0A=
    var __method =3D this, args =3D $A(arguments), timeout =3D =
args.shift() * 1000;=0A=
    return window.setTimeout(function() {=0A=
      return __method.apply(__method, args);=0A=
    }, timeout);=0A=
  },=0A=
=0A=
  defer: function() {=0A=
    var args =3D [0.01].concat($A(arguments));=0A=
    return this.delay.apply(this, args);=0A=
  },=0A=
=0A=
  wrap: function(wrapper) {=0A=
    var __method =3D this;=0A=
    return function() {=0A=
      return wrapper.apply(this, =
[__method.bind(this)].concat($A(arguments)));=0A=
    }=0A=
  },=0A=
=0A=
  methodize: function() {=0A=
    if (this._methodized) return this._methodized;=0A=
    var __method =3D this;=0A=
    return this._methodized =3D function() {=0A=
      return __method.apply(null, [this].concat($A(arguments)));=0A=
    };=0A=
  }=0A=
});=0A=
=0A=
Date.prototype.toJSON =3D function() {=0A=
  return '"' + this.getUTCFullYear() + '-' +=0A=
    (this.getUTCMonth() + 1).toPaddedString(2) + '-' +=0A=
    this.getUTCDate().toPaddedString(2) + 'T' +=0A=
    this.getUTCHours().toPaddedString(2) + ':' +=0A=
    this.getUTCMinutes().toPaddedString(2) + ':' +=0A=
    this.getUTCSeconds().toPaddedString(2) + 'Z"';=0A=
};=0A=
=0A=
var Try =3D {=0A=
  these: function() {=0A=
    var returnValue;=0A=
=0A=
    for (var i =3D 0, length =3D arguments.length; i < length; i++) {=0A=
      var lambda =3D arguments[i];=0A=
      try {=0A=
        returnValue =3D lambda();=0A=
        break;=0A=
      } catch (e) { }=0A=
    }=0A=
=0A=
    return returnValue;=0A=
  }=0A=
};=0A=
=0A=
RegExp.prototype.match =3D RegExp.prototype.test;=0A=
=0A=
RegExp.escape =3D function(str) {=0A=
  return String(str).replace(/([.*+?^=3D!:${}()|[\]\/\\])/g, '\\$1');=0A=
};=0A=
=0A=
/*-----------------------------------------------------------------------=
---*/=0A=
=0A=
var PeriodicalExecuter =3D Class.create({=0A=
  initialize: function(callback, frequency) {=0A=
    this.callback =3D callback;=0A=
    this.frequency =3D frequency;=0A=
    this.currentlyExecuting =3D false;=0A=
=0A=
    this.registerCallback();=0A=
  },=0A=
=0A=
  registerCallback: function() {=0A=
    this.timer =3D setInterval(this.onTimerEvent.bind(this), =
this.frequency * 1000);=0A=
  },=0A=
=0A=
  execute: function() {=0A=
    this.callback(this);=0A=
  },=0A=
=0A=
  stop: function() {=0A=
    if (!this.timer) return;=0A=
    clearInterval(this.timer);=0A=
    this.timer =3D null;=0A=
  },=0A=
=0A=
  onTimerEvent: function() {=0A=
    if (!this.currentlyExecuting) {=0A=
      try {=0A=
        this.currentlyExecuting =3D true;=0A=
        this.execute();=0A=
      } finally {=0A=
        this.currentlyExecuting =3D false;=0A=
      }=0A=
    }=0A=
  }=0A=
});=0A=
Object.extend(String, {=0A=
  interpret: function(value) {=0A=
    return value =3D=3D null ? '' : String(value);=0A=
  },=0A=
  specialChar: {=0A=
    '\b': '\\b',=0A=
    '\t': '\\t',=0A=
    '\n': '\\n',=0A=
    '\f': '\\f',=0A=
    '\r': '\\r',=0A=
    '\\': '\\\\'=0A=
  }=0A=
});=0A=
=0A=
Object.extend(String.prototype, {=0A=
  gsub: function(pattern, replacement) {=0A=
    var result =3D '', source =3D this, match;=0A=
    replacement =3D arguments.callee.prepareReplacement(replacement);=0A=
=0A=
    while (source.length > 0) {=0A=
      if (match =3D source.match(pattern)) {=0A=
        result +=3D source.slice(0, match.index);=0A=
        result +=3D String.interpret(replacement(match));=0A=
        source  =3D source.slice(match.index + match[0].length);=0A=
      } else {=0A=
        result +=3D source, source =3D '';=0A=
      }=0A=
    }=0A=
    return result;=0A=
  },=0A=
=0A=
  sub: function(pattern, replacement, count) {=0A=
    replacement =3D this.gsub.prepareReplacement(replacement);=0A=
    count =3D Object.isUndefined(count) ? 1 : count;=0A=
=0A=
    return this.gsub(pattern, function(match) {=0A=
      if (--count < 0) return match[0];=0A=
      return replacement(match);=0A=
    });=0A=
  },=0A=
=0A=
  scan: function(pattern, iterator) {=0A=
    this.gsub(pattern, iterator);=0A=
    return String(this);=0A=
  },=0A=
=0A=
  truncate: function(length, truncation) {=0A=
    length =3D length || 30;=0A=
    truncation =3D Object.isUndefined(truncation) ? '...' : truncation;=0A=
    return this.length > length ?=0A=
      this.slice(0, length - truncation.length) + truncation : =
String(this);=0A=
  },=0A=
=0A=
  strip: function() {=0A=
    return this.replace(/^\s+/, '').replace(/\s+$/, '');=0A=
  },=0A=
=0A=
  stripTags: function() {=0A=
    return this.replace(/<\/?[^>]+>/gi, '');=0A=
  },=0A=
=0A=
  stripScripts: function() {=0A=
    return this.replace(new RegExp(Prototype.ScriptFragment, 'img'), '');=0A=
  },=0A=
=0A=
  extractScripts: function() {=0A=
    var matchAll =3D new RegExp(Prototype.ScriptFragment, 'img');=0A=
    var matchOne =3D new RegExp(Prototype.ScriptFragment, 'im');=0A=
    return (this.match(matchAll) || []).map(function(scriptTag) {=0A=
      return (scriptTag.match(matchOne) || ['', ''])[1];=0A=
    });=0A=
  },=0A=
=0A=
  evalScripts: function() {=0A=
    return this.extractScripts().map(function(script) { return =
eval(script) });=0A=
  },=0A=
=0A=
  escapeHTML: function() {=0A=
    var self =3D arguments.callee;=0A=
    self.text.data =3D this;=0A=
    return self.div.innerHTML;=0A=
  },=0A=
=0A=
  unescapeHTML: function() {=0A=
    var div =3D new Element('div');=0A=
    div.innerHTML =3D this.stripTags();=0A=
    return div.childNodes[0] ? (div.childNodes.length > 1 ?=0A=
      $A(div.childNodes).inject('', function(memo, node) { return =
memo+node.nodeValue }) :=0A=
      div.childNodes[0].nodeValue) : '';=0A=
  },=0A=
=0A=
  toQueryParams: function(separator) {=0A=
    var match =3D this.strip().match(/([^?#]*)(#.*)?$/);=0A=
    if (!match) return { };=0A=
=0A=
    return match[1].split(separator || '&').inject({ }, function(hash, =
pair) {=0A=
      if ((pair =3D pair.split('=3D'))[0]) {=0A=
        var key =3D decodeURIComponent(pair.shift());=0A=
        var value =3D pair.length > 1 ? pair.join('=3D') : pair[0];=0A=
        if (value !=3D undefined) value =3D decodeURIComponent(value);=0A=
=0A=
        if (key in hash) {=0A=
          if (!Object.isArray(hash[key])) hash[key] =3D [hash[key]];=0A=
          hash[key].push(value);=0A=
        }=0A=
        else hash[key] =3D value;=0A=
      }=0A=
      return hash;=0A=
    });=0A=
  },=0A=
=0A=
  toArray: function() {=0A=
    return this.split('');=0A=
  },=0A=
=0A=
  succ: function() {=0A=
    return this.slice(0, this.length - 1) +=0A=
      String.fromCharCode(this.charCodeAt(this.length - 1) + 1);=0A=
  },=0A=
=0A=
  times: function(count) {=0A=
    return count < 1 ? '' : new Array(count + 1).join(this);=0A=
  },=0A=
=0A=
  camelize: function() {=0A=
    var parts =3D this.split('-'), len =3D parts.length;=0A=
    if (len =3D=3D 1) return parts[0];=0A=
=0A=
    var camelized =3D this.charAt(0) =3D=3D '-'=0A=
      ? parts[0].charAt(0).toUpperCase() + parts[0].substring(1)=0A=
      : parts[0];=0A=
=0A=
    for (var i =3D 1; i < len; i++)=0A=
      camelized +=3D parts[i].charAt(0).toUpperCase() + =
parts[i].substring(1);=0A=
=0A=
    return camelized;=0A=
  },=0A=
=0A=
  capitalize: function() {=0A=
    return this.charAt(0).toUpperCase() + =
this.substring(1).toLowerCase();=0A=
  },=0A=
=0A=
  underscore: function() {=0A=
    return this.gsub(/::/, =
'/').gsub(/([A-Z]+)([A-Z][a-z])/,'#{1}_#{2}').gsub(/([a-z\d])([A-Z])/,'#{=
1}_#{2}').gsub(/-/,'_').toLowerCase();=0A=
  },=0A=
=0A=
  dasherize: function() {=0A=
    return this.gsub(/_/,'-');=0A=
  },=0A=
=0A=
  inspect: function(useDoubleQuotes) {=0A=
    var escapedString =3D this.gsub(/[\x00-\x1f\\]/, function(match) {=0A=
      var character =3D String.specialChar[match[0]];=0A=
      return character ? character : '\\u00' + =
match[0].charCodeAt().toPaddedString(2, 16);=0A=
    });=0A=
    if (useDoubleQuotes) return '"' + escapedString.replace(/"/g, '\\"') =
+ '"';=0A=
    return "'" + escapedString.replace(/'/g, '\\\'') + "'";=0A=
  },=0A=
=0A=
  toJSON: function() {=0A=
    return this.inspect(true);=0A=
  },=0A=
=0A=
  unfilterJSON: function(filter) {=0A=
    return this.sub(filter || Prototype.JSONFilter, '#{1}');=0A=
  },=0A=
=0A=
  isJSON: function() {=0A=
    var str =3D this;=0A=
    if (str.blank()) return false;=0A=
    str =3D this.replace(/\\./g, '@').replace(/"[^"\\\n\r]*"/g, '');=0A=
    return (/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(str);=0A=
  },=0A=
=0A=
  evalJSON: function(sanitize) {=0A=
    var json =3D this.unfilterJSON();=0A=
    try {=0A=
      if (!sanitize || json.isJSON()) return eval('(' + json + ')');=0A=
    } catch (e) { }=0A=
    throw new SyntaxError('Badly formed JSON string: ' + this.inspect());=0A=
  },=0A=
=0A=
  include: function(pattern) {=0A=
    return this.indexOf(pattern) > -1;=0A=
  },=0A=
=0A=
  startsWith: function(pattern) {=0A=
    return this.indexOf(pattern) =3D=3D=3D 0;=0A=
  },=0A=
=0A=
  endsWith: function(pattern) {=0A=
    var d =3D this.length - pattern.length;=0A=
    return d >=3D 0 && this.lastIndexOf(pattern) =3D=3D=3D d;=0A=
  },=0A=
=0A=
  empty: function() {=0A=
    return this =3D=3D '';=0A=
  },=0A=
=0A=
  blank: function() {=0A=
    return /^\s*$/.test(this);=0A=
  },=0A=
=0A=
  interpolate: function(object, pattern) {=0A=
    return new Template(this, pattern).evaluate(object);=0A=
  }=0A=
});=0A=
=0A=
if (Prototype.Browser.WebKit || Prototype.Browser.IE) =
Object.extend(String.prototype, {=0A=
  escapeHTML: function() {=0A=
    return =
this.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');=0A=
  },=0A=
  unescapeHTML: function() {=0A=
    return =
this.stripTags().replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;=
/g,'>');=0A=
  }=0A=
});=0A=
=0A=
String.prototype.gsub.prepareReplacement =3D function(replacement) {=0A=
  if (Object.isFunction(replacement)) return replacement;=0A=
  var template =3D new Template(replacement);=0A=
  return function(match) { return template.evaluate(match) };=0A=
};=0A=
=0A=
String.prototype.parseQuery =3D String.prototype.toQueryParams;=0A=
=0A=
Object.extend(String.prototype.escapeHTML, {=0A=
  div:  document.createElement('div'),=0A=
  text: document.createTextNode('')=0A=
});=0A=
=0A=
String.prototype.escapeHTML.div.appendChild(String.prototype.escapeHTML.t=
ext);=0A=
=0A=
var Template =3D Class.create({=0A=
  initialize: function(template, pattern) {=0A=
    this.template =3D template.toString();=0A=
    this.pattern =3D pattern || Template.Pattern;=0A=
  },=0A=
=0A=
  evaluate: function(object) {=0A=
    if (Object.isFunction(object.toTemplateReplacements))=0A=
      object =3D object.toTemplateReplacements();=0A=
=0A=
    return this.template.gsub(this.pattern, function(match) {=0A=
      if (object =3D=3D null) return '';=0A=
=0A=
      var before =3D match[1] || '';=0A=
      if (before =3D=3D '\\') return match[2];=0A=
=0A=
      var ctx =3D object, expr =3D match[3];=0A=
      var pattern =3D /^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;=0A=
      match =3D pattern.exec(expr);=0A=
      if (match =3D=3D null) return before;=0A=
=0A=
      while (match !=3D null) {=0A=
        var comp =3D match[1].startsWith('[') ? match[2].gsub('\\\\]', =
']') : match[1];=0A=
        ctx =3D ctx[comp];=0A=
        if (null =3D=3D ctx || '' =3D=3D match[3]) break;=0A=
        expr =3D expr.substring('[' =3D=3D match[3] ? match[1].length : =
match[0].length);=0A=
        match =3D pattern.exec(expr);=0A=
      }=0A=
=0A=
      return before + String.interpret(ctx);=0A=
    });=0A=
  }=0A=
});=0A=
Template.Pattern =3D /(^|.|\r|\n)(#\{(.*?)\})/;=0A=
=0A=
var $break =3D { };=0A=
=0A=
var Enumerable =3D {=0A=
  each: function(iterator, context) {=0A=
    var index =3D 0;=0A=
    try {=0A=
      this._each(function(value) {=0A=
        iterator.call(context, value, index++);=0A=
      });=0A=
    } catch (e) {=0A=
      if (e !=3D $break) throw e;=0A=
    }=0A=
    return this;=0A=
  },=0A=
=0A=
  eachSlice: function(number, iterator, context) {=0A=
    var index =3D -number, slices =3D [], array =3D this.toArray();=0A=
    if (number < 1) return array;=0A=
    while ((index +=3D number) < array.length)=0A=
      slices.push(array.slice(index, index+number));=0A=
    return slices.collect(iterator, context);=0A=
  },=0A=
=0A=
  all: function(iterator, context) {=0A=
    iterator =3D iterator || Prototype.K;=0A=
    var result =3D true;=0A=
    this.each(function(value, index) {=0A=
      result =3D result && !!iterator.call(context, value, index);=0A=
      if (!result) throw $break;=0A=
    });=0A=
    return result;=0A=
  },=0A=
=0A=
  any: function(iterator, context) {=0A=
    iterator =3D iterator || Prototype.K;=0A=
    var result =3D false;=0A=
    this.each(function(value, index) {=0A=
      if (result =3D !!iterator.call(context, value, index))=0A=
        throw $break;=0A=
    });=0A=
    return result;=0A=
  },=0A=
=0A=
  collect: function(iterator, context) {=0A=
    iterator =3D iterator || Prototype.K;=0A=
    var results =3D [];=0A=
    this.each(function(value, index) {=0A=
      results.push(iterator.call(context, value, index));=0A=
    });=0A=
    return results;=0A=
  },=0A=
=0A=
  detect: function(iterator, context) {=0A=
    var result;=0A=
    this.each(function(value, index) {=0A=
      if (iterator.call(context, value, index)) {=0A=
        result =3D value;=0A=
        throw $break;=0A=
      }=0A=
    });=0A=
    return result;=0A=
  },=0A=
=0A=
  findAll: function(iterator, context) {=0A=
    var results =3D [];=0A=
    this.each(function(value, index) {=0A=
      if (iterator.call(context, value, index))=0A=
        results.push(value);=0A=
    });=0A=
    return results;=0A=
  },=0A=
=0A=
  grep: function(filter, iterator, context) {=0A=
    iterator =3D iterator || Prototype.K;=0A=
    var results =3D [];=0A=
=0A=
    if (Object.isString(filter))=0A=
      filter =3D new RegExp(filter);=0A=
=0A=
    this.each(function(value, index) {=0A=
      if (filter.match(value))=0A=
        results.push(iterator.call(context, value, index));=0A=
    });=0A=
    return results;=0A=
  },=0A=
=0A=
  include: function(object) {=0A=
    if (Object.isFunction(this.indexOf))=0A=
      if (this.indexOf(object) !=3D -1) return true;=0A=
=0A=
    var found =3D false;=0A=
    this.each(function(value) {=0A=
      if (value =3D=3D object) {=0A=
        found =3D true;=0A=
        throw $break;=0A=
      }=0A=
    });=0A=
    return found;=0A=
  },=0A=
=0A=
  inGroupsOf: function(number, fillWith) {=0A=
    fillWith =3D Object.isUndefined(fillWith) ? null : fillWith;=0A=
    return this.eachSlice(number, function(slice) {=0A=
      while(slice.length < number) slice.push(fillWith);=0A=
      return slice;=0A=
    });=0A=
  },=0A=
=0A=
  inject: function(memo, iterator, context) {=0A=
    this.each(function(value, index) {=0A=
      memo =3D iterator.call(context, memo, value, index);=0A=
    });=0A=
    return memo;=0A=
  },=0A=
=0A=
  invoke: function(method) {=0A=
    var args =3D $A(arguments).slice(1);=0A=
    return this.map(function(value) {=0A=
      return value[method].apply(value, args);=0A=
    });=0A=
  },=0A=
=0A=
  max: function(iterator, context) {=0A=
    iterator =3D iterator || Prototype.K;=0A=
    var result;=0A=
    this.each(function(value, index) {=0A=
      value =3D iterator.call(context, value, index);=0A=
      if (result =3D=3D null || value >=3D result)=0A=
        result =3D value;=0A=
    });=0A=
    return result;=0A=
  },=0A=
=0A=
  min: function(iterator, context) {=0A=
    iterator =3D iterator || Prototype.K;=0A=
    var result;=0A=
    this.each(function(value, index) {=0A=
      value =3D iterator.call(context, value, index);=0A=
      if (result =3D=3D null || value < result)=0A=
        result =3D value;=0A=
    });=0A=
    return result;=0A=
  },=0A=
=0A=
  partition: function(iterator, context) {=0A=
    iterator =3D iterator || Prototype.K;=0A=
    var trues =3D [], falses =3D [];=0A=
    this.each(function(value, index) {=0A=
      (iterator.call(context, value, index) ?=0A=
        trues : falses).push(value);=0A=
    });=0A=
    return [trues, falses];=0A=
  },=0A=
=0A=
  pluck: function(property) {=0A=
    var results =3D [];=0A=
    this.each(function(value) {=0A=
      results.push(value[property]);=0A=
    });=0A=
    return results;=0A=
  },=0A=
=0A=
  reject: function(iterator, context) {=0A=
    var results =3D [];=0A=
    this.each(function(value, index) {=0A=
      if (!iterator.call(context, value, index))=0A=
        results.push(value);=0A=
    });=0A=
    return results;=0A=
  },=0A=
=0A=
  sortBy: function(iterator, context) {=0A=
    return this.map(function(value, index) {=0A=
      return {=0A=
        value: value,=0A=
        criteria: iterator.call(context, value, index)=0A=
      };=0A=
    }).sort(function(left, right) {=0A=
      var a =3D left.criteria, b =3D right.criteria;=0A=
      return a < b ? -1 : a > b ? 1 : 0;=0A=
    }).pluck('value');=0A=
  },=0A=
=0A=
  toArray: function() {=0A=
    return this.map();=0A=
  },=0A=
=0A=
  zip: function() {=0A=
    var iterator =3D Prototype.K, args =3D $A(arguments);=0A=
    if (Object.isFunction(args.last()))=0A=
      iterator =3D args.pop();=0A=
=0A=
    var collections =3D [this].concat(args).map($A);=0A=
    return this.map(function(value, index) {=0A=
      return iterator(collections.pluck(index));=0A=
    });=0A=
  },=0A=
=0A=
  size: function() {=0A=
    return this.toArray().length;=0A=
  },=0A=
=0A=
  inspect: function() {=0A=
    return '#<Enumerable:' + this.toArray().inspect() + '>';=0A=
  }=0A=
};=0A=
=0A=
Object.extend(Enumerable, {=0A=
  map:     Enumerable.collect,=0A=
  find:    Enumerable.detect,=0A=
  select:  Enumerable.findAll,=0A=
  filter:  Enumerable.findAll,=0A=
  member:  Enumerable.include,=0A=
  entries: Enumerable.toArray,=0A=
  every:   Enumerable.all,=0A=
  some:    Enumerable.any=0A=
});=0A=
function $A(iterable) {=0A=
  if (!iterable) return [];=0A=
  if (iterable.toArray) return iterable.toArray();=0A=
  var length =3D iterable.length || 0, results =3D new Array(length);=0A=
  while (length--) results[length] =3D iterable[length];=0A=
  return results;=0A=
}=0A=
=0A=
if (Prototype.Browser.WebKit) {=0A=
  $A =3D function(iterable) {=0A=
    if (!iterable) return [];=0A=
    // In Safari, only use the `toArray` method if it's not a NodeList.=0A=
    // A NodeList is a function, has an function `item` property, and a =
numeric=0A=
    // `length` property. Adapted from Google Doctype.=0A=
    if (!(typeof iterable =3D=3D=3D 'function' && typeof iterable.length =
=3D=3D=3D=0A=
        'number' && typeof iterable.item =3D=3D=3D 'function') && =
iterable.toArray)=0A=
      return iterable.toArray();=0A=
    var length =3D iterable.length || 0, results =3D new Array(length);=0A=
    while (length--) results[length] =3D iterable[length];=0A=
    return results;=0A=
  };=0A=
}=0A=
=0A=
Array.from =3D $A;=0A=
=0A=
Object.extend(Array.prototype, Enumerable);=0A=
=0A=
if (!Array.prototype._reverse) Array.prototype._reverse =3D =
Array.prototype.reverse;=0A=
=0A=
Object.extend(Array.prototype, {=0A=
  _each: function(iterator) {=0A=
    for (var i =3D 0, length =3D this.length; i < length; i++)=0A=
      iterator(this[i]);=0A=
  },=0A=
=0A=
  clear: function() {=0A=
    this.length =3D 0;=0A=
    return this;=0A=
  },=0A=
=0A=
  first: function() {=0A=
    return this[0];=0A=
  },=0A=
=0A=
  last: function() {=0A=
    return this[this.length - 1];=0A=
  },=0A=
=0A=
  compact: function() {=0A=
    return this.select(function(value) {=0A=
      return value !=3D null;=0A=
    });=0A=
  },=0A=
=0A=
  flatten: function() {=0A=
    return this.inject([], function(array, value) {=0A=
      return array.concat(Object.isArray(value) ?=0A=
        value.flatten() : [value]);=0A=
    });=0A=
  },=0A=
=0A=
  without: function() {=0A=
    var values =3D $A(arguments);=0A=
    return this.select(function(value) {=0A=
      return !values.include(value);=0A=
    });=0A=
  },=0A=
=0A=
  reverse: function(inline) {=0A=
    return (inline !=3D=3D false ? this : this.toArray())._reverse();=0A=
  },=0A=
=0A=
  reduce: function() {=0A=
    return this.length > 1 ? this : this[0];=0A=
  },=0A=
=0A=
  uniq: function(sorted) {=0A=
    return this.inject([], function(array, value, index) {=0A=
      if (0 =3D=3D index || (sorted ? array.last() !=3D value : =
!array.include(value)))=0A=
        array.push(value);=0A=
      return array;=0A=
    });=0A=
  },=0A=
=0A=
  intersect: function(array) {=0A=
    return this.uniq().findAll(function(item) {=0A=
      return array.detect(function(value) { return item =3D=3D=3D value =
});=0A=
    });=0A=
  },=0A=
=0A=
  clone: function() {=0A=
    return [].concat(this);=0A=
  },=0A=
=0A=
  size: function() {=0A=
    return this.length;=0A=
  },=0A=
=0A=
  inspect: function() {=0A=
    return '[' + this.map(Object.inspect).join(', ') + ']';=0A=
  },=0A=
=0A=
  toJSON: function() {=0A=
    var results =3D [];=0A=
    this.each(function(object) {=0A=
      var value =3D Object.toJSON(object);=0A=
      if (!Object.isUndefined(value)) results.push(value);=0A=
    });=0A=
    return '[' + results.join(', ') + ']';=0A=
  }=0A=
});=0A=
=0A=
// use native browser JS 1.6 implementation if available=0A=
if (Object.isFunction(Array.prototype.forEach))=0A=
  Array.prototype._each =3D Array.prototype.forEach;=0A=
=0A=
if (!Array.prototype.indexOf) Array.prototype.indexOf =3D function(item, =
i) {=0A=
  i || (i =3D 0);=0A=
  var length =3D this.length;=0A=
  if (i < 0) i =3D length + i;=0A=
  for (; i < length; i++)=0A=
    if (this[i] =3D=3D=3D item) return i;=0A=
  return -1;=0A=
};=0A=
=0A=
if (!Array.prototype.lastIndexOf) Array.prototype.lastIndexOf =3D =
function(item, i) {=0A=
  i =3D isNaN(i) ? this.length : (i < 0 ? this.length + i : i) + 1;=0A=
  var n =3D this.slice(0, i).reverse().indexOf(item);=0A=
  return (n < 0) ? n : i - n - 1;=0A=
};=0A=
=0A=
Array.prototype.toArray =3D Array.prototype.clone;=0A=
=0A=
function $w(string) {=0A=
  if (!Object.isString(string)) return [];=0A=
  string =3D string.strip();=0A=
  return string ? string.split(/\s+/) : [];=0A=
}=0A=
=0A=
if (Prototype.Browser.Opera){=0A=
  Array.prototype.concat =3D function() {=0A=
    var array =3D [];=0A=
    for (var i =3D 0, length =3D this.length; i < length; i++) =
array.push(this[i]);=0A=
    for (var i =3D 0, length =3D arguments.length; i < length; i++) {=0A=
      if (Object.isArray(arguments[i])) {=0A=
        for (var j =3D 0, arrayLength =3D arguments[i].length; j < =
arrayLength; j++)=0A=
          array.push(arguments[i][j]);=0A=
      } else {=0A=
        array.push(arguments[i]);=0A=
      }=0A=
    }=0A=
    return array;=0A=
  };=0A=
}=0A=
Object.extend(Number.prototype, {=0A=
  toColorPart: function() {=0A=
    return this.toPaddedString(2, 16);=0A=
  },=0A=
=0A=
  succ: function() {=0A=
    return this + 1;=0A=
  },=0A=
=0A=
  times: function(iterator, context) {=0A=
    $R(0, this, true).each(iterator, context);=0A=
    return this;=0A=
  },=0A=
=0A=
  toPaddedString: function(length, radix) {=0A=
    var string =3D this.toString(radix || 10);=0A=
    return '0'.times(length - string.length) + string;=0A=
  },=0A=
=0A=
  toJSON: function() {=0A=
    return isFinite(this) ? this.toString() : 'null';=0A=
  }=0A=
});=0A=
=0A=
$w('abs round ceil floor').each(function(method){=0A=
  Number.prototype[method] =3D Math[method].methodize();=0A=
});=0A=
function $H(object) {=0A=
  return new Hash(object);=0A=
};=0A=
=0A=
var Hash =3D Class.create(Enumerable, (function() {=0A=
=0A=
  function toQueryPair(key, value) {=0A=
    if (Object.isUndefined(value)) return key;=0A=
    return key + '=3D' + encodeURIComponent(String.interpret(value));=0A=
  }=0A=
=0A=
  return {=0A=
    initialize: function(object) {=0A=
      this._object =3D Object.isHash(object) ? object.toObject() : =
Object.clone(object);=0A=
    },=0A=
=0A=
    _each: function(iterator) {=0A=
      for (var key in this._object) {=0A=
        var value =3D this._object[key], pair =3D [key, value];=0A=
        pair.key =3D key;=0A=
        pair.value =3D value;=0A=
        iterator(pair);=0A=
      }=0A=
    },=0A=
=0A=
    set: function(key, value) {=0A=
      return this._object[key] =3D value;=0A=
    },=0A=
=0A=
    get: function(key) {=0A=
      // simulating poorly supported hasOwnProperty=0A=
      if (this._object[key] !=3D=3D Object.prototype[key])=0A=
        return this._object[key];=0A=
    },=0A=
=0A=
    unset: function(key) {=0A=
      var value =3D this._object[key];=0A=
      delete this._object[key];=0A=
      return value;=0A=
    },=0A=
=0A=
    toObject: function() {=0A=
      return Object.clone(this._object);=0A=
    },=0A=
=0A=
    keys: function() {=0A=
      return this.pluck('key');=0A=
    },=0A=
=0A=
    values: function() {=0A=
      return this.pluck('value');=0A=
    },=0A=
=0A=
    index: function(value) {=0A=
      var match =3D this.detect(function(pair) {=0A=
        return pair.value =3D=3D=3D value;=0A=
      });=0A=
      return match && match.key;=0A=
    },=0A=
=0A=
    merge: function(object) {=0A=
      return this.clone().update(object);=0A=
    },=0A=
=0A=
    update: function(object) {=0A=
      return new Hash(object).inject(this, function(result, pair) {=0A=
        result.set(pair.key, pair.value);=0A=
        return result;=0A=
      });=0A=
    },=0A=
=0A=
    toQueryString: function() {=0A=
      return this.inject([], function(results, pair) {=0A=
        var key =3D encodeURIComponent(pair.key), values =3D pair.value;=0A=
=0A=
        if (values && typeof values =3D=3D 'object') {=0A=
          if (Object.isArray(values))=0A=
            return results.concat(values.map(toQueryPair.curry(key)));=0A=
        } else results.push(toQueryPair(key, values));=0A=
        return results;=0A=
      }).join('&');=0A=
    },=0A=
=0A=
    inspect: function() {=0A=
      return '#<Hash:{' + this.map(function(pair) {=0A=
        return pair.map(Object.inspect).join(': ');=0A=
      }).join(', ') + '}>';=0A=
    },=0A=
=0A=
    toJSON: function() {=0A=
      return Object.toJSON(this.toObject());=0A=
    },=0A=
=0A=
    clone: function() {=0A=
      return new Hash(this);=0A=
    }=0A=
  }=0A=
})());=0A=
=0A=
Hash.prototype.toTemplateReplacements =3D Hash.prototype.toObject;=0A=
Hash.from =3D $H;=0A=
var ObjectRange =3D Class.create(Enumerable, {=0A=
  initialize: function(start, end, exclusive) {=0A=
    this.start =3D start;=0A=
    this.end =3D end;=0A=
    this.exclusive =3D exclusive;=0A=
  },=0A=
=0A=
  _each: function(iterator) {=0A=
    var value =3D this.start;=0A=
    while (this.include(value)) {=0A=
      iterator(value);=0A=
      value =3D value.succ();=0A=
    }=0A=
  },=0A=
=0A=
  include: function(value) {=0A=
    if (value < this.start)=0A=
      return false;=0A=
    if (this.exclusive)=0A=
      return value < this.end;=0A=
    return value <=3D this.end;=0A=
  }=0A=
});=0A=
=0A=
var $R =3D function(start, end, exclusive) {=0A=
  return new ObjectRange(start, end, exclusive);=0A=
};=0A=
=0A=
var Ajax =3D {=0A=
  getTransport: function() {=0A=
    return Try.these(=0A=
      function() {return new XMLHttpRequest()},=0A=
      function() {return new ActiveXObject('Msxml2.XMLHTTP')},=0A=
      function() {return new ActiveXObject('Microsoft.XMLHTTP')}=0A=
    ) || false;=0A=
  },=0A=
=0A=
  activeRequestCount: 0=0A=
};=0A=
=0A=
Ajax.Responders =3D {=0A=
  responders: [],=0A=
=0A=
  _each: function(iterator) {=0A=
    this.responders._each(iterator);=0A=
  },=0A=
=0A=
  register: function(responder) {=0A=
    if (!this.include(responder))=0A=
      this.responders.push(responder);=0A=
  },=0A=
=0A=
  unregister: function(responder) {=0A=
    this.responders =3D this.responders.without(responder);=0A=
  },=0A=
=0A=
  dispatch: function(callback, request, transport, json) {=0A=
    this.each(function(responder) {=0A=
      if (Object.isFunction(responder[callback])) {=0A=
        try {=0A=
          responder[callback].apply(responder, [request, transport, =
json]);=0A=
        } catch (e) { }=0A=
      }=0A=
    });=0A=
  }=0A=
};=0A=
=0A=
Object.extend(Ajax.Responders, Enumerable);=0A=
=0A=
Ajax.Responders.register({=0A=
  onCreate:   function() { Ajax.activeRequestCount++ },=0A=
  onComplete: function() { Ajax.activeRequestCount-- }=0A=
});=0A=
=0A=
Ajax.Base =3D Class.create({=0A=
  initialize: function(options) {=0A=
    this.options =3D {=0A=
      method:       'post',=0A=
      asynchronous: true,=0A=
      contentType:  'application/x-www-form-urlencoded',=0A=
      encoding:     'UTF-8',=0A=
      parameters:   '',=0A=
      evalJSON:     true,=0A=
      evalJS:       true=0A=
    };=0A=
    Object.extend(this.options, options || { });=0A=
=0A=
    this.options.method =3D this.options.method.toLowerCase();=0A=
=0A=
    if (Object.isString(this.options.parameters))=0A=
      this.options.parameters =3D =
this.options.parameters.toQueryParams();=0A=
    else if (Object.isHash(this.options.parameters))=0A=
      this.options.parameters =3D this.options.parameters.toObject();=0A=
  }=0A=
});=0A=
=0A=
Ajax.Request =3D Class.create(Ajax.Base, {=0A=
  _complete: false,=0A=
=0A=
  initialize: function($super, url, options) {=0A=
    $super(options);=0A=
    this.transport =3D Ajax.getTransport();=0A=
    this.request(url);=0A=
  },=0A=
=0A=
  request: function(url) {=0A=
    this.url =3D url;=0A=
    this.method =3D this.options.method;=0A=
    var params =3D Object.clone(this.options.parameters);=0A=
=0A=
    if (!['get', 'post'].include(this.method)) {=0A=
      // simulate other verbs over post=0A=
      params['_method'] =3D this.method;=0A=
      this.method =3D 'post';=0A=
    }=0A=
=0A=
    this.parameters =3D params;=0A=
=0A=
    if (params =3D Object.toQueryString(params)) {=0A=
      // when GET, append parameters to URL=0A=
      if (this.method =3D=3D 'get')=0A=
        this.url +=3D (this.url.include('?') ? '&' : '?') + params;=0A=
      else if (/Konqueror|Safari|KHTML/.test(navigator.userAgent))=0A=
        params +=3D '&_=3D';=0A=
    }=0A=
=0A=
    try {=0A=
      var response =3D new Ajax.Response(this);=0A=
      if (this.options.onCreate) this.options.onCreate(response);=0A=
      Ajax.Responders.dispatch('onCreate', this, response);=0A=
=0A=
      this.transport.open(this.method.toUpperCase(), this.url,=0A=
        this.options.asynchronous);=0A=
=0A=
      if (this.options.asynchronous) =
this.respondToReadyState.bind(this).defer(1);=0A=
=0A=
      this.transport.onreadystatechange =3D =
this.onStateChange.bind(this);=0A=
      this.setRequestHeaders();=0A=
=0A=
      this.body =3D this.method =3D=3D 'post' ? (this.options.postBody =
|| params) : null;=0A=
      this.transport.send(this.body);=0A=
=0A=
      /* Force Firefox to handle ready state 4 for synchronous requests =
*/=0A=
      if (!this.options.asynchronous && this.transport.overrideMimeType)=0A=
        this.onStateChange();=0A=
=0A=
    }=0A=
    catch (e) {=0A=
      this.dispatchException(e);=0A=
    }=0A=
  },=0A=
=0A=
  onStateChange: function() {=0A=
    var readyState =3D this.transport.readyState;=0A=
    if (readyState > 1 && !((readyState =3D=3D 4) && this._complete))=0A=
      this.respondToReadyState(this.transport.readyState);=0A=
  },=0A=
=0A=
  setRequestHeaders: function() {=0A=
    var headers =3D {=0A=
      'X-Requested-With': 'XMLHttpRequest',=0A=
      'X-Prototype-Version': Prototype.Version,=0A=
      'Accept': 'text/javascript, text/html, application/xml, text/xml, =
*/*'=0A=
    };=0A=
=0A=
    if (this.method =3D=3D 'post') {=0A=
      headers['Content-type'] =3D this.options.contentType +=0A=
        (this.options.encoding ? '; charset=3D' + this.options.encoding =
: '');=0A=
=0A=
      /* Force "Connection: close" for older Mozilla browsers to work=0A=
       * around a bug where XMLHttpRequest sends an incorrect=0A=
       * Content-length header. See Mozilla Bugzilla #246651.=0A=
       */=0A=
      if (this.transport.overrideMimeType &&=0A=
          (navigator.userAgent.match(/Gecko\/(\d{4})/) || [0,2005])[1] < =
2005)=0A=
            headers['Connection'] =3D 'close';=0A=
    }=0A=
=0A=
    // user-defined headers=0A=
    if (typeof this.options.requestHeaders =3D=3D 'object') {=0A=
      var extras =3D this.options.requestHeaders;=0A=
=0A=
      if (Object.isFunction(extras.push))=0A=
        for (var i =3D 0, length =3D extras.length; i < length; i +=3D 2)=0A=
          headers[extras[i]] =3D extras[i+1];=0A=
      else=0A=
        $H(extras).each(function(pair) { headers[pair.key] =3D =
pair.value });=0A=
    }=0A=
=0A=
    for (var name in headers)=0A=
      this.transport.setRequestHeader(name, headers[name]);=0A=
  },=0A=
=0A=
  success: function() {=0A=
    var status =3D this.getStatus();=0A=
    return !status || (status >=3D 200 && status < 300);=0A=
  },=0A=
=0A=
  getStatus: function() {=0A=
    try {=0A=
      return this.transport.status || 0;=0A=
    } catch (e) { return 0 }=0A=
  },=0A=
=0A=
  respondToReadyState: function(readyState) {=0A=
    var state =3D Ajax.Request.Events[readyState], response =3D new =
Ajax.Response(this);=0A=
=0A=
    if (state =3D=3D 'Complete') {=0A=
      try {=0A=
        this._complete =3D true;=0A=
        (this.options['on' + response.status]=0A=
         || this.options['on' + (this.success() ? 'Success' : 'Failure')]=0A=
         || Prototype.emptyFunction)(response, response.headerJSON);=0A=
      } catch (e) {=0A=
        this.dispatchException(e);=0A=
      }=0A=
=0A=
      var contentType =3D response.getHeader('Content-type');=0A=
      if (this.options.evalJS =3D=3D 'force'=0A=
          || (this.options.evalJS && this.isSameOrigin() && contentType=0A=
          && =
contentType.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s=
*$/i)))=0A=
        this.evalResponse();=0A=
    }=0A=
=0A=
    try {=0A=
      (this.options['on' + state] || Prototype.emptyFunction)(response, =
response.headerJSON);=0A=
      Ajax.Responders.dispatch('on' + state, this, response, =
response.headerJSON);=0A=
    } catch (e) {=0A=
      this.dispatchException(e);=0A=
    }=0A=
=0A=
    if (state =3D=3D 'Complete') {=0A=
      // avoid memory leak in MSIE: clean up=0A=
      this.transport.onreadystatechange =3D Prototype.emptyFunction;=0A=
    }=0A=
  },=0A=
=0A=
  isSameOrigin: function() {=0A=
    var m =3D this.url.match(/^\s*https?:\/\/[^\/]*/);=0A=
    return !m || (m[0] =3D=3D =
'#{protocol}//#{domain}#{port}'.interpolate({=0A=
      protocol: location.protocol,=0A=
      domain: document.domain,=0A=
      port: location.port ? ':' + location.port : ''=0A=
    }));=0A=
  },=0A=
=0A=
  getHeader: function(name) {=0A=
    try {=0A=
      return this.transport.getResponseHeader(name) || null;=0A=
    } catch (e) { return null }=0A=
  },=0A=
=0A=
  evalResponse: function() {=0A=
    try {=0A=
      return eval((this.transport.responseText || '').unfilterJSON());=0A=
    } catch (e) {=0A=
      this.dispatchException(e);=0A=
    }=0A=
  },=0A=
=0A=
  dispatchException: function(exception) {=0A=
    (this.options.onException || Prototype.emptyFunction)(this, =
exception);=0A=
    Ajax.Responders.dispatch('onException', this, exception);=0A=
  }=0A=
});=0A=
=0A=
Ajax.Request.Events =3D=0A=
  ['Uninitialized', 'Loading', 'Loaded', 'Interactive', 'Complete'];=0A=
=0A=
Ajax.Response =3D Class.create({=0A=
  initialize: function(request){=0A=
    this.request =3D request;=0A=
    var transport  =3D this.transport  =3D request.transport,=0A=
        readyState =3D this.readyState =3D transport.readyState;=0A=
=0A=
    if((readyState > 2 && !Prototype.Browser.IE) || readyState =3D=3D 4) =
{=0A=
      this.status       =3D this.getStatus();=0A=
      this.statusText   =3D this.getStatusText();=0A=
      this.responseText =3D String.interpret(transport.responseText);=0A=
      this.headerJSON   =3D this._getHeaderJSON();=0A=
    }=0A=
=0A=
    if(readyState =3D=3D 4) {=0A=
      var xml =3D transport.responseXML;=0A=
      this.responseXML  =3D Object.isUndefined(xml) ? null : xml;=0A=
      this.responseJSON =3D this._getResponseJSON();=0A=
    }=0A=
  },=0A=
=0A=
  status:      0,=0A=
  statusText: '',=0A=
=0A=
  getStatus: Ajax.Request.prototype.getStatus,=0A=
=0A=
  getStatusText: function() {=0A=
    try {=0A=
      return this.transport.statusText || '';=0A=
    } catch (e) { return '' }=0A=
  },=0A=
=0A=
  getHeader: Ajax.Request.prototype.getHeader,=0A=
=0A=
  getAllHeaders: function() {=0A=
    try {=0A=
      return this.getAllResponseHeaders();=0A=
    } catch (e) { return null }=0A=
  },=0A=
=0A=
  getResponseHeader: function(name) {=0A=
    return this.transport.getResponseHeader(name);=0A=
  },=0A=
=0A=
  getAllResponseHeaders: function() {=0A=
    return this.transport.getAllResponseHeaders();=0A=
  },=0A=
=0A=
  _getHeaderJSON: function() {=0A=
    var json =3D this.getHeader('X-JSON');=0A=
    if (!json) return null;=0A=
    json =3D decodeURIComponent(escape(json));=0A=
    try {=0A=
      return json.evalJSON(this.request.options.sanitizeJSON ||=0A=
        !this.request.isSameOrigin());=0A=
    } catch (e) {=0A=
      this.request.dispatchException(e);=0A=
    }=0A=
  },=0A=
=0A=
  _getResponseJSON: function() {=0A=
    var options =3D this.request.options;=0A=
    if (!options.evalJSON || (options.evalJSON !=3D 'force' &&=0A=
      !(this.getHeader('Content-type') || =
'').include('application/json')) ||=0A=
        this.responseText.blank())=0A=
          return null;=0A=
    try {=0A=
      return this.responseText.evalJSON(options.sanitizeJSON ||=0A=
        !this.request.isSameOrigin());=0A=
    } catch (e) {=0A=
      this.request.dispatchException(e);=0A=
    }=0A=
  }=0A=
});=0A=
=0A=
Ajax.Updater =3D Class.create(Ajax.Request, {=0A=
  initialize: function($super, container, url, options) {=0A=
    this.container =3D {=0A=
      success: (container.success || container),=0A=
      failure: (container.failure || (container.success ? null : =
container))=0A=
    };=0A=
=0A=
    options =3D Object.clone(options);=0A=
    var onComplete =3D options.onComplete;=0A=
    options.onComplete =3D (function(response, json) {=0A=
      this.updateContent(response.responseText);=0A=
      if (Object.isFunction(onComplete)) onComplete(response, json);=0A=
    }).bind(this);=0A=
=0A=
    $super(url, options);=0A=
  },=0A=
=0A=
  updateContent: function(responseText) {=0A=
    var receiver =3D this.container[this.success() ? 'success' : =
'failure'],=0A=
        options =3D this.options;=0A=
=0A=
    if (!options.evalScripts) responseText =3D =
responseText.stripScripts();=0A=
=0A=
    if (receiver =3D $(receiver)) {=0A=
      if (options.insertion) {=0A=
        if (Object.isString(options.insertion)) {=0A=
          var insertion =3D { }; insertion[options.insertion] =3D =
responseText;=0A=
          receiver.insert(insertion);=0A=
        }=0A=
        else options.insertion(receiver, responseText);=0A=
      }=0A=
      else receiver.update(responseText);=0A=
    }=0A=
  }=0A=
});=0A=
=0A=
Ajax.PeriodicalUpdater =3D Class.create(Ajax.Base, {=0A=
  initialize: function($super, container, url, options) {=0A=
    $super(options);=0A=
    this.onComplete =3D this.options.onComplete;=0A=
=0A=
    this.frequency =3D (this.options.frequency || 2);=0A=
    this.decay =3D (this.options.decay || 1);=0A=
=0A=
    this.updater =3D { };=0A=
    this.container =3D container;=0A=
    this.url =3D url;=0A=
=0A=
    this.start();=0A=
  },=0A=
=0A=
  start: function() {=0A=
    this.options.onComplete =3D this.updateComplete.bind(this);=0A=
    this.onTimerEvent();=0A=
  },=0A=
=0A=
  stop: function() {=0A=
    this.updater.options.onComplete =3D undefined;=0A=
    clearTimeout(this.timer);=0A=
    (this.onComplete || Prototype.emptyFunction).apply(this, arguments);=0A=
  },=0A=
=0A=
  updateComplete: function(response) {=0A=
    if (this.options.decay) {=0A=
      this.decay =3D (response.responseText =3D=3D this.lastText ?=0A=
        this.decay * this.options.decay : 1);=0A=
=0A=
      this.lastText =3D response.responseText;=0A=
    }=0A=
    this.timer =3D this.onTimerEvent.bind(this).delay(this.decay * =
this.frequency);=0A=
  },=0A=
=0A=
  onTimerEvent: function() {=0A=
    this.updater =3D new Ajax.Updater(this.container, this.url, =
this.options);=0A=
  }=0A=
});=0A=
function $(element) {=0A=
  if (arguments.length > 1) {=0A=
    for (var i =3D 0, elements =3D [], length =3D arguments.length; i < =
length; i++)=0A=
      elements.push($(arguments[i]));=0A=
    return elements;=0A=
  }=0A=
  if (Object.isString(element))=0A=
    element =3D document.getElementById(element);=0A=
  return Element.extend(element);=0A=
}=0A=
=0A=
if (Prototype.BrowserFeatures.XPath) {=0A=
  document._getElementsByXPath =3D function(expression, parentElement) {=0A=
    var results =3D [];=0A=
    var query =3D document.evaluate(expression, $(parentElement) || =
document,=0A=
      null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);=0A=
    for (var i =3D 0, length =3D query.snapshotLength; i < length; i++)=0A=
      results.push(Element.extend(query.snapshotItem(i)));=0A=
    return results;=0A=
  };=0A=
}=0A=
=0A=
/*-----------------------------------------------------------------------=
---*/=0A=
=0A=
if (!window.Node) var Node =3D { };=0A=
=0A=
if (!Node.ELEMENT_NODE) {=0A=
  // DOM level 2 ECMAScript Language Binding=0A=
  Object.extend(Node, {=0A=
    ELEMENT_NODE: 1,=0A=
    ATTRIBUTE_NODE: 2,=0A=
    TEXT_NODE: 3,=0A=
    CDATA_SECTION_NODE: 4,=0A=
    ENTITY_REFERENCE_NODE: 5,=0A=
    ENTITY_NODE: 6,=0A=
    PROCESSING_INSTRUCTION_NODE: 7,=0A=
    COMMENT_NODE: 8,=0A=
    DOCUMENT_NODE: 9,=0A=
    DOCUMENT_TYPE_NODE: 10,=0A=
    DOCUMENT_FRAGMENT_NODE: 11,=0A=
    NOTATION_NODE: 12=0A=
  });=0A=
}=0A=
=0A=
(function() {=0A=
  var element =3D this.Element;=0A=
  this.Element =3D function(tagName, attributes) {=0A=
    attributes =3D attributes || { };=0A=
    tagName =3D tagName.toLowerCase();=0A=
    var cache =3D Element.cache;=0A=
    if (Prototype.Browser.IE && attributes.name) {=0A=
      tagName =3D '<' + tagName + ' name=3D"' + attributes.name + '">';=0A=
      delete attributes.name;=0A=
      return Element.writeAttribute(document.createElement(tagName), =
attributes);=0A=
    }=0A=
    if (!cache[tagName]) cache[tagName] =3D =
Element.extend(document.createElement(tagName));=0A=
    return Element.writeAttribute(cache[tagName].cloneNode(false), =
attributes);=0A=
  };=0A=
  Object.extend(this.Element, element || { });=0A=
  if (element) this.Element.prototype =3D element.prototype;=0A=
}).call(window);=0A=
=0A=
Element.cache =3D { };=0A=
=0A=
Element.Methods =3D {=0A=
  visible: function(element) {=0A=
    return $(element).style.display !=3D 'none';=0A=
  },=0A=
=0A=
  toggle: function(element) {=0A=
    element =3D $(element);=0A=
    Element[Element.visible(element) ? 'hide' : 'show'](element);=0A=
    return element;=0A=
  },=0A=
=0A=
  hide: function(element) {=0A=
    element =3D $(element);=0A=
    element.style.display =3D 'none';=0A=
    return element;=0A=
  },=0A=
=0A=
  show: function(element) {=0A=
    element =3D $(element);=0A=
    element.style.display =3D '';=0A=
    return element;=0A=
  },=0A=
=0A=
  remove: function(element) {=0A=
    element =3D $(element);=0A=
    element.parentNode.removeChild(element);=0A=
    return element;=0A=
  },=0A=
=0A=
  update: function(element, content) {=0A=
    element =3D $(element);=0A=
    if (content && content.toElement) content =3D content.toElement();=0A=
    if (Object.isElement(content)) return =
element.update().insert(content);=0A=
    content =3D Object.toHTML(content);=0A=
    element.innerHTML =3D content.stripScripts();=0A=
    content.evalScripts.bind(content).defer();=0A=
    return element;=0A=
  },=0A=
=0A=
  replace: function(element, content) {=0A=
    element =3D $(element);=0A=
    if (content && content.toElement) content =3D content.toElement();=0A=
    else if (!Object.isElement(content)) {=0A=
      content =3D Object.toHTML(content);=0A=
      var range =3D element.ownerDocument.createRange();=0A=
      range.selectNode(element);=0A=
      content.evalScripts.bind(content).defer();=0A=
      content =3D range.createContextualFragment(content.stripScripts());=0A=
    }=0A=
    element.parentNode.replaceChild(content, element);=0A=
    return element;=0A=
  },=0A=
=0A=
  insert: function(element, insertions) {=0A=
    element =3D $(element);=0A=
=0A=
    if (Object.isString(insertions) || Object.isNumber(insertions) ||=0A=
        Object.isElement(insertions) || (insertions && =
(insertions.toElement || insertions.toHTML)))=0A=
          insertions =3D {bottom:insertions};=0A=
=0A=
    var content, insert, tagName, childNodes;=0A=
=0A=
    for (var position in insertions) {=0A=
      content  =3D insertions[position];=0A=
      position =3D position.toLowerCase();=0A=
      insert =3D Element._insertionTranslations[position];=0A=
=0A=
      if (content && content.toElement) content =3D content.toElement();=0A=
      if (Object.isElement(content)) {=0A=
        insert(element, content);=0A=
        continue;=0A=
      }=0A=
=0A=
      content =3D Object.toHTML(content);=0A=
=0A=
      tagName =3D ((position =3D=3D 'before' || position =3D=3D 'after')=0A=
        ? element.parentNode : element).tagName.toUpperCase();=0A=
=0A=
      childNodes =3D Element._getContentFromAnonymousElement(tagName, =
content.stripScripts());=0A=
=0A=
      if (position =3D=3D 'top' || position =3D=3D 'after') =
childNodes.reverse();=0A=
      childNodes.each(insert.curry(element));=0A=
=0A=
      content.evalScripts.bind(content).defer();=0A=
    }=0A=
=0A=
    return element;=0A=
  },=0A=
=0A=
  wrap: function(element, wrapper, attributes) {=0A=
    element =3D $(element);=0A=
    if (Object.isElement(wrapper))=0A=
      $(wrapper).writeAttribute(attributes || { });=0A=
    else if (Object.isString(wrapper)) wrapper =3D new Element(wrapper, =
attributes);=0A=
    else wrapper =3D new Element('div', wrapper);=0A=
    if (element.parentNode)=0A=
      element.parentNode.replaceChild(wrapper, element);=0A=
    wrapper.appendChild(element);=0A=
    return wrapper;=0A=
  },=0A=
=0A=
  inspect: function(element) {=0A=
    element =3D $(element);=0A=
    var result =3D '<' + element.tagName.toLowerCase();=0A=
    $H({'id': 'id', 'className': 'class'}).each(function(pair) {=0A=
      var property =3D pair.first(), attribute =3D pair.last();=0A=
      var value =3D (element[property] || '').toString();=0A=
      if (value) result +=3D ' ' + attribute + '=3D' + =
value.inspect(true);=0A=
    });=0A=
    return result + '>';=0A=
  },=0A=
=0A=
  recursivelyCollect: function(element, property) {=0A=
    element =3D $(element);=0A=
    var elements =3D [];=0A=
    while (element =3D element[property])=0A=
      if (element.nodeType =3D=3D 1)=0A=
        elements.push(Element.extend(element));=0A=
    return elements;=0A=
  },=0A=
=0A=
  ancestors: function(element) {=0A=
    return $(element).recursivelyCollect('parentNode');=0A=
  },=0A=
=0A=
  descendants: function(element) {=0A=
    return $(element).select("*");=0A=
  },=0A=
=0A=
  firstDescendant: function(element) {=0A=
    element =3D $(element).firstChild;=0A=
    while (element && element.nodeType !=3D 1) element =3D =
element.nextSibling;=0A=
    return $(element);=0A=
  },=0A=
=0A=
  immediateDescendants: function(element) {=0A=
    if (!(element =3D $(element).firstChild)) return [];=0A=
    while (element && element.nodeType !=3D 1) element =3D =
element.nextSibling;=0A=
    if (element) return [element].concat($(element).nextSiblings());=0A=
    return [];=0A=
  },=0A=
=0A=
  previousSiblings: function(element) {=0A=
    return $(element).recursivelyCollect('previousSibling');=0A=
  },=0A=
=0A=
  nextSiblings: function(element) {=0A=
    return $(element).recursivelyCollect('nextSibling');=0A=
  },=0A=
=0A=
  siblings: function(element) {=0A=
    element =3D $(element);=0A=
    return =
element.previousSiblings().reverse().concat(element.nextSiblings());=0A=
  },=0A=
=0A=
  match: function(element, selector) {=0A=
    if (Object.isString(selector))=0A=
      selector =3D new Selector(selector);=0A=
    return selector.match($(element));=0A=
  },=0A=
=0A=
  up: function(element, expression, index) {=0A=
    element =3D $(element);=0A=
    if (arguments.length =3D=3D 1) return $(element.parentNode);=0A=
    var ancestors =3D element.ancestors();=0A=
    return Object.isNumber(expression) ? ancestors[expression] :=0A=
      Selector.findElement(ancestors, expression, index);=0A=
  },=0A=
=0A=
  down: function(element, expression, index) {=0A=
    element =3D $(element);=0A=
    if (arguments.length =3D=3D 1) return element.firstDescendant();=0A=
    return Object.isNumber(expression) ? =
element.descendants()[expression] :=0A=
      Element.select(element, expression)[index || 0];=0A=
  },=0A=
=0A=
  previous: function(element, expression, index) {=0A=
    element =3D $(element);=0A=
    if (arguments.length =3D=3D 1) return =
$(Selector.handlers.previousElementSibling(element));=0A=
    var previousSiblings =3D element.previousSiblings();=0A=
    return Object.isNumber(expression) ? previousSiblings[expression] :=0A=
      Selector.findElement(previousSiblings, expression, index);=0A=
  },=0A=
=0A=
  next: function(element, expression, index) {=0A=
    element =3D $(element);=0A=
    if (arguments.length =3D=3D 1) return =
$(Selector.handlers.nextElementSibling(element));=0A=
    var nextSiblings =3D element.nextSiblings();=0A=
    return Object.isNumber(expression) ? nextSiblings[expression] :=0A=
      Selector.findElement(nextSiblings, expression, index);=0A=
  },=0A=
=0A=
  select: function() {=0A=
    var args =3D $A(arguments), element =3D $(args.shift());=0A=
    return Selector.findChildElements(element, args);=0A=
  },=0A=
=0A=
  adjacent: function() {=0A=
    var args =3D $A(arguments), element =3D $(args.shift());=0A=
    return Selector.findChildElements(element.parentNode, =
args).without(element);=0A=
  },=0A=
=0A=
  identify: function(element) {=0A=
    element =3D $(element);=0A=
    var id =3D element.readAttribute('id'), self =3D arguments.callee;=0A=
    if (id) return id;=0A=
    do { id =3D 'anonymous_element_' + self.counter++ } while ($(id));=0A=
    element.writeAttribute('id', id);=0A=
    return id;=0A=
  },=0A=
=0A=
  readAttribute: function(element, name) {=0A=
    element =3D $(element);=0A=
    if (Prototype.Browser.IE) {=0A=
      var t =3D Element._attributeTranslations.read;=0A=
      if (t.values[name]) return t.values[name](element, name);=0A=
      if (t.names[name]) name =3D t.names[name];=0A=
      if (name.include(':')) {=0A=
        return (!element.attributes || !element.attributes[name]) ? null =
:=0A=
         element.attributes[name].value;=0A=
      }=0A=
    }=0A=
    return element.getAttribute(name);=0A=
  },=0A=
=0A=
  writeAttribute: function(element, name, value) {=0A=
    element =3D $(element);=0A=
    var attributes =3D { }, t =3D Element._attributeTranslations.write;=0A=
=0A=
    if (typeof name =3D=3D 'object') attributes =3D name;=0A=
    else attributes[name] =3D Object.isUndefined(value) ? true : value;=0A=
=0A=
    for (var attr in attributes) {=0A=
      name =3D t.names[attr] || attr;=0A=
      value =3D attributes[attr];=0A=
      if (t.values[attr]) name =3D t.values[attr](element, value);=0A=
      if (value =3D=3D=3D false || value =3D=3D=3D null)=0A=
        element.removeAttribute(name);=0A=
      else if (value =3D=3D=3D true)=0A=
        element.setAttribute(name, name);=0A=
      else element.setAttribute(name, value);=0A=
    }=0A=
    return element;=0A=
  },=0A=
=0A=
  getHeight: function(element) {=0A=
    return $(element).getDimensions().height;=0A=
  },=0A=
=0A=
  getWidth: function(element) {=0A=
    return $(element).getDimensions().width;=0A=
  },=0A=
=0A=
  classNames: function(element) {=0A=
    return new Element.ClassNames(element);=0A=
  },=0A=
=0A=
  hasClassName: function(element, className) {=0A=
    if (!(element =3D $(element))) return;=0A=
    var elementClassName =3D element.className;=0A=
    return (elementClassName.length > 0 && (elementClassName =3D=3D =
className ||=0A=
      new RegExp("(^|\\s)" + className + =
"(\\s|$)").test(elementClassName)));=0A=
  },=0A=
=0A=
  addClassName: function(element, className) {=0A=
    if (!(element =3D $(element))) return;=0A=
    if (!element.hasClassName(className))=0A=
      element.className +=3D (element.className ? ' ' : '') + className;=0A=
    return element;=0A=
  },=0A=
=0A=
  removeClassName: function(element, className) {=0A=
    if (!(element =3D $(element))) return;=0A=
    element.className =3D element.className.replace(=0A=
      new RegExp("(^|\\s+)" + className + "(\\s+|$)"), ' ').strip();=0A=
    return element;=0A=
  },=0A=
=0A=
  toggleClassName: function(element, className) {=0A=
    if (!(element =3D $(element))) return;=0A=
    return element[element.hasClassName(className) ?=0A=
      'removeClassName' : 'addClassName'](className);=0A=
  },=0A=
=0A=
  // removes whitespace-only text node children=0A=
  cleanWhitespace: function(element) {=0A=
    element =3D $(element);=0A=
    var node =3D element.firstChild;=0A=
    while (node) {=0A=
      var nextNode =3D node.nextSibling;=0A=
      if (node.nodeType =3D=3D 3 && !/\S/.test(node.nodeValue))=0A=
        element.removeChild(node);=0A=
      node =3D nextNode;=0A=
    }=0A=
    return element;=0A=
  },=0A=
=0A=
  empty: function(element) {=0A=
    return $(element).innerHTML.blank();=0A=
  },=0A=
=0A=
  descendantOf: function(element, ancestor) {=0A=
    element =3D $(element), ancestor =3D $(ancestor);=0A=
=0A=
    if (element.compareDocumentPosition)=0A=
      return (element.compareDocumentPosition(ancestor) & 8) =3D=3D=3D 8;=0A=
=0A=
    if (ancestor.contains)=0A=
      return ancestor.contains(element) && ancestor !=3D=3D element;=0A=
=0A=
    while (element =3D element.parentNode)=0A=
      if (element =3D=3D ancestor) return true;=0A=
=0A=
    return false;=0A=
  },=0A=
=0A=
  scrollTo: function(element) {=0A=
    element =3D $(element);=0A=
    var pos =3D element.cumulativeOffset();=0A=
    window.scrollTo(pos[0], pos[1]);=0A=
    return element;=0A=
  },=0A=
=0A=
  getStyle: function(element, style) {=0A=
    element =3D $(element);=0A=
    style =3D style =3D=3D 'float' ? 'cssFloat' : style.camelize();=0A=
    var value =3D element.style[style];=0A=
    if (!value || value =3D=3D 'auto') {=0A=
      var css =3D document.defaultView.getComputedStyle(element, null);=0A=
      value =3D css ? css[style] : null;=0A=
    }=0A=
    if (style =3D=3D 'opacity') return value ? parseFloat(value) : 1.0;=0A=
    return value =3D=3D 'auto' ? null : value;=0A=
  },=0A=
=0A=
  getOpacity: function(element) {=0A=
    return $(element).getStyle('opacity');=0A=
  },=0A=
=0A=
  setStyle: function(element, styles) {=0A=
    element =3D $(element);=0A=
    var elementStyle =3D element.style, match;=0A=
    if (Object.isString(styles)) {=0A=
      element.style.cssText +=3D ';' + styles;=0A=
      return styles.include('opacity') ?=0A=
        element.setOpacity(styles.match(/opacity:\s*(\d?\.?\d*)/)[1]) : =
element;=0A=
    }=0A=
    for (var property in styles)=0A=
      if (property =3D=3D 'opacity') =
element.setOpacity(styles[property]);=0A=
      else=0A=
        elementStyle[(property =3D=3D 'float' || property =3D=3D =
'cssFloat') ?=0A=
          (Object.isUndefined(elementStyle.styleFloat) ? 'cssFloat' : =
'styleFloat') :=0A=
            property] =3D styles[property];=0A=
=0A=
    return element;=0A=
  },=0A=
=0A=
  setOpacity: function(element, value) {=0A=
    element =3D $(element);=0A=
    element.style.opacity =3D (value =3D=3D 1 || value =3D=3D=3D '') ? =
'' :=0A=
      (value < 0.00001) ? 0 : value;=0A=
    return element;=0A=
  },=0A=
=0A=
  getDimensions: function(element) {=0A=
    element =3D $(element);=0A=
    var display =3D element.getStyle('display');=0A=
    if (display !=3D 'none' && display !=3D null) // Safari bug=0A=
      return {width: element.offsetWidth, height: element.offsetHeight};=0A=
=0A=
    // All *Width and *Height properties give 0 on elements with display =
none,=0A=
    // so enable the element temporarily=0A=
    var els =3D element.style;=0A=
    var originalVisibility =3D els.visibility;=0A=
    var originalPosition =3D els.position;=0A=
    var originalDisplay =3D els.display;=0A=
    els.visibility =3D 'hidden';=0A=
    els.position =3D 'absolute';=0A=
    els.display =3D 'block';=0A=
    var originalWidth =3D element.clientWidth;=0A=
    var originalHeight =3D element.clientHeight;=0A=
    els.display =3D originalDisplay;=0A=
    els.position =3D originalPosition;=0A=
    els.visibility =3D originalVisibility;=0A=
    return {width: originalWidth, height: originalHeight};=0A=
  },=0A=
=0A=
  makePositioned: function(element) {=0A=
    element =3D $(element);=0A=
    var pos =3D Element.getStyle(element, 'position');=0A=
    if (pos =3D=3D 'static' || !pos) {=0A=
      element._madePositioned =3D true;=0A=
      element.style.position =3D 'relative';=0A=
      // Opera returns the offset relative to the positioning context, =
when an=0A=
      // element is position relative but top and left have not been =
defined=0A=
      if (Prototype.Browser.Opera) {=0A=
        element.style.top =3D 0;=0A=
        element.style.left =3D 0;=0A=
      }=0A=
    }=0A=
    return element;=0A=
  },=0A=
=0A=
  undoPositioned: function(element) {=0A=
    element =3D $(element);=0A=
    if (element._madePositioned) {=0A=
      element._madePositioned =3D undefined;=0A=
      element.style.position =3D=0A=
        element.style.top =3D=0A=
        element.style.left =3D=0A=
        element.style.bottom =3D=0A=
        element.style.right =3D '';=0A=
    }=0A=
    return element;=0A=
  },=0A=
=0A=
  makeClipping: function(element) {=0A=
    element =3D $(element);=0A=
    if (element._overflow) return element;=0A=
    element._overflow =3D Element.getStyle(element, 'overflow') || =
'auto';=0A=
    if (element._overflow !=3D=3D 'hidden')=0A=
      element.style.overflow =3D 'hidden';=0A=
    return element;=0A=
  },=0A=
=0A=
  undoClipping: function(element) {=0A=
    element =3D $(element);=0A=
    if (!element._overflow) return element;=0A=
    element.style.overflow =3D element._overflow =3D=3D 'auto' ? '' : =
element._overflow;=0A=
    element._overflow =3D null;=0A=
    return element;=0A=
  },=0A=
=0A=
  cumulativeOffset: function(element) {=0A=
    var valueT =3D 0, valueL =3D 0;=0A=
    do {=0A=
      valueT +=3D element.offsetTop  || 0;=0A=
      valueL +=3D element.offsetLeft || 0;=0A=
      element =3D element.offsetParent;=0A=
    } while (element);=0A=
    return Element._returnOffset(valueL, valueT);=0A=
  },=0A=
=0A=
  positionedOffset: function(element) {=0A=
    var valueT =3D 0, valueL =3D 0;=0A=
    do {=0A=
      valueT +=3D element.offsetTop  || 0;=0A=
      valueL +=3D element.offsetLeft || 0;=0A=
      element =3D element.offsetParent;=0A=
      if (element) {=0A=
        if (element.tagName.toUpperCase() =3D=3D 'BODY') break;=0A=
        var p =3D Element.getStyle(element, 'position');=0A=
        if (p !=3D=3D 'static') break;=0A=
      }=0A=
    } while (element);=0A=
    return Element._returnOffset(valueL, valueT);=0A=
  },=0A=
=0A=
  absolutize: function(element) {=0A=
    element =3D $(element);=0A=
    if (element.getStyle('position') =3D=3D 'absolute') return element;=0A=
    // Position.prepare(); // To be done manually by Scripty when it =
needs it.=0A=
=0A=
    var offsets =3D element.positionedOffset();=0A=
    var top     =3D offsets[1];=0A=
    var left    =3D offsets[0];=0A=
    var width   =3D element.clientWidth;=0A=
    var height  =3D element.clientHeight;=0A=
=0A=
    element._originalLeft   =3D left - parseFloat(element.style.left  || =
0);=0A=
    element._originalTop    =3D top  - parseFloat(element.style.top || =
0);=0A=
    element._originalWidth  =3D element.style.width;=0A=
    element._originalHeight =3D element.style.height;=0A=
=0A=
    element.style.position =3D 'absolute';=0A=
    element.style.top    =3D top + 'px';=0A=
    element.style.left   =3D left + 'px';=0A=
    element.style.width  =3D width + 'px';=0A=
    element.style.height =3D height + 'px';=0A=
    return element;=0A=
  },=0A=
=0A=
  relativize: function(element) {=0A=
    element =3D $(element);=0A=
    if (element.getStyle('position') =3D=3D 'relative') return element;=0A=
    // Position.prepare(); // To be done manually by Scripty when it =
needs it.=0A=
=0A=
    element.style.position =3D 'relative';=0A=
    var top  =3D parseFloat(element.style.top  || 0) - =
(element._originalTop || 0);=0A=
    var left =3D parseFloat(element.style.left || 0) - =
(element._originalLeft || 0);=0A=
=0A=
    element.style.top    =3D top + 'px';=0A=
    element.style.left   =3D left + 'px';=0A=
    element.style.height =3D element._originalHeight;=0A=
    element.style.width  =3D element._originalWidth;=0A=
    return element;=0A=
  },=0A=
=0A=
  cumulativeScrollOffset: function(element) {=0A=
    var valueT =3D 0, valueL =3D 0;=0A=
    do {=0A=
      valueT +=3D element.scrollTop  || 0;=0A=
      valueL +=3D element.scrollLeft || 0;=0A=
      element =3D element.parentNode;=0A=
    } while (element);=0A=
    return Element._returnOffset(valueL, valueT);=0A=
  },=0A=
=0A=
  getOffsetParent: function(element) {=0A=
    if (element.offsetParent) return $(element.offsetParent);=0A=
    if (element =3D=3D document.body) return $(element);=0A=
=0A=
    while ((element =3D element.parentNode) && element !=3D =
document.body)=0A=
      if (Element.getStyle(element, 'position') !=3D 'static')=0A=
        return $(element);=0A=
=0A=
    return $(document.body);=0A=
  },=0A=
=0A=
  viewportOffset: function(forElement) {=0A=
    var valueT =3D 0, valueL =3D 0;=0A=
=0A=
    var element =3D forElement;=0A=
    do {=0A=
      valueT +=3D element.offsetTop  || 0;=0A=
      valueL +=3D element.offsetLeft || 0;=0A=
=0A=
      // Safari fix=0A=
      if (element.offsetParent =3D=3D document.body &&=0A=
        Element.getStyle(element, 'position') =3D=3D 'absolute') break;=0A=
=0A=
    } while (element =3D element.offsetParent);=0A=
=0A=
    element =3D forElement;=0A=
    do {=0A=
      if (!Prototype.Browser.Opera || (element.tagName && =
(element.tagName.toUpperCase() =3D=3D 'BODY'))) {=0A=
        valueT -=3D element.scrollTop  || 0;=0A=
        valueL -=3D element.scrollLeft || 0;=0A=
      }=0A=
    } while (element =3D element.parentNode);=0A=
=0A=
    return Element._returnOffset(valueL, valueT);=0A=
  },=0A=
=0A=
  clonePosition: function(element, source) {=0A=
    var options =3D Object.extend({=0A=
      setLeft:    true,=0A=
      setTop:     true,=0A=
      setWidth:   true,=0A=
      setHeight:  true,=0A=
      offsetTop:  0,=0A=
      offsetLeft: 0=0A=
    }, arguments[2] || { });=0A=
=0A=
    // find page position of source=0A=
    source =3D $(source);=0A=
    var p =3D source.viewportOffset();=0A=
=0A=
    // find coordinate system to use=0A=
    element =3D $(element);=0A=
    var delta =3D [0, 0];=0A=
    var parent =3D null;=0A=
    // delta [0,0] will do fine with position: fixed elements,=0A=
    // position:absolute needs offsetParent deltas=0A=
    if (Element.getStyle(element, 'position') =3D=3D 'absolute') {=0A=
      parent =3D element.getOffsetParent();=0A=
      delta =3D parent.viewportOffset();=0A=
    }=0A=
=0A=
    // correct by body offsets (fixes Safari)=0A=
    if (parent =3D=3D document.body) {=0A=
      delta[0] -=3D document.body.offsetLeft;=0A=
      delta[1] -=3D document.body.offsetTop;=0A=
    }=0A=
=0A=
    // set position=0A=
    if (options.setLeft)   element.style.left  =3D (p[0] - delta[0] + =
options.offsetLeft) + 'px';=0A=
    if (options.setTop)    element.style.top   =3D (p[1] - delta[1] + =
options.offsetTop) + 'px';=0A=
    if (options.setWidth)  element.style.width =3D source.offsetWidth + =
'px';=0A=
    if (options.setHeight) element.style.height =3D source.offsetHeight =
+ 'px';=0A=
    return element;=0A=
  }=0A=
};=0A=
=0A=
Element.Methods.identify.counter =3D 1;=0A=
=0A=
Object.extend(Element.Methods, {=0A=
  getElementsBySelector: Element.Methods.select,=0A=
  childElements: Element.Methods.immediateDescendants=0A=
});=0A=
=0A=
Element._attributeTranslations =3D {=0A=
  write: {=0A=
    names: {=0A=
      className: 'class',=0A=
      htmlFor:   'for'=0A=
    },=0A=
    values: { }=0A=
  }=0A=
};=0A=
=0A=
if (Prototype.Browser.Opera) {=0A=
  Element.Methods.getStyle =3D Element.Methods.getStyle.wrap(=0A=
    function(proceed, element, style) {=0A=
      switch (style) {=0A=
        case 'left': case 'top': case 'right': case 'bottom':=0A=
          if (proceed(element, 'position') =3D=3D=3D 'static') return =
null;=0A=
        case 'height': case 'width':=0A=
          // returns '0px' for hidden elements; we want it to return null=0A=
          if (!Element.visible(element)) return null;=0A=
=0A=
          // returns the border-box dimensions rather than the =
content-box=0A=
          // dimensions, so we subtract padding and borders from the =
value=0A=
          var dim =3D parseInt(proceed(element, style), 10);=0A=
=0A=
          if (dim !=3D=3D element['offset' + style.capitalize()])=0A=
            return dim + 'px';=0A=
=0A=
          var properties;=0A=
          if (style =3D=3D=3D 'height') {=0A=
            properties =3D ['border-top-width', 'padding-top',=0A=
             'padding-bottom', 'border-bottom-width'];=0A=
          }=0A=
          else {=0A=
            properties =3D ['border-left-width', 'padding-left',=0A=
             'padding-right', 'border-right-width'];=0A=
          }=0A=
          return properties.inject(dim, function(memo, property) {=0A=
            var val =3D proceed(element, property);=0A=
            return val =3D=3D=3D null ? memo : memo - parseInt(val, 10);=0A=
          }) + 'px';=0A=
        default: return proceed(element, style);=0A=
      }=0A=
    }=0A=
  );=0A=
=0A=
  Element.Methods.readAttribute =3D Element.Methods.readAttribute.wrap(=0A=
    function(proceed, element, attribute) {=0A=
      if (attribute =3D=3D=3D 'title') return element.title;=0A=
      return proceed(element, attribute);=0A=
    }=0A=
  );=0A=
}=0A=
=0A=
else if (Prototype.Browser.IE) {=0A=
  // IE doesn't report offsets correctly for static elements, so we =
change them=0A=
  // to "relative" to get the values, then change them back.=0A=
  Element.Methods.getOffsetParent =3D =
Element.Methods.getOffsetParent.wrap(=0A=
    function(proceed, element) {=0A=
      element =3D $(element);=0A=
      // IE throws an error if element is not in document=0A=
      try { element.offsetParent }=0A=
      catch(e) { return $(document.body) }=0A=
      var position =3D element.getStyle('position');=0A=
      if (position !=3D=3D 'static') return proceed(element);=0A=
      element.setStyle({ position: 'relative' });=0A=
      var value =3D proceed(element);=0A=
      element.setStyle({ position: position });=0A=
      return value;=0A=
    }=0A=
  );=0A=
=0A=
  $w('positionedOffset viewportOffset').each(function(method) {=0A=
    Element.Methods[method] =3D Element.Methods[method].wrap(=0A=
      function(proceed, element) {=0A=
        element =3D $(element);=0A=
        try { element.offsetParent }=0A=
        catch(e) { return Element._returnOffset(0,0) }=0A=
        var position =3D element.getStyle('position');=0A=
        if (position !=3D=3D 'static') return proceed(element);=0A=
        // Trigger hasLayout on the offset parent so that IE6 reports=0A=
        // accurate offsetTop and offsetLeft values for position: fixed.=0A=
        var offsetParent =3D element.getOffsetParent();=0A=
        if (offsetParent && offsetParent.getStyle('position') =3D=3D=3D =
'fixed')=0A=
          offsetParent.setStyle({ zoom: 1 });=0A=
        element.setStyle({ position: 'relative' });=0A=
        var value =3D proceed(element);=0A=
        element.setStyle({ position: position });=0A=
        return value;=0A=
      }=0A=
    );=0A=
  });=0A=
=0A=
  Element.Methods.cumulativeOffset =3D =
Element.Methods.cumulativeOffset.wrap(=0A=
    function(proceed, element) {=0A=
      try { element.offsetParent }=0A=
      catch(e) { return Element._returnOffset(0,0) }=0A=
      return proceed(element);=0A=
    }=0A=
  );=0A=
=0A=
  Element.Methods.getStyle =3D function(element, style) {=0A=
    element =3D $(element);=0A=
    style =3D (style =3D=3D 'float' || style =3D=3D 'cssFloat') ? =
'styleFloat' : style.camelize();=0A=
    var value =3D element.style[style];=0A=
    if (!value && element.currentStyle) value =3D =
element.currentStyle[style];=0A=
=0A=
    if (style =3D=3D 'opacity') {=0A=
      if (value =3D (element.getStyle('filter') || =
'').match(/alpha\(opacity=3D(.*)\)/))=0A=
        if (value[1]) return parseFloat(value[1]) / 100;=0A=
      return 1.0;=0A=
    }=0A=
=0A=
    if (value =3D=3D 'auto') {=0A=
      if ((style =3D=3D 'width' || style =3D=3D 'height') && =
(element.getStyle('display') !=3D 'none'))=0A=
        return element['offset' + style.capitalize()] + 'px';=0A=
      return null;=0A=
    }=0A=
    return value;=0A=
  };=0A=
=0A=
  Element.Methods.setOpacity =3D function(element, value) {=0A=
    function stripAlpha(filter){=0A=
      return filter.replace(/alpha\([^\)]*\)/gi,'');=0A=
    }=0A=
    element =3D $(element);=0A=
    var currentStyle =3D element.currentStyle;=0A=
    if ((currentStyle && !currentStyle.hasLayout) ||=0A=
      (!currentStyle && element.style.zoom =3D=3D 'normal'))=0A=
        element.style.zoom =3D 1;=0A=
=0A=
    var filter =3D element.getStyle('filter'), style =3D element.style;=0A=
    if (value =3D=3D 1 || value =3D=3D=3D '') {=0A=
      (filter =3D stripAlpha(filter)) ?=0A=
        style.filter =3D filter : style.removeAttribute('filter');=0A=
      return element;=0A=
    } else if (value < 0.00001) value =3D 0;=0A=
    style.filter =3D stripAlpha(filter) +=0A=
      'alpha(opacity=3D' + (value * 100) + ')';=0A=
    return element;=0A=
  };=0A=
=0A=
  Element._attributeTranslations =3D {=0A=
    read: {=0A=
      names: {=0A=
        'class': 'className',=0A=
        'for':   'htmlFor'=0A=
      },=0A=
      values: {=0A=
        _getAttr: function(element, attribute) {=0A=
          return element.getAttribute(attribute, 2);=0A=
        },=0A=
        _getAttrNode: function(element, attribute) {=0A=
          var node =3D element.getAttributeNode(attribute);=0A=
          return node ? node.value : "";=0A=
        },=0A=
        _getEv: function(element, attribute) {=0A=
          attribute =3D element.getAttribute(attribute);=0A=
          return attribute ? attribute.toString().slice(23, -2) : null;=0A=
        },=0A=
        _flag: function(element, attribute) {=0A=
          return $(element).hasAttribute(attribute) ? attribute : null;=0A=
        },=0A=
        style: function(element) {=0A=
          return element.style.cssText.toLowerCase();=0A=
        },=0A=
        title: function(element) {=0A=
          return element.title;=0A=
        }=0A=
      }=0A=
    }=0A=
  };=0A=
=0A=
  Element._attributeTranslations.write =3D {=0A=
    names: Object.extend({=0A=
      cellpadding: 'cellPadding',=0A=
      cellspacing: 'cellSpacing'=0A=
    }, Element._attributeTranslations.read.names),=0A=
    values: {=0A=
      checked: function(element, value) {=0A=
        element.checked =3D !!value;=0A=
      },=0A=
=0A=
      style: function(element, value) {=0A=
        element.style.cssText =3D value ? value : '';=0A=
      }=0A=
    }=0A=
  };=0A=
=0A=
  Element._attributeTranslations.has =3D {};=0A=
=0A=
  $w('colSpan rowSpan vAlign dateTime accessKey tabIndex ' +=0A=
      'encType maxLength readOnly longDesc =
frameBorder').each(function(attr) {=0A=
    Element._attributeTranslations.write.names[attr.toLowerCase()] =3D =
attr;=0A=
    Element._attributeTranslations.has[attr.toLowerCase()] =3D attr;=0A=
  });=0A=
=0A=
  (function(v) {=0A=
    Object.extend(v, {=0A=
      href:        v._getAttr,=0A=
      src:         v._getAttr,=0A=
      type:        v._getAttr,=0A=
      action:      v._getAttrNode,=0A=
      disabled:    v._flag,=0A=
      checked:     v._flag,=0A=
      readonly:    v._flag,=0A=
      multiple:    v._flag,=0A=
      onload:      v._getEv,=0A=
      onunload:    v._getEv,=0A=
      onclick:     v._getEv,=0A=
      ondblclick:  v._getEv,=0A=
      onmousedown: v._getEv,=0A=
      onmouseup:   v._getEv,=0A=
      onmouseover: v._getEv,=0A=
      onmousemove: v._getEv,=0A=
      onmouseout:  v._getEv,=0A=
      onfocus:     v._getEv,=0A=
      onblur:      v._getEv,=0A=
      onkeypress:  v._getEv,=0A=
      onkeydown:   v._getEv,=0A=
      onkeyup:     v._getEv,=0A=
      onsubmit:    v._getEv,=0A=
      onreset:     v._getEv,=0A=
      onselect:    v._getEv,=0A=
      onchange:    v._getEv=0A=
    });=0A=
  })(Element._attributeTranslations.read.values);=0A=
}=0A=
=0A=
else if (Prototype.Browser.Gecko && =
/rv:1\.8\.0/.test(navigator.userAgent)) {=0A=
  Element.Methods.setOpacity =3D function(element, value) {=0A=
    element =3D $(element);=0A=
    element.style.opacity =3D (value =3D=3D 1) ? 0.999999 :=0A=
      (value =3D=3D=3D '') ? '' : (value < 0.00001) ? 0 : value;=0A=
    return element;=0A=
  };=0A=
}=0A=
=0A=
else if (Prototype.Browser.WebKit) {=0A=
  Element.Methods.setOpacity =3D function(element, value) {=0A=
    element =3D $(element);=0A=
    element.style.opacity =3D (value =3D=3D 1 || value =3D=3D=3D '') ? =
'' :=0A=
      (value < 0.00001) ? 0 : value;=0A=
=0A=
    if (value =3D=3D 1)=0A=
      if(element.tagName.toUpperCase() =3D=3D 'IMG' && element.width) {=0A=
        element.width++; element.width--;=0A=
      } else try {=0A=
        var n =3D document.createTextNode(' ');=0A=
        element.appendChild(n);=0A=
        element.removeChild(n);=0A=
      } catch (e) { }=0A=
=0A=
    return element;=0A=
  };=0A=
=0A=
  // Safari returns margins on body which is incorrect if the child is =
absolutely=0A=
  // positioned.  For performance reasons, redefine =
Element#cumulativeOffset for=0A=
  // KHTML/WebKit only.=0A=
  Element.Methods.cumulativeOffset =3D function(element) {=0A=
    var valueT =3D 0, valueL =3D 0;=0A=
    do {=0A=
      valueT +=3D element.offsetTop  || 0;=0A=
      valueL +=3D element.offsetLeft || 0;=0A=
      if (element.offsetParent =3D=3D document.body)=0A=
        if (Element.getStyle(element, 'position') =3D=3D 'absolute') =
break;=0A=
=0A=
      element =3D element.offsetParent;=0A=
    } while (element);=0A=
=0A=
    return Element._returnOffset(valueL, valueT);=0A=
  };=0A=
}=0A=
=0A=
if (Prototype.Browser.IE || Prototype.Browser.Opera) {=0A=
  // IE and Opera are missing .innerHTML support for TABLE-related and =
SELECT elements=0A=
  Element.Methods.update =3D function(element, content) {=0A=
    element =3D $(element);=0A=
=0A=
    if (content && content.toElement) content =3D content.toElement();=0A=
    if (Object.isElement(content)) return =
element.update().insert(content);=0A=
=0A=
    content =3D Object.toHTML(content);=0A=
    var tagName =3D element.tagName.toUpperCase();=0A=
=0A=
    if (tagName in Element._insertionTranslations.tags) {=0A=
      $A(element.childNodes).each(function(node) { =
element.removeChild(node) });=0A=
      Element._getContentFromAnonymousElement(tagName, =
content.stripScripts())=0A=
        .each(function(node) { element.appendChild(node) });=0A=
    }=0A=
    else element.innerHTML =3D content.stripScripts();=0A=
=0A=
    content.evalScripts.bind(content).defer();=0A=
    return element;=0A=
  };=0A=
}=0A=
=0A=
if ('outerHTML' in document.createElement('div')) {=0A=
  Element.Methods.replace =3D function(element, content) {=0A=
    element =3D $(element);=0A=
=0A=
    if (content && content.toElement) content =3D content.toElement();=0A=
    if (Object.isElement(content)) {=0A=
      element.parentNode.replaceChild(content, element);=0A=
      return element;=0A=
    }=0A=
=0A=
    content =3D Object.toHTML(content);=0A=
    var parent =3D element.parentNode, tagName =3D =
parent.tagName.toUpperCase();=0A=
=0A=
    if (Element._insertionTranslations.tags[tagName]) {=0A=
      var nextSibling =3D element.next();=0A=
      var fragments =3D Element._getContentFromAnonymousElement(tagName, =
content.stripScripts());=0A=
      parent.removeChild(element);=0A=
      if (nextSibling)=0A=
        fragments.each(function(node) { parent.insertBefore(node, =
nextSibling) });=0A=
      else=0A=
        fragments.each(function(node) { parent.appendChild(node) });=0A=
    }=0A=
    else element.outerHTML =3D content.stripScripts();=0A=
=0A=
    content.evalScripts.bind(content).defer();=0A=
    return element;=0A=
  };=0A=
}=0A=
=0A=
Element._returnOffset =3D function(l, t) {=0A=
  var result =3D [l, t];=0A=
  result.left =3D l;=0A=
  result.top =3D t;=0A=
  return result;=0A=
};=0A=
=0A=
Element._getContentFromAnonymousElement =3D function(tagName, html) {=0A=
  var div =3D new Element('div'), t =3D =
Element._insertionTranslations.tags[tagName];=0A=
  if (t) {=0A=
    div.innerHTML =3D t[0] + html + t[1];=0A=
    t[2].times(function() { div =3D div.firstChild });=0A=
  } else div.innerHTML =3D html;=0A=
  return $A(div.childNodes);=0A=
};=0A=
=0A=
Element._insertionTranslations =3D {=0A=
  before: function(element, node) {=0A=
    element.parentNode.insertBefore(node, element);=0A=
  },=0A=
  top: function(element, node) {=0A=
    element.insertBefore(node, element.firstChild);=0A=
  },=0A=
  bottom: function(element, node) {=0A=
    element.appendChild(node);=0A=
  },=0A=
  after: function(element, node) {=0A=
    element.parentNode.insertBefore(node, element.nextSibling);=0A=
  },=0A=
  tags: {=0A=
    TABLE:  ['<table>',                '</table>',                   1],=0A=
    TBODY:  ['<table><tbody>',         '</tbody></table>',           2],=0A=
    TR:     ['<table><tbody><tr>',     '</tr></tbody></table>',      3],=0A=
    TD:     ['<table><tbody><tr><td>', '</td></tr></tbody></table>', 4],=0A=
    SELECT: ['<select>',               '</select>',                  1]=0A=
  }=0A=
};=0A=
=0A=
(function() {=0A=
  Object.extend(this.tags, {=0A=
    THEAD: this.tags.TBODY,=0A=
    TFOOT: this.tags.TBODY,=0A=
    TH:    this.tags.TD=0A=
  });=0A=
}).call(Element._insertionTranslations);=0A=
=0A=
Element.Methods.Simulated =3D {=0A=
  hasAttribute: function(element, attribute) {=0A=
    attribute =3D Element._attributeTranslations.has[attribute] || =
attribute;=0A=
    var node =3D $(element).getAttributeNode(attribute);=0A=
    return !!(node && node.specified);=0A=
  }=0A=
};=0A=
=0A=
Element.Methods.ByTag =3D { };=0A=
=0A=
Object.extend(Element, Element.Methods);=0A=
=0A=
if (!Prototype.BrowserFeatures.ElementExtensions &&=0A=
    document.createElement('div')['__proto__']) {=0A=
  window.HTMLElement =3D { };=0A=
  window.HTMLElement.prototype =3D =
document.createElement('div')['__proto__'];=0A=
  Prototype.BrowserFeatures.ElementExtensions =3D true;=0A=
}=0A=
=0A=
Element.extend =3D (function() {=0A=
  if (Prototype.BrowserFeatures.SpecificElementExtensions)=0A=
    return Prototype.K;=0A=
=0A=
  var Methods =3D { }, ByTag =3D Element.Methods.ByTag;=0A=
=0A=
  var extend =3D Object.extend(function(element) {=0A=
    if (!element || element._extendedByPrototype ||=0A=
        element.nodeType !=3D 1 || element =3D=3D window) return element;=0A=
=0A=
    var methods =3D Object.clone(Methods),=0A=
      tagName =3D element.tagName.toUpperCase(), property, value;=0A=
=0A=
    // extend methods for specific tags=0A=
    if (ByTag[tagName]) Object.extend(methods, ByTag[tagName]);=0A=
=0A=
    for (property in methods) {=0A=
      value =3D methods[property];=0A=
      if (Object.isFunction(value) && !(property in element))=0A=
        element[property] =3D value.methodize();=0A=
    }=0A=
=0A=
    element._extendedByPrototype =3D Prototype.emptyFunction;=0A=
    return element;=0A=
=0A=
  }, {=0A=
    refresh: function() {=0A=
      // extend methods for all tags (Safari doesn't need this)=0A=
      if (!Prototype.BrowserFeatures.ElementExtensions) {=0A=
        Object.extend(Methods, Element.Methods);=0A=
        Object.extend(Methods, Element.Methods.Simulated);=0A=
      }=0A=
    }=0A=
  });=0A=
=0A=
  extend.refresh();=0A=
  return extend;=0A=
})();=0A=
=0A=
Element.hasAttribute =3D function(element, attribute) {=0A=
  if (element.hasAttribute) return element.hasAttribute(attribute);=0A=
  return Element.Methods.Simulated.hasAttribute(element, attribute);=0A=
};=0A=
=0A=
Element.addMethods =3D function(methods) {=0A=
  var F =3D Prototype.BrowserFeatures, T =3D Element.Methods.ByTag;=0A=
=0A=
  if (!methods) {=0A=
    Object.extend(Form, Form.Methods);=0A=
    Object.extend(Form.Element, Form.Element.Methods);=0A=
    Object.extend(Element.Methods.ByTag, {=0A=
      "FORM":     Object.clone(Form.Methods),=0A=
      "INPUT":    Object.clone(Form.Element.Methods),=0A=
      "SELECT":   Object.clone(Form.Element.Methods),=0A=
      "TEXTAREA": Object.clone(Form.Element.Methods)=0A=
    });=0A=
  }=0A=
=0A=
  if (arguments.length =3D=3D 2) {=0A=
    var tagName =3D methods;=0A=
    methods =3D arguments[1];=0A=
  }=0A=
=0A=
  if (!tagName) Object.extend(Element.Methods, methods || { });=0A=
  else {=0A=
    if (Object.isArray(tagName)) tagName.each(extend);=0A=
    else extend(tagName);=0A=
  }=0A=
=0A=
  function extend(tagName) {=0A=
    tagName =3D tagName.toUpperCase();=0A=
    if (!Element.Methods.ByTag[tagName])=0A=
      Element.Methods.ByTag[tagName] =3D { };=0A=
    Object.extend(Element.Methods.ByTag[tagName], methods);=0A=
  }=0A=
=0A=
  function copy(methods, destination, onlyIfAbsent) {=0A=
    onlyIfAbsent =3D onlyIfAbsent || false;=0A=
    for (var property in methods) {=0A=
      var value =3D methods[property];=0A=
      if (!Object.isFunction(value)) continue;=0A=
      if (!onlyIfAbsent || !(property in destination))=0A=
        destination[property] =3D value.methodize();=0A=
    }=0A=
  }=0A=
=0A=
  function findDOMClass(tagName) {=0A=
    var klass;=0A=
    var trans =3D {=0A=
      "OPTGROUP": "OptGroup", "TEXTAREA": "TextArea", "P": "Paragraph",=0A=
      "FIELDSET": "FieldSet", "UL": "UList", "OL": "OList", "DL": =
"DList",=0A=
      "DIR": "Directory", "H1": "Heading", "H2": "Heading", "H3": =
"Heading",=0A=
      "H4": "Heading", "H5": "Heading", "H6": "Heading", "Q": "Quote",=0A=
      "INS": "Mod", "DEL": "Mod", "A": "Anchor", "IMG": "Image", =
"CAPTION":=0A=
      "TableCaption", "COL": "TableCol", "COLGROUP": "TableCol", "THEAD":=0A=
      "TableSection", "TFOOT": "TableSection", "TBODY": "TableSection", =
"TR":=0A=
      "TableRow", "TH": "TableCell", "TD": "TableCell", "FRAMESET":=0A=
      "FrameSet", "IFRAME": "IFrame"=0A=
    };=0A=
    if (trans[tagName]) klass =3D 'HTML' + trans[tagName] + 'Element';=0A=
    if (window[klass]) return window[klass];=0A=
    klass =3D 'HTML' + tagName + 'Element';=0A=
    if (window[klass]) return window[klass];=0A=
    klass =3D 'HTML' + tagName.capitalize() + 'Element';=0A=
    if (window[klass]) return window[klass];=0A=
=0A=
    window[klass] =3D { };=0A=
    window[klass].prototype =3D =
document.createElement(tagName)['__proto__'];=0A=
    return window[klass];=0A=
  }=0A=
=0A=
  if (F.ElementExtensions) {=0A=
    copy(Element.Methods, HTMLElement.prototype);=0A=
    copy(Element.Methods.Simulated, HTMLElement.prototype, true);=0A=
  }=0A=
=0A=
  if (F.SpecificElementExtensions) {=0A=
    for (var tag in Element.Methods.ByTag) {=0A=
      var klass =3D findDOMClass(tag);=0A=
      if (Object.isUndefined(klass)) continue;=0A=
      copy(T[tag], klass.prototype);=0A=
    }=0A=
  }=0A=
=0A=
  Object.extend(Element, Element.Methods);=0A=
  delete Element.ByTag;=0A=
=0A=
  if (Element.extend.refresh) Element.extend.refresh();=0A=
  Element.cache =3D { };=0A=
};=0A=
=0A=
document.viewport =3D {=0A=
  getDimensions: function() {=0A=
    var dimensions =3D { }, B =3D Prototype.Browser;=0A=
    $w('width height').each(function(d) {=0A=
      var D =3D d.capitalize();=0A=
      if (B.WebKit && !document.evaluate) {=0A=
        // Safari <3.0 needs self.innerWidth/Height=0A=
        dimensions[d] =3D self['inner' + D];=0A=
      } else if (B.Opera && parseFloat(window.opera.version()) < 9.5) {=0A=
        // Opera <9.5 needs document.body.clientWidth/Height=0A=
        dimensions[d] =3D document.body['client' + D]=0A=
      } else {=0A=
        dimensions[d] =3D document.documentElement['client' + D];=0A=
      }=0A=
    });=0A=
    return dimensions;=0A=
  },=0A=
=0A=
  getWidth: function() {=0A=
    return this.getDimensions().width;=0A=
  },=0A=
=0A=
  getHeight: function() {=0A=
    return this.getDimensions().height;=0A=
  },=0A=
=0A=
  getScrollOffsets: function() {=0A=
    return Element._returnOffset(=0A=
      window.pageXOffset || document.documentElement.scrollLeft || =
document.body.scrollLeft,=0A=
      window.pageYOffset || document.documentElement.scrollTop || =
document.body.scrollTop);=0A=
  }=0A=
};=0A=
/* Portions of the Selector class are derived from Jack Slocum's =
DomQuery,=0A=
 * part of YUI-Ext version 0.40, distributed under the terms of an =
MIT-style=0A=
 * license.  Please see http://www.yui-ext.com/ for more information. */=0A=
=0A=
var Selector =3D Class.create({=0A=
  initialize: function(expression) {=0A=
    this.expression =3D expression.strip();=0A=
=0A=
    if (this.shouldUseSelectorsAPI()) {=0A=
      this.mode =3D 'selectorsAPI';=0A=
    } else if (this.shouldUseXPath()) {=0A=
      this.mode =3D 'xpath';=0A=
      this.compileXPathMatcher();=0A=
    } else {=0A=
      this.mode =3D "normal";=0A=
      this.compileMatcher();=0A=
    }=0A=
=0A=
  },=0A=
=0A=
  shouldUseXPath: function() {=0A=
    if (!Prototype.BrowserFeatures.XPath) return false;=0A=
=0A=
    var e =3D this.expression;=0A=
=0A=
    // Safari 3 chokes on :*-of-type and :empty=0A=
    if (Prototype.Browser.WebKit &&=0A=
     (e.include("-of-type") || e.include(":empty")))=0A=
      return false;=0A=
=0A=
    // XPath can't do namespaced attributes, nor can it read=0A=
    // the "checked" property from DOM nodes=0A=
    if ((/(\[[\w-]*?:|:checked)/).test(e))=0A=
      return false;=0A=
=0A=
    return true;=0A=
  },=0A=
=0A=
  shouldUseSelectorsAPI: function() {=0A=
    if (!Prototype.BrowserFeatures.SelectorsAPI) return false;=0A=
=0A=
    if (!Selector._div) Selector._div =3D new Element('div');=0A=
=0A=
    // Make sure the browser treats the selector as valid. Test on an=0A=
    // isolated element to minimize cost of this check.=0A=
    try {=0A=
      Selector._div.querySelector(this.expression);=0A=
    } catch(e) {=0A=
      return false;=0A=
    }=0A=
=0A=
    return true;=0A=
  },=0A=
=0A=
  compileMatcher: function() {=0A=
    var e =3D this.expression, ps =3D Selector.patterns, h =3D =
Selector.handlers,=0A=
        c =3D Selector.criteria, le, p, m;=0A=
=0A=
    if (Selector._cache[e]) {=0A=
      this.matcher =3D Selector._cache[e];=0A=
      return;=0A=
    }=0A=
=0A=
    this.matcher =3D ["this.matcher =3D function(root) {",=0A=
                    "var r =3D root, h =3D Selector.handlers, c =3D =
false, n;"];=0A=
=0A=
    while (e && le !=3D e && (/\S/).test(e)) {=0A=
      le =3D e;=0A=
      for (var i in ps) {=0A=
        p =3D ps[i];=0A=
        if (m =3D e.match(p)) {=0A=
          this.matcher.push(Object.isFunction(c[i]) ? c[i](m) :=0A=
            new Template(c[i]).evaluate(m));=0A=
          e =3D e.replace(m[0], '');=0A=
          break;=0A=
        }=0A=
      }=0A=
    }=0A=
=0A=
    this.matcher.push("return h.unique(n);\n}");=0A=
    eval(this.matcher.join('\n'));=0A=
    Selector._cache[this.expression] =3D this.matcher;=0A=
  },=0A=
=0A=
  compileXPathMatcher: function() {=0A=
    var e =3D this.expression, ps =3D Selector.patterns,=0A=
        x =3D Selector.xpath, le, m;=0A=
=0A=
    if (Selector._cache[e]) {=0A=
      this.xpath =3D Selector._cache[e]; return;=0A=
    }=0A=
=0A=
    this.matcher =3D ['.//*'];=0A=
    while (e && le !=3D e && (/\S/).test(e)) {=0A=
      le =3D e;=0A=
      for (var i in ps) {=0A=
        if (m =3D e.match(ps[i])) {=0A=
          this.matcher.push(Object.isFunction(x[i]) ? x[i](m) :=0A=
            new Template(x[i]).evaluate(m));=0A=
          e =3D e.replace(m[0], '');=0A=
          break;=0A=
        }=0A=
      }=0A=
    }=0A=
=0A=
    this.xpath =3D this.matcher.join('');=0A=
    Selector._cache[this.expression] =3D this.xpath;=0A=
  },=0A=
=0A=
  findElements: function(root) {=0A=
    root =3D root || document;=0A=
    var e =3D this.expression, results;=0A=
=0A=
    switch (this.mode) {=0A=
      case 'selectorsAPI':=0A=
        // querySelectorAll queries document-wide, then filters to =
descendants=0A=
        // of the context element. That's not what we want.=0A=
        // Add an explicit context to the selector if necessary.=0A=
        if (root !=3D=3D document) {=0A=
          var oldId =3D root.id, id =3D $(root).identify();=0A=
          e =3D "#" + id + " " + e;=0A=
        }=0A=
=0A=
        results =3D $A(root.querySelectorAll(e)).map(Element.extend);=0A=
        root.id =3D oldId;=0A=
=0A=
        return results;=0A=
      case 'xpath':=0A=
        return document._getElementsByXPath(this.xpath, root);=0A=
      default:=0A=
       return this.matcher(root);=0A=
    }=0A=
  },=0A=
=0A=
  match: function(element) {=0A=
    this.tokens =3D [];=0A=
=0A=
    var e =3D this.expression, ps =3D Selector.patterns, as =3D =
Selector.assertions;=0A=
    var le, p, m;=0A=
=0A=
    while (e && le !=3D=3D e && (/\S/).test(e)) {=0A=
      le =3D e;=0A=
      for (var i in ps) {=0A=
        p =3D ps[i];=0A=
        if (m =3D e.match(p)) {=0A=
          // use the Selector.assertions methods unless the selector=0A=
          // is too complex.=0A=
          if (as[i]) {=0A=
            this.tokens.push([i, Object.clone(m)]);=0A=
            e =3D e.replace(m[0], '');=0A=
          } else {=0A=
            // reluctantly do a document-wide search=0A=
            // and look for a match in the array=0A=
            return this.findElements(document).include(element);=0A=
          }=0A=
        }=0A=
      }=0A=
    }=0A=
=0A=
    var match =3D true, name, matches;=0A=
    for (var i =3D 0, token; token =3D this.tokens[i]; i++) {=0A=
      name =3D token[0], matches =3D token[1];=0A=
      if (!Selector.assertions[name](element, matches)) {=0A=
        match =3D false; break;=0A=
      }=0A=
    }=0A=
=0A=
    return match;=0A=
  },=0A=
=0A=
  toString: function() {=0A=
    return this.expression;=0A=
  },=0A=
=0A=
  inspect: function() {=0A=
    return "#<Selector:" + this.expression.inspect() + ">";=0A=
  }=0A=
});=0A=
=0A=
Object.extend(Selector, {=0A=
  _cache: { },=0A=
=0A=
  xpath: {=0A=
    descendant:   "//*",=0A=
    child:        "/*",=0A=
    adjacent:     "/following-sibling::*[1]",=0A=
    laterSibling: '/following-sibling::*',=0A=
    tagName:      function(m) {=0A=
      if (m[1] =3D=3D '*') return '';=0A=
      return "[local-name()=3D'" + m[1].toLowerCase() +=0A=
             "' or local-name()=3D'" + m[1].toUpperCase() + "']";=0A=
    },=0A=
    className:    "[contains(concat(' ', @class, ' '), ' #{1} ')]",=0A=
    id:           "[@id=3D'#{1}']",=0A=
    attrPresence: function(m) {=0A=
      m[1] =3D m[1].toLowerCase();=0A=
      return new Template("[@#{1}]").evaluate(m);=0A=
    },=0A=
    attr: function(m) {=0A=
      m[1] =3D m[1].toLowerCase();=0A=
      m[3] =3D m[5] || m[6];=0A=
      return new Template(Selector.xpath.operators[m[2]]).evaluate(m);=0A=
    },=0A=
    pseudo: function(m) {=0A=
      var h =3D Selector.xpath.pseudos[m[1]];=0A=
      if (!h) return '';=0A=
      if (Object.isFunction(h)) return h(m);=0A=
      return new Template(Selector.xpath.pseudos[m[1]]).evaluate(m);=0A=
    },=0A=
    operators: {=0A=
      '=3D':  "[@#{1}=3D'#{3}']",=0A=
      '!=3D': "[@#{1}!=3D'#{3}']",=0A=
      '^=3D': "[starts-with(@#{1}, '#{3}')]",=0A=
      '$=3D': "[substring(@#{1}, (string-length(@#{1}) - =
string-length('#{3}') + 1))=3D'#{3}']",=0A=
      '*=3D': "[contains(@#{1}, '#{3}')]",=0A=
      '~=3D': "[contains(concat(' ', @#{1}, ' '), ' #{3} ')]",=0A=
      '|=3D': "[contains(concat('-', @#{1}, '-'), '-#{3}-')]"=0A=
    },=0A=
    pseudos: {=0A=
      'first-child': '[not(preceding-sibling::*)]',=0A=
      'last-child':  '[not(following-sibling::*)]',=0A=
      'only-child':  '[not(preceding-sibling::* or =
following-sibling::*)]',=0A=
      'empty':       "[count(*) =3D 0 and (count(text()) =3D 0)]",=0A=
      'checked':     "[@checked]",=0A=
      'disabled':    "[(@disabled) and (@type!=3D'hidden')]",=0A=
      'enabled':     "[not(@disabled) and (@type!=3D'hidden')]",=0A=
      'not': function(m) {=0A=
        var e =3D m[6], p =3D Selector.patterns,=0A=
            x =3D Selector.xpath, le, v;=0A=
=0A=
        var exclusion =3D [];=0A=
        while (e && le !=3D e && (/\S/).test(e)) {=0A=
          le =3D e;=0A=
          for (var i in p) {=0A=
            if (m =3D e.match(p[i])) {=0A=
              v =3D Object.isFunction(x[i]) ? x[i](m) : new =
Template(x[i]).evaluate(m);=0A=
              exclusion.push("(" + v.substring(1, v.length - 1) + ")");=0A=
              e =3D e.replace(m[0], '');=0A=
              break;=0A=
            }=0A=
          }=0A=
        }=0A=
        return "[not(" + exclusion.join(" and ") + ")]";=0A=
      },=0A=
      'nth-child':      function(m) {=0A=
        return =
Selector.xpath.pseudos.nth("(count(./preceding-sibling::*) + 1) ", m);=0A=
      },=0A=
      'nth-last-child': function(m) {=0A=
        return =
Selector.xpath.pseudos.nth("(count(./following-sibling::*) + 1) ", m);=0A=
      },=0A=
      'nth-of-type':    function(m) {=0A=
        return Selector.xpath.pseudos.nth("position() ", m);=0A=
      },=0A=
      'nth-last-of-type': function(m) {=0A=
        return Selector.xpath.pseudos.nth("(last() + 1 - position()) ", =
m);=0A=
      },=0A=
      'first-of-type':  function(m) {=0A=
        m[6] =3D "1"; return Selector.xpath.pseudos['nth-of-type'](m);=0A=
      },=0A=
      'last-of-type':   function(m) {=0A=
        m[6] =3D "1"; return =
Selector.xpath.pseudos['nth-last-of-type'](m);=0A=
      },=0A=
      'only-of-type':   function(m) {=0A=
        var p =3D Selector.xpath.pseudos; return p['first-of-type'](m) + =
p['last-of-type'](m);=0A=
      },=0A=
      nth: function(fragment, m) {=0A=
        var mm, formula =3D m[6], predicate;=0A=
        if (formula =3D=3D 'even') formula =3D '2n+0';=0A=
        if (formula =3D=3D 'odd')  formula =3D '2n+1';=0A=
        if (mm =3D formula.match(/^(\d+)$/)) // digit only=0A=
          return '[' + fragment + "=3D " + mm[1] + ']';=0A=
        if (mm =3D formula.match(/^(-?\d*)?n(([+-])(\d+))?/)) { // an+b=0A=
          if (mm[1] =3D=3D "-") mm[1] =3D -1;=0A=
          var a =3D mm[1] ? Number(mm[1]) : 1;=0A=
          var b =3D mm[2] ? Number(mm[2]) : 0;=0A=
          predicate =3D "[((#{fragment} - #{b}) mod #{a} =3D 0) and " +=0A=
          "((#{fragment} - #{b}) div #{a} >=3D 0)]";=0A=
          return new Template(predicate).evaluate({=0A=
            fragment: fragment, a: a, b: b });=0A=
        }=0A=
      }=0A=
    }=0A=
  },=0A=
=0A=
  criteria: {=0A=
    tagName:      'n =3D h.tagName(n, r, "#{1}", c);      c =3D false;',=0A=
    className:    'n =3D h.className(n, r, "#{1}", c);    c =3D false;',=0A=
    id:           'n =3D h.id(n, r, "#{1}", c);           c =3D false;',=0A=
    attrPresence: 'n =3D h.attrPresence(n, r, "#{1}", c); c =3D false;',=0A=
    attr: function(m) {=0A=
      m[3] =3D (m[5] || m[6]);=0A=
      return new Template('n =3D h.attr(n, r, "#{1}", "#{3}", "#{2}", =
c); c =3D false;').evaluate(m);=0A=
    },=0A=
    pseudo: function(m) {=0A=
      if (m[6]) m[6] =3D m[6].replace(/"/g, '\\"');=0A=
      return new Template('n =3D h.pseudo(n, "#{1}", "#{6}", r, c); c =
=3D false;').evaluate(m);=0A=
    },=0A=
    descendant:   'c =3D "descendant";',=0A=
    child:        'c =3D "child";',=0A=
    adjacent:     'c =3D "adjacent";',=0A=
    laterSibling: 'c =3D "laterSibling";'=0A=
  },=0A=
=0A=
  patterns: {=0A=
    // combinators must be listed first=0A=
    // (and descendant needs to be last combinator)=0A=
    laterSibling: /^\s*~\s*/,=0A=
    child:        /^\s*>\s*/,=0A=
    adjacent:     /^\s*\+\s*/,=0A=
    descendant:   /^\s/,=0A=
=0A=
    // selectors follow=0A=
    tagName:      /^\s*(\*|[\w\-]+)(\b|$)?/,=0A=
    id:           /^#([\w\-\*]+)(\b|$)/,=0A=
    className:    /^\.([\w\-\*]+)(\b|$)/,=0A=
    pseudo:=0A=
/^:((first|last|nth|nth-last|only)(-child|-of-type)|empty|checked|(en|dis=
)abled|not)(\((.*?)\))?(\b|$|(?=3D\s|[:+~>]))/,=0A=
    attrPresence: /^\[((?:[\w]+:)?[\w]+)\]/,=0A=
    attr:         =
/\[((?:[\w-]*:)?[\w-]+)\s*(?:([!^$*~|]?=3D)\s*((['"])([^\4]*?)\4|([^'"][^=
\]]*?)))?\]/=0A=
  },=0A=
=0A=
  // for Selector.match and Element#match=0A=
  assertions: {=0A=
    tagName: function(element, matches) {=0A=
      return matches[1].toUpperCase() =3D=3D =
element.tagName.toUpperCase();=0A=
    },=0A=
=0A=
    className: function(element, matches) {=0A=
      return Element.hasClassName(element, matches[1]);=0A=
    },=0A=
=0A=
    id: function(element, matches) {=0A=
      return element.id =3D=3D=3D matches[1];=0A=
    },=0A=
=0A=
    attrPresence: function(element, matches) {=0A=
      return Element.hasAttribute(element, matches[1]);=0A=
    },=0A=
=0A=
    attr: function(element, matches) {=0A=
      var nodeValue =3D Element.readAttribute(element, matches[1]);=0A=
      return nodeValue && Selector.operators[matches[2]](nodeValue, =
matches[5] || matches[6]);=0A=
    }=0A=
  },=0A=
=0A=
  handlers: {=0A=
    // UTILITY FUNCTIONS=0A=
    // joins two collections=0A=
    concat: function(a, b) {=0A=
      for (var i =3D 0, node; node =3D b[i]; i++)=0A=
        a.push(node);=0A=
      return a;=0A=
    },=0A=
=0A=
    // marks an array of nodes for counting=0A=
    mark: function(nodes) {=0A=
      var _true =3D Prototype.emptyFunction;=0A=
      for (var i =3D 0, node; node =3D nodes[i]; i++)=0A=
        node._countedByPrototype =3D _true;=0A=
      return nodes;=0A=
    },=0A=
=0A=
    unmark: function(nodes) {=0A=
      for (var i =3D 0, node; node =3D nodes[i]; i++)=0A=
        node._countedByPrototype =3D undefined;=0A=
      return nodes;=0A=
    },=0A=
=0A=
    // mark each child node with its position (for nth calls)=0A=
    // "ofType" flag indicates whether we're indexing for nth-of-type=0A=
    // rather than nth-child=0A=
    index: function(parentNode, reverse, ofType) {=0A=
      parentNode._countedByPrototype =3D Prototype.emptyFunction;=0A=
      if (reverse) {=0A=
        for (var nodes =3D parentNode.childNodes, i =3D nodes.length - =
1, j =3D 1; i >=3D 0; i--) {=0A=
          var node =3D nodes[i];=0A=
          if (node.nodeType =3D=3D 1 && (!ofType || =
node._countedByPrototype)) node.nodeIndex =3D j++;=0A=
        }=0A=
      } else {=0A=
        for (var i =3D 0, j =3D 1, nodes =3D parentNode.childNodes; node =
=3D nodes[i]; i++)=0A=
          if (node.nodeType =3D=3D 1 && (!ofType || =
node._countedByPrototype)) node.nodeIndex =3D j++;=0A=
      }=0A=
    },=0A=
=0A=
    // filters out duplicates and extends all nodes=0A=
    unique: function(nodes) {=0A=
      if (nodes.length =3D=3D 0) return nodes;=0A=
      var results =3D [], n;=0A=
      for (var i =3D 0, l =3D nodes.length; i < l; i++)=0A=
        if (!(n =3D nodes[i])._countedByPrototype) {=0A=
          n._countedByPrototype =3D Prototype.emptyFunction;=0A=
          results.push(Element.extend(n));=0A=
        }=0A=
      return Selector.handlers.unmark(results);=0A=
    },=0A=
=0A=
    // COMBINATOR FUNCTIONS=0A=
    descendant: function(nodes) {=0A=
      var h =3D Selector.handlers;=0A=
      for (var i =3D 0, results =3D [], node; node =3D nodes[i]; i++)=0A=
        h.concat(results, node.getElementsByTagName('*'));=0A=
      return results;=0A=
    },=0A=
=0A=
    child: function(nodes) {=0A=
      var h =3D Selector.handlers;=0A=
      for (var i =3D 0, results =3D [], node; node =3D nodes[i]; i++) {=0A=
        for (var j =3D 0, child; child =3D node.childNodes[j]; j++)=0A=
          if (child.nodeType =3D=3D 1 && child.tagName !=3D '!') =
results.push(child);=0A=
      }=0A=
      return results;=0A=
    },=0A=
=0A=
    adjacent: function(nodes) {=0A=
      for (var i =3D 0, results =3D [], node; node =3D nodes[i]; i++) {=0A=
        var next =3D this.nextElementSibling(node);=0A=
        if (next) results.push(next);=0A=
      }=0A=
      return results;=0A=
    },=0A=
=0A=
    laterSibling: function(nodes) {=0A=
      var h =3D Selector.handlers;=0A=
      for (var i =3D 0, results =3D [], node; node =3D nodes[i]; i++)=0A=
        h.concat(results, Element.nextSiblings(node));=0A=
      return results;=0A=
    },=0A=
=0A=
    nextElementSibling: function(node) {=0A=
      while (node =3D node.nextSibling)=0A=
        if (node.nodeType =3D=3D 1) return node;=0A=
      return null;=0A=
    },=0A=
=0A=
    previousElementSibling: function(node) {=0A=
      while (node =3D node.previousSibling)=0A=
        if (node.nodeType =3D=3D 1) return node;=0A=
      return null;=0A=
    },=0A=
=0A=
    // TOKEN FUNCTIONS=0A=
    tagName: function(nodes, root, tagName, combinator) {=0A=
      var uTagName =3D tagName.toUpperCase();=0A=
      var results =3D [], h =3D Selector.handlers;=0A=
      if (nodes) {=0A=
        if (combinator) {=0A=
          // fastlane for ordinary descendant combinators=0A=
          if (combinator =3D=3D "descendant") {=0A=
            for (var i =3D 0, node; node =3D nodes[i]; i++)=0A=
              h.concat(results, node.getElementsByTagName(tagName));=0A=
            return results;=0A=
          } else nodes =3D this[combinator](nodes);=0A=
          if (tagName =3D=3D "*") return nodes;=0A=
        }=0A=
        for (var i =3D 0, node; node =3D nodes[i]; i++)=0A=
          if (node.tagName.toUpperCase() =3D=3D=3D uTagName) =
results.push(node);=0A=
        return results;=0A=
      } else return root.getElementsByTagName(tagName);=0A=
    },=0A=
=0A=
    id: function(nodes, root, id, combinator) {=0A=
      var targetNode =3D $(id), h =3D Selector.handlers;=0A=
      if (!targetNode) return [];=0A=
      if (!nodes && root =3D=3D document) return [targetNode];=0A=
      if (nodes) {=0A=
        if (combinator) {=0A=
          if (combinator =3D=3D 'child') {=0A=
            for (var i =3D 0, node; node =3D nodes[i]; i++)=0A=
              if (targetNode.parentNode =3D=3D node) return [targetNode];=0A=
          } else if (combinator =3D=3D 'descendant') {=0A=
            for (var i =3D 0, node; node =3D nodes[i]; i++)=0A=
              if (Element.descendantOf(targetNode, node)) return =
[targetNode];=0A=
          } else if (combinator =3D=3D 'adjacent') {=0A=
            for (var i =3D 0, node; node =3D nodes[i]; i++)=0A=
              if (Selector.handlers.previousElementSibling(targetNode) =
=3D=3D node)=0A=
                return [targetNode];=0A=
          } else nodes =3D h[combinator](nodes);=0A=
        }=0A=
        for (var i =3D 0, node; node =3D nodes[i]; i++)=0A=
          if (node =3D=3D targetNode) return [targetNode];=0A=
        return [];=0A=
      }=0A=
      return (targetNode && Element.descendantOf(targetNode, root)) ? =
[targetNode] : [];=0A=
    },=0A=
=0A=
    className: function(nodes, root, className, combinator) {=0A=
      if (nodes && combinator) nodes =3D this[combinator](nodes);=0A=
      return Selector.handlers.byClassName(nodes, root, className);=0A=
    },=0A=
=0A=
    byClassName: function(nodes, root, className) {=0A=
      if (!nodes) nodes =3D Selector.handlers.descendant([root]);=0A=
      var needle =3D ' ' + className + ' ';=0A=
      for (var i =3D 0, results =3D [], node, nodeClassName; node =3D =
nodes[i]; i++) {=0A=
        nodeClassName =3D node.className;=0A=
        if (nodeClassName.length =3D=3D 0) continue;=0A=
        if (nodeClassName =3D=3D className || (' ' + nodeClassName + ' =
').include(needle))=0A=
          results.push(node);=0A=
      }=0A=
      return results;=0A=
    },=0A=
=0A=
    attrPresence: function(nodes, root, attr, combinator) {=0A=
      if (!nodes) nodes =3D root.getElementsByTagName("*");=0A=
      if (nodes && combinator) nodes =3D this[combinator](nodes);=0A=
      var results =3D [];=0A=
      for (var i =3D 0, node; node =3D nodes[i]; i++)=0A=
        if (Element.hasAttribute(node, attr)) results.push(node);=0A=
      return results;=0A=
    },=0A=
=0A=
    attr: function(nodes, root, attr, value, operator, combinator) {=0A=
      if (!nodes) nodes =3D root.getElementsByTagName("*");=0A=
      if (nodes && combinator) nodes =3D this[combinator](nodes);=0A=
      var handler =3D Selector.operators[operator], results =3D [];=0A=
      for (var i =3D 0, node; node =3D nodes[i]; i++) {=0A=
        var nodeValue =3D Element.readAttribute(node, attr);=0A=
        if (nodeValue =3D=3D=3D null) continue;=0A=
        if (handler(nodeValue, value)) results.push(node);=0A=
      }=0A=
      return results;=0A=
    },=0A=
=0A=
    pseudo: function(nodes, name, value, root, combinator) {=0A=
      if (nodes && combinator) nodes =3D this[combinator](nodes);=0A=
      if (!nodes) nodes =3D root.getElementsByTagName("*");=0A=
      return Selector.pseudos[name](nodes, value, root);=0A=
    }=0A=
  },=0A=
=0A=
  pseudos: {=0A=
    'first-child': function(nodes, value, root) {=0A=
      for (var i =3D 0, results =3D [], node; node =3D nodes[i]; i++) {=0A=
        if (Selector.handlers.previousElementSibling(node)) continue;=0A=
          results.push(node);=0A=
      }=0A=
      return results;=0A=
    },=0A=
    'last-child': function(nodes, value, root) {=0A=
      for (var i =3D 0, results =3D [], node; node =3D nodes[i]; i++) {=0A=
        if (Selector.handlers.nextElementSibling(node)) continue;=0A=
          results.push(node);=0A=
      }=0A=
      return results;=0A=
    },=0A=
    'only-child': function(nodes, value, root) {=0A=
      var h =3D Selector.handlers;=0A=
      for (var i =3D 0, results =3D [], node; node =3D nodes[i]; i++)=0A=
        if (!h.previousElementSibling(node) && =
!h.nextElementSibling(node))=0A=
          results.push(node);=0A=
      return results;=0A=
    },=0A=
    'nth-child':        function(nodes, formula, root) {=0A=
      return Selector.pseudos.nth(nodes, formula, root);=0A=
    },=0A=
    'nth-last-child':   function(nodes, formula, root) {=0A=
      return Selector.pseudos.nth(nodes, formula, root, true);=0A=
    },=0A=
    'nth-of-type':      function(nodes, formula, root) {=0A=
      return Selector.pseudos.nth(nodes, formula, root, false, true);=0A=
    },=0A=
    'nth-last-of-type': function(nodes, formula, root) {=0A=
      return Selector.pseudos.nth(nodes, formula, root, true, true);=0A=
    },=0A=
    'first-of-type':    function(nodes, formula, root) {=0A=
      return Selector.pseudos.nth(nodes, "1", root, false, true);=0A=
    },=0A=
    'last-of-type':     function(nodes, formula, root) {=0A=
      return Selector.pseudos.nth(nodes, "1", root, true, true);=0A=
    },=0A=
    'only-of-type':     function(nodes, formula, root) {=0A=
      var p =3D Selector.pseudos;=0A=
      return p['last-of-type'](p['first-of-type'](nodes, formula, root), =
formula, root);=0A=
    },=0A=
=0A=
    // handles the an+b logic=0A=
    getIndices: function(a, b, total) {=0A=
      if (a =3D=3D 0) return b > 0 ? [b] : [];=0A=
      return $R(1, total).inject([], function(memo, i) {=0A=
        if (0 =3D=3D (i - b) % a && (i - b) / a >=3D 0) memo.push(i);=0A=
        return memo;=0A=
      });=0A=
    },=0A=
=0A=
    // handles nth(-last)-child, nth(-last)-of-type, and =
(first|last)-of-type=0A=
    nth: function(nodes, formula, root, reverse, ofType) {=0A=
      if (nodes.length =3D=3D 0) return [];=0A=
      if (formula =3D=3D 'even') formula =3D '2n+0';=0A=
      if (formula =3D=3D 'odd')  formula =3D '2n+1';=0A=
      var h =3D Selector.handlers, results =3D [], indexed =3D [], m;=0A=
      h.mark(nodes);=0A=
      for (var i =3D 0, node; node =3D nodes[i]; i++) {=0A=
        if (!node.parentNode._countedByPrototype) {=0A=
          h.index(node.parentNode, reverse, ofType);=0A=
          indexed.push(node.parentNode);=0A=
        }=0A=
      }=0A=
      if (formula.match(/^\d+$/)) { // just a number=0A=
        formula =3D Number(formula);=0A=
        for (var i =3D 0, node; node =3D nodes[i]; i++)=0A=
          if (node.nodeIndex =3D=3D formula) results.push(node);=0A=
      } else if (m =3D formula.match(/^(-?\d*)?n(([+-])(\d+))?/)) { // =
an+b=0A=
        if (m[1] =3D=3D "-") m[1] =3D -1;=0A=
        var a =3D m[1] ? Number(m[1]) : 1;=0A=
        var b =3D m[2] ? Number(m[2]) : 0;=0A=
        var indices =3D Selector.pseudos.getIndices(a, b, nodes.length);=0A=
        for (var i =3D 0, node, l =3D indices.length; node =3D nodes[i]; =
i++) {=0A=
          for (var j =3D 0; j < l; j++)=0A=
            if (node.nodeIndex =3D=3D indices[j]) results.push(node);=0A=
        }=0A=
      }=0A=
      h.unmark(nodes);=0A=
      h.unmark(indexed);=0A=
      return results;=0A=
    },=0A=
=0A=
    'empty': function(nodes, value, root) {=0A=
      for (var i =3D 0, results =3D [], node; node =3D nodes[i]; i++) {=0A=
        // IE treats comments as element nodes=0A=
        if (node.tagName =3D=3D '!' || node.firstChild) continue;=0A=
        results.push(node);=0A=
      }=0A=
      return results;=0A=
    },=0A=
=0A=
    'not': function(nodes, selector, root) {=0A=
      var h =3D Selector.handlers, selectorType, m;=0A=
      var exclusions =3D new Selector(selector).findElements(root);=0A=
      h.mark(exclusions);=0A=
      for (var i =3D 0, results =3D [], node; node =3D nodes[i]; i++)=0A=
        if (!node._countedByPrototype) results.push(node);=0A=
      h.unmark(exclusions);=0A=
      return results;=0A=
    },=0A=
=0A=
    'enabled': function(nodes, value, root) {=0A=
      for (var i =3D 0, results =3D [], node; node =3D nodes[i]; i++)=0A=
        if (!node.disabled && (!node.type || node.type !=3D=3D 'hidden'))=0A=
          results.push(node);=0A=
      return results;=0A=
    },=0A=
=0A=
    'disabled': function(nodes, value, root) {=0A=
      for (var i =3D 0, results =3D [], node; node =3D nodes[i]; i++)=0A=
        if (node.disabled) results.push(node);=0A=
      return results;=0A=
    },=0A=
=0A=
    'checked': function(nodes, value, root) {=0A=
      for (var i =3D 0, results =3D [], node; node =3D nodes[i]; i++)=0A=
        if (node.checked) results.push(node);=0A=
      return results;=0A=
    }=0A=
  },=0A=
=0A=
  operators: {=0A=
    '=3D':  function(nv, v) { return nv =3D=3D v; },=0A=
    '!=3D': function(nv, v) { return nv !=3D v; },=0A=
    '^=3D': function(nv, v) { return nv =3D=3D v || nv && =
nv.startsWith(v); },=0A=
    '$=3D': function(nv, v) { return nv =3D=3D v || nv && =
nv.endsWith(v); },=0A=
    '*=3D': function(nv, v) { return nv =3D=3D v || nv && nv.include(v); =
},=0A=
    '$=3D': function(nv, v) { return nv.endsWith(v); },=0A=
    '*=3D': function(nv, v) { return nv.include(v); },=0A=
    '~=3D': function(nv, v) { return (' ' + nv + ' ').include(' ' + v + =
' '); },=0A=
    '|=3D': function(nv, v) { return ('-' + (nv || "").toUpperCase() +=0A=
     '-').include('-' + (v || "").toUpperCase() + '-'); }=0A=
  },=0A=
=0A=
  split: function(expression) {=0A=
    var expressions =3D [];=0A=
    expression.scan(/(([\w#:.~>+()\s-]+|\*|\[.*?\])+)\s*(,|$)/, =
function(m) {=0A=
      expressions.push(m[1].strip());=0A=
    });=0A=
    return expressions;=0A=
  },=0A=
=0A=
  matchElements: function(elements, expression) {=0A=
    var matches =3D $$(expression), h =3D Selector.handlers;=0A=
    h.mark(matches);=0A=
    for (var i =3D 0, results =3D [], element; element =3D elements[i]; =
i++)=0A=
      if (element._countedByPrototype) results.push(element);=0A=
    h.unmark(matches);=0A=
    return results;=0A=
  },=0A=
=0A=
  findElement: function(elements, expression, index) {=0A=
    if (Object.isNumber(expression)) {=0A=
      index =3D expression; expression =3D false;=0A=
    }=0A=
    return Selector.matchElements(elements, expression || '*')[index || =
0];=0A=
  },=0A=
=0A=
  findChildElements: function(element, expressions) {=0A=
    expressions =3D Selector.split(expressions.join(','));=0A=
    var results =3D [], h =3D Selector.handlers;=0A=
    for (var i =3D 0, l =3D expressions.length, selector; i < l; i++) {=0A=
      selector =3D new Selector(expressions[i].strip());=0A=
      h.concat(results, selector.findElements(element));=0A=
    }=0A=
    return (l > 1) ? h.unique(results) : results;=0A=
  }=0A=
});=0A=
=0A=
if (Prototype.Browser.IE) {=0A=
  Object.extend(Selector.handlers, {=0A=
    // IE returns comment nodes on getElementsByTagName("*").=0A=
    // Filter them out.=0A=
    concat: function(a, b) {=0A=
      for (var i =3D 0, node; node =3D b[i]; i++)=0A=
        if (node.tagName !=3D=3D "!") a.push(node);=0A=
      return a;=0A=
    },=0A=
=0A=
    // IE improperly serializes _countedByPrototype in (inner|outer)HTML.=0A=
    unmark: function(nodes) {=0A=
      for (var i =3D 0, node; node =3D nodes[i]; i++)=0A=
        node.removeAttribute('_countedByPrototype');=0A=
      return nodes;=0A=
    }=0A=
  });=0A=
}=0A=
=0A=
function $$() {=0A=
  return Selector.findChildElements(document, $A(arguments));=0A=
}=0A=
var Form =3D {=0A=
  reset: function(form) {=0A=
    $(form).reset();=0A=
    return form;=0A=
  },=0A=
=0A=
  serializeElements: function(elements, options) {=0A=
    if (typeof options !=3D 'object') options =3D { hash: !!options };=0A=
    else if (Object.isUndefined(options.hash)) options.hash =3D true;=0A=
    var key, value, submitted =3D false, submit =3D options.submit;=0A=
=0A=
    var data =3D elements.inject({ }, function(result, element) {=0A=
      if (!element.disabled && element.name) {=0A=
        key =3D element.name; value =3D $(element).getValue();=0A=
        if (value !=3D null && element.type !=3D 'file' && (element.type =
!=3D 'submit' || (!submitted &&=0A=
            submit !=3D=3D false && (!submit || key =3D=3D submit) && =
(submitted =3D true)))) {=0A=
          if (key in result) {=0A=
            // a key is already present; construct an array of values=0A=
            if (!Object.isArray(result[key])) result[key] =3D =
[result[key]];=0A=
            result[key].push(value);=0A=
          }=0A=
          else result[key] =3D value;=0A=
        }=0A=
      }=0A=
      return result;=0A=
    });=0A=
=0A=
    return options.hash ? data : Object.toQueryString(data);=0A=
  }=0A=
};=0A=
=0A=
Form.Methods =3D {=0A=
  serialize: function(form, options) {=0A=
    return Form.serializeElements(Form.getElements(form), options);=0A=
  },=0A=
=0A=
  getElements: function(form) {=0A=
    return $A($(form).getElementsByTagName('*')).inject([],=0A=
      function(elements, child) {=0A=
        if (Form.Element.Serializers[child.tagName.toLowerCase()])=0A=
          elements.push(Element.extend(child));=0A=
        return elements;=0A=
      }=0A=
    );=0A=
  },=0A=
=0A=
  getInputs: function(form, typeName, name) {=0A=
    form =3D $(form);=0A=
    var inputs =3D form.getElementsByTagName('input');=0A=
=0A=
    if (!typeName && !name) return $A(inputs).map(Element.extend);=0A=
=0A=
    for (var i =3D 0, matchingInputs =3D [], length =3D inputs.length; i =
< length; i++) {=0A=
      var input =3D inputs[i];=0A=
      if ((typeName && input.type !=3D typeName) || (name && input.name =
!=3D name))=0A=
        continue;=0A=
      matchingInputs.push(Element.extend(input));=0A=
    }=0A=
=0A=
    return matchingInputs;=0A=
  },=0A=
=0A=
  disable: function(form) {=0A=
    form =3D $(form);=0A=
    Form.getElements(form).invoke('disable');=0A=
    return form;=0A=
  },=0A=
=0A=
  enable: function(form) {=0A=
    form =3D $(form);=0A=
    Form.getElements(form).invoke('enable');=0A=
    return form;=0A=
  },=0A=
=0A=
  findFirstElement: function(form) {=0A=
    var elements =3D $(form).getElements().findAll(function(element) {=0A=
      return 'hidden' !=3D element.type && !element.disabled;=0A=
    });=0A=
    var firstByIndex =3D elements.findAll(function(element) {=0A=
      return element.hasAttribute('tabIndex') && element.tabIndex >=3D 0;=0A=
    }).sortBy(function(element) { return element.tabIndex }).first();=0A=
=0A=
    return firstByIndex ? firstByIndex : elements.find(function(element) =
{=0A=
      return ['input', 'select', =
'textarea'].include(element.tagName.toLowerCase());=0A=
    });=0A=
  },=0A=
=0A=
  focusFirstElement: function(form) {=0A=
    form =3D $(form);=0A=
    form.findFirstElement().activate();=0A=
    return form;=0A=
  },=0A=
=0A=
  request: function(form, options) {=0A=
    form =3D $(form), options =3D Object.clone(options || { });=0A=
=0A=
    var params =3D options.parameters, action =3D =
form.readAttribute('action') || '';=0A=
    if (action.blank()) action =3D window.location.href;=0A=
    options.parameters =3D form.serialize(true);=0A=
=0A=
    if (params) {=0A=
      if (Object.isString(params)) params =3D params.toQueryParams();=0A=
      Object.extend(options.parameters, params);=0A=
    }=0A=
=0A=
    if (form.hasAttribute('method') && !options.method)=0A=
      options.method =3D form.method;=0A=
=0A=
    return new Ajax.Request(action, options);=0A=
  }=0A=
};=0A=
=0A=
/*-----------------------------------------------------------------------=
---*/=0A=
=0A=
Form.Element =3D {=0A=
  focus: function(element) {=0A=
    $(element).focus();=0A=
    return element;=0A=
  },=0A=
=0A=
  select: function(element) {=0A=
    $(element).select();=0A=
    return element;=0A=
  }=0A=
};=0A=
=0A=
Form.Element.Methods =3D {=0A=
  serialize: function(element) {=0A=
    element =3D $(element);=0A=
    if (!element.disabled && element.name) {=0A=
      var value =3D element.getValue();=0A=
      if (value !=3D undefined) {=0A=
        var pair =3D { };=0A=
        pair[element.name] =3D value;=0A=
        return Object.toQueryString(pair);=0A=
      }=0A=
    }=0A=
    return '';=0A=
  },=0A=
=0A=
  getValue: function(element) {=0A=
    element =3D $(element);=0A=
    var method =3D element.tagName.toLowerCase();=0A=
    return Form.Element.Serializers[method](element);=0A=
  },=0A=
=0A=
  setValue: function(element, value) {=0A=
    element =3D $(element);=0A=
    var method =3D element.tagName.toLowerCase();=0A=
    Form.Element.Serializers[method](element, value);=0A=
    return element;=0A=
  },=0A=
=0A=
  clear: function(element) {=0A=
    $(element).value =3D '';=0A=
    return element;=0A=
  },=0A=
=0A=
  present: function(element) {=0A=
    return $(element).value !=3D '';=0A=
  },=0A=
=0A=
  activate: function(element) {=0A=
    element =3D $(element);=0A=
    try {=0A=
      element.focus();=0A=
      if (element.select && (element.tagName.toLowerCase() !=3D 'input' =
||=0A=
          !['button', 'reset', 'submit'].include(element.type)))=0A=
        element.select();=0A=
    } catch (e) { }=0A=
    return element;=0A=
  },=0A=
=0A=
  disable: function(element) {=0A=
    element =3D $(element);=0A=
    element.disabled =3D true;=0A=
    return element;=0A=
  },=0A=
=0A=
  enable: function(element) {=0A=
    element =3D $(element);=0A=
    element.disabled =3D false;=0A=
    return element;=0A=
  }=0A=
};=0A=
=0A=
/*-----------------------------------------------------------------------=
---*/=0A=
=0A=
var Field =3D Form.Element;=0A=
var $F =3D Form.Element.Methods.getValue;=0A=
=0A=
/*-----------------------------------------------------------------------=
---*/=0A=
=0A=
Form.Element.Serializers =3D {=0A=
  input: function(element, value) {=0A=
    switch (element.type.toLowerCase()) {=0A=
      case 'checkbox':=0A=
      case 'radio':=0A=
        return Form.Element.Serializers.inputSelector(element, value);=0A=
      default:=0A=
        return Form.Element.Serializers.textarea(element, value);=0A=
    }=0A=
  },=0A=
=0A=
  inputSelector: function(element, value) {=0A=
    if (Object.isUndefined(value)) return element.checked ? =
element.value : null;=0A=
    else element.checked =3D !!value;=0A=
  },=0A=
=0A=
  textarea: function(element, value) {=0A=
    if (Object.isUndefined(value)) return element.value;=0A=
    else element.value =3D value;=0A=
  },=0A=
=0A=
  select: function(element, value) {=0A=
    if (Object.isUndefined(value))=0A=
      return this[element.type =3D=3D 'select-one' ?=0A=
        'selectOne' : 'selectMany'](element);=0A=
    else {=0A=
      var opt, currentValue, single =3D !Object.isArray(value);=0A=
      for (var i =3D 0, length =3D element.length; i < length; i++) {=0A=
        opt =3D element.options[i];=0A=
        currentValue =3D this.optionValue(opt);=0A=
        if (single) {=0A=
          if (currentValue =3D=3D value) {=0A=
            opt.selected =3D true;=0A=
            return;=0A=
          }=0A=
        }=0A=
        else opt.selected =3D value.include(currentValue);=0A=
      }=0A=
    }=0A=
  },=0A=
=0A=
  selectOne: function(element) {=0A=
    var index =3D element.selectedIndex;=0A=
    return index >=3D 0 ? this.optionValue(element.options[index]) : =
null;=0A=
  },=0A=
=0A=
  selectMany: function(element) {=0A=
    var values, length =3D element.length;=0A=
    if (!length) return null;=0A=
=0A=
    for (var i =3D 0, values =3D []; i < length; i++) {=0A=
      var opt =3D element.options[i];=0A=
      if (opt.selected) values.push(this.optionValue(opt));=0A=
    }=0A=
    return values;=0A=
  },=0A=
=0A=
  optionValue: function(opt) {=0A=
    // extend element because hasAttribute may not be native=0A=
    return Element.extend(opt).hasAttribute('value') ? opt.value : =
opt.text;=0A=
  }=0A=
};=0A=
=0A=
/*-----------------------------------------------------------------------=
---*/=0A=
=0A=
Abstract.TimedObserver =3D Class.create(PeriodicalExecuter, {=0A=
  initialize: function($super, element, frequency, callback) {=0A=
    $super(callback, frequency);=0A=
    this.element   =3D $(element);=0A=
    this.lastValue =3D this.getValue();=0A=
  },=0A=
=0A=
  execute: function() {=0A=
    var value =3D this.getValue();=0A=
    if (Object.isString(this.lastValue) && Object.isString(value) ?=0A=
        this.lastValue !=3D value : String(this.lastValue) !=3D =
String(value)) {=0A=
      this.callback(this.element, value);=0A=
      this.lastValue =3D value;=0A=
    }=0A=
  }=0A=
});=0A=
=0A=
Form.Element.Observer =3D Class.create(Abstract.TimedObserver, {=0A=
  getValue: function() {=0A=
    return Form.Element.getValue(this.element);=0A=
  }=0A=
});=0A=
=0A=
Form.Observer =3D Class.create(Abstract.TimedObserver, {=0A=
  getValue: function() {=0A=
    return Form.serialize(this.element);=0A=
  }=0A=
});=0A=
=0A=
/*-----------------------------------------------------------------------=
---*/=0A=
=0A=
Abstract.EventObserver =3D Class.create({=0A=
  initialize: function(element, callback) {=0A=
    this.element  =3D $(element);=0A=
    this.callback =3D callback;=0A=
=0A=
    this.lastValue =3D this.getValue();=0A=
    if (this.element.tagName.toLowerCase() =3D=3D 'form')=0A=
      this.registerFormCallbacks();=0A=
    else=0A=
      this.registerCallback(this.element);=0A=
  },=0A=
=0A=
  onElementEvent: function() {=0A=
    var value =3D this.getValue();=0A=
    if (this.lastValue !=3D value) {=0A=
      this.callback(this.element, value);=0A=
      this.lastValue =3D value;=0A=
    }=0A=
  },=0A=
=0A=
  registerFormCallbacks: function() {=0A=
    Form.getElements(this.element).each(this.registerCallback, this);=0A=
  },=0A=
=0A=
  registerCallback: function(element) {=0A=
    if (element.type) {=0A=
      switch (element.type.toLowerCase()) {=0A=
        case 'checkbox':=0A=
        case 'radio':=0A=
          Event.observe(element, 'click', =
this.onElementEvent.bind(this));=0A=
          break;=0A=
        default:=0A=
          Event.observe(element, 'change', =
this.onElementEvent.bind(this));=0A=
          break;=0A=
      }=0A=
    }=0A=
  }=0A=
});=0A=
=0A=
Form.Element.EventObserver =3D Class.create(Abstract.EventObserver, {=0A=
  getValue: function() {=0A=
    return Form.Element.getValue(this.element);=0A=
  }=0A=
});=0A=
=0A=
Form.EventObserver =3D Class.create(Abstract.EventObserver, {=0A=
  getValue: function() {=0A=
    return Form.serialize(this.element);=0A=
  }=0A=
});=0A=
if (!window.Event) var Event =3D { };=0A=
=0A=
Object.extend(Event, {=0A=
  KEY_BACKSPACE: 8,=0A=
  KEY_TAB:       9,=0A=
  KEY_RETURN:   13,=0A=
  KEY_ESC:      27,=0A=
  KEY_LEFT:     37,=0A=
  KEY_UP:       38,=0A=
  KEY_RIGHT:    39,=0A=
  KEY_DOWN:     40,=0A=
  KEY_DELETE:   46,=0A=
  KEY_HOME:     36,=0A=
  KEY_END:      35,=0A=
  KEY_PAGEUP:   33,=0A=
  KEY_PAGEDOWN: 34,=0A=
  KEY_INSERT:   45,=0A=
=0A=
  cache: { },=0A=
=0A=
  relatedTarget: function(event) {=0A=
    var element;=0A=
    switch(event.type) {=0A=
      case 'mouseover': element =3D event.fromElement; break;=0A=
      case 'mouseout':  element =3D event.toElement;   break;=0A=
      default: return null;=0A=
    }=0A=
    return Element.extend(element);=0A=
  }=0A=
});=0A=
=0A=
Event.Methods =3D (function() {=0A=
  var isButton;=0A=
=0A=
  if (Prototype.Browser.IE) {=0A=
    var buttonMap =3D { 0: 1, 1: 4, 2: 2 };=0A=
    isButton =3D function(event, code) {=0A=
      return event.button =3D=3D buttonMap[code];=0A=
    };=0A=
=0A=
  } else if (Prototype.Browser.WebKit) {=0A=
    isButton =3D function(event, code) {=0A=
      switch (code) {=0A=
        case 0: return event.which =3D=3D 1 && !event.metaKey;=0A=
        case 1: return event.which =3D=3D 1 && event.metaKey;=0A=
        default: return false;=0A=
      }=0A=
    };=0A=
=0A=
  } else {=0A=
    isButton =3D function(event, code) {=0A=
      return event.which ? (event.which =3D=3D=3D code + 1) : =
(event.button =3D=3D=3D code);=0A=
    };=0A=
  }=0A=
=0A=
  return {=0A=
    isLeftClick:   function(event) { return isButton(event, 0) },=0A=
    isMiddleClick: function(event) { return isButton(event, 1) },=0A=
    isRightClick:  function(event) { return isButton(event, 2) },=0A=
=0A=
    element: function(event) {=0A=
      event =3D Event.extend(event);=0A=
=0A=
      var node          =3D event.target,=0A=
          type          =3D event.type,=0A=
          currentTarget =3D event.currentTarget;=0A=
=0A=
      if (currentTarget && currentTarget.tagName) {=0A=
        // Firefox screws up the "click" event when moving between radio =
buttons=0A=
        // via arrow keys. It also screws up the "load" and "error" =
events on images,=0A=
        // reporting the document as the target instead of the original =
image.=0A=
        if (type =3D=3D=3D 'load' || type =3D=3D=3D 'error' ||=0A=
          (type =3D=3D=3D 'click' && currentTarget.tagName.toLowerCase() =
=3D=3D=3D 'input'=0A=
            && currentTarget.type =3D=3D=3D 'radio'))=0A=
              node =3D currentTarget;=0A=
      }=0A=
      if (node.nodeType =3D=3D Node.TEXT_NODE) node =3D node.parentNode;=0A=
      return Element.extend(node);=0A=
    },=0A=
=0A=
    findElement: function(event, expression) {=0A=
      var element =3D Event.element(event);=0A=
      if (!expression) return element;=0A=
      var elements =3D [element].concat(element.ancestors());=0A=
      return Selector.findElement(elements, expression, 0);=0A=
    },=0A=
=0A=
    pointer: function(event) {=0A=
      var docElement =3D document.documentElement,=0A=
      body =3D document.body || { scrollLeft: 0, scrollTop: 0 };=0A=
      return {=0A=
        x: event.pageX || (event.clientX +=0A=
          (docElement.scrollLeft || body.scrollLeft) -=0A=
          (docElement.clientLeft || 0)),=0A=
        y: event.pageY || (event.clientY +=0A=
          (docElement.scrollTop || body.scrollTop) -=0A=
          (docElement.clientTop || 0))=0A=
      };=0A=
    },=0A=
=0A=
    pointerX: function(event) { return Event.pointer(event).x },=0A=
    pointerY: function(event) { return Event.pointer(event).y },=0A=
=0A=
    stop: function(event) {=0A=
      Event.extend(event);=0A=
      event.preventDefault();=0A=
      event.stopPropagation();=0A=
      event.stopped =3D true;=0A=
    }=0A=
  };=0A=
})();=0A=
=0A=
Event.extend =3D (function() {=0A=
  var methods =3D Object.keys(Event.Methods).inject({ }, function(m, =
name) {=0A=
    m[name] =3D Event.Methods[name].methodize();=0A=
    return m;=0A=
  });=0A=
=0A=
  if (Prototype.Browser.IE) {=0A=
    Object.extend(methods, {=0A=
      stopPropagation: function() { this.cancelBubble =3D true },=0A=
      preventDefault:  function() { this.returnValue =3D false },=0A=
      inspect: function() { return "[object Event]" }=0A=
    });=0A=
=0A=
    return function(event) {=0A=
      if (!event) return false;=0A=
      if (event._extendedByPrototype) return event;=0A=
=0A=
      event._extendedByPrototype =3D Prototype.emptyFunction;=0A=
      var pointer =3D Event.pointer(event);=0A=
      Object.extend(event, {=0A=
        target: event.srcElement,=0A=
        relatedTarget: Event.relatedTarget(event),=0A=
        pageX:  pointer.x,=0A=
        pageY:  pointer.y=0A=
      });=0A=
      return Object.extend(event, methods);=0A=
    };=0A=
=0A=
  } else {=0A=
    Event.prototype =3D Event.prototype || =
document.createEvent("HTMLEvents")['__proto__'];=0A=
    Object.extend(Event.prototype, methods);=0A=
    return Prototype.K;=0A=
  }=0A=
})();=0A=
=0A=
Object.extend(Event, (function() {=0A=
  var cache =3D Event.cache;=0A=
=0A=
  function getEventID(element) {=0A=
    if (element._prototypeEventID) return element._prototypeEventID[0];=0A=
    arguments.callee.id =3D arguments.callee.id || 1;=0A=
    return element._prototypeEventID =3D [++arguments.callee.id];=0A=
  }=0A=
=0A=
  function getDOMEventName(eventName) {=0A=
    if (eventName && eventName.include(':')) return "dataavailable";=0A=
    return eventName;=0A=
  }=0A=
=0A=
  function getCacheForID(id) {=0A=
    return cache[id] =3D cache[id] || { };=0A=
  }=0A=
=0A=
  function getWrappersForEventName(id, eventName) {=0A=
    var c =3D getCacheForID(id);=0A=
    return c[eventName] =3D c[eventName] || [];=0A=
  }=0A=
=0A=
  function createWrapper(element, eventName, handler) {=0A=
    var id =3D getEventID(element);=0A=
    var c =3D getWrappersForEventName(id, eventName);=0A=
    if (c.pluck("handler").include(handler)) return false;=0A=
=0A=
    var wrapper =3D function(event) {=0A=
      if (!Event || !Event.extend ||=0A=
        (event.eventName && event.eventName !=3D eventName))=0A=
          return false;=0A=
=0A=
      Event.extend(event);=0A=
      handler.call(element, event);=0A=
    };=0A=
=0A=
    wrapper.handler =3D handler;=0A=
    c.push(wrapper);=0A=
    return wrapper;=0A=
  }=0A=
=0A=
  function findWrapper(id, eventName, handler) {=0A=
    var c =3D getWrappersForEventName(id, eventName);=0A=
    return c.find(function(wrapper) { return wrapper.handler =3D=3D =
handler });=0A=
  }=0A=
=0A=
  function destroyWrapper(id, eventName, handler) {=0A=
    var c =3D getCacheForID(id);=0A=
    if (!c[eventName]) return false;=0A=
    c[eventName] =3D c[eventName].without(findWrapper(id, eventName, =
handler));=0A=
  }=0A=
=0A=
  function destroyCache() {=0A=
    for (var id in cache)=0A=
      for (var eventName in cache[id])=0A=
        cache[id][eventName] =3D null;=0A=
  }=0A=
=0A=
=0A=
  // Internet Explorer needs to remove event handlers on page unload=0A=
  // in order to avoid memory leaks.=0A=
  if (window.attachEvent) {=0A=
    window.attachEvent("onunload", destroyCache);=0A=
  }=0A=
=0A=
  // Safari has a dummy event handler on page unload so that it won't=0A=
  // use its bfcache. Safari <=3D 3.1 has an issue with restoring the =
"document"=0A=
  // object when page is returned to via the back button using its =
bfcache.=0A=
  if (Prototype.Browser.WebKit) {=0A=
    window.addEventListener('unload', Prototype.emptyFunction, false);=0A=
  }=0A=
=0A=
  return {=0A=
    observe: function(element, eventName, handler) {=0A=
      element =3D $(element);=0A=
      var name =3D getDOMEventName(eventName);=0A=
=0A=
      var wrapper =3D createWrapper(element, eventName, handler);=0A=
      if (!wrapper) return element;=0A=
=0A=
      if (element.addEventListener) {=0A=
        element.addEventListener(name, wrapper, false);=0A=
      } else {=0A=
        element.attachEvent("on" + name, wrapper);=0A=
      }=0A=
=0A=
      return element;=0A=
    },=0A=
=0A=
    stopObserving: function(element, eventName, handler) {=0A=
      element =3D $(element);=0A=
      var id =3D getEventID(element), name =3D =
getDOMEventName(eventName);=0A=
=0A=
      if (!handler && eventName) {=0A=
        getWrappersForEventName(id, eventName).each(function(wrapper) {=0A=
          element.stopObserving(eventName, wrapper.handler);=0A=
        });=0A=
        return element;=0A=
=0A=
      } else if (!eventName) {=0A=
        Object.keys(getCacheForID(id)).each(function(eventName) {=0A=
          element.stopObserving(eventName);=0A=
        });=0A=
        return element;=0A=
      }=0A=
=0A=
      var wrapper =3D findWrapper(id, eventName, handler);=0A=
      if (!wrapper) return element;=0A=
=0A=
      if (element.removeEventListener) {=0A=
        element.removeEventListener(name, wrapper, false);=0A=
      } else {=0A=
        element.detachEvent("on" + name, wrapper);=0A=
      }=0A=
=0A=
      destroyWrapper(id, eventName, handler);=0A=
=0A=
      return element;=0A=
    },=0A=
=0A=
    fire: function(element, eventName, memo) {=0A=
      element =3D $(element);=0A=
      if (element =3D=3D document && document.createEvent && =
!element.dispatchEvent)=0A=
        element =3D document.documentElement;=0A=
=0A=
      var event;=0A=
      if (document.createEvent) {=0A=
        event =3D document.createEvent("HTMLEvents");=0A=
        event.initEvent("dataavailable", true, true);=0A=
      } else {=0A=
        event =3D document.createEventObject();=0A=
        event.eventType =3D "ondataavailable";=0A=
      }=0A=
=0A=
      event.eventName =3D eventName;=0A=
      event.memo =3D memo || { };=0A=
=0A=
      if (document.createEvent) {=0A=
        element.dispatchEvent(event);=0A=
      } else {=0A=
        element.fireEvent(event.eventType, event);=0A=
      }=0A=
=0A=
      return Event.extend(event);=0A=
    }=0A=
  };=0A=
})());=0A=
=0A=
Object.extend(Event, Event.Methods);=0A=
=0A=
Element.addMethods({=0A=
  fire:          Event.fire,=0A=
  observe:       Event.observe,=0A=
  stopObserving: Event.stopObserving=0A=
});=0A=
=0A=
Object.extend(document, {=0A=
  fire:          Element.Methods.fire.methodize(),=0A=
  observe:       Element.Methods.observe.methodize(),=0A=
  stopObserving: Element.Methods.stopObserving.methodize(),=0A=
  loaded:        false=0A=
});=0A=
=0A=
(function() {=0A=
  /* Support for the DOMContentLoaded event is based on work by Dan Webb,=0A=
     Matthias Miller, Dean Edwards and John Resig. */=0A=
=0A=
  var timer;=0A=
=0A=
  function fireContentLoadedEvent() {=0A=
    if (document.loaded) return;=0A=
    if (timer) window.clearInterval(timer);=0A=
    document.fire("dom:loaded");=0A=
    document.loaded =3D true;=0A=
  }=0A=
=0A=
  if (document.addEventListener) {=0A=
    if (Prototype.Browser.WebKit) {=0A=
      timer =3D window.setInterval(function() {=0A=
        if (/loaded|complete/.test(document.readyState))=0A=
          fireContentLoadedEvent();=0A=
      }, 0);=0A=
=0A=
      Event.observe(window, "load", fireContentLoadedEvent);=0A=
=0A=
    } else {=0A=
      document.addEventListener("DOMContentLoaded",=0A=
        fireContentLoadedEvent, false);=0A=
    }=0A=
=0A=
  } else {=0A=
    document.write("<script id=3D__onDOMContentLoaded defer =
src=3D//:><\/script>");=0A=
    $("__onDOMContentLoaded").onreadystatechange =3D function() {=0A=
      if (this.readyState =3D=3D "complete") {=0A=
        this.onreadystatechange =3D null;=0A=
        fireContentLoadedEvent();=0A=
      }=0A=
    };=0A=
  }=0A=
})();=0A=
/*------------------------------- DEPRECATED =
-------------------------------*/=0A=
=0A=
Hash.toQueryString =3D Object.toQueryString;=0A=
=0A=
var Toggle =3D { display: Element.toggle };=0A=
=0A=
Element.Methods.childOf =3D Element.Methods.descendantOf;=0A=
=0A=
var Insertion =3D {=0A=
  Before: function(element, content) {=0A=
    return Element.insert(element, {before:content});=0A=
  },=0A=
=0A=
  Top: function(element, content) {=0A=
    return Element.insert(element, {top:content});=0A=
  },=0A=
=0A=
  Bottom: function(element, content) {=0A=
    return Element.insert(element, {bottom:content});=0A=
  },=0A=
=0A=
  After: function(element, content) {=0A=
    return Element.insert(element, {after:content});=0A=
  }=0A=
};=0A=
=0A=
var $continue =3D new Error('"throw $continue" is deprecated, use =
"return" instead');=0A=
=0A=
// This should be moved to script.aculo.us; notice the deprecated methods=0A=
// further below, that map to the newer Element methods.=0A=
var Position =3D {=0A=
  // set to true if needed, warning: firefox performance problems=0A=
  // NOT neeeded for page scrolling, only if draggable contained in=0A=
  // scrollable elements=0A=
  includeScrollOffsets: false,=0A=
=0A=
  // must be called before calling withinIncludingScrolloffset, every =
time the=0A=
  // page is scrolled=0A=
  prepare: function() {=0A=
    this.deltaX =3D  window.pageXOffset=0A=
                || document.documentElement.scrollLeft=0A=
                || document.body.scrollLeft=0A=
                || 0;=0A=
    this.deltaY =3D  window.pageYOffset=0A=
                || document.documentElement.scrollTop=0A=
                || document.body.scrollTop=0A=
                || 0;=0A=
  },=0A=
=0A=
  // caches x/y coordinate pair to use with overlap=0A=
  within: function(element, x, y) {=0A=
    if (this.includeScrollOffsets)=0A=
      return this.withinIncludingScrolloffsets(element, x, y);=0A=
    this.xcomp =3D x;=0A=
    this.ycomp =3D y;=0A=
    this.offset =3D Element.cumulativeOffset(element);=0A=
=0A=
    return (y >=3D this.offset[1] &&=0A=
            y <  this.offset[1] + element.offsetHeight &&=0A=
            x >=3D this.offset[0] &&=0A=
            x <  this.offset[0] + element.offsetWidth);=0A=
  },=0A=
=0A=
  withinIncludingScrolloffsets: function(element, x, y) {=0A=
    var offsetcache =3D Element.cumulativeScrollOffset(element);=0A=
=0A=
    this.xcomp =3D x + offsetcache[0] - this.deltaX;=0A=
    this.ycomp =3D y + offsetcache[1] - this.deltaY;=0A=
    this.offset =3D Element.cumulativeOffset(element);=0A=
=0A=
    return (this.ycomp >=3D this.offset[1] &&=0A=
            this.ycomp <  this.offset[1] + element.offsetHeight &&=0A=
            this.xcomp >=3D this.offset[0] &&=0A=
            this.xcomp <  this.offset[0] + element.offsetWidth);=0A=
  },=0A=
=0A=
  // within must be called directly before=0A=
  overlap: function(mode, element) {=0A=
    if (!mode) return 0;=0A=
    if (mode =3D=3D 'vertical')=0A=
      return ((this.offset[1] + element.offsetHeight) - this.ycomp) /=0A=
        element.offsetHeight;=0A=
    if (mode =3D=3D 'horizontal')=0A=
      return ((this.offset[0] + element.offsetWidth) - this.xcomp) /=0A=
        element.offsetWidth;=0A=
  },=0A=
=0A=
  // Deprecation layer -- use newer Element methods now (1.5.2).=0A=
=0A=
  cumulativeOffset: Element.Methods.cumulativeOffset,=0A=
=0A=
  positionedOffset: Element.Methods.positionedOffset,=0A=
=0A=
  absolutize: function(element) {=0A=
    Position.prepare();=0A=
    return Element.absolutize(element);=0A=
  },=0A=
=0A=
  relativize: function(element) {=0A=
    Position.prepare();=0A=
    return Element.relativize(element);=0A=
  },=0A=
=0A=
  realOffset: Element.Methods.cumulativeScrollOffset,=0A=
=0A=
  offsetParent: Element.Methods.getOffsetParent,=0A=
=0A=
  page: Element.Methods.viewportOffset,=0A=
=0A=
  clone: function(source, target, options) {=0A=
    options =3D options || { };=0A=
    return Element.clonePosition(target, source, options);=0A=
  }=0A=
};=0A=
=0A=
/*-----------------------------------------------------------------------=
---*/=0A=
=0A=
if (!document.getElementsByClassName) document.getElementsByClassName =
=3D function(instanceMethods){=0A=
  function iter(name) {=0A=
    return name.blank() ? null : "[contains(concat(' ', @class, ' '), ' =
" + name + " ')]";=0A=
  }=0A=
=0A=
  instanceMethods.getElementsByClassName =3D =
Prototype.BrowserFeatures.XPath ?=0A=
  function(element, className) {=0A=
    className =3D className.toString().strip();=0A=
    var cond =3D /\s/.test(className) ? $w(className).map(iter).join('') =
: iter(className);=0A=
    return cond ? document._getElementsByXPath('.//*' + cond, element) : =
[];=0A=
  } : function(element, className) {=0A=
    className =3D className.toString().strip();=0A=
    var elements =3D [], classNames =3D (/\s/.test(className) ? =
$w(className) : null);=0A=
    if (!classNames && !className) return elements;=0A=
=0A=
    var nodes =3D $(element).getElementsByTagName('*');=0A=
    className =3D ' ' + className + ' ';=0A=
=0A=
    for (var i =3D 0, child, cn; child =3D nodes[i]; i++) {=0A=
      if (child.className && (cn =3D ' ' + child.className + ' ') && =
(cn.include(className) ||=0A=
          (classNames && classNames.all(function(name) {=0A=
            return !name.toString().blank() && cn.include(' ' + name + ' =
');=0A=
          }))))=0A=
        elements.push(Element.extend(child));=0A=
    }=0A=
    return elements;=0A=
  };=0A=
=0A=
  return function(className, parentElement) {=0A=
    return $(parentElement || =
document.body).getElementsByClassName(className);=0A=
  };=0A=
}(Element.Methods);=0A=
=0A=
/*-----------------------------------------------------------------------=
---*/=0A=
=0A=
Element.ClassNames =3D Class.create();=0A=
Element.ClassNames.prototype =3D {=0A=
  initialize: function(element) {=0A=
    this.element =3D $(element);=0A=
  },=0A=
=0A=
  _each: function(iterator) {=0A=
    this.element.className.split(/\s+/).select(function(name) {=0A=
      return name.length > 0;=0A=
    })._each(iterator);=0A=
  },=0A=
=0A=
  set: function(className) {=0A=
    this.element.className =3D className;=0A=
  },=0A=
=0A=
  add: function(classNameToAdd) {=0A=
    if (this.include(classNameToAdd)) return;=0A=
    this.set($A(this).concat(classNameToAdd).join(' '));=0A=
  },=0A=
=0A=
  remove: function(classNameToRemove) {=0A=
    if (!this.include(classNameToRemove)) return;=0A=
    this.set($A(this).without(classNameToRemove).join(' '));=0A=
  },=0A=
=0A=
  toString: function() {=0A=
    return $A(this).join(' ');=0A=
  }=0A=
};=0A=
=0A=
Object.extend(Element.ClassNames.prototype, Enumerable);=0A=
=0A=
/*-----------------------------------------------------------------------=
---*/=0A=
=0A=
Element.addMethods();
------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: application/octet-stream
Content-Transfer-Encoding: quoted-printable
Content-Location: http://www.mono-project.com/skins/MonoWaveWide/wikihacks.js

function create_cookie (name, value, days) {=0A=
	if (days) {=0A=
		var date =3D new Date ();=0A=
		date.setTime (date.getTime () + (days * 24 *60 * 60 * 1000));=0A=
		var expires =3D "; expires=3D" + date.toGMTString();=0A=
	} else {=0A=
	    var expires =3D "";=0A=
	}=0A=
	=0A=
	document.cookie =3D name + "=3D" + value + expires + "; path=3D/";=0A=
}=0A=
=0A=
function read_cookie (name) {=0A=
	var nameEQ =3D name + "=3D";=0A=
	var ca =3D document.cookie.split (';');=0A=
	=0A=
	for (var i =3D 0; i < ca.length; i++) {=0A=
		var c =3D ca[i];=0A=
		while (c.charAt(0) =3D=3D ' ') {=0A=
		    c =3D c.substring (1, c.length);=0A=
		}=0A=
		=0A=
		if (c.indexOf (nameEQ) =3D=3D 0) {=0A=
		    return c.substring (nameEQ.length, c.length);=0A=
		}=0A=
	}=0A=
	=0A=
	return null;=0A=
}=0A=
=0A=
function erase_cookie (name) =0A=
{=0A=
	create_cookie (name, "", -1);=0A=
}=0A=
=0A=
function toggle_toolbox (toolbox, link)=0A=
{=0A=
    if (toolbox.getStyle ("display") !=3D "none") {=0A=
        link.innerHTML =3D "show";   =0A=
        toolbox.setStyle ("display: none");=0A=
        create_cookie ("wiki_toolbox_visible", "false", 60);=0A=
    } else {=0A=
        link.innerHTML =3D "hide";=0A=
        toolbox.setStyle ("display: block");=0A=
        create_cookie ("wiki_toolbox_visible", "true", 60);=0A=
    }=0A=
}=0A=
=0A=
function install_toolbox_hack ()=0A=
{=0A=
    var link =3D $('utility-bar-toggle-link');=0A=
    var toolbox =3D $('utility-bar-contents');=0A=
    =0A=
    if (link && toolbox) {=0A=
        link.observe ('click', function () { =0A=
            toggle_toolbox (toolbox, link); =0A=
        });=0A=
        =0A=
        var show =3D read_cookie ("wiki_toolbox_visible");=0A=
        if (!show || show =3D=3D "true") {=0A=
            toggle_toolbox (toolbox, link);=0A=
        } else {=0A=
            link.innerHTML =3D "show";=0A=
        }=0A=
    }=0A=
}=0A=
=0A=
function install_toc_hack ()=0A=
{=0A=
    var toc =3D $('toc');=0A=
    var wrapper =3D $('wrapper');=0A=
    var content =3D $('content');=0A=
    var tocparent =3D $('toc-parent');=0A=
    =0A=
    if (toc && tocparent) {=0A=
        wrapper.removeClassName ('wide');=0A=
        content.removeClassName ('wide');=0A=
        =0A=
        toc =3D toc.remove ();=0A=
        tocparent.insert (toc);=0A=
        toc.setStyle ('display: block');=0A=
    }=0A=
}=0A=
=0A=
function install_hacks ()=0A=
{=0A=
    install_toc_hack ();=0A=
    install_toolbox_hack ();=0A=
}=0A=
=0A=
Event.observe (window, 'load', install_hacks);=0A=
=0A=

------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: application/octet-stream
Content-Transfer-Encoding: quoted-printable
Content-Location: http://www.mono-project.com/skins/common/wikibits.js

// MediaWiki JavaScript support functions=0A=
=0A=
window.clientPC =3D navigator.userAgent.toLowerCase(); // Get client info=0A=
window.is_gecko =3D /gecko/.test( clientPC ) &&=0A=
	!/khtml|spoofer|netscape\/7\.0/.test(clientPC);=0A=
=0A=
window.is_safari =3D window.is_safari_win =3D window.webkit_version =3D=0A=
	window.is_chrome =3D window.is_chrome_mac =3D false;=0A=
window.webkit_match =3D clientPC.match(/applewebkit\/(\d+)/);=0A=
if (webkit_match) {=0A=
	window.is_safari =3D clientPC.indexOf('applewebkit') !=3D -1 &&=0A=
		clientPC.indexOf('spoofer') =3D=3D -1;=0A=
	window.is_safari_win =3D is_safari && clientPC.indexOf('windows') !=3D =
-1;=0A=
	window.webkit_version =3D parseInt(webkit_match[1]);=0A=
	// Tests for chrome here, to avoid breaking old scripts safari left =
alone=0A=
	// This is here for accesskeys=0A=
	window.is_chrome =3D clientPC.indexOf('chrome') !=3D=3D -1 &&=0A=
		clientPC.indexOf('spoofer') =3D=3D=3D -1;=0A=
	window.is_chrome_mac =3D is_chrome && clientPC.indexOf('mac') !=3D=3D -1=0A=
}=0A=
=0A=
// For accesskeys; note that FF3+ is included here!=0A=
window.is_ff2 =3D /firefox\/[2-9]|minefield\/3/.test( clientPC );=0A=
window.ff2_bugs =3D /firefox\/2/.test( clientPC );=0A=
// These aren't used here, but some custom scripts rely on them=0A=
window.is_ff2_win =3D is_ff2 && clientPC.indexOf('windows') !=3D -1;=0A=
window.is_ff2_x11 =3D is_ff2 && clientPC.indexOf('x11') !=3D -1;=0A=
=0A=
window.is_opera =3D window.is_opera_preseven =3D window.is_opera_95 =3D=0A=
	window.opera6_bugs =3D window.opera7_bugs =3D window.opera95_bugs =3D =
false;=0A=
if (clientPC.indexOf('opera') !=3D -1) {=0A=
	window.is_opera =3D true;=0A=
	window.is_opera_preseven =3D window.opera && !document.childNodes;=0A=
	window.is_opera_seven =3D window.opera && document.childNodes;=0A=
	window.is_opera_95 =3D /opera\/(9\.[5-9]|[1-9][0-9])/.test( clientPC );=0A=
	window.opera6_bugs =3D is_opera_preseven;=0A=
	window.opera7_bugs =3D is_opera_seven && !is_opera_95;=0A=
	window.opera95_bugs =3D /opera\/(9\.5)/.test( clientPC );=0A=
}=0A=
// As recommended by =
<http://msdn.microsoft.com/en-us/library/ms537509.aspx>,=0A=
// avoiding false positives from moronic extensions that append to the =
IE UA=0A=
// string (bug 23171)=0A=
window.ie6_bugs =3D false;=0A=
if ( /msie ([0-9]{1,}[\.0-9]{0,})/.exec( clientPC ) !=3D null=0A=
&& parseFloat( RegExp.$1 ) <=3D 6.0 ) {=0A=
	ie6_bugs =3D true;=0A=
}=0A=
=0A=
// Global external objects used by this script.=0A=
/*extern ta, stylepath, skin */=0A=
=0A=
// add any onload functions in this hook (please don't hard-code any =
events in the xhtml source)=0A=
window.doneOnloadHook =3D undefined;=0A=
=0A=
if (!window.onloadFuncts) {=0A=
	window.onloadFuncts =3D [];=0A=
}=0A=
=0A=
window.addOnloadHook =3D function( hookFunct ) {=0A=
	// Allows add-on scripts to add onload functions=0A=
	if( !doneOnloadHook ) {=0A=
		onloadFuncts[onloadFuncts.length] =3D hookFunct;=0A=
	} else {=0A=
		hookFunct();  // bug in MSIE script loading=0A=
	}=0A=
};=0A=
=0A=
window.importScript =3D function( page ) {=0A=
	// TODO: might want to introduce a utility function to match =
wfUrlencode() in PHP=0A=
	var uri =3D wgScript + '?title=3D' +=0A=
		encodeURIComponent(page.replace(/ =
/g,'_')).replace(/%2F/ig,'/').replace(/%3A/ig,':') +=0A=
		'&action=3Draw&ctype=3Dtext/javascript';=0A=
	return importScriptURI( uri );=0A=
};=0A=
=0A=
window.loadedScripts =3D {}; // included-scripts tracker=0A=
window.importScriptURI =3D function( url ) {=0A=
	if ( loadedScripts[url] ) {=0A=
		return null;=0A=
	}=0A=
	loadedScripts[url] =3D true;=0A=
	var s =3D document.createElement( 'script' );=0A=
	s.setAttribute( 'src', url );=0A=
	s.setAttribute( 'type', 'text/javascript' );=0A=
	document.getElementsByTagName('head')[0].appendChild( s );=0A=
	return s;=0A=
};=0A=
=0A=
window.importStylesheet =3D function( page ) {=0A=
	return importStylesheetURI( wgScript + =
'?action=3Draw&ctype=3Dtext/css&title=3D' + encodeURIComponent( =
page.replace(/ /g,'_') ) );=0A=
};=0A=
=0A=
window.importStylesheetURI =3D function( url, media ) {=0A=
	var l =3D document.createElement( 'link' );=0A=
	l.type =3D 'text/css';=0A=
	l.rel =3D 'stylesheet';=0A=
	l.href =3D url;=0A=
	if( media ) {=0A=
		l.media =3D media;=0A=
	}=0A=
	document.getElementsByTagName('head')[0].appendChild( l );=0A=
	return l;=0A=
};=0A=
=0A=
window.appendCSS =3D function( text ) {=0A=
	var s =3D document.createElement( 'style' );=0A=
	s.type =3D 'text/css';=0A=
	s.rel =3D 'stylesheet';=0A=
	if ( s.styleSheet ) {=0A=
		s.styleSheet.cssText =3D text; // IE=0A=
	} else {=0A=
		s.appendChild( document.createTextNode( text + '' ) ); // Safari =
sometimes borks on null=0A=
	}=0A=
	document.getElementsByTagName('head')[0].appendChild( s );=0A=
	return s;=0A=
};=0A=
=0A=
// Special stylesheet links for Monobook only (see bug 14717)=0A=
if ( typeof stylepath !=3D 'undefined' && skin =3D=3D 'monobook' ) {=0A=
	if ( opera6_bugs ) {=0A=
		importStylesheetURI( stylepath + '/' + skin + '/Opera6Fixes.css' );=0A=
	} else if ( opera7_bugs ) {=0A=
		importStylesheetURI( stylepath + '/' + skin + '/Opera7Fixes.css' );=0A=
	} else if ( opera95_bugs ) {=0A=
		importStylesheetURI( stylepath + '/' + skin + '/Opera9Fixes.css' );=0A=
	} else if ( ff2_bugs ) {=0A=
		importStylesheetURI( stylepath + '/' + skin + '/FF2Fixes.css' );=0A=
	}=0A=
}=0A=
=0A=
=0A=
if ( 'wgBreakFrames' in window && window.wgBreakFrames ) {=0A=
	// Un-trap us from framesets=0A=
	if ( window.top !=3D window ) {=0A=
		window.top.location =3D window.location;=0A=
	}=0A=
}=0A=
=0A=
window.showTocToggle =3D function() {=0A=
	if ( document.createTextNode ) {=0A=
		// Uses DOM calls to avoid document.write + XHTML issues=0A=
=0A=
		var linkHolder =3D document.getElementById( 'toctitle' );=0A=
		var existingLink =3D document.getElementById( 'togglelink' );=0A=
		if ( !linkHolder || existingLink ) {=0A=
			// Don't add the toggle link twice=0A=
			return;=0A=
		}=0A=
=0A=
		var outerSpan =3D document.createElement( 'span' );=0A=
		outerSpan.className =3D 'toctoggle';=0A=
=0A=
		var toggleLink =3D document.createElement( 'a' );=0A=
		toggleLink.id =3D 'togglelink';=0A=
		toggleLink.className =3D 'internal';=0A=
		toggleLink.href =3D '#';=0A=
		addClickHandler( toggleLink, function( evt ) { toggleToc(); return =
killEvt( evt ); } );=0A=
		=0A=
		toggleLink.appendChild( document.createTextNode( mediaWiki.msg( =
'hidetoc' ) ) );=0A=
=0A=
		outerSpan.appendChild( document.createTextNode( '[' ) );=0A=
		outerSpan.appendChild( toggleLink );=0A=
		outerSpan.appendChild( document.createTextNode( ']' ) );=0A=
=0A=
		linkHolder.appendChild( document.createTextNode( ' ' ) );=0A=
		linkHolder.appendChild( outerSpan );=0A=
=0A=
		var cookiePos =3D document.cookie.indexOf( "hidetoc=3D" );=0A=
		if ( cookiePos > -1 && document.cookie.charAt( cookiePos + 8 ) =3D=3D =
1 ) {=0A=
			toggleToc();=0A=
		}=0A=
	}=0A=
};=0A=
=0A=
window.changeText =3D function( el, newText ) {=0A=
	// Safari work around=0A=
	if ( el.innerText ) {=0A=
		el.innerText =3D newText;=0A=
	} else if ( el.firstChild && el.firstChild.nodeValue ) {=0A=
		el.firstChild.nodeValue =3D newText;=0A=
	}=0A=
};=0A=
=0A=
window.killEvt =3D function( evt ) {=0A=
	evt =3D evt || window.event || window.Event; // W3C, IE, Netscape=0A=
	if ( typeof ( evt.preventDefault ) !=3D 'undefined' ) {=0A=
		evt.preventDefault(); // Don't follow the link=0A=
		evt.stopPropagation();=0A=
	} else {=0A=
		evt.cancelBubble =3D true; // IE=0A=
	}=0A=
	return false; // Don't follow the link (IE)=0A=
};=0A=
=0A=
window.toggleToc =3D function() {=0A=
	var tocmain =3D document.getElementById( 'toc' );=0A=
	var toc =3D =
document.getElementById('toc').getElementsByTagName('ul')[0];=0A=
	var toggleLink =3D document.getElementById( 'togglelink' );=0A=
=0A=
	if ( toc && toggleLink && toc.style.display =3D=3D 'none' ) {=0A=
		changeText( toggleLink, mediaWiki.msg( 'hidetoc' ) );=0A=
		toc.style.display =3D 'block';=0A=
		document.cookie =3D "hidetoc=3D0";=0A=
		tocmain.className =3D 'toc';=0A=
	} else {=0A=
		changeText( toggleLink, mediaWiki.msg( 'showtoc' ) );=0A=
		toc.style.display =3D 'none';=0A=
		document.cookie =3D "hidetoc=3D1";=0A=
		tocmain.className =3D 'toc tochidden';=0A=
	}=0A=
	return false;=0A=
};=0A=
=0A=
window.mwEditButtons =3D [];=0A=
window.mwCustomEditButtons =3D []; // eg to add in MediaWiki:Common.js=0A=
=0A=
window.escapeQuotes =3D function( text ) {=0A=
	var re =3D new RegExp( "'", "g" );=0A=
	text =3D text.replace( re, "\\'" );=0A=
	re =3D new RegExp( "\\n", "g" );=0A=
	text =3D text.replace( re, "\\n" );=0A=
	return escapeQuotesHTML( text );=0A=
};=0A=
=0A=
window.escapeQuotesHTML =3D function( text ) {=0A=
	var re =3D new RegExp( '&', "g" );=0A=
	text =3D text.replace( re, "&amp;" );=0A=
	re =3D new RegExp( '"', "g" );=0A=
	text =3D text.replace( re, "&quot;" );=0A=
	re =3D new RegExp( '<', "g" );=0A=
	text =3D text.replace( re, "&lt;" );=0A=
	re =3D new RegExp( '>', "g" );=0A=
	text =3D text.replace( re, "&gt;" );=0A=
	return text;=0A=
};=0A=
=0A=
/**=0A=
 * Set the accesskey prefix based on browser detection.=0A=
 */=0A=
window.tooltipAccessKeyPrefix =3D 'alt-';=0A=
if ( is_opera ) {=0A=
	tooltipAccessKeyPrefix =3D 'shift-esc-';=0A=
} else if ( is_chrome ) {=0A=
	tooltipAccessKeyPrefix =3D is_chrome_mac ? 'ctrl-option-' : 'alt-';=0A=
} else if ( !is_safari_win && is_safari && webkit_version > 526 ) {=0A=
	tooltipAccessKeyPrefix =3D 'ctrl-alt-';=0A=
} else if ( !is_safari_win && ( is_safari=0A=
		|| clientPC.indexOf('mac') !=3D -1=0A=
		|| clientPC.indexOf('konqueror') !=3D -1 ) ) {=0A=
	tooltipAccessKeyPrefix =3D 'ctrl-';=0A=
} else if ( is_ff2 ) {=0A=
	tooltipAccessKeyPrefix =3D 'alt-shift-';=0A=
}=0A=
window.tooltipAccessKeyRegexp =3D =
/\[(ctrl-)?(alt-)?(shift-)?(esc-)?(.)\]$/;=0A=
=0A=
/**=0A=
 * Add the appropriate prefix to the accesskey shown in the tooltip.=0A=
 * If the nodeList parameter is given, only those nodes are updated;=0A=
 * otherwise, all the nodes that will probably have accesskeys by=0A=
 * default are updated.=0A=
 *=0A=
 * @param nodeList Array list of elements to update=0A=
 */=0A=
window.updateTooltipAccessKeys =3D function( nodeList ) {=0A=
	if ( !nodeList ) {=0A=
		// Rather than scan all links on the whole page, we can just scan these=0A=
		// containers which contain the relevant links. This is really just an=0A=
		// optimization technique.=0A=
		var linkContainers =3D [=0A=
			'column-one', // Monobook and Modern=0A=
			'mw-head', 'mw-panel', 'p-logo' // Vector=0A=
		];=0A=
		for ( var i in linkContainers ) {=0A=
			var linkContainer =3D document.getElementById( linkContainers[i] );=0A=
			if ( linkContainer ) {=0A=
				updateTooltipAccessKeys( linkContainer.getElementsByTagName( 'a' ) );=0A=
			}=0A=
		}=0A=
		// these are rare enough that no such optimization is needed=0A=
		updateTooltipAccessKeys( document.getElementsByTagName( 'input' ) );=0A=
		updateTooltipAccessKeys( document.getElementsByTagName( 'label' ) );=0A=
		return;=0A=
	}=0A=
=0A=
	for ( var i =3D 0; i < nodeList.length; i++ ) {=0A=
		var element =3D nodeList[i];=0A=
		var tip =3D element.getAttribute( 'title' );=0A=
		if ( tip && tooltipAccessKeyRegexp.exec( tip ) ) {=0A=
			tip =3D tip.replace(tooltipAccessKeyRegexp,=0A=
					  '[' + tooltipAccessKeyPrefix + "$5]");=0A=
			element.setAttribute( 'title', tip );=0A=
		}=0A=
	}=0A=
};=0A=
=0A=
/**=0A=
 * Add a link to one of the portlet menus on the page, including:=0A=
 *=0A=
 * p-cactions: Content actions (shown as tabs above the main content in =
Monobook)=0A=
 * p-personal: Personal tools (shown at the top right of the page in =
Monobook)=0A=
 * p-navigation: Navigation=0A=
 * p-tb: Toolbox=0A=
 *=0A=
 * This function exists for the convenience of custom JS authors.  All=0A=
 * but the first three parameters are optional, though providing at=0A=
 * least an id and a tooltip is recommended.=0A=
 *=0A=
 * By default the new link will be added to the end of the list.  To=0A=
 * add the link before a given existing item, pass the DOM node of=0A=
 * that item (easily obtained with document.getElementById()) as the=0A=
 * nextnode parameter; to add the link _after_ an existing item, pass=0A=
 * the node's nextSibling instead.=0A=
 *=0A=
 * @param portlet String id of the target portlet ("p-cactions", =
"p-personal", "p-navigation" or "p-tb")=0A=
 * @param href String link URL=0A=
 * @param text String link text (will be automatically lowercased by CSS =
for p-cactions in Monobook)=0A=
 * @param id String id of the new item, should be unique and preferably =
have the appropriate prefix ("ca-", "pt-", "n-" or "t-")=0A=
 * @param tooltip String text to show when hovering over the link, =
without accesskey suffix=0A=
 * @param accesskey String accesskey to activate this link (one =
character, try to avoid conflicts)=0A=
 * @param nextnode Node the DOM node before which the new item should be =
added, should be another item in the same list=0A=
 *=0A=
 * @return Node -- the DOM node of the new item (an LI element) or null=0A=
 */=0A=
window.addPortletLink =3D function( portlet, href, text, id, tooltip, =
accesskey, nextnode ) {=0A=
	var root =3D document.getElementById( portlet );=0A=
	if ( !root ) {=0A=
		return null;=0A=
	}=0A=
	var uls =3D root.getElementsByTagName( 'ul' );=0A=
	var node;=0A=
	if ( uls.length > 0 ) {=0A=
		node =3D uls[0];=0A=
	} else {=0A=
		node =3D document.createElement( 'ul' );=0A=
		var lastElementChild =3D null;=0A=
		for ( var i =3D 0; i < root.childNodes.length; ++i ) { /* get =
root.lastElementChild */=0A=
			if ( root.childNodes[i].nodeType =3D=3D 1 ) {=0A=
				lastElementChild =3D root.childNodes[i];=0A=
			}=0A=
		}=0A=
		if ( lastElementChild && lastElementChild.nodeName.match( /div/i ) ) {=0A=
			/* Insert into the menu divs */=0A=
			lastElementChild.appendChild( node );=0A=
		} else {=0A=
			root.appendChild( node );=0A=
		}=0A=
	}=0A=
	if ( !node ) {=0A=
		return null;=0A=
	}=0A=
=0A=
	// unhide portlet if it was hidden before=0A=
	root.className =3D root.className.replace( /(^| )emptyPortlet( |$)/, =
"$2" );=0A=
=0A=
	var link =3D document.createElement( 'a' );=0A=
	link.appendChild( document.createTextNode( text ) );=0A=
	link.href =3D href;=0A=
=0A=
	// Wrap in a span - make it work with vector tabs and has no effect on =
any other portlets=0A=
	var span =3D document.createElement( 'span' );=0A=
	span.appendChild( link );=0A=
=0A=
	var item =3D document.createElement( 'li' );=0A=
	item.appendChild( span );=0A=
	if ( id ) {=0A=
		item.id =3D id;=0A=
	}=0A=
=0A=
	if ( accesskey ) {=0A=
		link.setAttribute( 'accesskey', accesskey );=0A=
		tooltip +=3D ' [' + accesskey + ']';=0A=
	}=0A=
	if ( tooltip ) {=0A=
		link.setAttribute( 'title', tooltip );=0A=
	}=0A=
	if ( accesskey && tooltip ) {=0A=
		updateTooltipAccessKeys( new Array( link ) );=0A=
	}=0A=
=0A=
	if ( nextnode && nextnode.parentNode =3D=3D node ) {=0A=
		node.insertBefore( item, nextnode );=0A=
	} else {=0A=
		node.appendChild( item );  // IE compatibility (?)=0A=
	}=0A=
=0A=
	return item;=0A=
};=0A=
=0A=
window.getInnerText =3D function( el ) {=0A=
	if ( typeof el =3D=3D 'string' ) {=0A=
		return el;=0A=
	}=0A=
	if ( typeof el =3D=3D 'undefined' ) {=0A=
		return el;=0A=
	}=0A=
	// Custom sort value through 'data-sort-value' attribute=0A=
	// (no need to prepend hidden text to change sort value)=0A=
	if ( el.nodeType && el.getAttribute( 'data-sort-value' ) !=3D=3D null ) =
{=0A=
		// Make sure it's a valid DOM element (.nodeType) and that the =
attribute is set (!null)=0A=
		return el.getAttribute( 'data-sort-value' );=0A=
	}=0A=
	if ( el.textContent ) {=0A=
		return el.textContent; // not needed but it is faster=0A=
	}=0A=
	if ( el.innerText ) {=0A=
		return el.innerText; // IE doesn't have textContent=0A=
	}=0A=
	var str =3D '';=0A=
=0A=
	var cs =3D el.childNodes;=0A=
	var l =3D cs.length;=0A=
	for ( var i =3D 0; i < l; i++ ) {=0A=
		switch ( cs[i].nodeType ) {=0A=
			case 1: // ELEMENT_NODE=0A=
				str +=3D ts_getInnerText( cs[i] );=0A=
				break;=0A=
			case 3:	// TEXT_NODE=0A=
				str +=3D cs[i].nodeValue;=0A=
				break;=0A=
		}=0A=
	}=0A=
	return str;=0A=
};=0A=
=0A=
/* Dummy for deprecated function */=0A=
window.ta =3D [];=0A=
window.akeytt =3D function( doId ) {=0A=
};=0A=
=0A=
window.checkboxes =3D undefined;=0A=
window.lastCheckbox =3D undefined;=0A=
=0A=
window.setupCheckboxShiftClick =3D function() {=0A=
	checkboxes =3D [];=0A=
	lastCheckbox =3D null;=0A=
	var inputs =3D document.getElementsByTagName( 'input' );=0A=
	addCheckboxClickHandlers( inputs );=0A=
};=0A=
=0A=
window.addCheckboxClickHandlers =3D function( inputs, start ) {=0A=
	if ( !start ) {=0A=
		start =3D 0;=0A=
	}=0A=
=0A=
	var finish =3D start + 250;=0A=
	if ( finish > inputs.length ) {=0A=
		finish =3D inputs.length;=0A=
	}=0A=
=0A=
	for ( var i =3D start; i < finish; i++ ) {=0A=
		var cb =3D inputs[i];=0A=
		if ( !cb.type || cb.type.toLowerCase() !=3D 'checkbox' || ( ' ' + =
cb.className + ' ' ).indexOf( ' noshiftselect ' )  !=3D -1 ) {=0A=
			continue;=0A=
		}=0A=
		var end =3D checkboxes.length;=0A=
		checkboxes[end] =3D cb;=0A=
		cb.index =3D end;=0A=
		addClickHandler( cb, checkboxClickHandler );=0A=
	}=0A=
=0A=
	if ( finish < inputs.length ) {=0A=
		setTimeout( function() {=0A=
			addCheckboxClickHandlers( inputs, finish );=0A=
		}, 200 );=0A=
	}=0A=
};=0A=
=0A=
window.checkboxClickHandler =3D function( e ) {=0A=
	if ( typeof e =3D=3D 'undefined' ) {=0A=
		e =3D window.event;=0A=
	}=0A=
	if ( !e.shiftKey || lastCheckbox =3D=3D=3D null ) {=0A=
		lastCheckbox =3D this.index;=0A=
		return true;=0A=
	}=0A=
	var endState =3D this.checked;=0A=
	var start, finish;=0A=
	if ( this.index < lastCheckbox ) {=0A=
		start =3D this.index + 1;=0A=
		finish =3D lastCheckbox;=0A=
	} else {=0A=
		start =3D lastCheckbox;=0A=
		finish =3D this.index - 1;=0A=
	}=0A=
	for ( var i =3D start; i <=3D finish; ++i ) {=0A=
		checkboxes[i].checked =3D endState;=0A=
		if( i > start && typeof checkboxes[i].onchange =3D=3D 'function' ) {=0A=
			checkboxes[i].onchange(); // fire triggers=0A=
		}=0A=
	}=0A=
	lastCheckbox =3D this.index;=0A=
	return true;=0A=
};=0A=
=0A=
=0A=
/*=0A=
	Written by Jonathan Snook, http://www.snook.ca/jonathan=0A=
	Add-ons by Robert Nyman, http://www.robertnyman.com=0A=
	Author says "The credit comment is all it takes, no license. Go crazy =
with it!:-)"=0A=
	From =
http://www.robertnyman.com/2005/11/07/the-ultimate-getelementsbyclassname=
/=0A=
*/=0A=
window.getElementsByClassName =3D function( oElm, strTagName, =
oClassNames ) {=0A=
	var arrReturnElements =3D new Array();=0A=
	if ( typeof( oElm.getElementsByClassName ) =3D=3D 'function' ) {=0A=
		/* Use a native implementation where possible FF3, Saf3.2, Opera 9.5 */=0A=
		var arrNativeReturn =3D oElm.getElementsByClassName( oClassNames );=0A=
		if ( strTagName =3D=3D '*' ) {=0A=
			return arrNativeReturn;=0A=
		}=0A=
		for ( var h =3D 0; h < arrNativeReturn.length; h++ ) {=0A=
			if( arrNativeReturn[h].tagName.toLowerCase() =3D=3D =
strTagName.toLowerCase() ) {=0A=
				arrReturnElements[arrReturnElements.length] =3D arrNativeReturn[h];=0A=
			}=0A=
		}=0A=
		return arrReturnElements;=0A=
	}=0A=
	var arrElements =3D ( strTagName =3D=3D '*' && oElm.all ) ? oElm.all : =
oElm.getElementsByTagName( strTagName );=0A=
	var arrRegExpClassNames =3D new Array();=0A=
	if( typeof oClassNames =3D=3D 'object' ) {=0A=
		for( var i =3D 0; i < oClassNames.length; i++ ) {=0A=
			arrRegExpClassNames[arrRegExpClassNames.length] =3D=0A=
				new RegExp("(^|\\s)" + oClassNames[i].replace(/\-/g, "\\-") + =
"(\\s|$)");=0A=
		}=0A=
	} else {=0A=
		arrRegExpClassNames[arrRegExpClassNames.length] =3D=0A=
			new RegExp("(^|\\s)" + oClassNames.replace(/\-/g, "\\-") + "(\\s|$)");=0A=
	}=0A=
	var oElement;=0A=
	var bMatchesAll;=0A=
	for( var j =3D 0; j < arrElements.length; j++ ) {=0A=
		oElement =3D arrElements[j];=0A=
		bMatchesAll =3D true;=0A=
		for( var k =3D 0; k < arrRegExpClassNames.length; k++ ) {=0A=
			if( !arrRegExpClassNames[k].test( oElement.className ) ) {=0A=
				bMatchesAll =3D false;=0A=
				break;=0A=
			}=0A=
		}=0A=
		if( bMatchesAll ) {=0A=
			arrReturnElements[arrReturnElements.length] =3D oElement;=0A=
		}=0A=
	}=0A=
	return ( arrReturnElements );=0A=
};=0A=
=0A=
window.redirectToFragment =3D function( fragment ) {=0A=
	var match =3D navigator.userAgent.match(/AppleWebKit\/(\d+)/);=0A=
	if ( match ) {=0A=
		var webKitVersion =3D parseInt( match[1] );=0A=
		if ( webKitVersion < 420 ) {=0A=
			// Released Safari w/ WebKit 418.9.1 messes up horribly=0A=
			// Nightlies of 420+ are ok=0A=
			return;=0A=
		}=0A=
	}=0A=
	if ( window.location.hash =3D=3D '' ) {=0A=
		window.location.hash =3D fragment;=0A=
=0A=
		// Mozilla needs to wait until after load, otherwise the window doesn't=0A=
		// scroll.  See =
<https://bugzilla.mozilla.org/show_bug.cgi?id=3D516293>.=0A=
		// There's no obvious way to detect this programmatically, so we use=0A=
		// version-testing.  If Firefox fixes the bug, they'll jump twice, but=0A=
		// better twice than not at all, so make the fix hit future versions as=0A=
		// well.=0A=
		if ( is_gecko ) {=0A=
			addOnloadHook(function() {=0A=
				if ( window.location.hash =3D=3D fragment ) {=0A=
					window.location.hash =3D fragment;=0A=
				}=0A=
			});=0A=
		}=0A=
	}=0A=
};=0A=
=0A=
/*=0A=
 * Table sorting script based on one (c) 1997-2006 Stuart Langridge and =
Joost=0A=
 * de Valk:=0A=
 * http://www.joostdevalk.nl/code/sortable-table/=0A=
 * http://www.kryogenix.org/code/browser/sorttable/=0A=
 *=0A=
 * @todo don't break on colspans/rowspans (bug 8028)=0A=
 * @todo language-specific digit grouping/decimals (bug 8063)=0A=
 * @todo support all accepted date formats (bug 8226)=0A=
 */=0A=
=0A=
window.ts_image_path =3D stylepath + '/common/images/';=0A=
window.ts_image_up =3D 'sort_up.gif';=0A=
window.ts_image_down =3D 'sort_down.gif';=0A=
window.ts_image_none =3D 'sort_none.gif';=0A=
window.ts_europeandate =3D wgContentLanguage !=3D 'en'; // The =
non-American-inclined can change to "true"=0A=
window.ts_alternate_row_colors =3D false;=0A=
window.ts_number_transform_table =3D null;=0A=
window.ts_number_regex =3D null;=0A=
=0A=
window.sortables_init =3D function() {=0A=
	var idnum =3D 0;=0A=
	// Find all tables with class sortable and make them sortable=0A=
	var tables =3D getElementsByClassName( document, 'table', 'sortable' );=0A=
	for ( var ti =3D 0; ti < tables.length ; ti++ ) {=0A=
		if ( !tables[ti].id ) {=0A=
			tables[ti].setAttribute( 'id', 'sortable_table_id_' + idnum );=0A=
			++idnum;=0A=
		}=0A=
		ts_makeSortable( tables[ti] );=0A=
	}=0A=
};=0A=
=0A=
window.ts_makeSortable =3D function( table ) {=0A=
	var firstRow;=0A=
	if ( table.rows && table.rows.length > 0 ) {=0A=
		if ( table.tHead && table.tHead.rows.length > 0 ) {=0A=
			firstRow =3D table.tHead.rows[table.tHead.rows.length-1];=0A=
		} else {=0A=
			firstRow =3D table.rows[0];=0A=
		}=0A=
	}=0A=
	if ( !firstRow ) {=0A=
		return;=0A=
	}=0A=
=0A=
	// We have a first row: assume it's the header, and make its contents =
clickable links=0A=
	for ( var i =3D 0; i < firstRow.cells.length; i++ ) {=0A=
		var cell =3D firstRow.cells[i];=0A=
		if ( (' ' + cell.className + ' ').indexOf(' unsortable ') =3D=3D -1 ) {=0A=
			$(cell).append ( '<a href=3D"#" class=3D"sortheader" '=0A=
				+ 'onclick=3D"ts_resortTable(this);return false;">'=0A=
				+ '<span class=3D"sortarrow">'=0A=
				+ '<img src=3D"'=0A=
				+ ts_image_path=0A=
				+ ts_image_none=0A=
				+ '" alt=3D"&darr;"/></span></a>');=0A=
		}=0A=
	}=0A=
	if ( ts_alternate_row_colors ) {=0A=
		ts_alternate( table );=0A=
	}=0A=
};=0A=
=0A=
window.ts_getInnerText =3D function( el ) {=0A=
	return getInnerText( el );=0A=
};=0A=
=0A=
window.ts_resortTable =3D function( lnk ) {=0A=
	// get the span=0A=
	var span =3D lnk.getElementsByTagName('span')[0];=0A=
=0A=
	var td =3D lnk.parentNode;=0A=
	var tr =3D td.parentNode;=0A=
	var column =3D td.cellIndex;=0A=
=0A=
	var table =3D tr.parentNode;=0A=
	while ( table && !( table.tagName && table.tagName.toLowerCase() =3D=3D =
'table' ) ) {=0A=
		table =3D table.parentNode;=0A=
	}=0A=
	if ( !table ) {=0A=
		return;=0A=
	}=0A=
=0A=
	if ( table.rows.length <=3D 1 ) {=0A=
		return;=0A=
	}=0A=
=0A=
	// Generate the number transform table if it's not done already=0A=
	if ( ts_number_transform_table =3D=3D=3D null ) {=0A=
		ts_initTransformTable();=0A=
	}=0A=
=0A=
	// Work out a type for the column=0A=
	// Skip the first row if that's where the headings are=0A=
	var rowStart =3D ( table.tHead && table.tHead.rows.length > 0 ? 0 : 1 );=0A=
	var bodyRows =3D 0;=0A=
	if (rowStart =3D=3D 0 && table.tBodies) {=0A=
		for (var i=3D0; i < table.tBodies.length; i++ ) {=0A=
			bodyRows +=3D table.tBodies[i].rows.length;=0A=
		}=0A=
		if (bodyRows < table.rows.length)=0A=
			rowStart =3D 1;=0A=
	}=0A=
	=0A=
	var itm =3D '';=0A=
	for ( var i =3D rowStart; i < table.rows.length; i++ ) {=0A=
		if ( table.rows[i].cells.length > column ) {=0A=
			itm =3D ts_getInnerText(table.rows[i].cells[column]);=0A=
			itm =3D itm.replace(/^[\s\xa0]+/, '').replace(/[\s\xa0]+$/, '');=0A=
			if ( itm !=3D '' ) {=0A=
				break;=0A=
			}=0A=
		}=0A=
	}=0A=
=0A=
	// TODO: bug 8226, localised date formats=0A=
	var sortfn =3D ts_sort_generic;=0A=
	var preprocessor =3D ts_toLowerCase;=0A=
	if ( /^\d\d[\/. -][a-zA-Z]{3}[\/. -]\d\d\d\d$/.test( itm ) ) {=0A=
		preprocessor =3D ts_dateToSortKey;=0A=
	} else if ( /^\d\d[\/.-]\d\d[\/.-]\d\d\d\d$/.test( itm ) ) {=0A=
		preprocessor =3D ts_dateToSortKey;=0A=
	} else if ( /^\d\d[\/.-]\d\d[\/.-]\d\d$/.test( itm ) ) {=0A=
		preprocessor =3D ts_dateToSortKey;=0A=
		// (minus sign)([pound dollar euro yen currency]|cents)=0A=
	} else if ( /(^([-\u2212] =
*)?[\u00a3$\u20ac\u00a4\u00a5]|\u00a2$)/.test( itm ) ) {=0A=
		preprocessor =3D ts_currencyToSortKey;=0A=
	} else if ( ts_number_regex.test( itm ) ) {=0A=
		preprocessor =3D ts_parseFloat;=0A=
	}=0A=
=0A=
	var reverse =3D ( span.getAttribute( 'sortdir' ) =3D=3D 'down' );=0A=
=0A=
	var newRows =3D new Array();=0A=
	var staticRows =3D new Array();=0A=
	for ( var j =3D rowStart; j < table.rows.length; j++ ) {=0A=
		var row =3D table.rows[j];=0A=
		if( (' ' + row.className + ' ').indexOf(' unsortable ') < 0 ) {=0A=
			var keyText =3D ts_getInnerText( row.cells[column] );=0A=
			if( keyText =3D=3D=3D undefined ) {=0A=
				keyText =3D ''; =0A=
			}=0A=
			var oldIndex =3D ( reverse ? -j : j );=0A=
			var preprocessed =3D preprocessor( keyText.replace(/^[\s\xa0]+/, =
'').replace(/[\s\xa0]+$/, '') );=0A=
=0A=
			newRows[newRows.length] =3D new Array( row, preprocessed, oldIndex );=0A=
		} else {=0A=
			staticRows[staticRows.length] =3D new Array( row, false, j-rowStart );=0A=
		}=0A=
	}=0A=
=0A=
	newRows.sort( sortfn );=0A=
=0A=
	var arrowHTML;=0A=
	if ( reverse ) {=0A=
		arrowHTML =3D '<img src=3D"' + ts_image_path + ts_image_down + '" =
alt=3D"&darr;"/>';=0A=
		newRows.reverse();=0A=
		span.setAttribute( 'sortdir', 'up' );=0A=
	} else {=0A=
		arrowHTML =3D '<img src=3D"' + ts_image_path + ts_image_up + '" =
alt=3D"&uarr;"/>';=0A=
		span.setAttribute( 'sortdir', 'down' );=0A=
	}=0A=
=0A=
	for ( var i =3D 0; i < staticRows.length; i++ ) {=0A=
		var row =3D staticRows[i];=0A=
		newRows.splice( row[2], 0, row );=0A=
	}=0A=
=0A=
	// We appendChild rows that already exist to the tbody, so it moves =
them rather than creating new ones=0A=
	// don't do sortbottom rows=0A=
	for ( var i =3D 0; i < newRows.length; i++ ) {=0A=
		if ( ( ' ' + newRows[i][0].className + ' ').indexOf(' sortbottom ') =
=3D=3D -1 ) {=0A=
			table.tBodies[0].appendChild( newRows[i][0] );=0A=
		}=0A=
	}=0A=
	// do sortbottom rows only=0A=
	for ( var i =3D 0; i < newRows.length; i++ ) {=0A=
		if ( ( ' ' + newRows[i][0].className + ' ').indexOf(' sortbottom ') =
!=3D -1 ) {=0A=
			table.tBodies[0].appendChild( newRows[i][0] );=0A=
		}=0A=
	}=0A=
=0A=
	// Delete any other arrows there may be showing=0A=
	var spans =3D getElementsByClassName( tr, 'span', 'sortarrow' );=0A=
	for ( var i =3D 0; i < spans.length; i++ ) {=0A=
		spans[i].innerHTML =3D '<img src=3D"' + ts_image_path + ts_image_none =
+ '" alt=3D"&darr;"/>';=0A=
	}=0A=
	span.innerHTML =3D arrowHTML;=0A=
=0A=
	if ( ts_alternate_row_colors ) {=0A=
		ts_alternate( table );=0A=
	}=0A=
};=0A=
=0A=
window.ts_initTransformTable =3D function() {=0A=
	if ( typeof wgSeparatorTransformTable =3D=3D 'undefined'=0A=
			|| ( wgSeparatorTransformTable[0] =3D=3D '' && =
wgDigitTransformTable[2] =3D=3D '' ) )=0A=
	{=0A=
		var digitClass =3D "[0-9,.]";=0A=
		ts_number_transform_table =3D false;=0A=
	} else {=0A=
		ts_number_transform_table =3D {};=0A=
		// Unpack the transform table=0A=
		// Separators=0A=
		var ascii =3D wgSeparatorTransformTable[0].split("\t");=0A=
		var localised =3D wgSeparatorTransformTable[1].split("\t");=0A=
		for ( var i =3D 0; i < ascii.length; i++ ) {=0A=
			ts_number_transform_table[localised[i]] =3D ascii[i];=0A=
		}=0A=
		// Digits=0A=
		ascii =3D wgDigitTransformTable[0].split("\t");=0A=
		localised =3D wgDigitTransformTable[1].split("\t");=0A=
		for ( var i =3D 0; i < ascii.length; i++ ) {=0A=
			ts_number_transform_table[localised[i]] =3D ascii[i];=0A=
		}=0A=
=0A=
		// Construct regex for number identification=0A=
		var digits =3D ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ',', =
'\\.'];=0A=
		var maxDigitLength =3D 1;=0A=
		for ( var digit in ts_number_transform_table ) {=0A=
			// Escape regex metacharacters=0A=
			digits.push(=0A=
				digit.replace( /[\\\\$\*\+\?\.\(\)\|\{\}\[\]\-]/,=0A=
					function( s ) { return '\\' + s; } )=0A=
			);=0A=
			if ( digit.length > maxDigitLength ) {=0A=
				maxDigitLength =3D digit.length;=0A=
			}=0A=
		}=0A=
		if ( maxDigitLength > 1 ) {=0A=
			var digitClass =3D '[' + digits.join( '', digits ) + ']';=0A=
		} else {=0A=
			var digitClass =3D '(' + digits.join( '|', digits ) + ')';=0A=
		}=0A=
	}=0A=
=0A=
	// We allow a trailing percent sign, which we just strip.  This works =
fine=0A=
	// if percents and regular numbers aren't being mixed.=0A=
	ts_number_regex =3D new RegExp(=0A=
		"^(" +=0A=
			"[-+\u2212]?[0-9][0-9,]*(\\.[0-9,]*)?(E[-+\u2212]?[0-9][0-9,]*)?" + =
// Fortran-style scientific=0A=
			"|" +=0A=
			"[-+\u2212]?" + digitClass + "+%?" + // Generic localised=0A=
		")$", "i"=0A=
	);=0A=
};=0A=
=0A=
window.ts_toLowerCase =3D function( s ) {=0A=
	return s.toLowerCase();=0A=
};=0A=
=0A=
window.ts_dateToSortKey =3D function( date ) {=0A=
	// y2k notes: two digit years less than 50 are treated as 20XX, greater =
than 50 are treated as 19XX=0A=
	if ( date.length =3D=3D 11 ) {=0A=
		switch ( date.substr( 3, 3 ).toLowerCase() ) {=0A=
			case 'jan':=0A=
				var month =3D '01';=0A=
				break;=0A=
			case 'feb':=0A=
				var month =3D '02';=0A=
				break;=0A=
			case 'mar':=0A=
				var month =3D '03';=0A=
				break;=0A=
			case 'apr':=0A=
				var month =3D '04';=0A=
				break;=0A=
			case 'may':=0A=
				var month =3D '05';=0A=
				break;=0A=
			case 'jun':=0A=
				var month =3D '06';=0A=
				break;=0A=
			case 'jul':=0A=
				var month =3D '07';=0A=
				break;=0A=
			case 'aug':=0A=
				var month =3D '08';=0A=
				break;=0A=
			case 'sep':=0A=
				var month =3D '09';=0A=
				break;=0A=
			case 'oct':=0A=
				var month =3D '10';=0A=
				break;=0A=
			case 'nov':=0A=
				var month =3D '11';=0A=
				break;=0A=
			case 'dec':=0A=
				var month =3D '12';=0A=
				break;=0A=
			// default: var month =3D '00';=0A=
		}=0A=
		return date.substr( 7, 4 ) + month + date.substr( 0, 2 );=0A=
	} else if ( date.length =3D=3D 10 ) {=0A=
		if ( ts_europeandate =3D=3D false ) {=0A=
			return date.substr( 6, 4 ) + date.substr( 0, 2 ) + date.substr( 3, 2 =
);=0A=
		} else {=0A=
			return date.substr( 6, 4 ) + date.substr( 3, 2 ) + date.substr( 0, 2 =
);=0A=
		}=0A=
	} else if ( date.length =3D=3D 8 ) {=0A=
		var yr =3D date.substr( 6, 2 );=0A=
		if ( parseInt( yr ) < 50 ) {=0A=
			yr =3D '20' + yr;=0A=
		} else {=0A=
			yr =3D '19' + yr;=0A=
		}=0A=
		if ( ts_europeandate =3D=3D true ) {=0A=
			return yr + date.substr( 3, 2 ) + date.substr( 0, 2 );=0A=
		} else {=0A=
			return yr + date.substr( 0, 2 ) + date.substr( 3, 2 );=0A=
		}=0A=
	}=0A=
	return '00000000';=0A=
};=0A=
=0A=
window.ts_parseFloat =3D function( s ) {=0A=
	if ( !s ) {=0A=
		return 0;=0A=
	}=0A=
	if ( ts_number_transform_table !=3D false ) {=0A=
		var newNum =3D '', c;=0A=
=0A=
		for ( var p =3D 0; p < s.length; p++ ) {=0A=
			c =3D s.charAt( p );=0A=
			if ( c in ts_number_transform_table ) {=0A=
				newNum +=3D ts_number_transform_table[c];=0A=
			} else {=0A=
				newNum +=3D c;=0A=
			}=0A=
		}=0A=
		s =3D newNum;=0A=
	}=0A=
	var num =3D parseFloat( s.replace(/[, ]/g, '').replace("\u2212", '-') );=0A=
	return ( isNaN( num ) ? -Infinity : num );=0A=
};=0A=
=0A=
window.ts_currencyToSortKey =3D function( s ) {=0A=
	return ts_parseFloat(s.replace(/[^-\u22120-9.,]/g,''));=0A=
};=0A=
=0A=
window.ts_sort_generic =3D function( a, b ) {=0A=
	return a[1] < b[1] ? -1 : a[1] > b[1] ? 1 : a[2] - b[2];=0A=
};=0A=
=0A=
window.ts_alternate =3D function( table ) {=0A=
	// Take object table and get all it's tbodies.=0A=
	var tableBodies =3D table.getElementsByTagName( 'tbody' );=0A=
	// Loop through these tbodies=0A=
	for ( var i =3D 0; i < tableBodies.length; i++ ) {=0A=
		// Take the tbody, and get all it's rows=0A=
		var tableRows =3D tableBodies[i].getElementsByTagName( 'tr' );=0A=
		// Loop through these rows=0A=
		// Start at 1 because we want to leave the heading row untouched=0A=
		for ( var j =3D 0; j < tableRows.length; j++ ) {=0A=
			// Check if j is even, and apply classes for both possible results=0A=
			var oldClasses =3D tableRows[j].className.split(' ');=0A=
			var newClassName =3D '';=0A=
			for ( var k =3D 0; k < oldClasses.length; k++ ) {=0A=
				if ( oldClasses[k] !=3D '' && oldClasses[k] !=3D 'even' && =
oldClasses[k] !=3D 'odd' ) {=0A=
					newClassName +=3D oldClasses[k] + ' ';=0A=
				}=0A=
			}=0A=
			tableRows[j].className =3D newClassName + ( j % 2 =3D=3D 0 ? 'even' : =
'odd' );=0A=
		}=0A=
	}=0A=
};=0A=
=0A=
/*=0A=
 * End of table sorting code=0A=
 */=0A=
=0A=
=0A=
/**=0A=
 * Add a cute little box at the top of the screen to inform the user of=0A=
 * something, replacing any preexisting message.=0A=
 *=0A=
 * @param message String -or- Dom Object  HTML to be put inside the =
right div=0A=
 * @param className String   Used in adding a class; should be different =
for each=0A=
 *   call to allow CSS/JS to hide different boxes.  null =3D no class =
used.=0A=
 * @return Boolean       True on success, false on failure=0A=
 */=0A=
window.jsMsg =3D function( message, className ) {=0A=
	if ( !document.getElementById ) {=0A=
		return false;=0A=
	}=0A=
	// We special-case skin structures provided by the software.  Skins that=0A=
	// choose to abandon or significantly modify our formatting can just =
define=0A=
	// an mw-js-message div to start with.=0A=
	var messageDiv =3D document.getElementById( 'mw-js-message' );=0A=
	if ( !messageDiv ) {=0A=
		messageDiv =3D document.createElement( 'div' );=0A=
		if ( document.getElementById( 'column-content' )=0A=
		&& document.getElementById( 'content' ) ) {=0A=
			// MonoBook, presumably=0A=
			document.getElementById( 'content' ).insertBefore(=0A=
				messageDiv,=0A=
				document.getElementById( 'content' ).firstChild=0A=
			);=0A=
		} else if ( document.getElementById( 'content' )=0A=
		&& document.getElementById( 'article' ) ) {=0A=
			// Non-Monobook but still recognizable (old-style)=0A=
			document.getElementById( 'article').insertBefore(=0A=
				messageDiv,=0A=
				document.getElementById( 'article' ).firstChild=0A=
			);=0A=
		} else {=0A=
			return false;=0A=
		}=0A=
	}=0A=
=0A=
	messageDiv.setAttribute( 'id', 'mw-js-message' );=0A=
	messageDiv.style.display =3D 'block';=0A=
	if( className ) {=0A=
		messageDiv.setAttribute( 'class', 'mw-js-message-' + className );=0A=
	}=0A=
=0A=
	if ( typeof message =3D=3D=3D 'object' ) {=0A=
		while ( messageDiv.hasChildNodes() ) { // Remove old content=0A=
			messageDiv.removeChild( messageDiv.firstChild );=0A=
		}=0A=
		messageDiv.appendChild( message ); // Append new content=0A=
	} else {=0A=
		messageDiv.innerHTML =3D message;=0A=
	}=0A=
	return true;=0A=
};=0A=
=0A=
/**=0A=
 * Inject a cute little progress spinner after the specified element=0A=
 *=0A=
 * @param element Element to inject after=0A=
 * @param id Identifier string (for use with removeSpinner(), below)=0A=
 */=0A=
window.injectSpinner =3D function( element, id ) {=0A=
	var spinner =3D document.createElement( 'img' );=0A=
	spinner.id =3D 'mw-spinner-' + id;=0A=
	spinner.src =3D stylepath + '/common/images/spinner.gif';=0A=
	spinner.alt =3D spinner.title =3D '...';=0A=
	if( element.nextSibling ) {=0A=
		element.parentNode.insertBefore( spinner, element.nextSibling );=0A=
	} else {=0A=
		element.parentNode.appendChild( spinner );=0A=
	}=0A=
};=0A=
=0A=
/**=0A=
 * Remove a progress spinner added with injectSpinner()=0A=
 *=0A=
 * @param id Identifier string=0A=
 */=0A=
window.removeSpinner =3D function( id ) {=0A=
	var spinner =3D document.getElementById( 'mw-spinner-' + id );=0A=
	if( spinner ) {=0A=
		spinner.parentNode.removeChild( spinner );=0A=
	}=0A=
};=0A=
=0A=
window.runOnloadHook =3D function() {=0A=
	// don't run anything below this for non-dom browsers=0A=
	if ( doneOnloadHook || !( document.getElementById && =
document.getElementsByTagName ) ) {=0A=
		return;=0A=
	}=0A=
=0A=
	// set this before running any hooks, since any errors below=0A=
	// might cause the function to terminate prematurely=0A=
	doneOnloadHook =3D true;=0A=
=0A=
	updateTooltipAccessKeys( null );=0A=
	setupCheckboxShiftClick();=0A=
=0A=
	jQuery( document ).ready( sortables_init );=0A=
=0A=
	// Run any added-on functions=0A=
	for ( var i =3D 0; i < onloadFuncts.length; i++ ) {=0A=
		onloadFuncts[i]();=0A=
	}=0A=
};=0A=
=0A=
/**=0A=
 * Add an event handler to an element=0A=
 *=0A=
 * @param element Element to add handler to=0A=
 * @param attach String Event to attach to=0A=
 * @param handler callable Event handler callback=0A=
 */=0A=
window.addHandler =3D function( element, attach, handler ) {=0A=
	if( element.addEventListener ) {=0A=
		element.addEventListener( attach, handler, false );=0A=
	} else if( element.attachEvent ) {=0A=
		element.attachEvent( 'on' + attach, handler );=0A=
	}=0A=
};=0A=
=0A=
window.hookEvent =3D function( hookName, hookFunct ) {=0A=
	addHandler( window, hookName, hookFunct );=0A=
};=0A=
=0A=
/**=0A=
 * Add a click event handler to an element=0A=
 *=0A=
 * @param element Element to add handler to=0A=
 * @param handler callable Event handler callback=0A=
 */=0A=
window.addClickHandler =3D function( element, handler ) {=0A=
	addHandler( element, 'click', handler );=0A=
};=0A=
=0A=
/**=0A=
 * Removes an event handler from an element=0A=
 *=0A=
 * @param element Element to remove handler from=0A=
 * @param remove String Event to remove=0A=
 * @param handler callable Event handler callback to remove=0A=
 */=0A=
window.removeHandler =3D function( element, remove, handler ) {=0A=
	if( window.removeEventListener ) {=0A=
		element.removeEventListener( remove, handler, false );=0A=
	} else if( window.detachEvent ) {=0A=
		element.detachEvent( 'on' + remove, handler );=0A=
	}=0A=
};=0A=
// note: all skins should call runOnloadHook() at the end of html output,=0A=
//      so the below should be redundant. It's there just in case.=0A=
hookEvent( 'load', runOnloadHook );=0A=
=0A=
if ( ie6_bugs ) {=0A=
	importScriptURI( stylepath + '/common/IEFixes.js' );=0A=
}=0A=
=0A=
showTocToggle();=0A=

------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: application/octet-stream
Content-Transfer-Encoding: quoted-printable
Content-Location: http://www.google-analytics.com/urchin.js

//-- Google Analytics Urchin Module=0A=
//-- Copyright 2007 Google, All Rights Reserved.=0A=
=0A=
//-- Urchin On Demand Settings ONLY=0A=
var _uacct=3D"";			// set up the Urchin Account=0A=
var _userv=3D1;			// service mode (0=3Dlocal,1=3Dremote,2=3Dboth)=0A=
=0A=
//-- UTM User Settings=0A=
var _ufsc=3D1;			// set client info flag (1=3Don|0=3Doff)=0A=
var _udn=3D"auto";		// (auto|none|domain) set the domain name for cookies=0A=
var _uhash=3D"on";		// (on|off) unique domain hash for cookies=0A=
var _utimeout=3D"1800";   	// set the inactive session timeout in seconds=0A=
var _ugifpath=3D"/__utm.gif";	// set the web path to the __utm.gif file=0A=
var _utsp=3D"|";			// transaction field separator=0A=
var _uflash=3D1;			// set flash version detect option (1=3Don|0=3Doff)=0A=
var _utitle=3D1;			// set the document title detect option =
(1=3Don|0=3Doff)=0A=
var _ulink=3D0;			// enable linker functionality (1=3Don|0=3Doff)=0A=
var _uanchor=3D0;			// enable use of anchors for campaign =
(1=3Don|0=3Doff)=0A=
var _utcp=3D"/";			// the cookie path for tracking=0A=
var _usample=3D100;		// The sampling % of visitors to track (1-100).=0A=
=0A=
//-- UTM Campaign Tracking Settings=0A=
var _uctm=3D1;			// set campaign tracking module (1=3Don|0=3Doff)=0A=
var _ucto=3D"15768000";		// set timeout in seconds (6 month default)=0A=
var _uccn=3D"utm_campaign";	// name=0A=
var _ucmd=3D"utm_medium";		// medium (cpc|cpm|link|email|organic)=0A=
var _ucsr=3D"utm_source";		// source=0A=
var _uctr=3D"utm_term";		// term/keyword=0A=
var _ucct=3D"utm_content";	// content=0A=
var _ucid=3D"utm_id";		// id number=0A=
var _ucno=3D"utm_nooverride";	// don't override=0A=
=0A=
//-- Auto/Organic Sources and Keywords=0A=
var _uOsr=3Dnew Array();=0A=
var _uOkw=3Dnew Array();=0A=
_uOsr[0]=3D"google";	_uOkw[0]=3D"q";=0A=
_uOsr[1]=3D"yahoo";	_uOkw[1]=3D"p";=0A=
_uOsr[2]=3D"msn";		_uOkw[2]=3D"q";=0A=
_uOsr[3]=3D"aol";		_uOkw[3]=3D"query";=0A=
_uOsr[4]=3D"aol";		_uOkw[4]=3D"encquery";=0A=
_uOsr[5]=3D"lycos";	_uOkw[5]=3D"query";=0A=
_uOsr[6]=3D"ask";		_uOkw[6]=3D"q";=0A=
_uOsr[7]=3D"altavista";	_uOkw[7]=3D"q";=0A=
_uOsr[8]=3D"netscape";	_uOkw[8]=3D"query";=0A=
_uOsr[9]=3D"cnn";	_uOkw[9]=3D"query";=0A=
_uOsr[10]=3D"looksmart";	_uOkw[10]=3D"qt";=0A=
_uOsr[11]=3D"about";	_uOkw[11]=3D"terms";=0A=
_uOsr[12]=3D"mamma";	_uOkw[12]=3D"query";=0A=
_uOsr[13]=3D"alltheweb";	_uOkw[13]=3D"q";=0A=
_uOsr[14]=3D"gigablast";	_uOkw[14]=3D"q";=0A=
_uOsr[15]=3D"voila";	_uOkw[15]=3D"rdata";=0A=
_uOsr[16]=3D"virgilio";	_uOkw[16]=3D"qs";=0A=
_uOsr[17]=3D"live";	_uOkw[17]=3D"q";=0A=
_uOsr[18]=3D"baidu";	_uOkw[18]=3D"wd";=0A=
_uOsr[19]=3D"alice";	_uOkw[19]=3D"qs";=0A=
_uOsr[20]=3D"yandex";	_uOkw[20]=3D"text";=0A=
_uOsr[21]=3D"najdi";	_uOkw[21]=3D"q";=0A=
_uOsr[22]=3D"aol";	_uOkw[22]=3D"q";=0A=
_uOsr[23]=3D"club-internet"; _uOkw[23]=3D"query";=0A=
_uOsr[24]=3D"mama";	_uOkw[24]=3D"query";=0A=
_uOsr[25]=3D"seznam";	_uOkw[25]=3D"q";=0A=
_uOsr[26]=3D"search";	_uOkw[26]=3D"q";=0A=
_uOsr[27]=3D"wp";	_uOkw[27]=3D"szukaj";=0A=
_uOsr[28]=3D"onet";	_uOkw[28]=3D"qt";=0A=
_uOsr[29]=3D"netsprint";	_uOkw[29]=3D"q";=0A=
_uOsr[30]=3D"google.interia";	_uOkw[30]=3D"q";=0A=
_uOsr[31]=3D"szukacz";	_uOkw[31]=3D"q";=0A=
_uOsr[32]=3D"yam";	_uOkw[32]=3D"k";=0A=
_uOsr[33]=3D"pchome";	_uOkw[33]=3D"q";=0A=
_uOsr[34]=3D"kvasir";	_uOkw[34]=3D"searchExpr";=0A=
_uOsr[35]=3D"sesam";	_uOkw[35]=3D"q";=0A=
_uOsr[36]=3D"ozu"; _uOkw[36]=3D"q";=0A=
_uOsr[37]=3D"terra"; _uOkw[37]=3D"query";=0A=
_uOsr[38]=3D"nostrum"; _uOkw[38]=3D"query";=0A=
_uOsr[39]=3D"mynet"; _uOkw[39]=3D"q";=0A=
_uOsr[40]=3D"ekolay"; _uOkw[40]=3D"q";=0A=
_uOsr[41]=3D"search.ilse"; _uOkw[41]=3D"search_for";=0A=
_uOsr[42]=3D"bing"; _uOkw[42]=3D"q";=0A=
=0A=
//-- Auto/Organic Keywords to Ignore=0A=
var _uOno=3Dnew Array();=0A=
//_uOno[0]=3D"urchin";=0A=
//_uOno[1]=3D"urchin.com";=0A=
//_uOno[2]=3D"www.urchin.com";=0A=
=0A=
//-- Referral domains to Ignore=0A=
var _uRno=3Dnew Array();=0A=
//_uRno[0]=3D".urchin.com";=0A=
=0A=
//-- **** Don't modify below this point ***=0A=
var =
_uff,_udh,_udt,_ubl=3D0,_udo=3D"",_uu,_ufns=3D0,_uns=3D0,_ur=3D"-",_ufno=3D=
0,_ust=3D0,_ubd=3Ddocument,_udl=3D_ubd.location,_udlh=3D"",_uwv=3D"1.4";=0A=
var _ugifpath2=3D"http://www.google-analytics.com/__utm.gif";=0A=
if (_udl.hash) _udlh=3D_udl.href.substring(_udl.href.indexOf('#'));=0A=
if (_udl.protocol=3D=3D"https:") =
_ugifpath2=3D"https://ssl.google-analytics.com/__utm.gif";=0A=
if (!_utcp || _utcp=3D=3D"") _utcp=3D"/";=0A=
function urchinTracker(page) {=0A=
 if (_udl.protocol=3D=3D"file:") return;=0A=
 if (_uff && (!page || page=3D=3D"")) return;=0A=
 var a,b,c,xx,v,z,k,x=3D"",s=3D"",f=3D0,nv=3D0;=0A=
 var nx=3D" expires=3D"+_uNx()+";";=0A=
 var dc=3D_ubd.cookie;=0A=
 _udh=3D_uDomain();=0A=
 if (!_uVG()) return;=0A=
 _uu=3DMath.round(Math.random()*2147483647);=0A=
 _udt=3Dnew Date();=0A=
 _ust=3DMath.round(_udt.getTime()/1000);=0A=
 a=3Ddc.indexOf("__utma=3D"+_udh+".");=0A=
 b=3Ddc.indexOf("__utmb=3D"+_udh);=0A=
 c=3Ddc.indexOf("__utmc=3D"+_udh);=0A=
 if (_udn && _udn!=3D"") { _udo=3D" domain=3D"+_udn+";"; }=0A=
 if (_utimeout && _utimeout!=3D"") {=0A=
  x=3Dnew Date(_udt.getTime()+(_utimeout*1000));=0A=
  x=3D" expires=3D"+x.toGMTString()+";";=0A=
 }=0A=
 if (_ulink) {=0A=
  if (_uanchor && _udlh && _udlh!=3D"") s=3D_udlh+"&";=0A=
  s+=3D_udl.search;=0A=
  if(s && s!=3D"" && s.indexOf("__utma=3D")>=3D0) {=0A=
   if (!(_uIN(a=3D_uGC(s,"__utma=3D","&")))) a=3D"-";=0A=
   if (!(_uIN(b=3D_uGC(s,"__utmb=3D","&")))) b=3D"-";=0A=
   if (!(_uIN(c=3D_uGC(s,"__utmc=3D","&")))) c=3D"-";=0A=
   v=3D_uGC(s,"__utmv=3D","&");=0A=
   z=3D_uGC(s,"__utmz=3D","&");=0A=
   k=3D_uGC(s,"__utmk=3D","&");=0A=
   xx=3D_uGC(s,"__utmx=3D","&");=0A=
   if ((k*1) !=3D ((_uHash(a+b+c+xx+z+v)*1)+(_udh*1))) =
{_ubl=3D1;a=3D"-";b=3D"-";c=3D"-";xx=3D"-";z=3D"-";v=3D"-";}=0A=
   if (a!=3D"-" && b!=3D"-" && c!=3D"-") f=3D1;=0A=
   else if(a!=3D"-") f=3D2;=0A=
  }=0A=
 }=0A=
 if(f=3D=3D1) {=0A=
  _ubd.cookie=3D"__utma=3D"+a+"; path=3D"+_utcp+";"+nx+_udo;=0A=
  _ubd.cookie=3D"__utmb=3D"+b+"; path=3D"+_utcp+";"+x+_udo;=0A=
  _ubd.cookie=3D"__utmc=3D"+c+"; path=3D"+_utcp+";"+_udo;=0A=
 } else if (f=3D=3D2) {=0A=
  a=3D_uFixA(s,"&",_ust);=0A=
  _ubd.cookie=3D"__utma=3D"+a+"; path=3D"+_utcp+";"+nx+_udo;=0A=
  _ubd.cookie=3D"__utmb=3D"+_udh+"; path=3D"+_utcp+";"+x+_udo;=0A=
  _ubd.cookie=3D"__utmc=3D"+_udh+"; path=3D"+_utcp+";"+_udo;=0A=
  _ufns=3D1;=0A=
 } else if (a>=3D0 && b>=3D0 && c>=3D0) {=0A=
   b =3D _uGC(dc,"__utmb=3D"+_udh,";");=0A=
   b =3D ("-" =3D=3D b) ? _udh : b;  =0A=
  _ubd.cookie=3D"__utmb=3D"+b+"; path=3D"+_utcp+";"+x+_udo;=0A=
 } else {=0A=
  if (a>=3D0) a=3D_uFixA(_ubd.cookie,";",_ust);=0A=
  else {=0A=
   a=3D_udh+"."+_uu+"."+_ust+"."+_ust+"."+_ust+".1";=0A=
   nv=3D1;=0A=
  }=0A=
  _ubd.cookie=3D"__utma=3D"+a+"; path=3D"+_utcp+";"+nx+_udo;=0A=
  _ubd.cookie=3D"__utmb=3D"+_udh+"; path=3D"+_utcp+";"+x+_udo;=0A=
  _ubd.cookie=3D"__utmc=3D"+_udh+"; path=3D"+_utcp+";"+_udo;=0A=
  _ufns=3D1;=0A=
 }=0A=
 if (_ulink && xx && xx!=3D"" && xx!=3D"-") {=0A=
   xx=3D_uUES(xx);=0A=
   if (xx.indexOf(";")=3D=3D-1) _ubd.cookie=3D"__utmx=3D"+xx+"; =
path=3D"+_utcp+";"+nx+_udo;=0A=
 }=0A=
 if (_ulink && v && v!=3D"" && v!=3D"-") {=0A=
  v=3D_uUES(v);=0A=
  if (v.indexOf(";")=3D=3D-1) _ubd.cookie=3D"__utmv=3D"+v+"; =
path=3D"+_utcp+";"+nx+_udo;=0A=
 }=0A=
 var wc=3Dwindow;=0A=
 var c=3D_ubd.cookie;=0A=
 if(wc && wc.gaGlobal && wc.gaGlobal.dh=3D=3D_udh){=0A=
  var g=3Dwc.gaGlobal;=0A=
  var ua=3Dc.split("__utma=3D"+_udh+".")[1].split(";")[0].split(".");=0A=
  if(g.sid)ua[3]=3Dg.sid;=0A=
  if(nv>0){=0A=
   ua[2]=3Dua[3];=0A=
   if(g.vid){=0A=
    var v=3Dg.vid.split(".");=0A=
    ua[0]=3Dv[0];=0A=
    ua[1]=3Dv[1];=0A=
   }=0A=
  }=0A=
  _ubd.cookie=3D"__utma=3D"+_udh+"."+ua.join(".")+"; =
path=3D"+_utcp+";"+nx+_udo;=0A=
 }=0A=
 _uInfo(page);=0A=
 _ufns=3D0;=0A=
 _ufno=3D0;=0A=
 if (!page || page=3D=3D"") _uff=3D1;=0A=
}=0A=
function _uGH() {=0A=
 var hid;=0A=
 var wc=3Dwindow;=0A=
 if (wc && wc.gaGlobal && wc.gaGlobal.hid) {=0A=
  hid=3Dwc.gaGlobal.hid;=0A=
 } else {=0A=
  hid=3DMath.round(Math.random()*0x7fffffff);=0A=
  if (!wc.gaGlobal) wc.gaGlobal=3D{};=0A=
  wc.gaGlobal.hid=3Dhid;=0A=
 }=0A=
 return hid;=0A=
}=0A=
function _uInfo(page) {=0A=
 var p,s=3D"",dm=3D"",pg=3D_udl.pathname+_udl.search;=0A=
 if (page && page!=3D"") pg=3D_uES(page,1);=0A=
 _ur=3D_ubd.referrer;=0A=
 if (!_ur || _ur=3D=3D"") { _ur=3D"-"; }=0A=
 else {=0A=
  dm=3D_ubd.domain;=0A=
  if(_utcp && _utcp!=3D"/") dm+=3D_utcp;=0A=
  p=3D_ur.indexOf(dm);=0A=
  if ((p>=3D0) && (p<=3D8)) { _ur=3D"0"; }=0A=
  if (_ur.indexOf("[")=3D=3D0 && =
_ur.lastIndexOf("]")=3D=3D(_ur.length-1)) { _ur=3D"-"; }=0A=
 }=0A=
 s+=3D"&utmn=3D"+_uu;=0A=
 if (_ufsc) s+=3D_uBInfo();=0A=
 if (_uctm) s+=3D_uCInfo();=0A=
 if (_utitle && _ubd.title && _ubd.title!=3D"") =
s+=3D"&utmdt=3D"+_uES(_ubd.title);=0A=
 if (_udl.hostname && _udl.hostname!=3D"") =
s+=3D"&utmhn=3D"+_uES(_udl.hostname);=0A=
 if (_usample && _usample !=3D 100) s+=3D"&utmsp=3D"+_uES(_usample);=0A=
 s+=3D"&utmhid=3D"+_uGH();=0A=
 s+=3D"&utmr=3D"+_ur;=0A=
 s+=3D"&utmp=3D"+pg;=0A=
 if ((_userv=3D=3D0 || _userv=3D=3D2) && _uSP()) {=0A=
  var i=3Dnew Image(1,1);=0A=
  i.src=3D_ugifpath+"?"+"utmwv=3D"+_uwv+s;=0A=
  i.onload=3Dfunction() { _uVoid(); }=0A=
 }=0A=
 if ((_userv=3D=3D1 || _userv=3D=3D2) && _uSP()) {=0A=
  var i2=3Dnew Image(1,1);=0A=
  =
i2.src=3D_ugifpath2+"?"+"utmwv=3D"+_uwv+s+"&utmac=3D"+_uacct+"&utmcc=3D"+=
_uGCS();=0A=
  i2.onload=3Dfunction() { _uVoid(); }=0A=
 }=0A=
 return;=0A=
}=0A=
function _uVoid() { return; }=0A=
function _uCInfo() {=0A=
 if (!_ucto || _ucto=3D=3D"") { _ucto=3D"15768000"; }=0A=
 if (!_uVG()) return;=0A=
 var =
c=3D"",t=3D"-",t2=3D"-",t3=3D"-",o=3D0,cs=3D0,cn=3D0,i=3D0,z=3D"-",s=3D""=
;=0A=
 if (_uanchor && _udlh && _udlh!=3D"") s=3D_udlh+"&";=0A=
 s+=3D_udl.search;=0A=
 var x=3Dnew Date(_udt.getTime()+(_ucto*1000));=0A=
 var dc=3D_ubd.cookie;=0A=
 x=3D" expires=3D"+x.toGMTString()+";";=0A=
 if (_ulink && !_ubl) {=0A=
  z=3D_uUES(_uGC(s,"__utmz=3D","&"));=0A=
  if (z!=3D"-" && z.indexOf(";")=3D=3D-1) { =
_ubd.cookie=3D"__utmz=3D"+z+"; path=3D"+_utcp+";"+x+_udo; return ""; }=0A=
 }=0A=
 z=3Ddc.indexOf("__utmz=3D"+_udh+".");=0A=
 if (z>-1) { z=3D_uGC(dc,"__utmz=3D"+_udh+".",";"); }=0A=
 else { z=3D"-"; }=0A=
 t=3D_uGC(s,_ucid+"=3D","&");=0A=
 t2=3D_uGC(s,_ucsr+"=3D","&");=0A=
 t3=3D_uGC(s,"gclid=3D","&");=0A=
 if ((t!=3D"-" && t!=3D"") || (t2!=3D"-" && t2!=3D"") || (t3!=3D"-" && =
t3!=3D"")) {=0A=
  if (t!=3D"-" && t!=3D"") c+=3D"utmcid=3D"+_uEC(t);=0A=
  if (t2!=3D"-" && t2!=3D"") { if (c !=3D "") c+=3D"|"; =
c+=3D"utmcsr=3D"+_uEC(t2); }=0A=
  if (t3!=3D"-" && t3!=3D"") { if (c !=3D "") c+=3D"|"; =
c+=3D"utmgclid=3D"+_uEC(t3); }=0A=
  t=3D_uGC(s,_uccn+"=3D","&");=0A=
  if (t!=3D"-" && t!=3D"") c+=3D"|utmccn=3D"+_uEC(t);=0A=
  else c+=3D"|utmccn=3D(not+set)";=0A=
  t=3D_uGC(s,_ucmd+"=3D","&");=0A=
  if (t!=3D"-" && t!=3D"") c+=3D"|utmcmd=3D"+_uEC(t);=0A=
  else  c+=3D"|utmcmd=3D(not+set)";=0A=
  t=3D_uGC(s,_uctr+"=3D","&");=0A=
  if (t!=3D"-" && t!=3D"") c+=3D"|utmctr=3D"+_uEC(t);=0A=
  else { t=3D_uOrg(1); if (t!=3D"-" && t!=3D"") =
c+=3D"|utmctr=3D"+_uEC(t); }=0A=
  t=3D_uGC(s,_ucct+"=3D","&");=0A=
  if (t!=3D"-" && t!=3D"") c+=3D"|utmcct=3D"+_uEC(t);=0A=
  t=3D_uGC(s,_ucno+"=3D","&");=0A=
  if (t=3D=3D"1") o=3D1;=0A=
  if (z!=3D"-" && o=3D=3D1) return "";=0A=
 }=0A=
 if (c=3D=3D"-" || c=3D=3D"") { c=3D_uOrg(); if (z!=3D"-" && =
_ufno=3D=3D1)  return ""; }=0A=
 if (c=3D=3D"-" || c=3D=3D"") { if (_ufns=3D=3D1)  c=3D_uRef(); if =
(z!=3D"-" && _ufno=3D=3D1)  return ""; }=0A=
 if (c=3D=3D"-" || c=3D=3D"") {=0A=
  if (z=3D=3D"-" && _ufns=3D=3D1) { =
c=3D"utmccn=3D(direct)|utmcsr=3D(direct)|utmcmd=3D(none)"; }=0A=
  if (c=3D=3D"-" || c=3D=3D"") return "";=0A=
 }=0A=
 if (z!=3D"-") {=0A=
  i=3Dz.indexOf(".");=0A=
  if (i>-1) i=3Dz.indexOf(".",i+1);=0A=
  if (i>-1) i=3Dz.indexOf(".",i+1);=0A=
  if (i>-1) i=3Dz.indexOf(".",i+1);=0A=
  t=3Dz.substring(i+1,z.length);=0A=
  if (t.toLowerCase()=3D=3Dc.toLowerCase()) cs=3D1;=0A=
  t=3Dz.substring(0,i);=0A=
  if ((i=3Dt.lastIndexOf(".")) > -1) {=0A=
   t=3Dt.substring(i+1,t.length);=0A=
   cn=3D(t*1);=0A=
  }=0A=
 }=0A=
 if (cs=3D=3D0 || _ufns=3D=3D1) {=0A=
  t=3D_uGC(dc,"__utma=3D"+_udh+".",";");=0A=
  if ((i=3Dt.lastIndexOf(".")) > 9) {=0A=
   _uns=3Dt.substring(i+1,t.length);=0A=
   _uns=3D(_uns*1);=0A=
  }=0A=
  cn++;=0A=
  if (_uns=3D=3D0) _uns=3D1;=0A=
  _ubd.cookie=3D"__utmz=3D"+_udh+"."+_ust+"."+_uns+"."+cn+"."+c+"; =
path=3D"+_utcp+"; "+x+_udo;=0A=
 }=0A=
 if (cs=3D=3D0 || _ufns=3D=3D1) return "&utmcn=3D1";=0A=
 else return "&utmcr=3D1";=0A=
}=0A=
function _uRef() {=0A=
 if (_ur=3D=3D"0" || _ur=3D=3D"" || _ur=3D=3D"-") return "";=0A=
 var i=3D0,h,k,n;=0A=
 if ((i=3D_ur.indexOf("://"))<0 || _uGCse()) return "";=0A=
 h=3D_ur.substring(i+3,_ur.length);=0A=
 if (h.indexOf("/") > -1) {=0A=
  k=3Dh.substring(h.indexOf("/"),h.length);=0A=
  if (k.indexOf("?") > -1) k=3Dk.substring(0,k.indexOf("?"));=0A=
  h=3Dh.substring(0,h.indexOf("/"));=0A=
 }=0A=
 h=3Dh.toLowerCase();=0A=
 n=3Dh;=0A=
 if ((i=3Dn.indexOf(":")) > -1) n=3Dn.substring(0,i);=0A=
 for (var ii=3D0;ii<_uRno.length;ii++) {=0A=
  if ((i=3Dn.indexOf(_uRno[ii].toLowerCase())) > -1 && =
n.length=3D=3D(i+_uRno[ii].length)) { _ufno=3D1; break; }=0A=
 }=0A=
 if (h.indexOf("www.")=3D=3D0) h=3Dh.substring(4,h.length);=0A=
 return =
"utmccn=3D(referral)|utmcsr=3D"+_uEC(h)+"|"+"utmcct=3D"+_uEC(k)+"|utmcmd=3D=
referral";=0A=
}=0A=
function _uOrg(t) {=0A=
 if (_ur=3D=3D"0" || _ur=3D=3D"" || _ur=3D=3D"-") return "";=0A=
 var i=3D0,h,k;=0A=
 if ((i=3D_ur.indexOf("://"))<0 || _uGCse()) return "";=0A=
 h=3D_ur.substring(i+3,_ur.length);=0A=
 if (h.indexOf("/") > -1) {=0A=
  h=3Dh.substring(0,h.indexOf("/"));=0A=
 }=0A=
 for (var ii=3D0;ii<_uOsr.length;ii++) {=0A=
  if (h.toLowerCase().indexOf(_uOsr[ii].toLowerCase()) > -1) {=0A=
   if ((i=3D_ur.indexOf("?"+_uOkw[ii]+"=3D")) > -1 || =
(i=3D_ur.indexOf("&"+_uOkw[ii]+"=3D")) > -1) {=0A=
    k=3D_ur.substring(i+_uOkw[ii].length+2,_ur.length);=0A=
    if ((i=3Dk.indexOf("&")) > -1) k=3Dk.substring(0,i);=0A=
    for (var yy=3D0;yy<_uOno.length;yy++) {=0A=
     if (_uOno[yy].toLowerCase()=3D=3Dk.toLowerCase()) { _ufno=3D1; =
break; }=0A=
    }=0A=
    if (t) return _uEC(k);=0A=
    else return =
"utmccn=3D(organic)|utmcsr=3D"+_uEC(_uOsr[ii])+"|"+"utmctr=3D"+_uEC(k)+"|=
utmcmd=3Dorganic";=0A=
   }=0A=
  }=0A=
 }=0A=
 return "";=0A=
}=0A=
function _uGCse() {=0A=
 var h,p;=0A=
 h=3Dp=3D_ur.split("://")[1];=0A=
 if(h.indexOf("/")>-1) {=0A=
  h=3Dh.split("/")[0];=0A=
  p=3Dp.substring(p.indexOf("/")+1,p.length);=0A=
 }=0A=
 if(p.indexOf("?")>-1) {=0A=
  p=3Dp.split("?")[0];=0A=
 }=0A=
 if(h.toLowerCase().indexOf("google")>-1) {=0A=
  if(_ur.indexOf("?q=3D")>-1 || _ur.indexOf("&q=3D")>-1) {=0A=
   if (p.toLowerCase().indexOf("cse")>-1) {=0A=
    return true;=0A=
   }=0A=
  }=0A=
 }=0A=
}=0A=
function _uBInfo() {=0A=
 var sr=3D"-",sc=3D"-",ul=3D"-",fl=3D"-",cs=3D"-",je=3D1;=0A=
 var n=3Dnavigator;=0A=
 if (self.screen) {=0A=
  sr=3Dscreen.width+"x"+screen.height;=0A=
  sc=3Dscreen.colorDepth+"-bit";=0A=
 } else if (self.java) {=0A=
  var j=3Djava.awt.Toolkit.getDefaultToolkit();=0A=
  var s=3Dj.getScreenSize();=0A=
  sr=3Ds.width+"x"+s.height;=0A=
 }=0A=
 if (n.language) { ul=3Dn.language.toLowerCase(); }=0A=
 else if (n.browserLanguage) { ul=3Dn.browserLanguage.toLowerCase(); }=0A=
 je=3Dn.javaEnabled()?1:0;=0A=
 if (_uflash) fl=3D_uFlash();=0A=
 if (_ubd.characterSet) cs=3D_uES(_ubd.characterSet);=0A=
 else if (_ubd.charset) cs=3D_uES(_ubd.charset);=0A=
 return =
"&utmcs=3D"+cs+"&utmsr=3D"+sr+"&utmsc=3D"+sc+"&utmul=3D"+ul+"&utmje=3D"+j=
e+"&utmfl=3D"+fl;=0A=
}=0A=
function __utmSetTrans() {=0A=
 var e;=0A=
 if (_ubd.getElementById) e=3D_ubd.getElementById("utmtrans");=0A=
 else if (_ubd.utmform && _ubd.utmform.utmtrans) =
e=3D_ubd.utmform.utmtrans;=0A=
 if (!e) return;=0A=
 var l=3De.value.split("UTM:");=0A=
 var i,i2,c;=0A=
 if (_userv=3D=3D0 || _userv=3D=3D2) i=3Dnew Array();=0A=
 if (_userv=3D=3D1 || _userv=3D=3D2) { i2=3Dnew Array(); c=3D_uGCS(); }=0A=
=0A=
 for (var ii=3D0;ii<l.length;ii++) {=0A=
  l[ii]=3D_uTrim(l[ii]);=0A=
  if (l[ii].charAt(0)!=3D'T' && l[ii].charAt(0)!=3D'I') continue;=0A=
  var r=3DMath.round(Math.random()*2147483647);=0A=
  if (!_utsp || _utsp=3D=3D"") _utsp=3D"|";=0A=
  var f=3Dl[ii].split(_utsp),s=3D"";=0A=
  if (f[0].charAt(0)=3D=3D'T') {=0A=
   s=3D"&utmt=3Dtran"+"&utmn=3D"+r;=0A=
   f[1]=3D_uTrim(f[1]); if(f[1]&&f[1]!=3D"") =
s+=3D"&utmtid=3D"+_uES(f[1]);=0A=
   f[2]=3D_uTrim(f[2]); if(f[2]&&f[2]!=3D"") =
s+=3D"&utmtst=3D"+_uES(f[2]);=0A=
   f[3]=3D_uTrim(f[3]); if(f[3]&&f[3]!=3D"") =
s+=3D"&utmtto=3D"+_uES(f[3]);=0A=
   f[4]=3D_uTrim(f[4]); if(f[4]&&f[4]!=3D"") =
s+=3D"&utmttx=3D"+_uES(f[4]);=0A=
   f[5]=3D_uTrim(f[5]); if(f[5]&&f[5]!=3D"") =
s+=3D"&utmtsp=3D"+_uES(f[5]);=0A=
   f[6]=3D_uTrim(f[6]); if(f[6]&&f[6]!=3D"") =
s+=3D"&utmtci=3D"+_uES(f[6]);=0A=
   f[7]=3D_uTrim(f[7]); if(f[7]&&f[7]!=3D"") =
s+=3D"&utmtrg=3D"+_uES(f[7]);=0A=
   f[8]=3D_uTrim(f[8]); if(f[8]&&f[8]!=3D"") =
s+=3D"&utmtco=3D"+_uES(f[8]);=0A=
  } else {=0A=
   s=3D"&utmt=3Ditem"+"&utmn=3D"+r;=0A=
   f[1]=3D_uTrim(f[1]); if(f[1]&&f[1]!=3D"") =
s+=3D"&utmtid=3D"+_uES(f[1]);=0A=
   f[2]=3D_uTrim(f[2]); if(f[2]&&f[2]!=3D"") =
s+=3D"&utmipc=3D"+_uES(f[2]);=0A=
   f[3]=3D_uTrim(f[3]); if(f[3]&&f[3]!=3D"") =
s+=3D"&utmipn=3D"+_uES(f[3]);=0A=
   f[4]=3D_uTrim(f[4]); if(f[4]&&f[4]!=3D"") =
s+=3D"&utmiva=3D"+_uES(f[4]);=0A=
   f[5]=3D_uTrim(f[5]); if(f[5]&&f[5]!=3D"") =
s+=3D"&utmipr=3D"+_uES(f[5]);=0A=
   f[6]=3D_uTrim(f[6]); if(f[6]&&f[6]!=3D"") =
s+=3D"&utmiqt=3D"+_uES(f[6]);=0A=
  }=0A=
  if (_udl.hostname && _udl.hostname!=3D"") =
s+=3D"&utmhn=3D"+_uES(_udl.hostname);=0A=
  if (_usample && _usample !=3D 100) s+=3D"&utmsp=3D"+_uES(_usample);=0A=
=0A=
  if ((_userv=3D=3D0 || _userv=3D=3D2) && _uSP()) {=0A=
   i[ii]=3Dnew Image(1,1);=0A=
   i[ii].src=3D_ugifpath+"?"+"utmwv=3D"+_uwv+s;=0A=
   i[ii].onload=3Dfunction() { _uVoid(); }=0A=
  }=0A=
  if ((_userv=3D=3D1 || _userv=3D=3D2) && _uSP()) {=0A=
   i2[ii]=3Dnew Image(1,1);=0A=
   =
i2[ii].src=3D_ugifpath2+"?"+"utmwv=3D"+_uwv+s+"&utmac=3D"+_uacct+"&utmcc=3D=
"+c;=0A=
   i2[ii].onload=3Dfunction() { _uVoid(); }=0A=
  }=0A=
 }=0A=
 return;=0A=
}=0A=
function _uFlash() {=0A=
 var f=3D"-",n=3Dnavigator;=0A=
 if (n.plugins && n.plugins.length) {=0A=
  for (var ii=3D0;ii<n.plugins.length;ii++) {=0A=
   if (n.plugins[ii].name.indexOf('Shockwave Flash')!=3D-1) {=0A=
    f=3Dn.plugins[ii].description.split('Shockwave Flash ')[1];=0A=
    break;=0A=
   }=0A=
  }=0A=
 } else {=0A=
  var fl;=0A=
  try {=0A=
   fl =3D new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");=0A=
   f =3D fl.GetVariable("$version");=0A=
  } catch(e) {}=0A=
  if (f =3D=3D "-") {=0A=
   try {=0A=
    fl =3D new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");=0A=
    f =3D "WIN 6,0,21,0";=0A=
    fl.AllowScriptAccess =3D "always";=0A=
    f =3D fl.GetVariable("$version");=0A=
   } catch(e) {}=0A=
  }=0A=
  if (f =3D=3D "-") {=0A=
   try {=0A=
    fl =3D new ActiveXObject("ShockwaveFlash.ShockwaveFlash");=0A=
    f =3D fl.GetVariable("$version");=0A=
   } catch(e) {}=0A=
  }=0A=
  if (f !=3D "-") {=0A=
   f =3D f.split(" ")[1].split(",");=0A=
   f =3D f[0] + "." + f[1] + " r" + f[2];=0A=
  }=0A=
 }=0A=
 return f;=0A=
}=0A=
function __utmLinkerUrl(l,h) {=0A=
 var p,k,a=3D"-",b=3D"-",c=3D"-",x=3D"-",z=3D"-",v=3D"-";=0A=
 var dc=3D_ubd.cookie;=0A=
 var iq =3D l.indexOf("?");=0A=
 var ih =3D l.indexOf("#");=0A=
 var url=3Dl;=0A=
 if (dc) {=0A=
  a=3D_uES(_uGC(dc,"__utma=3D"+_udh+".",";"));=0A=
  b=3D_uES(_uGC(dc,"__utmb=3D"+_udh,";"));=0A=
  c=3D_uES(_uGC(dc,"__utmc=3D"+_udh,";"));=0A=
  x=3D_uES(_uGC(dc,"__utmx=3D"+_udh,";"));=0A=
  z=3D_uES(_uGC(dc,"__utmz=3D"+_udh+".",";"));=0A=
  v=3D_uES(_uGC(dc,"__utmv=3D"+_udh+".",";"));=0A=
  k=3D(_uHash(a+b+c+x+z+v)*1)+(_udh*1);=0A=
  =
p=3D"__utma=3D"+a+"&__utmb=3D"+b+"&__utmc=3D"+c+"&__utmx=3D"+x+"&__utmz=3D=
"+z+"&__utmv=3D"+v+"&__utmk=3D"+k;=0A=
 }=0A=
 if (p) {=0A=
  if (h && ih>-1) return;=0A=
  if (h) { url=3Dl+"#"+p; }=0A=
  else {=0A=
   if (iq=3D=3D-1 && ih=3D=3D-1) url=3Dl+"?"+p;=0A=
   else if (ih=3D=3D-1) url=3Dl+"&"+p;=0A=
   else if (iq=3D=3D-1) url=3Dl.substring(0,ih-1)+"?"+p+l.substring(ih);=0A=
   else url=3Dl.substring(0,ih-1)+"&"+p+l.substring(ih);=0A=
  }=0A=
 }=0A=
 return url;=0A=
}=0A=
function __utmLinker(l,h) {=0A=
 if (!_ulink || !l || l=3D=3D"") return;=0A=
 _udl.href=3D__utmLinkerUrl(l,h);=0A=
}=0A=
function __utmLinkPost(f,h) {=0A=
 if (!_ulink || !f || !f.action) return;=0A=
 f.action=3D__utmLinkerUrl(f.action, h);=0A=
 return;=0A=
}=0A=
function __utmSetVar(v) {=0A=
 if (!v || v=3D=3D"") return;=0A=
 if (!_udo || _udo =3D=3D "") {=0A=
  _udh=3D_uDomain();=0A=
  if (_udn && _udn!=3D"") { _udo=3D" domain=3D"+_udn+";"; }=0A=
 }=0A=
 if (!_uVG()) return;=0A=
 var r=3DMath.round(Math.random() * 2147483647);=0A=
 _ubd.cookie=3D"__utmv=3D"+_udh+"."+_uES(v)+"; path=3D"+_utcp+"; =
expires=3D"+_uNx()+";"+_udo;=0A=
 var s=3D"&utmt=3Dvar&utmn=3D"+r;=0A=
 if (_usample && _usample !=3D 100) s+=3D"&utmsp=3D"+_uES(_usample);=0A=
 if ((_userv=3D=3D0 || _userv=3D=3D2) && _uSP()) {=0A=
  var i=3Dnew Image(1,1);=0A=
  i.src=3D_ugifpath+"?"+"utmwv=3D"+_uwv+s;=0A=
  i.onload=3Dfunction() { _uVoid(); }=0A=
 }=0A=
 if ((_userv=3D=3D1 || _userv=3D=3D2) && _uSP()) {=0A=
  var i2=3Dnew Image(1,1);=0A=
  =
i2.src=3D_ugifpath2+"?"+"utmwv=3D"+_uwv+s+"&utmac=3D"+_uacct+"&utmcc=3D"+=
_uGCS();=0A=
  i2.onload=3Dfunction() { _uVoid(); }=0A=
 }=0A=
}=0A=
function _uGCS() {=0A=
 var t,c=3D"",dc=3D_ubd.cookie;=0A=
 if ((t=3D_uGC(dc,"__utma=3D"+_udh+".",";"))!=3D"-") =
c+=3D_uES("__utma=3D"+t+";+");=0A=
 if ((t=3D_uGC(dc,"__utmx=3D"+_udh,";"))!=3D"-") =
c+=3D_uES("__utmx=3D"+t+";+");=0A=
 if ((t=3D_uGC(dc,"__utmz=3D"+_udh+".",";"))!=3D"-") =
c+=3D_uES("__utmz=3D"+t+";+");=0A=
 if ((t=3D_uGC(dc,"__utmv=3D"+_udh+".",";"))!=3D"-") =
c+=3D_uES("__utmv=3D"+t+";");=0A=
 if (c.charAt(c.length-1)=3D=3D"+") c=3Dc.substring(0,c.length-1);=0A=
 return c;=0A=
}=0A=
function _uGC(l,n,s) {=0A=
 if (!l || l=3D=3D"" || !n || n=3D=3D"" || !s || s=3D=3D"") return "-";=0A=
 var i,i2,i3,c=3D"-";=0A=
 i=3Dl.indexOf(n);=0A=
 i3=3Dn.indexOf("=3D")+1;=0A=
 if (i > -1) {=0A=
  i2=3Dl.indexOf(s,i); if (i2 < 0) { i2=3Dl.length; }=0A=
  c=3Dl.substring((i+i3),i2);=0A=
 }=0A=
 return c;=0A=
}=0A=
function _uDomain() {=0A=
 if (!_udn || _udn=3D=3D"" || _udn=3D=3D"none") { _udn=3D""; return 1; }=0A=
 if (_udn=3D=3D"auto") {=0A=
  var d=3D_ubd.domain;=0A=
  if (d.substring(0,4)=3D=3D"www.") {=0A=
   d=3Dd.substring(4,d.length);=0A=
  }=0A=
  _udn=3Dd;=0A=
 }=0A=
 _udn =3D _udn.toLowerCase(); =0A=
 if (_uhash=3D=3D"off") return 1;=0A=
 return _uHash(_udn);=0A=
}=0A=
function _uHash(d) {=0A=
 if (!d || d=3D=3D"") return 1;=0A=
 var h=3D0,g=3D0;=0A=
 for (var i=3Dd.length-1;i>=3D0;i--) {=0A=
  var c=3DparseInt(d.charCodeAt(i));=0A=
  h=3D((h << 6) & 0xfffffff) + c + (c << 14);=0A=
  if ((g=3Dh & 0xfe00000)!=3D0) h=3D(h ^ (g >> 21));=0A=
 }=0A=
 return h;=0A=
}=0A=
function _uFixA(c,s,t) {=0A=
 if (!c || c=3D=3D"" || !s || s=3D=3D"" || !t || t=3D=3D"") return "-";=0A=
 var a=3D_uGC(c,"__utma=3D"+_udh+".",s);=0A=
 var lt=3D0,i=3D0;=0A=
 if ((i=3Da.lastIndexOf(".")) > 9) {=0A=
  _uns=3Da.substring(i+1,a.length);=0A=
  _uns=3D(_uns*1)+1;=0A=
  a=3Da.substring(0,i);=0A=
  if ((i=3Da.lastIndexOf(".")) > 7) {=0A=
   lt=3Da.substring(i+1,a.length);=0A=
   a=3Da.substring(0,i);=0A=
  }=0A=
  if ((i=3Da.lastIndexOf(".")) > 5) {=0A=
   a=3Da.substring(0,i);=0A=
  }=0A=
  a+=3D"."+lt+"."+t+"."+_uns;=0A=
 }=0A=
 return a;=0A=
}=0A=
function _uTrim(s) {=0A=
  if (!s || s=3D=3D"") return "";=0A=
  while ((s.charAt(0)=3D=3D' ') || (s.charAt(0)=3D=3D'\n') || =
(s.charAt(0,1)=3D=3D'\r')) s=3Ds.substring(1,s.length);=0A=
  while ((s.charAt(s.length-1)=3D=3D' ') || =
(s.charAt(s.length-1)=3D=3D'\n') || (s.charAt(s.length-1)=3D=3D'\r')) =
s=3Ds.substring(0,s.length-1);=0A=
  return s;=0A=
}=0A=
function _uEC(s) {=0A=
  var n=3D"";=0A=
  if (!s || s=3D=3D"") return "";=0A=
  for (var i=3D0;i<s.length;i++) {if (s.charAt(i)=3D=3D" ") n+=3D"+"; =
else n+=3Ds.charAt(i);}=0A=
  return n;=0A=
}=0A=
function __utmVisitorCode(f) {=0A=
 var r=3D0,t=3D0,i=3D0,i2=3D0,m=3D31;=0A=
 var a=3D_uGC(_ubd.cookie,"__utma=3D"+_udh+".",";");=0A=
 if ((i=3Da.indexOf(".",0))<0) return;=0A=
 if ((i2=3Da.indexOf(".",i+1))>0) r=3Da.substring(i+1,i2); else return =
"";  =0A=
 if ((i=3Da.indexOf(".",i2+1))>0) t=3Da.substring(i2+1,i); else return =
"";  =0A=
 if (f) {=0A=
  return r;=0A=
 } else {=0A=
  var c=3Dnew =
Array('A','B','C','D','E','F','G','H','J','K','L','M','N','P','R','S','T'=
,'U','V','W','X','Y','Z','1','2','3','4','5','6','7','8','9');=0A=
  return =
c[r>>28&m]+c[r>>23&m]+c[r>>18&m]+c[r>>13&m]+"-"+c[r>>8&m]+c[r>>3&m]+c[((r=
&7)<<2)+(t>>30&3)]+c[t>>25&m]+c[t>>20&m]+"-"+c[t>>15&m]+c[t>>10&m]+c[t>>5=
&m]+c[t&m];=0A=
 }=0A=
}=0A=
function _uIN(n) {=0A=
 if (!n) return false;=0A=
 for (var i=3D0;i<n.length;i++) {=0A=
  var c=3Dn.charAt(i);=0A=
  if ((c<"0" || c>"9") && (c!=3D".")) return false;=0A=
 }=0A=
 return true;=0A=
}=0A=
function _uES(s,u) {=0A=
 if (typeof(encodeURIComponent) =3D=3D 'function') {=0A=
  if (u) return encodeURI(s);=0A=
  else return encodeURIComponent(s);=0A=
 } else {=0A=
  return escape(s);=0A=
 }=0A=
}=0A=
function _uUES(s) {=0A=
 if (typeof(decodeURIComponent) =3D=3D 'function') {=0A=
  return decodeURIComponent(s);=0A=
 } else {=0A=
  return unescape(s);=0A=
 }=0A=
}=0A=
function _uVG() {=0A=
 if((_udn.indexOf("www.google.") =3D=3D 0 || _udn.indexOf(".google.") =
=3D=3D 0 || _udn.indexOf("google.") =3D=3D 0) && _utcp=3D=3D'/' && =
_udn.indexOf("google.org")=3D=3D-1) {=0A=
  return false;=0A=
 }=0A=
 return true;=0A=
}=0A=
function _uSP() {=0A=
 var s=3D100;=0A=
 if (_usample) s=3D_usample;=0A=
 if(s>=3D100 || s<=3D0) return true;=0A=
 return ((__utmVisitorCode(1)%10000)<(s*100));=0A=
}=0A=
function urchinPathCopy(p){=0A=
 var d=3Ddocument,nx,tx,sx,i,c,cs,t,h,o;=0A=
 cs=3Dnew Array("a","b","c","v","x","z");=0A=
 h=3D_uDomain(); if (_udn && _udn!=3D"") o=3D" domain=3D"+_udn+";";=0A=
 nx=3D_uNx()+";";=0A=
 tx=3Dnew Date(); tx.setTime(tx.getTime()+(_utimeout*1000));=0A=
 tx=3Dtx.toGMTString()+";";=0A=
 sx=3Dnew Date(); sx.setTime(sx.getTime()+(_ucto*1000));=0A=
 sx=3Dsx.toGMTString()+";";=0A=
 for (i=3D0;i<6;i++){=0A=
  t=3D" expires=3D";=0A=
  if (i=3D=3D1) t+=3Dtx; else if (i=3D=3D2) t=3D""; else if (i=3D=3D5) =
t+=3Dsx; else t+=3Dnx;=0A=
  c=3D_uGC(d.cookie,"__utm"+cs[i]+"=3D"+h,";");=0A=
  if (c!=3D"-") d.cookie=3D"__utm"+cs[i]+"=3D"+c+"; path=3D"+p+";"+t+o;=0A=
 }=0A=
}=0A=
function _uCO() {=0A=
 if (!_utk || _utk=3D=3D"" || _utk.length<10) return;=0A=
 var d=3D'www.google.com';=0A=
 if (_utk.charAt(0)=3D=3D'!') d=3D'analytics.corp.google.com';=0A=
 _ubd.cookie=3D"GASO=3D"+_utk+"; path=3D"+_utcp+";"+_udo;=0A=
 var sc=3Ddocument.createElement('script');=0A=
 sc.type=3D'text/javascript';=0A=
 sc.id=3D"_gasojs";=0A=
 =
sc.src=3D'https://'+d+'/analytics/reporting/overlay_js?gaso=3D'+_utk+'&'+=
Math.random();=0A=
 document.getElementsByTagName('head')[0].appendChild(sc);  =0A=
}=0A=
function _uGT() {=0A=
 var h=3Dlocation.hash, a;=0A=
 if (h && h!=3D"" && h.indexOf("#gaso=3D")=3D=3D0) {=0A=
  a=3D_uGC(h,"gaso=3D","&");=0A=
 } else {=0A=
  a=3D_uGC(_ubd.cookie,"GASO=3D",";");=0A=
 }=0A=
 return a;=0A=
}=0A=
var _utk=3D_uGT();=0A=
if (_utk && _utk!=3D"" && _utk.length>10 && _utk.indexOf("=3D")=3D=3D-1) =
{=0A=
 if (window.addEventListener) {=0A=
  window.addEventListener('load', _uCO, false); =0A=
 } else if (window.attachEvent) { =0A=
  window.attachEvent('onload', _uCO);=0A=
 }=0A=
}=0A=
=0A=
function _uNx() {=0A=
  return (new Date((new Date()).getTime()+63072000000)).toGMTString();=0A=
}=0A=

------=_NextPart_000_0029_01CDC768.C75D0220
Content-Type: application/octet-stream
Content-Transfer-Encoding: quoted-printable
Content-Location: http://www.googleadservices.com/pagead/conversion.js

(function(){var f=3Dnull;var h=3D"google_conversion_id =
google_conversion_format google_conversion_type =
google_conversion_order_id google_conversion_language =
google_conversion_value google_conversion_domain google_conversion_label =
google_conversion_color google_disable_viewthrough =
google_remarketing_only google_remarketing_for_search =
google_conversion_items google_custom_params google_conversion_date =
google_conversion_time google_conversion_js_version onload_callback =
opt_image_generator google_is_call google_conversion_page_url".split(" =
");=0A=
function j(b){return b!=3Df?escape(b.toString()):""}function k(b,c){var =
g=3Dj(c);if(""!=3Dg){var =
a=3Dj(b);if(""!=3Da)return"&".concat(a,"=3D",g)}return""}function =
l(b){var c=3Dtypeof b;return =
b=3D=3Df||"object"=3D=3Dc||"function"=3D=3Dc?f:String(b).replace(/,/g,"\\=
,").replace(/;/g,"\\;").replace(/=3D/g,"\\=3D")}=0A=
function m(b){var c;b=3Db.google_custom_params;if(!b||"object"!=3Dtypeof =
b||"function"=3D=3Dtypeof b.join)c=3D"";else{var g=3D[];for(c in =
b)if(Object.prototype.hasOwnProperty.call(b,c)){var =
a=3Db[c];if(a&&"function"=3D=3Dtypeof a.join){for(var =
d=3D[],e=3D0;e<a.length;++e){var =
s=3Dl(a[e]);s!=3Df&&d.push(s)}a=3D0=3D=3Dd.length?f:d.join(",")}else =
a=3Dl(a);(d=3Dl(c))&&a!=3Df&&g.push(d+"=3D"+a)}c=3Dg.join(";")}return""=3D=
=3Dc?"":"&".concat("data=3D",encodeURIComponent(c))}=0A=
function n(b){return"number"!=3Dtypeof b&&"string"!=3Dtypeof =
b?"":j(b.toString())}function =
p(b){if(!b)return"";b=3Db.google_conversion_items;if(!b)return"";for(var =
c=3D[],g=3D0,a=3Db.length;g<a;g++){var =
d=3Db[g],e=3D[];d&&(e.push(n(d.value)),e.push(n(d.quantity)),e.push(n(d.i=
tem_id)),e.push(n(d.adwords_grouping)),e.push(n(d.sku)),c.push("("+e.join=
("*")+")"))}return 0<c.length?"&item=3D"+c.join(""):""}=0A=
function q(b,c,g){var a=3D[];if(b){var =
d=3Db.screen;d&&(a.push(k("u_h",d.height)),a.push(k("u_w",d.width)),a.pus=
h(k("u_ah",d.availHeight)),a.push(k("u_aw",d.availWidth)),a.push(k("u_cd"=
,d.colorDepth)));b.history&&a.push(k("u_his",b.history.length))}g&&"funct=
ion"=3D=3Dtypeof =
g.getTimezoneOffset&&a.push(k("u_tz",-g.getTimezoneOffset()));c&&("functi=
on"=3D=3Dtypeof =
c.javaEnabled&&a.push(k("u_java",c.javaEnabled())),c.plugins&&a.push(k("u=
_nplug",c.plugins.length)),c.mimeTypes&&a.push(k("u_nmime",c.mimeTypes.le=
ngth)));=0A=
return a.join("")}function r(b,c,g){var a=3D"";if(c){var =
a=3Da+k("ref",c.referrer!=3Df?c.referrer.toString().substring(0,256):""),=
d;c=3D2;try{if(b.top.document=3D=3Db.document)c=3D0;else{var =
e=3Db.top;try{d=3D!!e.location.href||""=3D=3D=3De.location.href}catch(s){=
d=3D!1}d&&(c=3D1)}}catch(L){}d=3Dc;e=3D"";e=3Dg?g:1=3D=3Dd?b.top.location=
.href:b.location.href;a+=3Dk("url",e!=3Df?e.toString().substring(0,256):"=
");a+=3Dk("frm",d)}return a}=0A=
function t(b){return =
b&&b.location&&b.location.protocol&&"https:"=3D=3Db.location.protocol.toS=
tring().toLowerCase()?"https:":"http:"}function u(b,c,g){return =
t(b)+"//"+(g.google_remarketing_only?"googleads.g.doubleclick.net":g.goog=
le_conversion_domain||"www.googleadservices.com")+"/pagead/"+c}=0A=
function v(){var =
b=3Dw,c=3Dnavigator,g=3Ddocument,a=3Dw,d=3D"/?";"landing"=3D=3Da.google_c=
onversion_type&&(d=3D"/extclk?");var =
d=3Du(b,[a.google_remarketing_only?"viewthroughconversion/":"conversion/"=
,j(a.google_conversion_id),d,"random=3D",j(a.google_conversion_time)].joi=
n(""),a),e;a:{e=3Da.google_conversion_language;if(e!=3Df){e=3De.toString(=
);if(2=3D=3De.length){e=3Dk("hl",e);break =
a}if(5=3D=3De.length){e=3Dk("hl",e.substring(0,2))+k("gl",e.substring(3,5=
));break =
a}}e=3D""}c=3D[k("cv",a.google_conversion_js_version),k("fst",a.google_co=
nversion_first_time),=0A=
k("num",a.google_conversion_snippets),k("fmt",a.google_conversion_format)=
,k("value",a.google_conversion_value),k("label",a.google_conversion_label=
),k("oid",a.google_conversion_order_id),k("bg",a.google_conversion_color)=
,e,k("guid","ON"),k("disvt",a.google_disable_viewthrough),k("is_call",a.g=
oogle_is_call),p(a),q(b,c,a.google_conversion_date),r(b,g,a.google_conver=
sion_page_url),m(a),a.google_remarketing_for_search&&!a.google_conversion=
_domain?"&srr=3Dn":""].join("");c=3Dd+c;g=3Dfunction(a,b,c){return'<img =
height=3D"'+=0A=
c+'" width=3D"'+b+'" border=3D"0" src=3D"'+a+'" />'};return =
0=3D=3Da.google_conversion_format&&a.google_conversion_domain=3D=3Df?'<a =
href=3D"'+(t(b)+"//services.google.com/sitestats/"+({ar:1,bg:1,cs:1,da:1,=
de:1,el:1,en_AU:1,en_US:1,en_GB:1,es:1,et:1,fi:1,fr:1,hi:1,hr:1,hu:1,id:1=
,is:1,it:1,iw:1,ja:1,ko:1,lt:1,nl:1,no:1,pl:1,pt_BR:1,pt_PT:1,ro:1,ru:1,s=
k:1,sl:1,sr:1,sv:1,th:1,tl:1,tr:1,vi:1,zh_CN:1,zh_TW:1}[a.google_conversi=
on_language]?a.google_conversion_language+".html":"en_US.html")+"?cid=3D"=
+j(a.google_conversion_id))+=0A=
'" =
target=3D"_blank">'+g(c,135,27)+"</a>":1<a.google_conversion_snippets||3=3D=
=3Da.google_conversion_format?g(c,1,1):'<iframe =
name=3D"google_conversion_frame" =
width=3D"'+(2=3D=3Da.google_conversion_format?200:300)+'" =
height=3D"'+(2=3D=3Da.google_conversion_format?26:13)+'" src=3D"'+c+'" =
frameborder=3D"0" marginwidth=3D"0" marginheight=3D"0" vspace=3D"0" =
hspace=3D"0" allowtransparency=3D"true" =
scrolling=3D"no">'+g(c.replace(/\?random=3D/,"?frame=3D0&random=3D"),1,1)=
+"</iframe>"}function x(){return new Image};var w=3Dwindow;=0A=
if(w)if(/[\?&;]google_debug/.exec(document.URL)!=3Df){var =
y=3Dw,z=3Ddocument.getElementsByTagName("head")[0];z||(z=3Ddocument.creat=
eElement("head"),document.getElementsByTagName("html")[0].insertBefore(z,=
document.getElementsByTagName("body")[0]));var =
A=3Ddocument.createElement("script");A.src=3Du(window,"conversion_debug_o=
verlay.js",y);z.appendChild(A)}else{try{var B;var =
C=3Dw;"landing"=3D=3DC.google_conversion_type||!C.google_conversion_id||C=
.google_remarketing_only&&C.google_disable_viewthrough?B=3D!1:(C.google_c=
onversion_date=3D=0A=
new =
Date,C.google_conversion_time=3DC.google_conversion_date.getTime(),C.goog=
le_conversion_snippets=3D"number"=3D=3Dtypeof =
C.google_conversion_snippets&&0<C.google_conversion_snippets?C.google_con=
version_snippets+1:1,"number"!=3Dtypeof =
C.google_conversion_first_time&&(C.google_conversion_first_time=3DC.googl=
e_conversion_time),C.google_conversion_js_version=3D"7",0!=3DC.google_con=
version_format&&(1!=3DC.google_conversion_format&&2!=3DC.google_conversio=
n_format&&3!=3DC.google_conversion_format)&&(C.google_conversion_format=3D=0A=
1),B=3D!0);if(B&&(document.write(v()),w.google_remarketing_for_search&&!w=
.google_conversion_domain)){var =
D=3Dw,E,F=3Dw,G;G=3Dt(F)+"//www.google.com/ads/user-lists/"+[j(D.google_c=
onversion_id),"/?random=3D",Math.floor(1E9*Math.random())].join("");E=3DG=
+=3D[k("label",D.google_conversion_label),k("fmt","3"),r(F,document,D.goo=
gle_conversion_page_url)].join("");var H=3Dx;"function"=3D=3D=3Dtypeof =
D.opt_image_generator&&(H=3DD.opt_image_generator);var =
I=3DH();E+=3Dk("async","1");I.src=3DE;I.onload=3Dfunction(){}}}catch(J){}=
for(var K=3D=0A=
w,M=3D0;M<h.length;M++)K[h[M]]=3Df};})();=0A=

------=_NextPart_000_0029_01CDC768.C75D0220--
